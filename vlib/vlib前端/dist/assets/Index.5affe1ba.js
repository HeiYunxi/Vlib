import{u as _}from"./user.d8d3d080.js";import{m as j,v as A,a as p,r as k,b as d,o as F,c as O,d as e,w as l,f as i,u as h,e as V,x as G,E as m}from"./index.36f971ea.js";import"./http.67206c72.js";const H={style:{"text-align":"center"}},J={slot:"footer",class:"dialog-footer",style:{"text-align":"center","padding-top":"20px"}},X={__name:"Index",setup(K){const C=j();A(()=>{f()});const w=p([]),r=p([]);let y=p();const g=p(!1);let b=p([]),c=k({roleId:"",roleName:""}),x=p(0);const u=k({pageNum:1,pageSize:10,account:""}),f=async()=>{const a=await _.getUserList(u);console.log(a),b.value=a.data.data,console.log(a.data.data),x.value=a.data.total},z=a=>{u.pageSize=a,f()},N=a=>{u.pageNum=a,f()},I=()=>{u.pageNum=1,f()},U=a=>{G.confirm("\u786E\u5B9A\u8981\u5220\u9664\u8BE5\u7528\u6237\u4FE1\u606F\u5417?",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(async()=>{(await _.delUser({userId:a})).data?(m.success("\u5220\u9664\u6210\u529F"),f()):m.error("\u5220\u9664\u5931\u8D25")}).catch(()=>{m({type:"info",message:"\u53D6\u6D88\u5220\u9664"})})},B=async a=>{M(),y.value=a,g.value=!0;const t=await _.getRoleMap({userId:a});c.value=t.data.data;for(let n=0;n<c.value.length;n++)w.value.push({key:c.value[n].roleId,label:c.value[n].roleName,disabled:!1});const s=await _.getUserRoleMap({userId:a});c.value=s.data.data;for(let n=0;n<c.value.length;n++)r.value.push(c.value[n].roleId)},S=a=>{a()},E=async()=>{if(r.value.length==0){m.error("\u7528\u6237\u89D2\u8272\u81F3\u5C11\u9009\u62E9\u4E00\u9879");return}(await _.saveUserRole({userId:y.value,rolelist:r.value})).data?m.success("\u7528\u6237\u89D2\u8272\u8BBE\u7F6E\u6210\u529F"):m.error("\u7528\u6237\u89D2\u8272\u8BBE\u7F6E\u5931\u8D25"),g.value=!1,console.log(r.value),r.value.forEach(function(t){console.log(t)})},M=()=>{r.value=[],w.value=[]};return(a,t)=>{const s=d("el-button"),n=d("el-input"),v=d("el-table-column"),R=d("el-table"),q=d("el-pagination"),D=d("el-card"),T=d("el-transfer"),$=d("el-dialog");return F(),O("div",null,[e(D,null,{default:l(()=>[e(n,{style:{width:"440px"},onClear:I,clearable:"",modelValue:u.account,"onUpdate:modelValue":t[0]||(t[0]=o=>u.account=o),placeholder:"\u8BF7\u8F93\u5165\u8D26\u53F7",class:"input-with-select"},{append:l(()=>[e(s,{icon:"Search",onClick:I})]),_:1},8,["modelValue"]),i(" \xA0\xA0\xA0 "),e(s,{type:"primary",onClick:t[1]||(t[1]=()=>h(C).push({path:"/user/save",query:{userId:""}}))},{default:l(()=>[i("\u65B0\u589E\u7528\u6237 ")]),_:1}),e(R,{data:h(b),border:"",style:{width:"100%","margin-top":"20px"}},{default:l(()=>[e(v,{prop:"userId",label:"ID",width:"180"}),e(v,{prop:"userName",label:"\u7528\u6237\u540D",width:"180"}),e(v,{prop:"account",label:"\u8D26\u53F7",width:"180"}),e(v,{prop:"phone",label:"\u624B\u673A\u53F7",width:"180"}),e(v,{label:"\u64CD\u4F5C",width:"330"},{default:l(o=>[e(s,{type:"danger",size:"small",onClick:L=>U(o.row.userId)},{default:l(()=>[i("\u5220\u9664")]),_:2},1032,["onClick"]),e(s,{size:"small",onClick:()=>h(C).push({path:"/user/detail",query:{userId:o.row.userId}})},{default:l(()=>[i("\u8BE6\u60C5")]),_:2},1032,["onClick"]),e(s,{size:"small",onClick:()=>h(C).push({path:"/user/detail",query:{userId:o.row.userId,edit:1}})},{default:l(()=>[i("\u7F16\u8F91")]),_:2},1032,["onClick"]),e(s,{size:"small",onClick:L=>B(o.row.userId)},{default:l(()=>[i("\u89D2\u8272\u8BBE\u7F6E")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(q,{style:{"margin-top":"20px"},"current-page":u.pageNum,"page-size":u.pageSize,"page-sizes":[10,20,30,40],layout:"->,total, sizes, prev, pager, next, jumper",total:h(x),onSizeChange:z,onCurrentChange:N},null,8,["current-page","page-size","total"])]),_:1}),e($,{title:"\u89D2\u8272\u8BBE\u7F6E",modelValue:g.value,"onUpdate:modelValue":t[4]||(t[4]=o=>g.value=o),width:"700px","before-close":S},{default:l(()=>[V("div",H,[e(T,{modelValue:r.value,"onUpdate:modelValue":t[2]||(t[2]=o=>r.value=o),titles:["\u672A\u9009\u62E9","\u5DF2\u9009\u62E9"],data:w.value},null,8,["modelValue","data"])]),V("div",J,[e(s,{onClick:t[3]||(t[3]=o=>g.value=!1)},{default:l(()=>[i("\u53D6 \u6D88")]),_:1}),e(s,{type:"primary",onClick:E},{default:l(()=>[i("\u786E \u5B9A")]),_:1})])]),_:1},8,["modelValue"])])}}};export{X as default};
