import{u as v}from"./user.778b4438.js";import{n as L,z as j,a as p,r as z,b as d,c as F,d as O,e,w as l,f as y,h as i,u as h,A as G,E as m}from"./index.cc30dbfe.js";import"./http.f2a51fde.js";const H=y("p",null,"\u7528\u6237\u7BA1\u7406",-1),J={style:{"text-align":"center"}},K={slot:"footer",class:"dialog-footer",style:{"text-align":"center","padding-top":"20px"}},Y={__name:"Index",setup(P){const C=L();j(()=>{_()});let b=p();const w=p([]),r=p([]),g=p(!1);let x=p([]),c=z({roleId:"",roleName:""}),k=p(0);const u=z({pageNum:1,pageSize:10,account:""}),_=async()=>{const a=await v.getUserList(u);x.value=a.data.data,k.value=a.data.total},V=a=>{u.pageSize=a,_()},N=a=>{u.pageNum=a,_()},I=()=>{u.pageNum=1,_()},U=a=>{G.confirm("\u786E\u5B9A\u8981\u5220\u9664\u8BE5\u7528\u6237\u4FE1\u606F\u5417?",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(async()=>{(await v.delUser({userId:a})).data?(m.success("\u5220\u9664\u6210\u529F"),_()):m.error("\u5220\u9664\u5931\u8D25")}).catch(()=>{m({type:"info",message:"\u53D6\u6D88\u5220\u9664"})})},B=async a=>{M(),b.value=a,g.value=!0;const t=await v.getRoleMap({userId:a});c.value=t.data.data;for(let n=0;n<c.value.length;n++)w.value.push({key:c.value[n].roleId,label:c.value[n].roleName,disabled:!1});const s=await v.getUserRoleMap({userId:a});c.value=s.data.data;for(let n=0;n<c.value.length;n++)r.value.push(c.value[n].roleId)},S=a=>{a()},E=async()=>{if(r.value.length==0){m.error("\u7528\u6237\u89D2\u8272\u81F3\u5C11\u9009\u62E9\u4E00\u9879");return}(await v.saveUserRole({userId:b.value,rolelist:r.value})).data?m.success("\u7528\u6237\u89D2\u8272\u8BBE\u7F6E\u6210\u529F"):m.error("\u7528\u6237\u89D2\u8272\u8BBE\u7F6E\u5931\u8D25"),g.value=!1,console.log(r.value),r.value.forEach(function(t){console.log(t)})},M=()=>{r.value=[],w.value=[]};return(a,t)=>{const s=d("el-button"),n=d("el-input"),f=d("el-table-column"),R=d("el-table"),q=d("el-pagination"),T=d("el-card"),$=d("el-transfer"),A=d("el-dialog");return F(),O("div",null,[H,e(T,null,{default:l(()=>[e(n,{style:{width:"440px"},onClear:I,clearable:"",modelValue:u.account,"onUpdate:modelValue":t[0]||(t[0]=o=>u.account=o),placeholder:"\u8BF7\u8F93\u5165\u8D26\u53F7",class:"input-with-select"},{append:l(()=>[e(s,{icon:"Search",onClick:I})]),_:1},8,["modelValue"]),i(" \xA0\xA0\xA0 "),e(s,{type:"primary",onClick:t[1]||(t[1]=()=>h(C).push({path:"/user/save",query:{userId:""}}))},{default:l(()=>[i("\u65B0\u589E\u7528\u6237")]),_:1}),e(R,{data:h(x),border:"",style:{width:"100%","margin-top":"20px"}},{default:l(()=>[e(f,{prop:"userId",label:"id",width:"180"}),e(f,{prop:"userName",label:"\u7528\u6237\u540D",width:"180"}),e(f,{prop:"account",label:"\u8D26\u53F7",width:"180"}),e(f,{prop:"phone",label:"\u624B\u673A\u53F7",width:"180"}),e(f,{label:"\u64CD\u4F5C",width:"330"},{default:l(o=>[e(s,{type:"danger",size:"small",onClick:D=>U(o.row.userId)},{default:l(()=>[i("\u5220\u9664")]),_:2},1032,["onClick"]),e(s,{size:"small",onClick:()=>h(C).push({path:"/user/detail",query:{userId:o.row.userId}})},{default:l(()=>[i("\u8BE6\u60C5")]),_:2},1032,["onClick"]),e(s,{size:"small",onClick:()=>h(C).push({path:"/user/detail",query:{userId:o.row.userId,edit:1}})},{default:l(()=>[i("\u7F16\u8F91")]),_:2},1032,["onClick"]),e(s,{size:"small",onClick:D=>B(o.row.userId)},{default:l(()=>[i("\u89D2\u8272\u8BBE\u7F6E")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(q,{style:{"margin-top":"20px"},"current-page":u.pageNum,"page-size":u.pageSize,"page-sizes":[10,20,30,40],layout:"->,total, sizes, prev, pager, next, jumper",total:h(k),onSizeChange:V,onCurrentChange:N},null,8,["current-page","page-size","total"])]),_:1}),e(A,{title:"\u89D2\u8272\u8BBE\u7F6E",modelValue:g.value,"onUpdate:modelValue":t[4]||(t[4]=o=>g.value=o),width:"700px","before-close":S},{default:l(()=>[y("div",J,[e($,{modelValue:r.value,"onUpdate:modelValue":t[2]||(t[2]=o=>r.value=o),titles:["\u672A\u9009\u62E9","\u5DF2\u9009\u62E9"],data:w.value},null,8,["modelValue","data"])]),y("div",K,[e(s,{onClick:t[3]||(t[3]=o=>g.value=!1)},{default:l(()=>[i("\u53D6 \u6D88")]),_:1}),e(s,{type:"primary",onClick:E},{default:l(()=>[i("\u786E \u5B9A")]),_:1})])]),_:1},8,["modelValue"])])}}};export{Y as default};
