"object"==typeof globalThis&&(globalThis.jsExecStartTimeStamp=Date.now()),(self.webpackChunkuni=self.webpackChunkuni||[]).push([[9140],{915833:function(e,t){t.Z={titlebar:"titlebar--AeZff","menu-icon-button":"menu-icon-button--zS+Iz",menuIconButton:"menu-icon-button--zS+Iz"}},266169:function(e,t,n){n.d(t,{Z:function(){return d}});var o=n(839461),i=n(87363),r=n.n(i),a=n(495155),c=n(707605).qO.getInstance(),l=c.canUseAI,u=c.isAIUserPassed;l&&u&&(n.e(7601).then(n.bind(n,327601)).catch((function(e){return a.Logger.error("get toolbar icon error：".concat(null==e?void 0:e.message))})),n.e(4340).then(n.bind(n,424340)).catch((function(e){return a.Logger.error("get toolbar_motion_once icon error：".concat(null==e?void 0:e.message))})));var s={display:"flex",justifyContent:"center",alignItems:"center"};function d(e){var t=(0,o.__read)((0,i.useState)(!1),2),c=t[0],d=t[1],p=(0,o.__read)((0,i.useState)(""),2),f=p[0],m=p[1],v=(0,o.__read)((0,i.useState)(""),2),h=v[0],g=v[1],E=e.style,y=void 0===E?{}:E,_=e.anim;if((0,i.useEffect)((function(){l&&u&&(n.e(7601).then(n.bind(n,327601)).then((function(e){return m(e.default)})).catch((function(e){return a.Logger.error("get toolbar icon error：".concat(null==e?void 0:e.message))})),_&&n.e(4340).then(n.bind(n,424340)).then((function(e){return g(e.default)})).catch((function(e){return a.Logger.error("get toolbar_motion_once icon error：".concat(null==e?void 0:e.message))})))}),[]),!l||!u)return r().createElement(r().Fragment,null);var b=f;return _&&c&&(b=h),r().createElement("div",{style:s,onMouseEnter:function(){return d(!0)},onMouseLeave:function(){return d(!1)}},b&&r().createElement("img",{style:y,src:b}))}},592698:function(e,t,n){n.d(t,{Gr:function(){return c},aI:function(){return a},f8:function(){return o}});var o,i=n(839461),r=n(495155);!function(e){e.BEFORE_REPLACE_URL="BEFORE_REPLACE_URL",e.ON_GET_DATA_START="ON_GET_DATA_START",e.ON_DATA_READY="ON_DATA_READY",e.AFTER_REPLACE_URL="AFTER_REPLACE_URL",e.SWITCH_TO_BACKGROUND="SWITCH_TO_BACKGROUND",e.ON_READY="ON_READY"}(o||(o={})),function(e){function t(t){var n=e.call(this,o.BEFORE_REPLACE_URL)||this;return n.secretId=t,n}(0,i.__extends)(t,e)}(r.Notification),function(e){function t(t){var n=e.call(this,o.ON_GET_DATA_START)||this;return n.secretId=t,n}(0,i.__extends)(t,e)}(r.Notification),function(e){function t(t,n){var i=e.call(this,o.ON_DATA_READY)||this;return i.secretId=t,i.clientVars=n,i}(0,i.__extends)(t,e)}(r.Notification),function(e){function t(t){var n=e.call(this,o.AFTER_REPLACE_URL)||this;return n.secretId=t,n}(0,i.__extends)(t,e)}(r.Notification);var a=function(e){function t(){return e.call(this,o.SWITCH_TO_BACKGROUND)||this}return(0,i.__extends)(t,e),t}(r.Notification),c=function(e){function t(){return e.call(this,o.ON_READY)||this}return(0,i.__extends)(t,e),t}(r.Notification)},834012:function(e,t,n){n.d(t,{$:function(){return a}});var o=n(750670),i=(n(495155),n(731373)),r=n(294677),a=function(){function e(){}return e.create=function(t,n,a,c){var l=window.QRCode;if(l){var u=c&&c.width?c.width:100,s=c&&c.height?c.height:100,d=c&&c.correctLevel?c.correctLevel:l.CorrectLevel.Q,p=document.createElement("div");p.style.width="".concat(u,"px"),p.style.height="".concat(s,"px");var f=document.createElement("canvas");f.setAttribute("width","".concat(u)),f.setAttribute("height","".concat(s)),c&&c.autosize&&(f.style.width="100%",f.style.height="auto");var m=f.getContext("2d");if(new l(p,{width:u,height:s,correctLevel:d}).makeCode(n),m){var v=p.lastChild;v&&v instanceof HTMLImageElement?v.onload=function(){var n=new Image;n.width=u,n.height=s,n.onload=function(){if(n.src)if(m.drawImage(n,0,0,u,s),a){var o=new Image,l=e.getPercentByCorrectLevel(d),p=u*l/100,v=s*l/100;o.width=p,o.height=v;var h=(u-p)/2,g=(s-v)/2;o.onload=function(){for(m.drawImage(o,h,g,p,v);t.hasChildNodes();)t.lastChild.remove();t.appendChild(f)},c&&1===c.logoType?o.src=i.Z:o.src=r.Z}else t.appendChild(f)},n.src=o.NodeUtil.getAttr(v,"src")||""}:t.appendChild(p)}else t.appendChild(p)}},e.getPercentByCorrectLevel=function(e){var t=window.QRCode,n=0;return e===t.CorrectLevel.L?n=7:e===t.CorrectLevel.M?n=15:e===t.CorrectLevel.Q?n=25:e===t.CorrectLevel.H&&(n=30),n},e}()},612981:function(e,t,n){n.d(t,{GI:function(){return i},SL:function(){return c},bs:function(){return a},cF:function(){return u},po:function(){return l}});var o=n(495155);function i(e,t){t.createdDate=+new Date;var n,i="docs_actions",r=(n=i,o.LocalStorageUtil.getItem(n));r=r&&JSON.parse(r)||[];var a={};r.forEach((function(e,t){var n=e.data;a["".concat(n.localPadId,"$").concat(n.domainId)]={index:t,type:e.type,value:n}}));var c,l,u=a["".concat(t.localPadId,"$").concat(t.domainId)];if(u){for(var s in t)s&&(u.value[s]=t[s]);r[u.index]={type:"ADD"===u.type&&"MODIFY"===e?"ADD":e,data:u.value}}else r.push({type:e,data:t});c=i,l=JSON.stringify(r),o.LocalStorageUtil.setItem(c,l)}function r(e){var t=window.clientVars,n=t&&t.userInfo&&t.userInfo.userId;return"".concat(e,"-").concat(n)}function a(e){return"1"===o.LocalStorageUtil.getItem(r(e))}function c(e){o.LocalStorageUtil.setItem(r(e),"1")}function l(e,t,n){try{var i=o.LocalStorageUtil.getItem(e)||"{}",r=JSON.parse(i);return r[t]=n,o.LocalStorageUtil.setItem(e,JSON.stringify(r)),!0}catch(e){return!1}}function u(e,t){try{var n=o.LocalStorageUtil.getItem(e)||"{}";return JSON.parse(n)[t]}catch(e){return}}},464871:function(e,t,n){n.r(t),n.d(t,{IAddonNewFeature:function(){return l}});var o=n(839461),i=n(259356),r=n(870372),a=n(293325),c=n(336338),l=Symbol.for("feature:".concat(r.C.AddonNew));i.Ln.merge(l,{useFactory:function(){return(0,o.__awaiter)(void 0,void 0,void 0,(function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5597),n.e(9820),n.e(5660)]).then(n.bind(n,953460))];case 1:return[2,e.sent().AddonNewHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2,a.YV.Publish],key:l,load:!c.cm})})},451662:function(e,t,n){n.r(t),n.d(t,{IAIFeature:function(){return l}});var o=n(839461),i=n(259356),r=n(870372),a=n(707605),c=n(293325),l=Symbol.for("feature:".concat(r.C.AI));i.Ln.merge(l,{useFactory:function(){return(0,o.__awaiter)(void 0,void 0,void 0,(function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(5741).then(n.bind(n,740886))];case 1:return[2,e.sent().AIEditorHandler]}}))}))},on:c.iz.On({stages:[c.YV.Level2,c.YV.Publish],key:l,load:a.qO.getInstance().shouldLoadAI})})},860511:function(e,t,n){n.d(t,{e:function(){return s}});var o=n(839461),i=n(87363),r=n.n(i),a=n(199235),c=n(136454),l=n(446296),u=r().lazy((function(){return n.e(9621).then(n.t.bind(n,39621,23))})),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.render=function(){var e=(0,c.Yi)().official_auth_info||l.f.domainInfo.userOfficialInfo;return r().createElement(r().Suspense,{fallback:null},r().createElement(u,(0,o.__assign)({},e)))},t.contextType=a.FN,t}(i.Component)},952884:function(e,t,n){n.r(t),n.d(t,{IFieldcodeMentionFeature:function(){return c}});var o=n(839461),i=n(870372),r=n(259356),a=n(293325),c=(n(495155),Symbol.for("feature:".concat(i.C.FieldcodeMention)));r.Ln.merge(c,{useFactory:function(){return(0,o.__awaiter)(void 0,void 0,void 0,(function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5070),n.e(9440),n.e(5597),n.e(9820),n.e(6649),n.e(6922),n.e(5049),n.e(8063),n.e(6205),n.e(8971),n.e(823),n.e(1997),n.e(9140),n.e(2557),n.e(3974),n.e(2878),n.e(2340),n.e(4292),n.e(4397),n.e(4427),n.e(5576),n.e(520)]).then(n.bind(n,802803))];case 1:return[2,e.sent().FieldCodeMentionHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:c,platforms:[a.Ev.Pad,a.Ev.Mobile,a.Ev.Pc],load:!0})})},503642:function(e,t,n){n.r(t),n.d(t,{IFileExportHandler:function(){return c}});var o=n(839461),i=n(259356),r=n(870372),a=n(293325),c=Symbol.for("feature:".concat(r.C.FileExport));i.Ln.merge(c,{useFactory:function(){return(0,o.__awaiter)(void 0,void 0,void 0,(function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5070),n.e(9440),n.e(5597),n.e(9820),n.e(6649),n.e(6922),n.e(5049),n.e(8063),n.e(6205),n.e(8971),n.e(823),n.e(1997),n.e(9140),n.e(2557),n.e(3974),n.e(2878),n.e(2340),n.e(4292),n.e(4397),n.e(4427),n.e(5576),n.e(520)]).then(n.bind(n,838854))];case 1:return[2,e.sent().FileExportHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:c,platforms:[a.Ev.Pc,a.Ev.Mobile,a.Ev.Pad]})})},594185:function(e,t,n){n.r(t),n.d(t,{IFilePcFeature:function(){return c}});var o=n(839461),i=n(259356),r=n(870372),a=n(293325),c=Symbol.for("feature:".concat(r.C.FilePc));i.Ln.merge(c,{useFactory:function(){return(0,o.__awaiter)(void 0,void 0,void 0,(function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5070),n.e(9440),n.e(5597),n.e(9820),n.e(6649),n.e(6922),n.e(5049),n.e(8063),n.e(6205),n.e(8971),n.e(823),n.e(1997),n.e(9140),n.e(2557),n.e(3974),n.e(2878),n.e(2340),n.e(4292),n.e(4397),n.e(4427),n.e(5576),n.e(520)]).then(n.bind(n,231163))];case 1:return[2,e.sent().FilePcHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2,a.YV.Publish],key:c,platforms:[a.Ev.Pc]})})},715036:function(e,t,n){n.r(t),n.d(t,{IPageShadeFeature:function(){return l},ShadeEntrance:function(){return o}});var o,i=n(839461),r=n(259356),a=n(870372),c=n(293325);!function(e){e.PC_TOOLBAR="pc_toolbar",e.PC_TITLEBAR="pc_titlebar"}(o||(o={}));var l=Symbol.for("feature:".concat(a.C.PageShade));r.Ln.merge(l,{useFactory:function(){return(0,i.__awaiter)(void 0,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5070),n.e(9440),n.e(5597),n.e(9820),n.e(6649),n.e(6922),n.e(5049),n.e(8063),n.e(6205),n.e(8971),n.e(823),n.e(1997),n.e(9140),n.e(2557),n.e(3974),n.e(2878),n.e(2340),n.e(4292),n.e(4397),n.e(4427),n.e(5576),n.e(520)]).then(n.bind(n,915669))];case 1:return[2,e.sent().PageShadeHandler]}}))}))},on:c.iz.On({stages:[c.YV.Level2,c.YV.Level3],key:l})})},249997:function(e,t,n){n.r(t),n.d(t,{IPresentationFeature:function(){return l},shouldAutoLoad:function(){return u}});var o=n(839461),i=n(259356),r=n(293325),a=n(870372),c=n(495155),l=Symbol.for("feature:".concat(a.C.Presentation)),u=function(){return"meeting"===(0,c.getUrlParameter)("mode")&&"speaker"===(0,c.getUrlParameter)("login")};i.Ln.merge(l,{useFactory:function(){return(0,o.__awaiter)(void 0,void 0,void 0,(function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(7623).then(n.bind(n,650568))];case 1:return[2,e.sent().PresentationHandler]}}))}))},on:r.iz.On({key:l,stages:[r.YV.Level2],platforms:[r.Ev.Pc],load:"player"!==(0,c.getUrlParameter)("show")})})},479697:function(e,t,n){n.r(t),n.d(t,{ISectionFeature:function(){return s},PAGE_FOOTER:function(){return u},PAGE_HEADER:function(){return l},PageNumberPosition:function(){return o}});var o,i=n(839461),r=n(259356),a=n(870372),c=n(293325);!function(e){e.HEADER="header",e.FOOTER="footer",e.CURSOR="cursor"}(o||(o={}));var l="header",u="footer",s=Symbol.for("feature:".concat(a.C.Section));r.Ln.merge(s,{useFactory:function(){return(0,i.__awaiter)(void 0,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5070),n.e(9440),n.e(5597),n.e(9820),n.e(6649),n.e(6922),n.e(5049),n.e(8063),n.e(6205),n.e(8971),n.e(823),n.e(1997),n.e(9140),n.e(2557),n.e(3974),n.e(2878),n.e(2340),n.e(4292),n.e(4397),n.e(4427),n.e(5576),n.e(520)]).then(n.bind(n,45619))];case 1:return[2,e.sent().SectionHandler]}}))}))},on:c.iz.On({stages:[c.YV.Level2],key:s})})},845500:function(e,t,n){n.d(t,{i:function(){return a}});var o=n(839461),i=n(87363),r=n.n(i),a=function(e){var t=e.style,n=void 0===t?{}:t,i=e.className;return r().createElement("div",{style:(0,o.__assign)({margin:"0px 4px 0px 12px",height:24,width:1,opacity:.06,borderRight:"1px solid rgb(0, 0, 0)",marginTop:6,marginBottom:6,verticalAlign:"top",display:"inline-block"},n),className:i})}},728970:function(e,t,n){n.d(t,{my:function(){return oe}});var o,i,r=n(87363),a=n.n(r),c=n(487988),l=n(771724),u=n(218581),s=n(839461),d=n(725771),p=n(495155),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,s.__extends)(t,e),t.prototype.shouldHide=function(){return!this.props.isLogin},t.prototype.render=function(){return this.shouldHide()||window.isPublishedURL?null:a().createElement("div",{style:{display:"flex",flexDirection:"row"}},a().createElement("div",{id:"titlebar-share-button",style:{display:"flex",alignItems:"center"}}))},t}(r.PureComponent),m=(0,d.x)(["isLogin","isEditable"])(f),v=n(259356),h=n(243607),g=n(339144),E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.container=a().createRef(),t.initAvatarComponent=function(){return(0,s.__awaiter)(t,void 0,void 0,(function(){return(0,s.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.extensionService.getExtension(g._X)];case 1:return e.sent().show({usageScenario:"OPEN_LOGIN_BOX",container:this.container.current}),[2]}}))}))},t}var n;return(0,s.__extends)(t,e),t.prototype.getStyle=function(){return{}},t.prototype.componentDidMount=function(){this.initAvatarComponent()},t.prototype.render=function(){var e,t,n,o,i=!!(null===(e=window.basicClientVars)||void 0===e?void 0:e.userInfo.tinyId)||(null===(t=window.clientVars)||void 0===t?void 0:t.isLogin),r=null===(o=null===(n=window.basicClientVars)||void 0===n?void 0:n.userInfo)||void 0===o?void 0:o.userPic;if(!i)return null;var c={width:28,height:28,borderRadius:4};return r&&(c.backgroundImage="url(".concat(r,")"),c.backgroundSize="cover"),a().createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",fontSize:0}},a().createElement("div",{style:this.getStyle(),id:"titlebar-avatar",ref:this.container},a().createElement("div",{className:"shins-loading",style:c})))},(0,s.__decorate)([(0,v.tB)(),(0,s.__metadata)("design:type","function"==typeof(n=void 0!==h.$&&h.$)?n:Object)],t.prototype,"extensionService",void 0),t}(r.PureComponent),y=(0,d.x)(["isLogin"])(E),_=n(234877),b=n(750670),w=n(947229),L="button--YfHch",T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleLogin=function(){t.eventEmitter.emit("$requestLogin"),b.ReportHelper.tdwReport({opername:"doc_login",module:"readonly",action:"login_exp_pc"})},t}var n;return(0,s.__extends)(t,e),t.prototype.componentWillUnmount=function(){this.eventEmitter.emit("$loginBannerUnmount")},t.prototype.render=function(){return a().createElement("div",null,a().createElement(_.default,{type:"primary",style:{fontSize:12,height:28,padding:"0px 16px 1px 16px",border:"none",cursor:"default"},className:"".concat(L),onClick:this.handleLogin},(0,u.$t)("登录腾讯文档")))},(0,s.__decorate)([(0,v.tB)(),(0,s.__metadata)("design:type","function"==typeof(n=void 0!==w.v&&w.v)?n:Object)],t.prototype,"eventEmitter",void 0),t}(r.Component),C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,s.__extends)(t,e),t.prototype.render=function(){return this.props.isLogin?null:a().createElement(T,null)},t}(r.Component),I=(0,d.x)(["isLogin"])(C),S=n(147641),O=n(199235),A=n(137600),P=n(129602),x=n(429749),R=n(67986),N=n(130508),M=n(669144),F=n(915833),H={width:28,height:28,padding:2,boxSizing:"border-box",fontSize:0},k=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={hasBasicClientVars:M.W.hasBasicClientVars},t.handleDropdownOpen=function(e){var n;t.store.update("menuActive",!0),t.handleMouseEnter(e),t.context.editor instanceof b.MeloEditor&&(null===(n=t.context.editor.surface)||void 0===n||n.requestBlur())},t.handleDropdownClose=function(){t.store.update("menuActive",!1),t.store.update("menuHover","none")},t.handleMouseEnter=function(e){t.store.update("menuHover",e),t.store.update("menuLastHover",e),t.tooltipTimer=setTimeout((function(){t.store.update("menuHoverTooltip",e)}),R.V)},t.handleMouseLeave=function(){t.store.update("menuHover","none"),clearTimeout(t.tooltipTimer),setTimeout((function(){t.store.update("menuHoverTooltip","none")}),R.V)},t.shouldRender=function(){var e=t.props.isLogin,n=t.configService.get("common.titlebar.fileMenu");return!(!e||!n)},t}var n,o;return(0,s.__extends)(t,e),t.prototype.componentDidUpdate=function(){var e,t,n=this;null===(t=null===(e=null===window||void 0===window?void 0:window.ClientVarsPromise)||void 0===e?void 0:e.then)||void 0===t||t.call(e,(function(){n.setState({hasBasicClientVars:M.W.hasBasicClientVars})}))},t.prototype.renderMoreMenu=function(){var e=this,t=this.props,n=t.menuActive,o=t.menuHoverTooltip,i=t.menuLastHover;return this.shouldRender()?a().createElement(S.l,{align:"auto",name:"file",contentStyle:H,animated:!1,show:n&&"file"===i,onDropdownOpen:function(){return e.handleDropdownOpen("file")},onDropdownClose:this.handleDropdownClose,onMouseEnter:function(){e.handleMouseEnter("file")},onMouseLeave:this.handleMouseLeave,itemStyle:{width:"185px"}},a().createElement(P.ZP,{key:"titlebar-menu-file",title:(0,u.$t)("文档操作"),visible:!n&&"file"===o,className:F.Z["menu-icon-button"]},a().createElement(N.r,null))):null},t.prototype.render=function(){return a().createElement(a().Fragment,null,this.renderMoreMenu())},t.contextType=O.FN,(0,s.__decorate)([(0,v.tB)(),(0,s.__metadata)("design:type","function"==typeof(n=void 0!==A.O&&A.O)?n:Object)],t.prototype,"store",void 0),(0,s.__decorate)([(0,v.tB)(),(0,s.__metadata)("design:type","function"==typeof(o=void 0!==x.ax&&x.ax)?o:Object)],t.prototype,"configService",void 0),t}(r.PureComponent),U=(0,d.x)(["menuActive","menuLastHover","menuHoverTooltip"])(k),D=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,s.__extends)(t,e),t.prototype.render=function(){return a().createElement(U,{isLogin:this.props.isLogin,isEditable:this.props.isEditable})},t}(r.PureComponent),B=(0,d.x)(["isLogin","isEditable"])(D),V=n(426501),G=n(715036),j=n(614512),$={width:28,height:28,padding:2,boxSizing:"border-box",fontSize:0,borderRadius:2},Y=function(e){function t(t){var n=e.call(this,t)||this;return n.handleDropdownOpen=function(e){var t;n.store.update("menuActive",!0),n.handleMouseEnter(e),n.context.editor instanceof b.MeloEditor&&(null===(t=n.context.editor.surface)||void 0===t||t.requestBlur())},n.handleDropdownClose=function(){n.store.update("menuActive",!1),n.store.update("menuHover","none")},n.handleMouseEnter=function(e){n.store.update("menuHover",e),n.store.update("menuLastHover",e),n.tooltipTimer=setTimeout((function(){n.store.update("menuHoverTooltip",e)}),R.V),n.store.getValue("menuActive")&&b.ReportHelper.tdwReport({opername:"doc_word_editor",module:"shading",action:"entrance_show",ver5:(0,j.iW)(),ver7:G.ShadeEntrance.PC_TITLEBAR})},n.handleMouseLeave=function(){n.store.update("menuHover","none"),clearTimeout(n.tooltipTimer),setTimeout((function(){n.store.update("menuHoverTooltip","none")}),R.V)},n.shouldRender=function(){var e=n.props,t=e.isLogin,o=e.isEditable,i=n.configService.get("common.titlebar.fileMenu");return!!(t&&o&&i)},n.state={hasBasicClientVars:M.W.hasBasicClientVars},n}var n,o;return(0,s.__extends)(t,e),t.prototype.componentDidUpdate=function(){var e,t,n=this;null===(t=null===(e=null===window||void 0===window?void 0:window.ClientVarsPromise)||void 0===e?void 0:e.then)||void 0===t||t.call(e,(function(){n.setState({hasBasicClientVars:M.W.hasBasicClientVars})}))},t.prototype.renderEditMenu=function(){var e=this,t=this.props,n=t.menuActive,o=t.menuHoverTooltip,i=t.menuLastHover,r=t.isLogin,c=t.isEditable,l=this.configService.get("common.titlebar.fileMenu");return this.shouldRender()?r&&c&&l&&a().createElement(S.l,{align:"auto",name:"more",contentStyle:$,animated:!1,show:n&&"more"===i,onDropdownOpen:function(){return e.handleDropdownOpen("more")},onDropdownClose:this.handleDropdownClose,onMouseEnter:function(){e.handleMouseEnter("more")},onMouseLeave:this.handleMouseLeave,itemStyle:{width:"185px"}},a().createElement(P.ZP,{key:"titlebar-menu-more",title:(0,u.$t)("编辑功能"),visible:!n&&"more"===o,className:F.Z["menu-icon-button"]},a().createElement(V.r,null))):null},t.prototype.render=function(){return a().createElement(a().Fragment,null,this.renderEditMenu())},t.contextType=O.FN,(0,s.__decorate)([(0,v.tB)(),(0,s.__metadata)("design:type","function"==typeof(n=void 0!==A.O&&A.O)?n:Object)],t.prototype,"store",void 0),(0,s.__decorate)([(0,v.tB)(),(0,s.__metadata)("design:type","function"==typeof(o=void 0!==x.ax&&x.ax)?o:Object)],t.prototype,"configService",void 0),t}(r.PureComponent),W=(0,d.x)(["menuActive","menuLastHover","menuHoverTooltip"])(Y),z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,s.__extends)(t,e),t.prototype.render=function(){return a().createElement(W,{isLogin:this.props.isLogin,isEditable:this.props.isEditable})},t}(r.PureComponent),Z=(0,d.x)(["isLogin","isEditable"])(z),q=n(439378),Q=n(399267),J=n(845500),X=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isShow:!1},n.listenQQGroupInfoComponent(),n}var n;return(0,s.__extends)(t,e),t.prototype.checkShowGroupTips=function(){return!!((0,p.getUrlParameter)("groupUin")||(0,p.getUrlParameter)("group_code")||(0,p.getUrlParameter)("friendUin"))},t.prototype.listenQQGroupInfoComponent=function(){var e=this;this._scriptLoader&&this.checkShowGroupTips()&&this._scriptLoader.getScriptLoader().listen("SL-INIT",(function(){e._scriptLoader.getScriptLoader().load("GroupTips",(function(t){return(0,s.__awaiter)(e,void 0,void 0,(function(){var e,n,o;return(0,s.__generator)(this,(function(i){switch(i.label){case 0:return(e=document.getElementById("titlebar-qqgroup-info"))&&t?(n=this.setState,o={},[4,t.show(e)]):[2];case 1:return n.apply(this,[(o.isShow=i.sent(),o)]),[2]}}))}))}))}))},t.prototype.render=function(){return a().createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",marginLeft:this.state.isShow?"8":"0"}},a().createElement("div",{id:"titlebar-qqgroup-info"}),a().createElement("div",{style:{display:this.state.isShow?"flex":"none"},id:"qqgroup-info-divider"},a().createElement(J.i,null)))},(0,s.__decorate)([(0,v.tB)(),(0,s.__metadata)("design:type","function"==typeof(n=void 0!==Q.$&&Q.$)?n:Object)],t.prototype,"_scriptLoader",void 0),t}(r.PureComponent),K=n(481734),ee=n(176654),te=n(860511),ne=n(266169);!function(e){e.HOME="titlebar-home",e.TITLE="titlebar-title",e.READONLY_TIPS="titlebar-readonly-tips",e.EXTERNAL="titlebar-external",e.MOVE_TO="titlebar-move-to",e.CERTIFICATION="titlebar-certification-tips",e.COLLAB_STATUS="titlebar-collab-status",e.SUBSCRIBE_ENTRY="subscribe-entry",e.STATUS_TIPS="titlebar-status-tips",e.QQGROUP_INFO="titlebar-qqgroup-info",e.FILE_MENU="titlebar-file-menu",e.MORE_MENU="titlebar-more-menu",e.PRESENTATION="titlebar-presentation-button",e.LOGIN_PRESENTATION="titlebar-presentation-button",e.POLICY="titlebar-policy-button",e.SHARE="titlebar-share",e.ACCOUNT_AVATAR="titlebar-avatar",e.LOGIN="titlebar-login",e.PUSHER="pusher",e.DIVIDER="divider",e.TOGGLE="toolbar-toggle",e.COLLECT="titlebar-collect",e.AI="titlebar-ai"}(i||(i={})),(o={})[i.HOME]="logo",o[i.TITLE]="title",o[i.CERTIFICATION]="certification",o[i.READONLY_TIPS]="readonly",o[i.SUBSCRIBE_ENTRY]="saveState",o[i.STATUS_TIPS]="saveState",o[i.COLLAB_STATUS]="collaborators",o[i.QQGROUP_INFO]="qq-group",o[i.FILE_MENU]="fileMenu",o[i.MORE_MENU]="moreMenu",o[i.PRESENTATION]="presentation",o[i.POLICY]="auth",o[i.SHARE]="share",o[i.ACCOUNT_AVATAR]="account",o[i.LOGIN]="login",o[i.COLLECT]="collect",o[i.TOGGLE]="toggle",o[i.MOVE_TO]="move",o[i.AI]="ai";var oe=new Set;i.HOME,a().createElement(K.pp,null),i.TITLE,a().createElement(K.$t,null),i.CERTIFICATION,a().createElement(te.e,null),i.READONLY_TIPS,a().createElement(K.Pk,null),i.EXTERNAL,a().createElement(K.GV,null),i.MOVE_TO,a().createElement(K.SV,null),i.SUBSCRIBE_ENTRY,a().createElement(K.l9,null),i.STATUS_TIPS,a().createElement(K.OY,null),i.COLLAB_STATUS,a().createElement(K.uR,null),i.QQGROUP_INFO,a().createElement(X,null),i.FILE_MENU,a().createElement(B,null),i.MORE_MENU,a().createElement(Z,null),i.PRESENTATION,a().createElement(q.H,null),i.POLICY,a().createElement(K.dH,null),i.SHARE,a().createElement(m,null),i.ACCOUNT_AVATAR,a().createElement(y,null),i.LOGIN,a().createElement(I,null),i.AI,a().createElement(ne.Z,null),ee.o4.INSERT,a().createElement(l.r,null),(0,u.$t)("插入"),(0,u.$t)("titlebar:insert-tips"),ee.o4.UNOFFICIAL_ADDONS,a().createElement(c.r,null)},459879:function(e,t,n){n.r(t),n.d(t,{ITitlebarFeature:function(){return a}});var o=n(839461),i=n(259356),r=n(870372),a=Symbol.for("feature:".concat(r.C.Titlebar));i.Ln.merge(a,{useFactory:function(){return(0,o.__awaiter)(void 0,void 0,void 0,(function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.resolve().then(n.bind(n,869993))];case 1:return[2,e.sent().TitlebarHandler]}}))}))}})},869993:function(e,t,n){n.r(t),n.d(t,{TitlebarHandler:function(){return E},hydrateMap:function(){return g}});var o=n(839461),i=n(522142),r=n(137600),a=n(874650),c=n(947229),l=n(45972),u=n(87360),s=n(661533),d=n.n(s),p=n(870372),f=n(429749),m=n(459879),v=n(728970),h=n(495155),g=new Map,E=function(){function e(e,t,n,o,i,r){var a=this;this.store=e,this.toolbarService=t,this.configService=o,this.settings=r,n.listen("$onInjectContext",(function(e){"permission"===e.key&&(a.setEditable(e.value.isEditable),n.listen("$editableChanged",(function(e){a.setEditable(e)})))})),n.listen("$featureLoaded",(function(){a.setLoginStatus(i.context.clientVars.isLogin)}))}var t,n,s,E,y,_;return e.prototype.setEditable=function(e){this.store.update("isEditable",e)},e.prototype.setTitleEditable=function(e){this.store.update("canEditTitle",e)},e.prototype.setLoginStatus=function(e){this.store.update("isLogin",e)},e.prototype.hydrate=function(e,t,n){var o=this;if(void 0===n&&(n=0),n>10)h.Logger.error('hydrate() with the same param "id" is executed over 10 times');else{var i=this.settings.container.querySelector("#".concat(e));i||!v.my.has(e)?i?d().render(t,i):setTimeout((function(){o.hydrate(e,t,n+1)})):g.set(e,(function(){return o.hydrate(e,t)}))}},e.prototype.detach=function(e){var t=document.getElementById(e);t&&d().unmountComponentAtNode(t)},e.prototype.toggleTitlebar=function(){var e=this.store.getValue("isTitlebarShowed");this.store.update("isTitlebarShowed",!e),this.toolbarService.$forceUpdate()},e=(0,o.__decorate)([(0,i.L)({name:p.C.Titlebar,adapters:["melo"],provide:m.ITitlebarFeature}),(0,o.__metadata)("design:paramtypes",["function"==typeof(t=void 0!==r.O&&r.O)?t:Object,"function"==typeof(n=void 0!==a.O&&a.O)?n:Object,"function"==typeof(s=void 0!==c.v&&c.v)?s:Object,"function"==typeof(E=void 0!==f.ax&&f.ax)?E:Object,"function"==typeof(y=void 0!==l.O&&l.O)?y:Object,"function"==typeof(_=void 0!==u.I&&u.I)?_:Object])],e)}()},481734:function(e,t,n){n.d(t,{uR:function(){return U},GV:function(){return N},pp:function(){return x},SV:function(){return F},dH:function(){return D},Pk:function(){return M},OY:function(){return k},l9:function(){return H},$t:function(){return R}});var o=n(87363),i=n.n(o),r=n(839461),a=n(259356),c=n(947229),l=n(137600),u=n(344695),s=n(725771),d=n(218581),p=n(339144),f=n(243607),m=n(495155),v="".concat(p.xT.name,"_container"),h=(0,d.$t)("无标题文档"),g=function(e){function t(t){var n,o,r=this;return(r=e.call(this,t)||this).widgetService.float({name:"text-measure",component:i().createElement("div",{style:{position:"absolute"},id:"text-measure",className:""}),styles:{pointerEvents:"none"}}),window.isPublishedURL&&(null===(n=window.clientVars)||void 0===n?void 0:n.padTitle)&&r.store.update("docTitle",null===(o=window.clientVars)||void 0===o?void 0:o.padTitle),r}var n,o,s,d;return(0,r.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;this.extensionService.getExtension(p.xT).then((function(t){var n,o,i;e.titleComponent=t,e.titleComponent.show({container:document.getElementById(v),emptyTitle:h,afterTitleChanged:function(t){e.store.update("docTitle",t),e.eventEmitter.emit("setTitle",t)}}),window.isPublishedURL&&(e.eventEmitter.listenOnce("$featureLoaded",(function(){var t,n,o;null===(n=(t=e.titleComponent).setCurTitle)||void 0===n||n.call(t,null===(o=window.clientVars)||void 0===o?void 0:o.padTitle)})),null===(o=(n=e.titleComponent).setCurTitle)||void 0===o||o.call(n,null===(i=window.clientVars)||void 0===i?void 0:i.padTitle))}))},t.prototype.render=function(){return i().createElement("div",{id:v})},(0,r.__decorate)([(0,a.tB)(),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==c.v&&c.v)?n:Object)],t.prototype,"eventEmitter",void 0),(0,r.__decorate)([(0,a.tB)(),(0,r.__metadata)("design:type","function"==typeof(o=void 0!==l.O&&l.O)?o:Object)],t.prototype,"store",void 0),(0,r.__decorate)([(0,a.tB)(),(0,r.__metadata)("design:type","function"==typeof(s=void 0!==u.i&&u.i)?s:Object)],t.prototype,"widgetService",void 0),(0,r.__decorate)([(0,a.tB)(),(0,r.__metadata)("design:type","function"==typeof(d=void 0!==f.$&&f.$)?d:Object)],t.prototype,"extensionService",void 0),t}(o.PureComponent),E=(0,s.x)(["docTitle","canEditTitle"],!0)(g),y="brand_container--9KHMq",_="brand_publish_logo--Am6l5",b=n(750670),w=n(669144),L=n(129602),T=n(801134),C=n.n(T),I=n(328413),S=n(991287),O=function(e){function t(t){var n=e.call(this,t)||this;return n.isLogoCanBackToHome=function(){return!w.W.isEntAccountViewToCDoc||!m.PlatformUtil.isWeWorkMacOrWin()},n.onBackClick=function(){var e;if(n.state.canLogoClick)if(b.ReportHelper.tdwReport({opername:"doc_menubar",module:"backto_list_button",action:"click"}),w.W.isEntAccountViewToCDoc){(null===(e=window.tdocs)||void 0===e?void 0:e.openAndJumpToMainPage)&&window.tdocs.openAndJumpToMainPage();var t=window.multiAccountUtil.getMultiUrl(S.X.getInstance().getConfig("custom.links.businessHomePage"));(0,I.l)({url:t,replace:!0})}else{var o=window.multiAccountUtil.getMultiUrl("https://".concat(window.location.hostname,"/desktop/?_from=1"));(0,I.l)({url:o,replace:!0})}},n.mouseEnterHandler=function(){n.setState({isHover:!0})},n.mouseLeaveHandler=function(){n.setState({isHover:!1})},n.renderLogo=function(){var e=n.state.canLogoClick;return i().createElement("div",{className:C()(y),onMouseEnter:n.mouseEnterHandler,onMouseLeave:n.mouseLeaveHandler,onClick:n.onBackClick},i().createElement("a",{className:C()(_),style:e?{cursor:"pointer"}:{pointerEvents:"none"}}))},n.state={isHover:!1,canLogoClick:n.isLogoCanBackToHome()},n}return(0,r.__extends)(t,e),t.prototype.render=function(){var e=this.props.hideBack;return i().createElement(L.u,{title:(0,d.$t)("返回首页"),containerOffsetX:15,placement:"bottom",overlayStyle:{textAlign:"center"},containerOffsetY:-8,disabled:e},this.renderLogo())},t}(o.Component),A=n(728970),P=function(){return i().createElement(i().Fragment,null,i().createElement(O,null))},x=function(){var e=i().createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"}},window.isPublishedURL?i().createElement(P,null):i().createElement("div",{id:"titlebar-mini-list-wrapper",key:"tdocs-mini-list"}));return window.isPublishedURL&&A.my.add("titlebar-mini-list-wrapper"),e},R=function(){return i().createElement("div",null," ",i().createElement(E,{key:"tdocs-title"})," ")},N=function(){return i().createElement("div",{id:"titlebar-external",key:"tdocs-external"})},M=function(){return i().createElement("div",{id:"titlebar-readonly-tips",key:"tdocs-readonly-tips"})},F=function(){return i().createElement("div",{id:"titlebar-move-to",key:"tdocs-move-to"})},H=function(){return i().createElement("div",{id:"subscribe-entry",key:"subscribe-entry"})},k=function(){return i().createElement("div",{id:"titlebar-status-tips",key:"tdocs-status-tips"})},U=function(){return i().createElement("div",{id:"titlebar-collab-status",key:"tdocs-collab-status"})},D=function(){return i().createElement("div",{id:"titlebar-policy-button"})}},439378:function(e,t,n){n.d(t,{H:function(){return se}});var o,i,r=n(839461),a=n(87363),c=n.n(a),l=n(259356),u=n(19589),s=n(725771),d=n(129602),p=n(583865),f=(n(495155),"presentation-button--pgkbR"),m="focus--du35-",v=n(628605),h=n(993969),g=function(){return c().createElement(h.r,null)},E=function(){return c().createElement("img",{src:v.Z})},y=n(824731),_=n(429313),b=n(783504),w="presentation-status--l9VOq",L="menu-item-wrapper--2LUTq",T="menu-icon--FNO+c",C="menu-item--pzVWR",I="hover-content-title--8H0u+",S="hover-content-text--yCo5z",O=n(5258),A=n(929488),P=n(74587),x=n(395698),R=n(545058),N=n(317999),M=n(218581),F=function(){return c().createElement("img",{src:A.Z,className:T})},H=function(){return c().createElement("img",{src:P.Z,className:T})},k=function(){return c().createElement("img",{src:O.Z,className:T})},U=function(){return c().createElement("div",null,c().createElement("p",{className:I},(0,M.$t)("presentation:tencent-meeting-tooltip-title")),c().createElement("p",{className:S},(0,M.$t)("presentation:tencent-meeting-tooltip-desc")),c().createElement("img",{src:b.ZP.language.indexOf("zh")?x.Z:R.Z,style:{margin:"0px 12px 8px 12px",width:288,height:162}}))},D=function(e){var t=e.itemText,n=e.disableHover,o=e.hoverContent,i=e.icon;return c().createElement(d.u,{disabled:n,title:o,placement:"left",alignment:"start",containerOffsetX:-20,hoverDelay:100},c().createElement("div",{className:L},i,c().createElement("span",{className:C},t)))},B=function(e){var t=e.handleLocalPresentation,n=e.handleRemotePresentation,o=e.remoteMemberCount,i=void 0===o?-1:o,r=e.disableRemotePresentation,a=e.shouldHideRemotePresentation,l=e.disabled;return c().createElement(y.default,{selectable:!1},c().createElement(y.default.Item,{id:"local-presentation",onClick:t,disabled:l},c().createElement(D,{itemText:(0,M.$t)("presentation:local-presentation"),disableHover:!0,icon:c().createElement(F,null)})),a?null:c().createElement("div",null,c().createElement(_.ZP,null),c().createElement(y.default.Item,{id:"remote-presentation",style:{display:"flex",flexDirection:"column",height:"auto",alignItems:"flex-start"},onClick:n,disabled:r||l},N.A.shouldPresentationByWemeet()?c().createElement(D,{itemText:(0,M.$t)("presentation:present-with-tencent-meeting"),icon:c().createElement(k,null),disableHover:!1,hoverContent:c().createElement(U,null)}):c().createElement(D,{itemText:(0,M.$t)("presentation:remote-presentation"),icon:c().createElement(H,null),disableHover:!0}),0===i&&c().createElement("p",{className:w},(0,M.$t)("等待收看者加入")),i>0&&c().createElement("p",{className:w},(0,M.$t)("presentation:waiting-persons",{remoteMemberCount:i})))))},V=n(234877),G={"dialog-wrapper":"dialog-wrapper--Ku0oC",dialogWrapper:"dialog-wrapper--Ku0oC","modal-close":"modal-close--GUs8n",modalClose:"modal-close--GUs8n","modal-close-x":"modal-close-x--9sF6d",modalCloseX:"modal-close-x--9sF6d","modal-content":"modal-content--0-PRJ",modalContent:"modal-content--0-PRJ"},j=function(e){var t=e.children,n=e.onClose;return c().createElement("div",{className:G["dialog-wrapper"]},c().createElement("div",{className:G["top-tip"]}),c().createElement("button",{"aria-label":"Close",className:G["modal-close"],onClick:function(){return n&&n()}},c().createElement("span",{className:G["modal-close-x"]})),c().createElement("div",{className:G["modal-content"]},t))},$="guide-image--XEsHI",Y=function(e){var t=e.onClose,n=e.onInvite;return c().createElement(j,{onClose:t},c().createElement("h1",null,(0,M.$t)("欢迎使用远程演示")),c().createElement("p",null,(0,M.$t)("手机电脑同步观看，语音讨论更加高效")),c().createElement("div",{className:$}),c().createElement(V.default,{type:"primary",size:"large",onClick:n,style:{width:240}},(0,M.$t)("邀请好友")))},W=n(462412),z=n(276034),Z=n(834012),q=(0,s.x)(["roomId"])((function(e){var t=e.onClose,n=e.onCopy,o=e.startRemotePresentation,i=e.stopInvite,r=e.changeFlipAuth,l=e.roomId,u=(0,a.useRef)(null),s=(0,a.useMemo)((function(){return"https://".concat(window.location.hostname,"/meetingroom/").concat(l)}),[l]);return(0,a.useEffect)((function(){u.current&&Z.$.create(u.current,s,!0,{height:120,width:120})}),[s]),c().createElement(j,{onClose:function(){return t&&t()}},c().createElement("h1",null,(0,M.$t)("邀请好友加入")),c().createElement("div",{ref:u,style:{height:120,width:120,marginTop:12}}),c().createElement("div",{style:{marginTop:20,display:"inline-flex"}},c().createElement(z.default,{value:s,style:{width:192,height:32}}),c().createElement(V.default,{style:{height:34,width:74,marginLeft:-2},onClick:function(){return n(s)}},(0,M.$t)("复制链接"))),c().createElement(V.default,{type:"primary",size:"large",style:{width:240,marginTop:20},onClick:function(){o&&o()}},(0,M.$t)("开始远程演示")),c().createElement(V.default,{type:"default",size:"large",style:{width:240,marginTop:12},onClick:function(){i&&i()}},(0,M.$t)("关闭邀请")),c().createElement(W.ZP,{defaultChecked:!0,style:{marginTop:20},onChange:function(e){return r(e)}},(0,M.$t)("允许观看者翻看文档全文")))})),Q=n(199235),J=n(750670),X=n(67986),K=n(669144),ee=n(136454),te=n(915833),ne=n(336338),oe=function(e){var t=e.onClick,n=e.active,i=e.focus,l=e.onMouseEnter,u=void 0===l?function(){}:l,s=e.onMouseLeave,p=void 0===s?function(){}:s,v=(0,r.__read)((0,a.useState)(!1),2),h=v[0],y=v[1];return c().createElement(d.ZP,{title:(0,M.$t)("演示"),key:"titlebar-presentation-button",visible:!i&&h,className:te.Z["menu-icon-button"]},c().createElement("div",{id:"presentation-button",className:"".concat(f," ").concat(i?m:""),style:{marginRight:K.W.isWeworkEnv?8:0},onClick:function(e){t(e),y(!1)},onMouseEnter:function(){o=setTimeout((function(){y(!0)}),X.V),u()},onMouseLeave:function(){clearTimeout(o),setTimeout((function(){y(!1)}),X.V),p()}},n?c().createElement(E,null):c().createElement(g,null)))};!function(e){e[e.None=0]="None",e[e.Menu=1]="Menu",e[e.Guide=2]="Guide",e[e.Invite=3]="Invite"}(i||(i={}));var ie=c().lazy((function(){return Promise.all([n.e(3790),n.e(7760)]).then(n.t.bind(n,507760,23)).then((function(e){return e}))})),re=function(){return N.A.isSpeaker()&&(0,ee.Yi)().isOwner?c().createElement("div",null,c().createElement(c().Suspense,{fallback:null},c().createElement(ie,{padType:(0,ee.Yi)().padType}))):null},ae=(0,s.x)(["waitingForRemotePresentation","menuActive","menuHover","menuLastHover","isPresentationDisabled"])((function(e){var t,n,o,l,u=e.handler,s=e.handlerCallback,f=e.waitingForRemotePresentation,m=e.menuActive,v=e.menuHover,h=e.menuLastHover,g=e.isPresentationDisabled,E=(0,r.__read)((0,a.useState)(i.None),2),y=E[0],_=E[1],b=function(e){s((function(t){_(e)}))},w=(0,a.useContext)(Q.FN);return N.A.isMeetingEnv()?c().createElement(re,null):y===i.Guide?c().createElement("div",{id:"presentationGuideDialog"},c().createElement(d.ZP,{trigger:"click",title:c().createElement(Y,{onClose:function(){return b(i.None)},onInvite:function(){var e;f||null===(e=u())||void 0===e||e.createShowRoom((function(){b(i.None)})),b(i.Invite)}}),defaultVisible:y===i.Guide,onVisibleChange:function(e){return!e&&b(i.None)}},c().createElement(oe,{focus:!0,active:!1,onClick:function(){b(i.None)}}))):y===i.Invite?c().createElement("div",{id:"presentationInviteDialog"},c().createElement(d.ZP,{trigger:"click",title:c().createElement(q,{onClose:function(){return b(i.None)},onCopy:function(e){var t;return null===(t=u())||void 0===t?void 0:t.copyLiveLink(e)},startRemotePresentation:function(){var e;null===(e=u())||void 0===e||e.startLiving(),b(i.None)},stopInvite:function(){var e;null===(e=u())||void 0===e||e.closeShowRoom(),b(i.None)},changeFlipAuth:function(e){var t;null===(t=u())||void 0===t||t.setAllowFlip(e)}}),defaultVisible:y===i.Invite,onVisibleChange:function(e){return!e&&b(i.None)}},c().createElement(oe,{focus:!0,active:!0,onClick:function(){b(i.None)}}))):c().createElement("div",{id:"presentationMenu",style:{fontSize:0}},c().createElement(p.default,{animated:!1,alignment:"auto",dropContent:c().createElement(B,{disabled:g,handleLocalPresentation:function(){var e;b(i.None),null===(e=u())||void 0===e||e.showPresentation()},handleRemotePresentation:function(){N.A.shouldPresentationByWemeet()?N.A.redirectToWemeet():b(f?i.Invite:i.Guide)},disableRemotePresentation:!(null===(t=u())||void 0===t?void 0:t.hasRemotePresentation()),shouldHideRemotePresentation:null!==(o=null===(n=u())||void 0===n?void 0:n.shouldHideRemotePresentation())&&void 0!==o?o:ne.cm,remoteMemberCount:f?null===(l=u())||void 0===l?void 0:l.getMemberCount():-1}),visible:m&&"presentation"===h,onVisibleChange:function(e){e?(w.store.update("menuActive",!0),w.store.update("menuHover","presentation"),w.store.update("menuLastHover","presentation")):(w.store.update("menuActive",!1),w.store.update("menuHover","none"))}},c().createElement(oe,{active:f,onClick:function(){N.A.shouldPresentationByWemeet()&&J.ReportHelper.tdwReport({opername:"doc_meet_web",module:"doc_to_meet",action:"begin_presentation_view",file_type:"doc"}),b(y===i.None?i.Menu:i.None)},focus:m&&"presentation"===h&&("presentation"===v||"none"===v),onMouseEnter:function(){w.store.update("menuLastHover","presentation"),w.store.update("menuHover","presentation")},onMouseLeave:function(){w.store.update("menuHover","none")}})))})),ce=n(249997),le=n(734156),ue=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handler=function(){return t.loader.loaded?t.loader.instance:void 0},t}var n;return(0,r.__extends)(t,e),t.prototype.handlerCallback=function(e){e(this.loader.instance)},t.prototype.render=function(){return c().createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"}},c().createElement("div",{id:"titlebar-presentation-button"},c().createElement(ae,{handler:this.handler,handlerCallback:this.handlerCallback.bind(this)})))},(0,r.__decorate)([(0,l.aN)(ce.IPresentationFeature),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==u.R&&u.R)?n:Object)],t.prototype,"loader",void 0),(0,r.__decorate)([(0,le.kR)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Function]),(0,r.__metadata)("design:returntype",void 0)],t.prototype,"handlerCallback",null),t}(a.PureComponent),se=(0,s.x)(["isLogin","isEditable"])(ue)},626091:function(e,t,n){n.d(t,{NJ:function(){return r},P1:function(){return a},VG:function(){return l},x3:function(){return u},yi:function(){return c}});var o=n(495155),i=n(750670),r=function(){return!0},a=function(){var e,t;return{marginTop:(0,o.pxToTwips)(window.WEBLAYOUT_MARGIN_TOP||i.Defaults.webLayout.standardWide.pageMargins.top),marginLeft:(0,o.pxToTwips)(window.WEBLAYOUT_MARGIN_LEFT||i.Defaults.webLayout.standardWide.pageMargins.left),marginRight:(0,o.pxToTwips)(window.WEBLAYOUT_MARGIN_RIGHT||i.Defaults.webLayout.standardWide.pageMargins.right),pageWidth:(0,o.pxToTwips)(Math.min(window.WEBLAYOUT_FLOATING_WIDTH||i.Defaults.webLayout.ultraWide.pageSize.width,document.documentElement.clientWidth-(null===(e=window.getPageMarginRightWidth)||void 0===e?void 0:e.call(window))-(null===(t=window.getPageMarginLeftWidth)||void 0===t?void 0:t.call(window))))}},c=function(){var e=document.getElementById("scrollable");return e?e.offsetWidth:document.documentElement.clientWidth},l=940,u=1440},361401:function(e,t,n){n.d(t,{D:function(){return i},i:function(){return l}});var o,i,r,a=n(839461),c=n(826973);n(495155),function(e){e.UploadFile="UploadFile",e.UploadImage="UploadImage",e.ImportFile="ImportFile",e.CloneDoc="CloneDoc"}(i||(i={})),function(e){e[e.InsertFile=0]="InsertFile",e[e.InsertPicture=1]="InsertPicture",e[e.InsertFileInForm=2]="InsertFileInForm",e[e.InsertPictureInForm=3]="InsertPictureInForm",e[e.FromTemplate=4]="FromTemplate",e[e.ImportFile=5]="ImportFile",e[e.AssociateResults=6]="AssociateResults",e[e.GenerateCopy=7]="GenerateCopy"}(r||(r={})),(o={})[i.UploadFile]=r.InsertFile,o[i.UploadImage]=r.InsertPicture,o[i.ImportFile]=r.ImportFile,o[i.CloneDoc]=r.GenerateCopy;var l=Symbol.for("Service: ".concat("[CapacityService]"));!function(){function e(){}e.prototype.checkCapacityAsync=function(){return(0,a.__awaiter)(this,void 0,void 0,(function(){return(0,a.__generator)(this,(function(e){return[2,!1]}))}))},e.prototype.checkCapacity=function(){return!1},e.prototype.getInfoAsync=function(){return(0,a.__awaiter)(this,void 0,void 0,(function(){return(0,a.__generator)(this,(function(e){return[2,{}]}))}))},e.prototype.openKnowMorePage=function(){},e=(0,a.__decorate)([(0,c.t)({provide:l})],e)}()},399267:function(e,t,n){n.d(t,{$:function(){return h}});var o=n(839461),i=n(826973),r=n(45972),a=(n(495155),n(411812)),c=n(429020),l=n(267448),u=n(305775),s=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]};!function(){if("function"==typeof window.CustomEvent)return!1;function e(e,t){var n=t||{bubbles:!1,cancelable:!1,detail:void 0},o=document.createEvent("CustomEvent");return o.initCustomEvent(e,n.bubbles,n.cancelable,n.detail),o}e.prototype=window.Event.prototype,window.CustomEvent=e}();var d=(0,l.A)(),p=d.getRetryCountLimit(),f="SL-INIT",m=function(){function e(){if(this.metadata=null,this.firstLoaded={},this.asset={},this.assetLoaded=!1,this.cache={},this.evtArr=[],this.listenerMap=new Map,e.instance)return e.instance;e.instance=this,window.SLR=this}return e.getInstance=function(){return new e},e.prototype.clearCache=function(){Object.values(this.cache).forEach((function(e){e&&"function"==typeof e.destroy&&e.destroy()})),this.firstLoaded={},this.cache={},this.asset={},this.assetLoaded=!1,this.listenerMap.forEach((function(e,t){e.forEach((function(e){window.removeEventListener(t,e)}))}))},e.prototype.init=function(e,t,n,o){var i=this;if(void 0===t&&(t=s),void 0===n&&(n=s),void 0===o&&(o=0),a.network.isOnline)if(this.offlineInterval&&clearTimeout(this.offlineInterval),o<=2){var r="".concat(e,"?_t=").concat(Date.now());this.ajax({method:"GET",url:r,success:function(e){i.metadata=e.data.metadata,delete e.data.metadata,delete e.data.ScriptLoader,Object.keys(e.data).forEach((function(t){if(i.asset[t]={url:e.data[t].js||null,state:-1},e.data[t].dependency){var n=e.data[t].dependency;i.asset[t].dep=n,Object.keys(n).forEach((function(e){i.asset[e]={url:n[e],state:-1}}))}})),i.assetLoaded=!0,i.dispatch(f),t&&t(),i.evtArr.forEach((function(e){i.dispatch(e.eventName,e.detail)})),i.monitor(3078347)},fail:function(r){console.log(r),o+=1,i.init(e,t,n,o),i.monitor(3078348)}})}else n&&n({code:1,msg:"load error"});else this.offlineInterval=setTimeout((function(){i.init(e,t,n,o)}),1e3)},e.prototype.monitor=function(e){(0,c.monitor)(e)},e.prototype.load=function(e,t,n,i){return void 0===t&&(t=s),void 0===n&&(n=s),void 0===i&&(i=0),(0,o.__awaiter)(this,void 0,void 0,(function(){var r,a,c,l,u,d=this;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:if(void 0===this.asset[e]&&!this.assetLoaded)return this.listen(f,(function(){d.load(e,t,n,i)})),[2];a=(r=this).asset,c=r.cache,o.label=1;case 1:return o.trys.push([1,8,,9]),void 0===a[e]?[3,6]:void 0===c[e]&&i<=p?a[e].dep?(l=[],Object.keys(a[e].dep).forEach((function(t){if(window[t])c[t]=window[t],a[t].state=0;else if(void 0===c[t]&&-1===a[t].state){var n=d.loadScriptProcess({asset:a,cache:c,mod:t,parentModule:e},s,s,i);a[t].loading=n,l.push(n)}else{var o=a[t];o.loading&&l.push(o.loading)}})),[4,Promise.all(l)]):[3,3]:[3,4];case 2:o.sent(),o.label=3;case 3:return-1===a[e].state?this.loadScriptProcess({asset:a,cache:c,mod:e,parentModule:e},t,n,i):this.listenModuleLoad(e,(function(){t(d.cache[e],d.cache)})),[3,5];case 4:c[e]&&this.firstLoaded[e]&&this.checkAllLoaded(a,e)&&(t(c[e],c,!1),this.firstLoaded[e]=!0),o.label=5;case 5:return[3,7];case 6:console.log("".concat(e," is not found.")),n&&n({code:1,msg:"".concat(e," is not found.")}),o.label=7;case 7:return[3,9];case 8:return u=o.sent(),console.log(u),this.monitor(3078382),n&&n({code:2,msg:u}),[3,9];case 9:return[2]}}))}))},e.prototype.loadAsync=function(e){return(0,o.__awaiter)(this,void 0,void 0,(function(){var t=this;return(0,o.__generator)(this,(function(n){return[2,new Promise((function(n,o){t.load(e,(function(e){return n(e)}),(function(e){return o(e)}))}))]}))}))},e.prototype.listenModuleLoad=function(e,t){void 0===t&&(t=s),this.listen("SL_MODULE_LOAD_".concat(e),t)},e.prototype.loadScriptProcess=function(e,t,n,i){var r=this;return new Promise((function(a,c){var l=e.asset,s=e.cache,f=e.mod,m=e.parentModule,v=(0,u.e)("env_id")?l[f].url:d.findRequestUrl(l[f].url,i),h=r.createScript(v);l[f].state=1,h.addEventListener("load",(function(){window[f]&&(d.emitLoadSuccessEvent(v,{resourceType:"JS",retryCount:i}),s[f]=window[f],l[f].state=0,!r.firstLoaded[m]&&r.checkAllLoaded(l,m)&&t(s[m],s,!0),r.dispatch("SL_MODULE_LOAD_".concat(f)),r.monitor(3078345),a())})),h.addEventListener("error",(function(){d.emitLoadFailedEvent(v,{resourceType:"JS",retryCount:i}),i+1>=p?(c(),l[f].state=2):l[f].state=-1,l[f].url=v,r.load(f,(function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];a(),null==t||t.apply(void 0,(0,o.__spreadArray)([],(0,o.__read)(e),!1))}),n,i+1),h&&r.removeScript(h),null==n||n({code:3,msg:"load error"}),r.monitor(3078346)}))}))},e.prototype.checkAllLoaded=function(e,t){var n=e[t];if(0!==e[t].state)return!1;if(void 0!==n.dep)for(var o=Object.keys(n.dep),i=0,r=o.length;i<r;i++)if(!window[o[i]])return!1;return this.firstLoaded[t]=!0,!0},e.prototype.createScript=function(e){var t=document.createElement("script");return t.src="".concat(e).concat(e.indexOf("?")<0?"?":"&","version=").concat(this.metadata),t.async=!1,t.type="text/javascript",e.indexOf(location.host)<0&&(t.crossOrigin="anonymous"),document.body.appendChild(t),t},e.prototype.removeScript=function(e){e&&e.parentNode&&e.parentNode.removeChild(e)},e.prototype.ajax=function(e){var t,n,o=this,i=function(e){return{url:e.url,paramObj:e.paramObj||{},success:e.success||s,fail:e.fail||s,method:e.method||"GET"}}(e),r=(t=i.paramObj,n=[],Object.keys(t).forEach((function(e){n.push("".concat(e,"=").concat(encodeURIComponent(t[e])))})),n.join("&")),a=function(e,t){return e+(e.indexOf("?")>=0?"&":"?".concat(t))}(i.url,r),c=function(){for(var e=null,t=[function(){return new XMLHttpRequest},function(){return new XDomainRequest}],n=0,o=t.length;n<o;n++){try{e=t[n]()}catch(e){continue}break}return e}();if(!c)throw new Error("XMLHttp is not defined");c.open("GET",a,!0),c.send(),c.onreadystatechange=function(){if(4===c.readyState)if(200===c.status){var e=JSON.parse(c.responseText);i.success({data:e,code:0}),o.monitor(3078349)}else i.fail({code:c.status}),c.status>=400&&c.status<500?o.monitor(3078350):c.status>=500&&c.status<600&&o.monitor(3078351)},c.onerror=function(){i.fail({code:-1})}},e.prototype.dispatch=function(e,t){if(this.assetLoaded){var n=new window.CustomEvent(e,{detail:t});window.dispatchEvent(n)}else this.evtArr.push({eventName:e,detail:t})},e.prototype.listen=function(e,t){void 0===t&&(t=s),e===f&&this.assetLoaded?t({}):(window.addEventListener(e,t),this.listenerMap.get(e)?this.listenerMap.get(e).push(t):this.listenerMap.set(e,[t]))},e}(),v=n(1792),h=function(){function e(e){var t=this;this.contextService=e,this.afterInit=function(){t.initAuthModalByUrlQuery()},this.slr=m.getInstance(),this.init()}var t;return e.prototype.init=function(){v.dQ||this.slr.init("//".concat(window.location.hostname,"/components/feature/assets.v1.json"))},e.prototype.getScriptLoader=function(){return this.slr},e.prototype.$onReset=function(){this.slr.clearCache(),this.init()},e.prototype.initAuthModalByUrlQuery=function(){var e,t,n=this;this.openAuthModalByUrlQuery(),null===(t=null===(e=window.tdocs)||void 0===e?void 0:e.onUrlChange)||void 0===t||t.call(e,(function(e){n.openAuthModalByUrlQuery(e.url)}))},e.prototype.openAuthModalByUrlQuery=function(e){var t=this;(e||location.href).match(/wdop=openAuthDlg/)&&window.SLR.load("CooperationV3",(function(e){var n=t.contextService.context.clientVars,o=n.globalPadId,i=n.padTitle,r=n.userInfo,a=r.corpId,c=r.userId,l=n.creatorCorpName,u="avd-container",s=document.getElementById(u);s||((s=document.createElement("div")).id=u,document.body.appendChild(s)),e.init(s,{thirdAuthPanel:{type:"enterpriseWx",options:{globalPadId:o,title:i,corpId:a,corpName:l,uid:c}}})}))},e=(0,o.__decorate)([(0,i.t)(),(0,o.__metadata)("design:paramtypes",["function"==typeof(t=void 0!==r.O&&r.O)?t:Object])],e)}()}}]),"object"==typeof globalThis&&(globalThis.jsExecEndTimeStamp=Date.now(),globalThis.cachedPerformanceEntries||(globalThis.cachedPerformanceEntries=[]),globalThis.cachedPerformanceEntries.push({name:"jsExec: js/public-9140-120b4df1.js",entryType:"jsExec",startTime:globalThis.jsExecStartTimeStamp,endTime:globalThis.jsExecEndTimeStamp}));
//# sourceMappingURL=public-9140-120b4df1.js.map