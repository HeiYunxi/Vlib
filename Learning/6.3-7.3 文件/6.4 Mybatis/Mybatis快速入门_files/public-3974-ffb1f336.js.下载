"object"==typeof globalThis&&(globalThis.jsExecStartTimeStamp=Date.now()),(self.webpackChunkuni=self.webpackChunkuni||[]).push([[3974],{888357:function(){},158774:function(e,t){t.Z={"list-overlay":"tdocs-list-overlay",listOverlay:"tdocs-list-overlay","list-overlay-layer":"tdocs-list-overlay-layer",listOverlayLayer:"tdocs-list-overlay-layer","list-overlay-selected":"tdocs-list-overlay-selected",listOverlaySelected:"tdocs-list-overlay-selected","list-overlay-list-selected":"tdocs-list-overlay-list-selected",listOverlayListSelected:"tdocs-list-overlay-list-selected","list-marker-lite":"tdocs-list-marker-lite",listMarkerLite:"tdocs-list-marker-lite","list-marker-text":"tdocs-list-marker-text",listMarkerText:"tdocs-list-marker-text"}},37416:function(e,t,n){n.d(t,{z:function(){return a}});var o=n(839461),r=n(865213),i=n(734156);function a(e,t,n){return void 0===t&&(t=["loader"]),void 0===n&&(n=!1),function(a,s,l){void 0===l&&(l=(0,r.yH)(a,s));var c=l.value;l.value=function(){for(var r=this,a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];return i.kU.call(this,t)?c.call.apply(c,(0,o.__spreadArray)([this],(0,o.__read)(a),!1)):(n&&Promise.all(i.bn.call(this,t)).then((function(){return c.call.apply(c,(0,o.__spreadArray)([r],(0,o.__read)(a),!1))})),e)}}}},282790:function(e,t,n){var o;n.d(t,{F:function(){return o}}),function(e){e[e.Seperator=0]="Seperator",e[e.ImageButton=1]="ImageButton",e[e.DropdownButton=2]="DropdownButton",e[e.TextButton=3]="TextButton",e[e.SeperatorBlock=4]="SeperatorBlock"}(o||(o={}))},83034:function(e,t,n){n.d(t,{n:function(){return g}});var o=n(839461),r=(n(888357),n(87363)),i=n.n(r),a=n(282790),s=n(129602),l=n(801134),c=n.n(l),u=function(e){function t(t){var n=e.call(this,t)||this;return n.onMouseUp=function(e){n.props.disable&&n.props.disable()||n.props.onClickCallback(e,n.props.id,n.props.type)},n.getClassName=function(){var e=c()("st-button",n.props.icon);return n.props.disable&&n.props.disable()?e="".concat(e," st-button-disabled"):n.props.selected&&n.props.selected()&&(e=c()("st-button-selected",n.props.icon)),e},n}return(0,o.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.title,n=void 0===t?"":t,o=e.iconSrc,r=this.getClassName(),a=o?{backgroundImage:"url(".concat(o,")")}:{};return i().createElement(s.ZP,{placement:"top",title:this.props.tips||n},i().createElement("div",{className:r,style:a,onMouseUp:this.onMouseUp.bind(this)},n))},t}(i().Component),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.render=function(){return i().createElement("div",{className:"st-separator"})},t}(i().Component),p=n(429313),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onMouseUp=function(e){t.props.onSelectedItemCallback(e,t.props.item,t.props.index),e.preventDefault(),e.stopPropagation()},t}return(0,o.__extends)(t,e),t.prototype.wrapWithToolTip=function(e,t){var n=e.tooltip;if(!n)return t;if(n instanceof Object){var o=n.placement,r=n.containerStyle,a=n.overlayStyle,l=n.style,c=n.alignment,u=n.hoverDelay,d=n.content;return i().createElement(s.ZP,{placement:o||"left",style:l,containerStyle:r,overlayStyle:a,alignment:c||"center",hoverDelay:u||400,title:d,key:e.name},t)}return i().createElement(s.ZP,{placement:"left",title:n,key:e.name},t)},t.prototype.generateIcon=function(){var e=this.props.item,t=e.iconSize?{width:"".concat(e.iconSize,"px"),height:"".concat(e.iconSize,"px"),backgroundSize:"".concat(e.iconSize,"px")}:{};return"right"===e.iconPosition&&(t=Object.assign(t,{marginLeft:"4px"})),i().createElement(i().Fragment,null,e.icon&&i().createElement("div",{className:"st-dropdown-item-icon ".concat(this.props.item.icon),style:t}),e.iconURL&&i().createElement("img",{className:"st-dropdown-item-addon-icon",style:t,src:this.props.item.iconURL}))},t.prototype.render=function(){var e,t,n=this.props.item;if("divider"===n.type)return i().createElement(p.ZP,null);var o=null!==(t=n.checkStyle)&&void 0!==t?t:"st-dropdown-item-selected-blue",r="title"===n.type,a=c()(((e={"st-dropdown-item":!0,"st-dropdown-item-no-hover":!!this.props.noHover||!!n.isDisabled||r})[o]=n.isSelected,e)),s=c()({"st-dropdown-item-content":!0,"st-dropdown-item-disabled":n.isDisabled||r,"st-dropdown-item-show-select-content":!(n.isHideSelect||r)}),l=null;return n.name&&n.name.length>0&&(l=i().createElement("div",{className:s,style:this.props.style},"right"!==n.iconPosition?this.generateIcon():null,n.name,n.description,"right"===n.iconPosition?this.generateIcon():null)),this.wrapWithToolTip(this.props.item,i().createElement("li",{className:a,onMouseUp:this.onMouseUp.bind(this)},null!=l?l:""))},t}(i().Component),h=n(276034),m=n(218581),v=function(e){function t(t){var n=e.call(this,t)||this;return n.listRef=i().createRef(),n.searchRef=i().createRef(),n.handleSelectedItem=function(e,t,o){t&&(n.props.autoSelected&&n.updateSelectedItem(t),!t.isDisabled&&n.props.onSelectedItemCallback(e,t,o))},n.updateSelectedItem=function(e){n.props.items.forEach((function(t){t&&(t.isSelected=t===e)}))},n.fuzzySearch=function(e){var t=n.props.items;if(""!==e){var o=t.filter((function(t){return n.candidateTokens(t).some((function(t){return t&&n.indexOfKeyword(t,e)>=0}))})).sort((function(t,o){var r=n.closestToken(n.candidateTokens(t),e),i=n.closestToken(n.candidateTokens(o),e);return n.indexOfKeyword(r,e)-n.indexOfKeyword(i,e)}));n.setState({filterItems:o})}},n.candidateTokens=function(e){return e.alias?(0,o.__spreadArray)([e.name,e.alias],(0,o.__read)(e.fuzzyToken||[]),!1):(0,o.__spreadArray)([e.name],(0,o.__read)(e.fuzzyToken||[]),!1)},n.closestToken=function(e,t){return(0,o.__read)(e.filter((function(e){return n.indexOfKeyword(e,t)>=0})).sort((function(e,o){return n.indexOfKeyword(e,t)-n.indexOfKeyword(o,t)})),1)[0]},n.indexOfKeyword=function(e,t){return e.trim().toLowerCase().indexOf(t.toLowerCase())},n.componentDidMount=function(){var e;n.menuMoveToSelected(),null===(e=n.searchRef.current)||void 0===e||e.focus({preventScroll:!0})},n.state={filterItems:n.props.items,text:"",hasBeenAutoScroll:!1},n}return(0,o.__extends)(t,e),t.prototype.onMouseDown=function(e){e.stopPropagation()},t.prototype.onMouseUp=function(e){e.stopPropagation()},t.prototype.onTextChange=function(e){this.setState({text:e}),this.fuzzySearch(e)},t.prototype.componentDidUpdate=function(){""!==this.state.text?this.menuMoveToTop():this.menuMoveToSelected()},t.prototype.menuMoveToTop=function(){this.props.autoScroll&&!this.state.hasBeenAutoScroll&&(this.listRef&&this.listRef.current&&(this.listRef.current.scrollTo?this.listRef.current.scrollTo(0,0):(this.listRef.current.scrollLeft=0,this.listRef.current.scrollTop=0)),this.setState({hasBeenAutoScroll:!0}))},t.prototype.menuMoveToSelected=function(){if(this.props.autoScroll&&!this.state.hasBeenAutoScroll){for(var e=0,t=0;t<this.props.items.length;t++)if(this.props.items[t].isSelected){e=t;break}this.listRef&&this.listRef.current&&(this.listRef.current.scrollTo?this.listRef.current.scrollTo(0,32*e):(this.listRef.current.scrollLeft=0,this.listRef.current.scrollTop=32*e)),this.setState({hasBeenAutoScroll:!0})}},t.prototype.render=function(){var e=this,t=this.state,n=t.filterItems,o=t.text,r=this.props,a=r.items,s=r.precede,l=r.searchPlaceholder,c=[];return c=""===o?a:n,i().createElement("div",{className:"st-dropdown-menu",style:s?{paddingTop:8}:{}},l?i().createElement(h.default,{inputRef:this.searchRef,className:"st-dropdown-menu-search",inputClassName:"st-dropdown-menu-search-input",placeholder:l,onChange:this.onTextChange.bind(this),onMouseDown:this.onMouseDown.bind(this),onMouseUp:this.onMouseUp.bind(this),value:o,inputStyle:{paddingLeft:"34px",paddingRight:"46px"},leftIcon:i().createElement("div",{className:"st-dropdown-menu-search-icon-left"}),icon:""===o?"":i().createElement("div",{className:"st-dropdown-menu-search-icon-right"}),onClickIcon:function(){return e.setState({text:""})}}):"",l?i().createElement("div",{style:{borderTop:"1px solid rgba(0,0,0,0.08)",paddingBottom:7}}):"",i().createElement("div",{className:"st-dropdown-menu-listbox",ref:this.listRef},c.length>0?c.map((function(t,n){return t.name?i().createElement(f,{key:n,index:n,item:t,onSelectedItemCallback:e.handleSelectedItem.bind(e)}):null})):i().createElement("div",{className:"st-dropdown-menu-nothing"},(0,m.$t)("无结果"))))},t}(i().Component),y=function(e){function t(t){var n=e.call(this,t)||this;return n.onMouseUp=function(e){n.props.disable&&n.props.disable()||n.props.onClickCallback(e,n.props.id,n.props.type)},n.handleSelectItemCallback=function(e,t,o){t&&n.props.onSelectedItemCallback(e,n.props.id,n.props.type,t,o)},n}return(0,o.__extends)(t,e),t.prototype.getSelectContent=function(){return this.props.extend?this.props.content?this.props.content:i().createElement("div",{className:"st-dropdown-menu-wrapper"},i().createElement(v,{precede:this.props.tips,searchPlaceholder:this.props.searchPlaceholder,items:this.props.items,onSelectedItemCallback:this.handleSelectItemCallback.bind(this),autoScroll:this.props.autoScroll,autoSelected:this.props.autoSelected})):null},t.prototype.render=function(){var e=this.props.title||"",t=c()("st-dropdown-button",this.props.icon),n="st-dropdown-button-wrapper";return this.props.disable&&this.props.disable()?n="".concat(n," st-button-disabled"):this.props.extend&&(n="".concat(n," active")),i().createElement("div",{className:"st-dropdown-button-container"},i().createElement(s.ZP,{placement:"top",title:this.props.tips,disabled:!this.props.tips||this.props.extend},i().createElement("div",{className:n,onMouseUp:this.onMouseUp.bind(this)},i().createElement("div",{className:t},e),i().createElement("div",{className:"st-menu-button-dropdown",style:this.props.icon?{marginLeft:0,marginRight:"2px"}:{}}))),this.getSelectContent())},t}(i().Component),E=function(e){function t(t){var n=e.call(this,t)||this;return n.onMouseUp=function(e){n.props.onClickCallback(e,n.props.id,n.props.type)},n.mouseEnter=function(){n.setState({mouseIn:!0})},n.mouseLeave=function(){n.setState({mouseIn:!1})},n.state={mouseIn:!1},n}return(0,o.__extends)(t,e),t.prototype.render=function(){var e=this.props.title||"",t=c()("st-text-button",this.props.text);this.props.disable&&this.props.disable()?t="".concat(t," st-button-disabled"):this.state.mouseIn&&(t="st-text-button st-text-highted");var n=i().createElement("div",{className:t,onMouseUp:this.onMouseUp.bind(this),onMouseEnter:this.mouseEnter.bind(this),onMouseLeave:this.mouseLeave.bind(this)},this.props.text);return this.props.tips||this.props.title?i().createElement(s.ZP,{placement:"top",title:this.props.tips||e},n):n},t}(i().Component),g=function(e){function t(t){var n=e.call(this,t)||this;return n.toolbarRef=i().createRef(),n.state={extendId:""},n}return(0,o.__extends)(t,e),t.prototype.componentDidUpdate=function(e){var t=e.posX,n=e.posY,o=this.props,r=o.posX,i=o.posY;t===r&&n===i||this.hideDropdown()},t.prototype.getISTButtonMap=function(e){var t,n=this;return(t={})[a.F.DropdownButton]=function(){return n.renderDropdownButton(e)},t[a.F.ImageButton]=function(){return n.renderImageButton(e)},t[a.F.Seperator]=function(){return n.renderSeperator(e)},t[a.F.SeperatorBlock]=function(){return n.renderSeperatorBlock(e)},t[a.F.TextButton]=function(){return n.renderTextButton(e)},t},t.prototype.renderImageButton=function(e){return i().createElement(u,{key:e.id,id:e.id,type:e.type,tips:e.config.tips,title:e.config.title,icon:e.config.icon,iconSrc:e.config.iconSrc,disable:e.disable,selected:e.selected,onClickCallback:this.onClickCallback.bind(this)})},t.prototype.renderDropdownButton=function(e){return i().createElement(y,{key:e.id,id:e.id,type:e.type,icon:e.config.icon,tips:e.config.tips,title:e.config.title,extend:this.state.extendId===e.id,items:e.config.items?e.config.items:[],autoScroll:e.config.autoScroll,autoSelected:e.config.autoSelected,disable:e.disable,searchPlaceholder:e.config.searchPlaceholder,onClickCallback:this.onClickCallback.bind(this),content:e.config.content,onSelectedItemCallback:this.onSelectedItemCallback.bind(this)})},t.prototype.renderSeperator=function(e){return i().createElement(d,{key:e.id})},t.prototype.renderTextButton=function(e){return i().createElement(E,{key:e.id,id:e.id,type:e.type,tips:e.config.tips,title:e.config.title,text:e.config.text,disable:e.disable,onClickCallback:this.onClickCallback.bind(this)})},t.prototype.renderSeperatorBlock=function(e){return i().createElement("div",{key:e.id,className:"st-separator-block"+"".concat(-1!==e.id.indexOf("big")?" bigblock":"")})},t.prototype.switchButtonType=function(e){var t=this.getISTButtonMap(e);return Object.hasOwnProperty.call(t,e.type)?(0,t[e.type])(e):""},t.prototype.processButtonConfig=function(){for(var e=this.props.buttons.filter((function(e){return!e.show||e.show()})),t=e.length-1;t>=0&&e[t].type===a.F.Seperator;)t-=1;return e.slice(0,t+1)},t.prototype.render=function(){var e=this,t=(0,o.__assign)({left:this.props.posX,top:this.props.posY},this.props.extraStyle),n=this.processButtonConfig();return this.props.visible&&n.length>0?i().createElement("div",{className:"suspend-toolbar docs-ui-unprintable",style:t,ref:this.toolbarRef,onMouseDown:this.onMouseDown.bind(this),onMouseMove:this.onMouseMove.bind(this),onMouseUp:this.onMouseUp.bind(this),onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave},n.map((function(t){return e.switchButtonType(t)}))):""},t.prototype.showDropdown=function(e){this.state.extendId!==e&&this.setState({extendId:e})},t.prototype.hideDropdown=function(){this.setState({extendId:""})},t.prototype.getToolbarSize=function(){if(!this.toolbarRef.current)return null;var e=this.toolbarRef.current.getBoundingClientRect();return{width:e.width,height:e.height}},t.prototype.onClickCallback=function(e,t,n){var o=!1;n===a.F.DropdownButton&&t!==this.state.extendId?(this.setState({extendId:t}),o=!0):this.setState({extendId:""}),this.props.onClickCallback(e,t,n,o)},t.prototype.onSelectedItemCallback=function(e,t,n,o,r){this.props.onSelectedItemCallback&&this.props.onSelectedItemCallback(e,t,n,o,r),this.hideDropdown()},t.prototype.handlerMouseEvent=function(e){e.stopPropagation(),e.preventDefault()},t.prototype.onMouseDown=function(e){this.handlerMouseEvent(e)},t.prototype.onMouseUp=function(e){this.handlerMouseEvent(e)},t.prototype.onMouseMove=function(e){this.handlerMouseEvent(e)},t}(i().Component)},292060:function(e,t,n){n.r(t),n.d(t,{IAddonSceneFeature:function(){return s}});var o=n(839461),r=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.AddonScene));r.Ln.merge(s,{useFactory:function(){return(0,o.__awaiter)(void 0,void 0,void 0,(function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5070),n.e(9440),n.e(5597),n.e(9820),n.e(6649),n.e(6922),n.e(5049),n.e(8063),n.e(6205),n.e(8971),n.e(823),n.e(1997),n.e(9140),n.e(2557),n.e(3974),n.e(2878),n.e(2340),n.e(4292),n.e(4397),n.e(4427),n.e(5576),n.e(520)]).then(n.bind(n,632662))];case 1:return[2,e.sent().AddonSceneHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2,a.YV.Publish],key:s})})},410253:function(e,t,n){n.r(t),n.d(t,{IContextmenuMobileFeature:function(){return s}});var o=n(839461),r=n(259356),i=n(293325),a=n(870372),s=Symbol.for("feature:".concat(a.C.ContextmenuMobile));r.Ln.merge(s,{useFactory:function(){return(0,o.__awaiter)(void 0,void 0,void 0,(function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(9234).then(n.bind(n,285886))];case 1:return[2,e.sent().ContextMenuMobileHandler]}}))}))},on:i.iz.On({stages:[i.YV.Level2,i.YV.Publish],key:s,platforms:[i.Ev.Mobile,i.Ev.Pad]})})},452088:function(e,t,n){n.d(t,{UH:function(){return i},jG:function(){return s},k8:function(){return l},ol:function(){return a},ym:function(){return o}});var o,r=n(218581),i=128,a=13;!function(e){e.OpenOriginUrl="openOriginUrl",e.CopyUrl="copyUrl",e.EditUrl="editUrl",e.FullScreen="fullScreen",e.Refresh="refresh",e.SwitchMode="switchMode",e.Delete="delete",e.Cancel="cancel"}(o||(o={}));var s,l={text:(0,r.$t)("文字链"),inline:(0,r.$t)("图标+文字链"),card:(0,r.$t)("卡片"),preview:(0,r.$t)("预览"),iframe:(0,r.$t)("预览")};!function(e){e.Copy="st-button-copylink",e.Edit="st-button-editSrcUrl",e.FullScreen="st-button-fullscreen",e.Refresh="st-button-refresh",e.Delete="st-button-delete",e.Cancel="st-button-cancelLink"}(s||(s={}))},539957:function(e,t,n){n.r(t),n.d(t,{IHyperlinkFeature:function(){return s}});var o=n(839461),r=n(259356),i=n(293325),a=n(870372),s=Symbol.for("feature:".concat(a.C.Hyperlink));r.Ln.merge(s,{useFactory:function(){return(0,o.__awaiter)(void 0,void 0,void 0,(function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5070),n.e(9440),n.e(5597),n.e(9820),n.e(6649),n.e(6922),n.e(5049),n.e(8063),n.e(6205),n.e(8971),n.e(823),n.e(1997),n.e(9140),n.e(2557),n.e(3974),n.e(2878),n.e(2340),n.e(4292),n.e(4397),n.e(4427),n.e(5576),n.e(520)]).then(n.bind(n,723936))];case 1:return[2,e.sent().HyperlinkHandler]}}))}))},on:i.iz.On({stages:[i.YV.Level2,i.YV.Publish],key:s})})},76989:function(e,t,n){n.d(t,{Kh:function(){return h},Nn:function(){return f},_b:function(){return d},lm:function(){return c},sQ:function(){return u},w$:function(){return m},w0:function(){return p}});var o=n(750670),r=(n(495155),n(707605)),i=n(967844),a=n(252783),s=n(704918),l=n(503312);function c(e){var t,n=null===(t=e.fieldCode.switches)||void 0===t?void 0:t[i.h_.fileExt];return Number(void 0===n?a.Au.NORMAL_LINK:n)}function u(e){var t,n=e.fieldCode,o=n.instructions,r=n.switches,a=null==o?void 0:o[0];return(a||(null==r?void 0:r.l))&&r?{key:null==r?void 0:r[i.h_.key],fileExt:c(e),fileUrl:r[i.h_.fileUrl]||a,internalJump:r[i.a.internalJump]||"",fileType:r[i.h_.fileType],fileId:r[i.h_.fileId],fileName:(null===(t=e.fieldResult)||void 0===t?void 0:t.result)||r[i.h_.fileName]||"",docPolicy:r[i.h_.docPolicy]?Number(r[i.h_.docPolicy]):void 0,displayLayoutType:r[i.h_.displayLayoutType],fileDesc:r[i.h_.fileDesc],fileFavicon:r[i.h_.fileFavicon],docLinkFrom:r[i.h_.docLinkFrom],openType:r[i.h_.docPolicy]?Number(r[i.h_.openType]):void 0}:null}function d(e){var t,n=e.fileUrl,r=e.fileName,a=e.openType,s=e.fileId,c=e.fileType,u=e.fileExt,d=e.docPolicy,p=e.key,f=e.displayLayoutType,h=void 0===f?o.FieldDisplayLayoutTypeChar.Inline:f,m=e.fileDesc,v=e.fileFavicon,y=e.docLinkFrom,E=e.internalJump,g=(0,l.NV)(u),_=[n,g],x=((t={})[i.h_.fileType]=c,t[i.h_.fileExt]="".concat(u),t[i.h_.fileId]=s,t[i.h_.docPolicy]=void 0===d?void 0:"".concat(d),t[i.h_.openType]=void 0===d?void 0:"".concat(a),t[i.h_.displayLayoutType]=h,t[i.h_.fileDesc]=m,t[i.h_.fileFavicon]=v,t[i.h_.docLinkFrom]=y,t[i.a.internalJump]=E,t[o.FieldCommonSwitchesName.subtype]=g,t[o.FieldCommonSwitchesName.key]=p,t);return{fieldCode:{name:o.FieldName.HYPERLINK,instructions:_,switches:x},fieldResult:r?{result:r}:void 0}}function p(e){var t,n;try{var r=e.fieldCode.switches;if(!r)return null;var i=r[s.fC.displayText],a=r[s.fC.extraData]?unescape(r[s.fC.extraData]):void 0;return{title:i?unescape(i):null!==(n=null===(t=e.fieldResult)||void 0===t?void 0:t.result)&&void 0!==n?n:"",embedUrl:r[s.fC.embedUrl],originUrl:r[s.fC.originUrl],width:Number(r[s.fC.width]),height:Number(r[s.fC.height]),iframeId:r[s.fC.iframeId],extraData:a,mode:r[s.fC.displayLayoutType],icon:"",aid:r[s.fC.iframeId],lockAspectRatio:!!r[o.FieldCommonSwitchesName.lockAspectRatio]}}catch(e){return null}}function f(e){var t,n=void 0;return e.lockAspectRatio&&(n=e.lockAspectRatio?"1":"0"),(t={})[s.fC.embedUrl]=e.embedUrl,t[s.fC.originUrl]=e.originUrl,t[s.fC.width]="".concat(e.width),t[s.fC.height]="".concat(e.height),t[s.fC.iframeId]=e.iframeId,t[s.fC.extendedData]=e.iframeId,t[s.fC.extraData]=e.extraData?escape(e.extraData):void 0,t[s.fC.lockAspectRatio]=n,t[o.FieldCommonSwitchesName.displayLayoutType]=e.mode,t}function h(e,t){var n;return void 0===t&&(t=!0),!!(null===(n=window.clientVars)||void 0===n?void 0:n.isPublish)||e.docEnv.docViewType===o.DocViewType.PresentationPreview||e.docEnv.preview||t&&!r.qO.getInstance().isEditable||t&&!1}function m(e,t){return void 0===t&&(t=!0),h(e,t)}},717610:function(e,t,n){n.d(t,{Y:function(){return s}});var o=n(839461),r=n(750670),i=n(218581),a=function(){function e(){}return e.numberToChinese=function(e){var t=["〇",(0,i.$t)("一"),(0,i.$t)("二"),(0,i.$t)("三"),(0,i.$t)("四"),(0,i.$t)("五"),(0,i.$t)("六"),(0,i.$t)("七"),(0,i.$t)("八"),(0,i.$t)("九")],n=["",(0,i.$t)("十"),(0,i.$t)("百"),(0,i.$t)("千"),(0,i.$t)("万"),(0,i.$t)("十"),(0,i.$t)("百"),(0,i.$t)("千"),(0,i.$t)("亿"),(0,i.$t)("十"),(0,i.$t)("百"),(0,i.$t)("千"),(0,i.$t)("兆"),(0,i.$t)("十"),(0,i.$t)("百"),(0,i.$t)("千"),(0,i.$t)("京"),(0,i.$t)("十"),(0,i.$t)("百"),(0,i.$t)("千"),(0,i.$t)("垓")],o=(0,i.$t)("负"),r="",a=Math.floor(Math.abs(e));if(a<1)return(e<0?o:"")+t[0];for(var s=n.slice();a>0;){var l=s.shift();r=t[a%10]+l+r,a=Math.floor(a/10)}var c=n[1]+n[2]+n[3],u=n[4]+n[8]+n[12]+n[16]+n[20],d=t[0];return(e<0?o:"")+(r=r.replace(new RegExp("(".concat(d,")[").concat(c,"]"),"g"),"$1").replace(new RegExp("([".concat(u,"])[^").concat(c,"]+([").concat(u,"])"),"g"),"$1".concat(d)).replace(new RegExp("([".concat(c,"])").concat(d,"+([").concat(u,"])"),"g"),"$1$2".concat(d)).replace(new RegExp("(".concat(t[0],")+"),"g"),"$1").replace(new RegExp("".concat(d,"+$")),"").replace(new RegExp("^".concat(t[1]).concat(n[1])),n[1]))},e.chineseToNumber=function(e){for(var t={"〇":0,"零":0,"一":1,"二":2,"三":3,"四":4,"五":5,"六":6,"七":7,"八":8,"九":9},n={"十":{value:10,secUnit:!1},"百":{value:100,secUnit:!1},"千":{value:1e3,secUnit:!1},"万":{value:1e4,secUnit:!0},"亿":{value:1e8,secUnit:!0}},o=0,r=0,i=0,a=e.split(""),s=0;s<a.length;s++){var l=t[a[s]];if(void 0!==l)i=l,s===a.length-1&&(r+=i);else{var c=n[a[s]].value;n[a[s]].secUnit?(o+=r=(r+i)*c,r=0):r+=i*c,i=0}}return o+r},(0,o.__decorate)([(0,r.cached)(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Number]),(0,o.__metadata)("design:returntype",void 0)],e,"numberToChinese",null),(0,o.__decorate)([(0,r.cached)(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[String]),(0,o.__metadata)("design:returntype",Number)],e,"chineseToNumber",null),e}(),s=function(e){function t(t){var n=e.call(this)||this;return n.editor=t,n.isAutoUpdate=!0,n}return(0,o.__extends)(t,e),t.prototype.canFocusInField=function(e){return!1},t.prototype.getFieldLayoutText=function(e,n){return t.parse(e,n)},t.parse=function(e,t){var n;return this.parseFieldCodeSwitches(null!==(n=e.switches)&&void 0!==n?n:{},t)},t.parseFieldCodeSwitches=function(e,t){var n,o,s,l,c,u=null!==(n=t.pageNum)&&void 0!==n?n:r.Defaults.section.pageStartAt,d=null!==(o=t.pageNumFormat)&&void 0!==o?o:r.STNumberFormat.PBDEFAULT;if(d!==r.STNumberFormat.PBDEFAULT)return r.NumberedListUtil.numeric2ListText(u,d);var p=null!==(s=t.pageCount)&&void 0!==s?s:0;"TDW-CHINESE"===e["*"]?(l=a.numberToChinese(u),c=a.numberToChinese(p)):(l="".concat(u),c="".concat(p));var f=l;switch(e["@"]){case"·$P·":f="·".concat(l,"·");break;case"-$P-":f="-".concat(l,"-");break;case"第$P页":f=(0,i.$t)("第{{pageResult}}页",{pageResult:l});break;case"$P/$N":f="".concat(l,"/").concat(c);break;default:f=r.NumberedListUtil.numeric2ListText(u,d)}return f},t.prototype.requiredContext=function(e){var t=[r.FieldCodeLayoutContextKey.PAGE_NUM,r.FieldCodeLayoutContextKey.PAGE_NUM_FORMAT];return e.switches&&"string"==typeof e.switches["@"]&&e.switches["@"].indexOf("$N")>=0&&t.push(r.FieldCodeLayoutContextKey.PAGE_COUNT),t},t.prototype.getPrefab=function(e){return t.parse(e,{pageNum:999,pageCount:999})},t.prototype.getDropdownItems=function(e,n){var o,i=this,s=e.switches,l="",c=-1;switch((void 0===s?{}:s)["@"]){case"·$P·":o=/·(\d+)·/,c=1;break;case"-$P-":o=/-(\d+)-/,c=2;break;case"第$P页":o=/第([〇一二三四五六七八九十百千万]+)页/,c=3;break;case"$P/$N":o=/(\d+)\/(\d+)/,c=4;break;default:c=0,l=n,o=/(\d+)/}if(""===l){var u=o.exec(n);if(null===u)return[];l=3===c?"".concat(a.chineseToNumber(u[1])):u[1]}var d=parseInt(l,10);return["PAGE",'PAGE \\@ "·$P·"','PAGE \\@ "-$P-"','PAGE \\@ "第$P页" \\* TDW-CHINESE','PAGE \\@ "$P/$N"'].map((function(e,n){var o=r.FieldUtil.decodeFieldCode(e);return{checked:n===c,content:t.parse(o,{pageNum:d,pageCount:i.editor.pageCount}),onClick:function(n){i.editor.service.getDocument().getRange(n.begin(),n.end()).updateField(e,"1"),r.ReportHelper.tdwReport({opername:"doc_word_editor",module:"pagenumbers",action:"style_set",obj3:t.parse(o,{pageNum:1,pageCount:42})})}}}))},t.prototype.afterShowDropdown=function(){r.ReportHelper.tdwReport({opername:"doc_word_editor",module:"pagenumbers",action:"style_show"})},t}(r.FieldCodeProcessor)},503312:function(e,t,n){n.d(t,{FZ:function(){return _},GQ:function(){return y},MZ:function(){return x},Md:function(){return l},NV:function(){return c},T8:function(){return g},UU:function(){return m},tB:function(){return v},vm:function(){return E}});var o=n(839461),r=n(750670),i=n(252783),a=n(967844),s=n(704918);function l(e,t,n,o){return{fieldCode:"".concat(r.FieldName.HYPERLINK," ").concat(e," ").concat(t||""," ").concat(n||""),fieldResult:"".concat(o||e)}}function c(e){return e===i.Au.NORMAL_LINK?i.m7.NormalLink:i.m7.DocLink}function u(e,t){return Object.keys(e).find((function(n){return e[n]===t}))}function d(e,t,n){return Object.keys(a.fy).includes(e)?unescape(n[t]):s.lW.includes(t)?Number(n[t]):n[t]}function p(e,t,n){return Object.keys(a.fy).includes(e)?void 0===n?"":escape(n[e]):t}function f(){return function(e,t){var n,r,i="";try{for(var a=(0,o.__values)(Object.entries(e)),s=a.next();!s.done;s=a.next()){var l=(0,o.__read)(s.value,2),c=l[0],u=l[1];void 0!==u&&(i+="\\".concat(t[c]," ").concat(p(c,u,e)," "))}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return i&&i.slice(0,-1),i}}function h(e){return function(t){var n,r,i={};try{for(var a=(0,o.__values)(Object.entries(t)),s=a.next();!s.done;s=a.next()){var l=(0,o.__read)(s.value,1)[0],c=u(e,l);c&&(i[c]=d(c,l,t))}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return i}}var m=f(),v=f(),y=(f(),f(),f(),f()),E=h(s.c9),g=h(s.oc),_=h(s.fC),x=(f(),h(s.AG))},596740:function(e,t,n){n.r(t),n.d(t,{IFieldcodeDocLinkHandler:function(){return s}});var o=n(839461),r=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.FieldcodeDocLink));r.Ln.merge(s,{useFactory:function(){return(0,o.__awaiter)(void 0,void 0,void 0,(function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5070),n.e(9440),n.e(5597),n.e(9820),n.e(6649),n.e(6922),n.e(5049),n.e(8063),n.e(6205),n.e(8971),n.e(823),n.e(1997),n.e(9140),n.e(2557),n.e(3974),n.e(2878),n.e(2340),n.e(4292),n.e(4397),n.e(4427),n.e(5576),n.e(520)]).then(n.bind(n,18403))];case 1:return[2,e.sent().FieldcodeDocLinkHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2,a.YV.Publish],key:s})})},181355:function(e,t,n){n.d(t,{Ow:function(){return ie},x7:function(){return re},Fs:function(){return ne},zj:function(){return ye},N2:function(){return ue},re:function(){return pe},Rl:function(){return le},kb:function(){return de},M:function(){return fe},t7:function(){return ve},KC:function(){return me},mS:function(){return ce},N6:function(){return he}});var o,r=n(839461),i=n(87363),a=n.n(i),s=n(750670),l=n(495155),c=n(309003),u="data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' width='22' height='22' viewBox='0 0 22 22'%3e %3cdefs%3e %3cpath id='prefix__a' d='M10.01 1.036l7.945 7-.17.003H12.9l-1.61 8.97H7.152l1.608-8.97H5.514L2.59 4.919l6.73-.011.69-3.872z'/%3e %3c/defs%3e %3cg fill='none' fill-rule='evenodd' transform='translate(1.375 2.375)'%3e %3cpath fill='%232A65F5' d='M15.542.352H3.205c-.17 0-.316.12-.345.286L.005 16.603c-.037.211.128.406.346.406h6.8l.54-.165h3.157l.442.165h5.238c.17 0 .316-.12.346-.286L19.222 3.59 15.542.352z'/%3e %3cpath fill='%2300DCFF' fill-rule='nonzero' d='M15.542.352l3.68 3.24H15.38c-.218 0-.383-.195-.345-.406l.507-2.834z'/%3e %3cuse fill='white' xlink:href='%23prefix__a'/%3e %3c/g%3e %3c/svg%3e",d=n(712488),p=n(157488),f=n(503312),h=n(883397),m=n(199253),v=n(88111),y=n(140663),E=n(23212),g=n(241852),_=n(521052),x=n(912215),b=n(887235),C=n(262849),S=n(893846),w=n(975616),R=n(30582),D=n(92437),A=n(744005),T=n(318206),I=n(294577),k=n(554494),L=n(742763),M=n(167609),P=n(451267),N=n(30462),F=n(96345),O=n(642951),W=n(310108),V=n(833750),U=n(846655),B=n(851603),H=n(325265),$=n(589708),Z=n(698969),z=n(379458),K=n(506186),X=n(836062),j=n(799781),G=n(991287),Y=n(252783),J=n(967844),Q=n(546179),q=n(259356),ee=n(339106),te=n(76989),ne={doc:["doc","dot","wps","wpt","docx","dotx","docm","dotm"],ppt:["pptx","ppt","pot","potx","pps","ppsx","dps","dpt","pptm","potm","ppsm"],xlsx:["xls","xlt","et","ett","xlsx","ltx","csv","xlsb","xlsm","xltm","ets"],txt:["txt"]},oe={doc:Y.Au.WORD,word:Y.Au.WORD,sheet:Y.Au.EXCEL,excel:Y.Au.EXCEL,slide:Y.Au.SLIDE,form:Y.Au.FORM,pdf:Y.Au.PDF,mind:Y.Au.MIND,flowchart:Y.Au.FLOWCHART},re=((o={})[Y.Au.WORD]=(0,Q.mS)({docType:Y.e8.WORD}),o[Y.Au.EXCEL]=(0,Q.mS)({docType:Y.e8.EXCEL}),o[Y.Au.FOLDER]=c.Z,o[Y.Au.FOLDER_SHARE]=d.Z,o[Y.Au.COLLAB_SPACE]=p.Z,o[Y.Au.SLIDE]=(0,Q.mS)({docType:Y.e8.SLIDE}),o[Y.Au.FORM]=(0,Q.mS)({docType:Y.e8.FORM}),o[Y.Au.PDF]=(0,Q.mS)({docType:Y.e8.PDF}),o[Y.Au.MIND]=(0,Q.mS)({docType:Y.e8.MIND}),o[Y.Au.FLOWCHART]=(0,Q.mS)({docType:Y.e8.FLOWCHART}),o[Y.Au.SMARTCANVAS]=(0,Q.mS)({docType:Y.e8.SMARTCANVAS}),o[Y.Au.SMARTSHEET]=a().createElement(g.Z,null),o[Y.Au.FORM_JOURNAL]=a().createElement(_.Z,null),o[Y.Au.NORMAL_LINK]=h.Z,o[Y.Au.UNKNOWN]=h.Z,o[Y.Au.WEDRIVE_TXT]=a().createElement(x.Z,null),o[Y.Au.WEDRIVE_HTML]=a().createElement(b.Z,null),o[Y.Au.WEDRIVE_IMAGE]=a().createElement(C.Z,null),o[Y.Au.WEDRIVE_AUDIO]=a().createElement(S.Z,null),o[Y.Au.WEDRIVE_VIDEO]=a().createElement(w.Z,null),o[Y.Au.WEDRIVE_ZIP]=a().createElement(R.Z,null),o[Y.Au.WEDRIVE_FONT]=a().createElement(D.C,null),o[Y.Au.WEDRIVE_MAIL]=a().createElement(A.Z,null),o[Y.Au.WEDRIVE_XMIND]=a().createElement(T.Z,null),o[Y.Au.WEDRIVE_EXE]=a().createElement(I.Z,null),o[Y.Au.WEDRIVE_EXCEL]=a().createElement(k.Z,null),o[Y.Au.WEDRIVE_PPT]=a().createElement(L.Z,null),o[Y.Au.WEDRIVE_WORD]=a().createElement(M.Z,null),o[Y.Au.WEDRIVE_NUMBERS]=a().createElement(P.Z,null),o[Y.Au.WEDRIVE_KEYNOTE]=a().createElement(N.Z,null),o[Y.Au.WEDRIVE_PAGES]=a().createElement(F.Z,null),o[Y.Au.WEDRIVE_CAD]=a().createElement(O.Z,null),o[Y.Au.WEDRIVE_CDR]=a().createElement(W.Z,null),o[Y.Au.WEDRIVE_SW]=a().createElement(V.Z,null),o[Y.Au.WEDRIVE_PSD]=a().createElement(U.Z,null),o[Y.Au.WEDRIVE_AI]=a().createElement(B.Z,null),o[Y.Au.WEDRIVE_PDF]=a().createElement(H.Z,null),o[Y.Au.WEDRIVE_SKETCH]=a().createElement($.Z,null),o[Y.Au.WEDRIVE_ANDROID]=a().createElement(Z.Z,null),o[Y.Au.WEDRIVE_MAC]=a().createElement(z.C,null),o[Y.Au.WEDRIVE_SVG]=a().createElement(K.Z,null),o[Y.Au.WEDRIVE_FOLDER]=a().createElement(X.Z,null),o[Y.Au.WEDRIVE_OTHER]=a().createElement(j.Z,null),o[Y.Au.APP_LINK]="data:image/svg+xml,%3Csvg%20width%3D%2216%22%20height%3D%2217%22%20viewBox%3D%220%200%2016%2017%22%20fill%3D%22none%22%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%3E%0A%3Crect%20y%3D%220.5%22%20width%3D%2216%22%20height%3D%2216%22%20rx%3D%223%22%20fill%3D%22%234B95F3%22/%3E%0A%3Cpath%20d%3D%22M3.5%209.47926C3.5%209.21457%203.71457%209%203.97926%209H7.02074C7.28543%209%207.5%209.21457%207.5%209.47926V12.5207C7.5%2012.7854%207.28543%2013%207.02074%2013H3.97926C3.71457%2013%203.5%2012.7854%203.5%2012.5207V9.47926Z%22%20fill%3D%22white%22/%3E%0A%3Cpath%20d%3D%22M8.5%209.4824C8.5%209.21598%208.71598%209%208.9824%209H12.0176C12.284%209%2012.5%209.21598%2012.5%209.4824V12.5176C12.5%2012.784%2012.284%2013%2012.0176%2013H8.9824C8.71598%2013%208.5%2012.784%208.5%2012.5176V9.4824Z%22%20fill%3D%22white%22/%3E%0A%3Cpath%20d%3D%22M3.5%204.4288C3.5%204.19198%203.69198%204%203.9288%204H7.0712C7.30802%204%207.5%204.19198%207.5%204.4288V7.5712C7.5%207.80802%207.30802%208%207.0712%208H3.9288C3.69198%208%203.5%207.80802%203.5%207.5712V4.4288Z%22%20fill%3D%22white%22/%3E%0A%3Cpath%20d%3D%22M8.5%204.4288C8.5%204.19198%208.69198%204%208.9288%204H12.0712C12.308%204%2012.5%204.19198%2012.5%204.4288V7.5712C12.5%207.80802%2012.308%208%2012.0712%208H8.9288C8.69198%208%208.5%207.80802%208.5%207.5712V4.4288Z%22%20fill%3D%22white%22/%3E%0A%3C/svg%3E%0A",o),ie={DOC:Y.Au.WORD,SHEET:Y.Au.EXCEL,FORM:Y.Au.FORM,FOLDER:Y.Au.FOLDER,FOLDER_SHARE:Y.Au.FOLDER_SHARE,COLLAB_SPACE:Y.Au.COLLAB_SPACE,SLIDE:Y.Au.SLIDE,PDF:Y.Au.PDF,SMARTSHEET:Y.Au.SMARTSHEET,SMARTCANVAS:Y.Au.SMARTCANVAS,FORM_JOURNAL:Y.Au.FORM_JOURNAL,MIND:Y.Au.MIND,FLOWDIAGRAM:Y.Au.FLOWCHART,FLOWCHART:Y.Au.FLOWCHART,DRIVE:Y.Au.DRIVE,txt:Y.Au.WEDRIVE_TXT,html:Y.Au.WEDRIVE_HTML,image:Y.Au.WEDRIVE_IMAGE,audio:Y.Au.WEDRIVE_AUDIO,video:Y.Au.WEDRIVE_VIDEO,zip:Y.Au.WEDRIVE_ZIP,font:Y.Au.WEDRIVE_FONT,mail:Y.Au.WEDRIVE_MAIL,xmind:Y.Au.WEDRIVE_XMIND,exe:Y.Au.WEDRIVE_EXE,excel:Y.Au.WEDRIVE_EXCEL,ppt:Y.Au.WEDRIVE_PPT,word:Y.Au.WEDRIVE_WORD,numbers:Y.Au.WEDRIVE_NUMBERS,key:Y.Au.WEDRIVE_KEYNOTE,pages:Y.Au.WEDRIVE_PAGES,cad:Y.Au.WEDRIVE_CAD,cdr:Y.Au.WEDRIVE_CDR,sw:Y.Au.WEDRIVE_SW,psd:Y.Au.WEDRIVE_PSD,ai:Y.Au.WEDRIVE_AI,pdf:Y.Au.WEDRIVE_PDF,sketch:Y.Au.WEDRIVE_SKETCH,android:Y.Au.WEDRIVE_ANDROID,mac:Y.Au.WEDRIVE_MAC,svg:Y.Au.WEDRIVE_SVG,folder:Y.Au.WEDRIVE_FOLDER},ae=function(e){return function(t){return null==t?void 0:t.match(new RegExp("(?:http://|https://)?(?:\\w+.){0,2}".concat(e,"/?(doc|sheet|slide|form|pdf|mind|flowchart)?/?(?:[/\\w+&@#/%=~_|$?!:,\\.-]*)(.*)"),"i"))}};function se(){var e=G.X.getInstance().getConfig("tenantConfig.tenantLogo.SVGColor");return null!=e?e:u}function le(e){for(var t=null,n=[G.X.getInstance().getConfig("runtime.domainName"),G.X.getInstance().getConfig("custom.domains.customerDomain"),G.X.getInstance().getConfig("custom.domains.businessDomain")];!t&&n.length;){var o=n.shift();t=ae(o)(e)}return t}function ce(e){return e.indexOf("drive.weixin")>=0}function ue(e,t){var n=e.fileUrl,o=e.fileName,i=e.displayLayoutType,a=void 0===i?s.FieldDisplayLayoutTypeChar.Text:i,c=e.docLinkFrom;if(ce(n))return(0,r.__assign)((0,r.__assign)({},t),{docLinkFrom:c,fileType:J.m_.Wedrive,fileUrl:n,fileName:o||n,fileExt:Y.Au.WEDRIVE_OTHER,displayLayoutType:a});var u=e.fileExt;u||(u=(null==t?void 0:t.fileUrl)===e.fileUrl&&(null==t?void 0:t.fileExt)?null==t?void 0:t.fileExt:function(e){var t=le(e),n=(null==t?void 0:t[2])||(null==t?void 0:t[1]);return n?oe[n]:Y.Au.NORMAL_LINK}(n));var d=(0,l.appendHttp)(n,!0);return u===Y.Au.NORMAL_LINK?{key:null==t?void 0:t.key,fileExt:u,fileName:o,fileUrl:d,docLinkFrom:null!=c?c:null==t?void 0:t.docLinkFrom,displayLayoutType:a}:(0,r.__assign)((0,r.__assign)({},t),{fileExt:u,fileName:o,fileUrl:d,docLinkFrom:null!=c?c:null==t?void 0:t.docLinkFrom,displayLayoutType:a})}function de(e){return e.fileFavicon?e.fileFavicon:Object.prototype.hasOwnProperty.call(re,e.fileExt)?e.fileExt===Y.Au.DRIVE?function(e){var t,n={doc:function(){return y.Z},xlsx:function(){return E.Z},txt:function(){return m.Z},ppt:function(){return v.Z}},o=function(e){var t=e.fileName;if(t){var n=t.split(".");return n[n.length-1]}}(e);if(o)return Object.entries(ne).forEach((function(e){var n=(0,r.__read)(e,2),i=n[0];-1!==n[1].indexOf(o)&&(t=i)})),t&&Object.prototype.hasOwnProperty.call(n,t)?n[t]():se()}(e):re[e.fileExt]||se():se()}function pe(e,t){if(!e.instructions||!e.instructions[0])return null;var n=e.switches;if(!n)return null;var o=e.instructions[0],r=n[J.h_.fileExt];return{key:n[J.h_.key],fileExt:Number(void 0===r?Y.Au.NORMAL_LINK:r),fileUrl:n[J.h_.fileUrl]||o,fileType:n[J.h_.fileType],fileId:n[J.h_.fileId],fileName:unescape((null==t?void 0:t.fieldResult)||n[J.h_.fileName]||""),docPolicy:n[J.h_.docPolicy]&&Number(n[J.h_.docPolicy]),displayLayoutType:n[J.h_.displayLayoutType],fileDesc:n[J.h_.fileDesc],fileFavicon:n[J.h_.fileFavicon],fileCreatorNick:n[J.h_.fileCreatorNick],docLinkFrom:n[J.h_.docLinkFrom],openType:n[J.h_.docPolicy]&&Number(n[J.h_.openType]),height:n[J.h_.height],width:n[J.h_.width]}}function fe(e,t,n,o,i,a,s){var l=q.Am.get(ee.D),c=ue({fileUrl:e,fileName:t,displayLayoutType:n,docLinkFrom:a},i),u=(0,te._b)(c);l.insertField((0,r.__assign)((0,r.__assign)({},u),{fieldRange:o}),{keepRangeText:!1===s})}function he(e,t,n,o,i,a,s){var l={fileUrl:e,fileName:t,displayLayoutType:n},c=q.Am.get(ee.D),u=ue(l,i),d=(0,te._b)(u);c.updateField((0,r.__assign)((0,r.__assign)({},d),{fieldRange:o}),{keepRangeText:!1===a,isUnMergeUndoRedoStack:s})}function me(e){return e.fileType===J.m_.Link||e.fileExt===Y.Au.NORMAL_LINK}function ve(e){var t=le(e);return!!(null==t?void 0:t.length)}var ye=function(){function e(){}return e.isWeDrivePreview=function(e){return!(!e.fileType||![J.m_.Doc,J.m_.Wedoc,J.m_.Wedrive,J.m_.ProgressLoading].includes(e.fileType))&&[Y.Au.WEDRIVE_IMAGE,Y.Au.WEDRIVE_VIDEO].includes(e.fileExt)},e.getDefaultSize=function(){return{width:(0,l.pxToTwips)(600),height:(0,l.pxToTwips)(360)}},e.convertPcSizeToMobile=function(e,t){var n=t.docLink,o=t.layoutBox,r=this.getMaxLineWidth(e,o);if(!r||!n.width||!n.height)return null;var i=(0,l.twipsToPx)(parseFloat(n.width)),a=(0,l.twipsToPx)(parseFloat(n.height));return i<=r?{width:i,height:a}:{width:r,height:r*(a/i)}},e.convertMobileSizeToPC=function(e){var t=e.curWidth,n=e.curHeight,o=e.mobileOriginWidth,r=e.docLink;if(!r.width)return{width:t,height:n};var i=(0,l.twipsToPx)(parseFloat(r.width));if(i===o)return{width:t,height:n};var a=i/o;return{width:t*a,height:n*a}},e.getMaxLineWidth=function(e,t){if((0,s.isContainerBoxLite)(t))return t.parentBox?s.CssUtil.computeParagraphWidth(t.parentBox):0;var n=e.getDocumentBox().getFirstDescendantOf(s.BoxKind.Body);return n?(0,l.twipsToPx)(n.rect.width):0},e.setWeDrivePreviewSize=function(e,t){var n=t.field,o=t.docLink,i=t.width,a=t.height,c=n.fieldRange;if(c){var u=e.getDocumentBox().getFirstDescendantOf(s.BoxKind.Body),d=i,p=a;if(u){var h=(0,l.twipsToPx)(u.rect.width);if(h<d){var m=h/d;d=Math.floor(h),p=Math.floor(p*m)}}var v=(0,r.__assign)((0,r.__assign)({},o),{height:String((0,l.pxToTwips)(p)),width:String((0,l.pxToTwips)(d))}),y=(0,f.GQ)(v,J.h_),E=(0,f.Md)(v.fileUrl,Y.m7.DocLink,y,v.fileName);e.service.getDocument().getRange(c.begin(),c.end()).updateField(E.fieldCode,E.fieldResult)}},e.getRandomKey=function(e){return void 0===e&&(e=""),"".concat(e,"-").concat(l.StringUtil.generateRandomId())},e}()},929410:function(e,t,n){n.r(t),n.d(t,{IImageReadonlyFeature:function(){return s}});var o=n(839461),r=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.ImageReadonly));r.Ln.merge(s,{useFactory:function(){return(0,o.__awaiter)(void 0,void 0,void 0,(function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5070),n.e(9440),n.e(5597),n.e(9820),n.e(6649),n.e(6922),n.e(5049),n.e(8063),n.e(6205),n.e(8971),n.e(823),n.e(1997),n.e(9140),n.e(2557),n.e(3974),n.e(2878),n.e(2340),n.e(4292),n.e(4397),n.e(4427),n.e(5576),n.e(520)]).then(n.bind(n,338065))];case 1:return[2,e.sent().ImageReadonlyHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2,a.YV.Publish],key:s})})},841952:function(e,t,n){n.r(t),n.d(t,{CURSOR_TYPE:function(){return o},IParagraphShortcutMenuFeature:function(){return l}});var o,r=n(839461),i=n(259356),a=n(870372),s=n(293325);!function(e){e.END="end",e.START="start",e.NULL="null"}(o||(o={}));var l=Symbol.for("feature:".concat(a.C.ParagraphShortcutMenu));i.Ln.merge(l,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5070),n.e(9440),n.e(5597),n.e(9820),n.e(6649),n.e(6922),n.e(5049),n.e(8063),n.e(6205),n.e(8971),n.e(823),n.e(1997),n.e(9140),n.e(2557),n.e(3974),n.e(2878),n.e(2340),n.e(4292),n.e(4397),n.e(4427),n.e(5576),n.e(520)]).then(n.bind(n,532710))];case 1:return[2,e.sent().ParagraphShortcutMenuHandler]}}))}))},on:s.iz.On({stages:[s.YV.Level2],key:l,platforms:[s.Ev.Pc]})})},834980:function(e,t,n){n.r(t),n.d(t,{IReadRecordFeature:function(){return s}});var o=n(839461),r=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.ReadRecord));r.Ln.merge(s,{useFactory:function(){return(0,o.__awaiter)(void 0,void 0,void 0,(function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5597),n.e(9820),n.e(7797),n.e(5049),n.e(8063),n.e(823),n.e(3974),n.e(4397),n.e(7021),n.e(7131)]).then(n.bind(n,478989))];case 1:return[2,e.sent().ReadRecordHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s,platforms:[a.Ev.Pc,a.Ev.Pad,a.Ev.Mobile]})})},466391:function(e,t,n){var o;n.d(t,{l:function(){return o}}),function(e){e.InsertMention="insert_mention",e.InsertDoc="insert_doc"}(o||(o={}))},843402:function(e,t,n){n.d(t,{M:function(){return f}});var o=n(839461),r=n(87363),i=n.n(r),a=n(750670),s=n(495155),l=n(67761),c="tdocs-melo-hint",u="tdocs-melo-hint-click",d=n(377842),p=n(466391),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.contentRef=i().createRef(),t}return(0,o.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this.props,t=e.editor,n=e.paraBox;(0,a.isParagraphBoxLite)(n)&&(t.on(a.StateNotification.ModelChange,this.updateHintWidthForLite,this),this.updateHintWidthForLite())},t.prototype.componentWillUnmount=function(){var e=this.props,t=e.editor,n=e.paraBox;(0,a.isParagraphBoxLite)(n)&&t.removeListener(a.StateNotification.ModelChange,this)},t.prototype.renderItem=function(e,t){switch(e.type){case l.V.mention:return this.renderMentionSpan(e,t);case l.V.doc:return this.renderDocSpan(e,t);case l.V.normal:default:var n=this.props.paraBox,o=(0,d.O)(n);return i().createElement("span",{style:o,key:t},e.text)}},t.prototype.renderMentionSpan=function(e,t){var n=this.props,o=n.paraBox,r=n.editor,a=(0,d.O)(o);return i().createElement("span",{style:a,className:"".concat(r.isEditable()?u:""),key:t,onMouseDown:function(e){e.stopPropagation(),e.preventDefault()},onMouseUp:this.insertMention.bind(this),onTouchStart:function(e){e.stopPropagation()},onTouchEnd:this.insertMention.bind(this)},e.text)},t.prototype.renderDocSpan=function(e,t){var n=this.props,o=n.paraBox,r=n.editor,a=(0,d.O)(o);return i().createElement("span",{style:a,className:"".concat(r.isEditable()?u:""),key:t,onMouseUp:this.insertDoc.bind(this),onTouchStart:function(e){e.stopPropagation()},onTouchEnd:this.insertDoc.bind(this)},e.text)},t.prototype.insertMention=function(e){if(this.props.bridge){var t=this.props,n=t.editor,o=t.paraBox,r=o.getRange();if(!n.service.getPermissionRange().checkPermissionRangeByGcpRange(r)||!n.state.getRestrictEdit().checkPermissionRangeByGcpRange(r))return;this.moveToHintPara(n,o)&&this.props.bridge.instance.sendAction(this.props.bridge.key,{type:p.l.InsertMention,data:null})}e.preventDefault()},t.prototype.insertDoc=function(e){if(this.props.bridge){var t=this.props,n=t.editor,o=t.paraBox,r=o.getRange();if(!n.service.getPermissionRange().checkPermissionRangeByGcpRange(r)||!n.state.getRestrictEdit().checkPermissionRangeByGcpRange(r))return;this.moveToHintPara(n,o)&&this.props.bridge.instance.sendAction(this.props.bridge.key,{type:p.l.InsertDoc,data:null})}e.preventDefault()},t.prototype.moveToHintPara=function(e,t){var n=t.getRange();return!!n&&(e.setRangeTo(new a.GCPRange(n.end()-1,0)),!0)},t.prototype.updateHintWidthForLite=function(){if(!(0,a.isParagraphBox)(this.props.paraBox)){var e=this.contentRef.current;(null==e?void 0:e.parentElement)&&(e.style.width="".concat(null==e?void 0:e.parentElement.getBoundingClientRect().width,"px"))}},t.prototype.renderForCanvas=function(){var e=this,t=this.props,n=t.textInfos,o=t.frame;return o?i().createElement("div",{className:c,ref:this.contentRef,style:{width:"".concat((0,s.twipsToPx)(o.width),"px"),height:"".concat((0,s.twipsToPx)(o.height),"px"),lineHeight:"".concat((0,s.twipsToPx)(o.height),"px")}},n.map((function(t,n){return e.renderItem(t,n)}))):""},t.prototype.renderForReact=function(){var e=this,t=this.props.textInfos;return i().createElement("div",{className:c,ref:this.contentRef},t.map((function(t,n){return e.renderItem(t,n)})))},t.prototype.render=function(){var e=this.props.paraBox;return(0,a.isParagraphBoxLite)(e)?this.renderForReact():this.renderForCanvas()},t}(i().Component)},489541:function(e,t,n){n.d(t,{y:function(){return u}});var o=n(750670),r=n(67761),i=n(843402),a=n(377842),s=n(87363),l=n.n(s),c=function(){function e(e,t){this.context=e,this.bridge=t}return e.prototype.draw=function(e,t){var n=t.property.hintType;if((0,o.isParagraphBox)(t)&&n&&(0,a.E)(this.context,t)){if(!t.firstChild)return;var s=0,c=0,u=t.totalHeight;(0,o.isLineBox)(t.firstChild)&&(s=t.firstChild.edge.left,c=t.firstChild.edge.top,u=t.firstChild.rect.height,(0,o.isSubLineBox)(t.firstChild.firstChild)&&(s+=t.firstChild.firstChild.edge.left));var d=(0,o.makeFrame)(s,c,t.rect.width-s,u),p=(0,r.c)(n);if(!p)return;var f=o.PoolNodeFactory.obtain(o.IComponentView,t.uuid,d,l().createElement(i.M,{bridge:this.bridge,paraBox:t,textInfos:p,editor:this.context,frame:d}));e.addView(f)}},e}();function u(e,t){return new c(e,t)}},377842:function(e,t,n){n.d(t,{E:function(){return i},O:function(){return a}});var o=n(750670),r=n(495155);function i(e,t){return t.getRange().len<=1}function a(e){var t;if(!e)return{};if((0,o.isLineBox)(e.firstChild)&&(0,o.isLeafBox)(e.firstChild.firstChild)&&(t=o.CssUtil.computeStyles(e.firstChild.firstChild).cssProperties),(0,o.isTextBoxLite)(e.firstChild)&&(t=o.CssUtil.parseTextSpan(e.firstChild.property)),t){var n=t.fontStyle,i=t.textDecoration,a=t.fontSize,s=t.fontWeight;return"number"==typeof a&&(a="".concat((0,r.twipsToPt)(a),"pt")),"string"==typeof s&&(s="bold"===s?700:400),{fontSize:a,fontWeight:s,fontStyle:n,textDecoration:i}}return{}}},67761:function(e,t,n){n.d(t,{V:function(){return o},c:function(){return p}});var o,r=n(750670);n(495155),function(e){e.normal="normal",e.mention="mention",e.doc="doc"}(o||(o={}));var i=String.fromCharCode(r.PlaceholderCharCode.FieldBegin),a=String.fromCharCode(r.PlaceholderCharCode.FieldSeparate),s=String.fromCharCode(r.PlaceholderCharCode.FieldEnd);function l(e){return"".concat(i).concat(o.mention).concat(a).concat(e).concat(s)}var c,u={EnterAt:"输入“".concat(l("@"),"”，通知相关同学一起完成任务"),EnterPlus:"插入".concat((c=window.productName,"".concat(i).concat(o.doc).concat(a).concat(c).concat(s)),"，快速插入相关文档"),Ellipses1:"...",EnterProjectName:"输入项目名",EnterTask:"输入任务1",AtPerson:"".concat(l("@相关同学")," 或插入相关").concat(window.productName),DailyReport:"输入今日工作，并 ".concat(l("@相关同学")),EnterTodo:"输入待办，".concat(l("@相关同学")," 来通知对方"),DoneToday:"今日完成了...",InsertFile:"插入".concat(window.productName),AtOwner:"".concat(l("@日报所有者")),AtManager:"".concat(l("@负责人")),DateFormatMMdd:"XXXX年XX月XX日",Date0701:"07/01",Data0715:"07/15",Surving:"调研中"};function d(e){for(var t="".concat(i,"([^").concat(i,"]+)").concat(a,"([^").concat(s,"]+)").concat(s),n=[],r=new RegExp(t,"g").exec(e),l=e;r;)0!==r.index&&n.push({text:l.slice(0,r.index),type:o.normal}),n.push({type:r[1],text:r[2]}),l=l.slice(r.index+r[0].length),r=new RegExp(t,"g").exec(l);return l&&n.push({text:l,type:o.normal}),n}function p(e){return d(function(e){return Object.keys(u).includes(e)?u[e]:e}(e))}},325236:function(e,t,n){n.d(t,{R:function(){return c}});var o=n(839461),r=n(87363),i=n.n(r),a=n(750670),s=n(495155),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),Object.defineProperty(t.prototype,"listInfo",{get:function(){var e=this.props.layoutBox.lineBox;if(e){var t=e.parentBox;if(t)return t.property}},enumerable:!1,configurable:!0}),t.prototype.getRenderMetric=function(){var e=this.props.layoutBox.edge,t=(0,s.twipsToPx)(this.props.layoutBox.rect.width),n=(0,s.twipsToPx)(e.padding.right);return e.recycle(),{markWidth:t,width:t+n}},t}(n(62197).w);function c(e){return function(t,n){return t instanceof a.ListLineBox&&t.listMark?i().createElement(l,{key:n,layoutBox:t.listMark,bridge:e}):null}}},62197:function(e,t,n){n.d(t,{w:function(){return u}});var o=n(839461),r=n(87363),i=n.n(r),a=n(750670),s=n(158774),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ref=i().createRef(),t.onNativeTouchSelect=function(e){e.stopPropagation(),e.preventDefault(),t.props.onSelect(t)},t._onMouseSelect=function(e){e.stopPropagation(),e.preventDefault(),0===e.button&&t.props.onSelect(t)},t}return(0,o.__extends)(t,e),t.prototype.render=function(){return i().createElement("div",{ref:this.ref,className:s.Z["list-overlay"],style:(0,o.__assign)({width:this.props.width},this.props.textStyle),onMouseDown:this._onMouseSelect},this.props.text||"")},t.prototype.componentDidMount=function(){var e;null===(e=this.ref.current)||void 0===e||e.addEventListener("touchstart",this.onNativeTouchSelect)},t.prototype.componentWillUnmount=function(){var e;null===(e=this.ref.current)||void 0===e||e.removeEventListener("touchstart",this.onNativeTouchSelect)},t}(i().Component),c=function(e){function t(t){var n=e.call(this,t)||this;return n._onCancel=function(){n.props.bridge.instance.sendAction(n.props.bridge.key,{type:"select_cancel",data:null})},n.state={isListSelected:!1,isSelected:!1},n}return(0,o.__extends)(t,e),t.prototype.componentDidMount=function(){this.update(this.props.listId,this.props.listLevel,this.props.order)},t.prototype.shouldComponentUpdate=function(e,t){return this.update(e.listId,e.listLevel,e.order,this.props.listId,this.props.listLevel),this.state.isSelected!==t.isSelected||this.state.isListSelected!==t.isListSelected||this.props.markWidth!==e.markWidth},t.prototype.componentWillUnmount=function(){this.update("",-1,-1,this.props.listId,this.props.listLevel)},t.prototype.render=function(){var e=this.props.enableExtendOverlay?{}:{minWidth:this.props.width,width:"auto"},t=i().createElement("div",{className:this.state.isListSelected?s.Z["list-overlay-list-selected"]:s.Z["list-overlay-layer"],style:e},i().createElement("div",{ref:this.ref,className:this.state.isSelected?s.Z["list-overlay-selected"]:"".concat(s.Z["list-overlay-layer"]),style:(0,o.__assign)({width:this.props.markWidth},this.props.textStyle),onMouseDown:this._onMouseSelect},this.props.text||""));return this.props.enableExtendOverlay?i().createElement("div",{className:s.Z["list-overlay"],style:{width:2*this.props.width},onMouseDown:this._onCancel,onTouchStart:this._onCancel},t):t},t.prototype.update=function(e,t,n,o,r){void 0===o&&(o=""),void 0===r&&(r=-1),e===o&&t===r||this.props.bridge.instance.sendAction(this.props.bridge.key,{type:"dom_update",data:{prevListId:o,prevListLevel:r,listId:e,listLevel:t,listOrder:n,ref:this}},!0,!0)},t}(l),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderTextInOverlay=!1,t.enableExtendOverlay=!0,t}return(0,o.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.listInfo;if(t){var n=(0,o.__assign)({},a.CssUtil.cssPropsToStyle(a.CssUtil.computeStyles(t.listMarkerSpanProp).cssProperties));n.fontFamily&&t.listMarkerSpanProp&&!t.listMarkerSpanProp.fontFamily&&(n.fontFamily=void 0);var r=this.getRenderMetric(),u=r.width,d=r.markWidth,p=r.wrapperStyles,f=r.className,h=null;return this.props.bridge&&(h=t.isTask?i().createElement(l,{width:u,onSelect:function(){return e.onSelect(t)},text:this.renderTextInOverlay?t.actualText:void 0,textStyle:this.renderTextInOverlay?n:void 0}):i().createElement(c,{width:u,listId:t.listId,listLevel:t.listLevel,order:t.order,markWidth:d,bridge:this.props.bridge,enableExtendOverlay:this.enableExtendOverlay,onSelect:function(n){return e.onSelect(t,n)},text:this.renderTextInOverlay?t.actualText:void 0,textStyle:this.renderTextInOverlay?n:void 0})),i().createElement("span",{className:f,style:p},h,this.renderTextInOverlay?null:i().createElement("span",{className:s.Z["list-marker-text"],style:(0,o.__assign)({width:u},n)},t.actualText))}return null},t.prototype.onSelect=function(e,t){this.props.bridge&&this.props.bridge.instance.sendAction(this.props.bridge.key,{type:"select",data:{list:e,overlay:t}})},t}(i().Component)},318352:function(e,t,n){n.d(t,{$:function(){return r}});var o=n(750670),r=function(e){var t={};return e&&e.firstChild instanceof o.ListLineBox&&e.firstChild.listMark&&e.property.numPr.numId.val&&e.property.taskPr.taskState===o.STTaskState.done&&(t={opacity:.3,textDecoration:"line-through",textDecorationColor:"black"}),t}}}]),"object"==typeof globalThis&&(globalThis.jsExecEndTimeStamp=Date.now(),globalThis.cachedPerformanceEntries||(globalThis.cachedPerformanceEntries=[]),globalThis.cachedPerformanceEntries.push({name:"jsExec: js/public-3974-ffb1f336.js",entryType:"jsExec",startTime:globalThis.jsExecStartTimeStamp,endTime:globalThis.jsExecEndTimeStamp}));
//# sourceMappingURL=public-3974-ffb1f336.js.map