"object"==typeof globalThis&&(globalThis.jsExecStartTimeStamp=Date.now()),(self.webpackChunkuni=self.webpackChunkuni||[]).push([[5949],{123033:function(e,t,n){n.r(t),n.d(t,{DependentServiceCombinder:function(){return ht},EventTarget:function(){return et},EventType:function(){return tt},ExtensionConfigManager:function(){return _t},ExtensionEvent:function(){return dt},ExtensionManager:function(){return Je},ExtensionService:function(){return mt},FCModule:function(){return Gt},IDependentServiceCombinder:function(){return pt},IExtensionConfigManager:function(){return vt},IExtensionEvent:function(){return lt},IExtensionManager:function(){return nt},IExtensionService:function(){return xt},LoadType:function(){return be},ScriptLoaderAdapter:function(){return At},createExtensionService:function(){return Nt},initInstantiationService:function(){return It},injectExtensionServiceToCollection:function(){return Zt},patchScriptLoader:function(){return Pt},registerExtensionService:function(){return Lt}}),n(832733),n(88813),n(22474);var r=n(70324),i=n(178940),o=(n(266123),n(661487),n(928347),n(755728),n(649858),n(320701),n(757970),n(836554),n(621256),n(765274)),a=n.n(o),s=n(338104),c=(n(860903),n(568287),n(184253)),u=n(948763),d=n(493626),l=n(592870),f=(n(715360),n(133157)),h=(n(397583),n(789978),n(680778)),p=n(478247),v=n(46288),m=n(546855),y=n(94471),g=(n(884689),n(959293),n(495789)),w=(n(810839),n(305986),n(360841),n(836484),n(349807),n(930501),n(897612),n(183495),n(478861),n(840431),n(558352)),E=(n(887853),n(750477),n(134850)),_=n(646066),x=(n(628227),n(698312),n(166178)),k=n(734460),C=n(960844),b=n(908576),D=n(882918),S=n(816473),M=n(266173),R=n(2080),O=n(446134),N=n(694335),L=n(725412),Z=n(27249),I=n(727353),T=n(35742),U=n(321900),A=n(89207),j=n(345807),P=n(276183),G=n(472691),B=n(924251),F=n(156869),V=n(535669),W=n(257121),q=n(958444),H=n(132292),K=n(44041),Y=n(887689),z=n(257387),Q=n(519228),X=n(995193),$=n(122495),J=n(593722),ee=n(798477),te=n(779722),ne=n(908958),re=n(988455),ie=n(684363),oe=n(104591),ae=n(609782),se=n(887533),ce=n(137317),ue=n(972925),de=n(352177),le=(n(7991),n(93827),n(766506),n(744907),n(626734),n(616832)),fe=n(545154),he=n.n(fe),pe=(n(333885),n(917484),n(233339),n(936319),n(133013));if(n(864102),"performance"in window||(window.performance={}),Date.now=Date.now||function(){return Date.now()},!("now"in window.performance)){var ve=Date.now();performance.timing&&performance.timing.navigationStart&&(ve=performance.timing.navigationStart),window.performance.now=function(){return Date.now()-ve}}function me(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.Z)(e);if(t){var i=(0,d.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.Z)(this,n)}}var ye=function(e){(0,c.Z)(n,e);var t=me(n);function n(e){(0,r.Z)(this,n);var i="(Extension Error) ".concat(e);return t.call(this,i)}return(0,i.Z)(n)}((0,l.Z)(Error)),ge="ark_extension_function_cost",we="ark_extension_function_error",Ee="ark_extension_load_cost",_e="ark_extension_load_fail",xe=function(){function e(){(0,r.Z)(this,e)}return(0,i.Z)(e,null,[{key:"loadCost",value:function(e){var t=new CustomEvent(Ee,{detail:e});window.dispatchEvent(t)}},{key:"functionCallCost",value:function(e){var t=new CustomEvent(ge,{detail:e});window.dispatchEvent(t)}},{key:"functionCallError",value:function(e){var t=new CustomEvent(we,{detail:e});window.dispatchEvent(t)}},{key:"loadFail",value:function(e){var t=new CustomEvent(_e,{detail:e});window.dispatchEvent(t)}}]),e}();function ke(e,t,n){return"object"!==(0,f.Z)(e)?e:new Proxy(e,{get:function(e,r){var i=e[r];return i instanceof Function?function(){for(var e=performance.now(),o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];var c=i.call.apply(i,[this].concat(a));return c instanceof Promise&&(c.finally((function(){var i=performance.now()-e;xe.functionCallCost({module:t,function:r,cost:i,url:n,start:e})})),c.catch((function(i){var o=performance.now()-e;xe.functionCallError({module:t,function:r,cost:o,url:n,error:i,start:e})}))),c}:i}})}var Ce,be,De,Se=(0,p.y)("IMetadataLoader"),Me=function(){function e(t){this.element=t,this.next=e.Undefined,this.prev=e.Undefined}return e.Undefined=new e(void 0),e}(),Re=function(){function e(){this.first=Me.Undefined,this.last=Me.Undefined,this.mSize=0}return Object.defineProperty(e.prototype,"size",{get:function(){return this.mSize},enumerable:!1,configurable:!0}),e.prototype.isEmpty=function(){return this.first===Me.Undefined},e.prototype.clear=function(){this.first=Me.Undefined,this.last=Me.Undefined,this.mSize=0},e.prototype.unshift=function(e){return this.insert(e,!1)},e.prototype.push=function(e){return this.insert(e,!0)},e.prototype.shift=function(){if(this.first!==Me.Undefined){var e=this.first.element;return this.remove(this.first),e}},e.prototype.pop=function(){if(this.last!==Me.Undefined){var e=this.last.element;return this.remove(this.last),e}},e.prototype[Symbol.iterator]=function(){var e;return(0,s.__generator)(this,(function(t){switch(t.label){case 0:e=this.first,t.label=1;case 1:return e===Me.Undefined?[3,3]:[4,e.element];case 2:return t.sent(),e=e.next,[3,1];case 3:return[2]}}))},e.prototype.insert=function(e,t){var n=this,r=new Me(e);if(this.first===Me.Undefined)this.first=r,this.last=r;else if(t){var i=this.last;this.last=r,r.prev=i,i.next=r}else{var o=this.first;this.first=r,r.next=o,o.prev=r}this.mSize+=1;var a=!1;return function(){a||(a=!0,n.remove(r))}},e.prototype.remove=function(e){if(e.prev!==Me.Undefined&&e.next!==Me.Undefined){var t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===Me.Undefined&&e.next===Me.Undefined?(this.first=Me.Undefined,this.last=Me.Undefined):e.next===Me.Undefined?(this.last=this.last.prev,this.last.next=Me.Undefined):e.prev===Me.Undefined&&(this.first=this.first.next,this.first.prev=Me.Undefined);this.mSize-=1},e}(),Oe=function(){function e(e){this.disposed=!1,this.options=e}return Object.defineProperty(e.prototype,"event",{get:function(){var e=this;return this.mEvent||(this.mEvent=function(t,n,r){var i,o,a;e.listeners||(e.listeners=new Re);var s=e.listeners.isEmpty();s&&(null===(i=e.options)||void 0===i?void 0:i.onFirstListenerAdd)&&e.options.onFirstListenerAdd(e);var c=e.listeners.push(n?[t,n]:t);s&&(null===(o=e.options)||void 0===o?void 0:o.onFirstListenerDidAdd)&&e.options.onFirstListenerDidAdd(e),(null===(a=e.options)||void 0===a?void 0:a.onListenerDidAdd)&&e.options.onListenerDidAdd(e,t,n);var u={dispose:function(){var t;e.disposed||(c(),(null===(t=e.options)||void 0===t?void 0:t.onLastListenerRemove)&&(e.listeners&&!e.listeners.isEmpty()||e.options.onLastListenerRemove(e))),(0,g.markTracked)(u)},disposableId:"event"};return Array.isArray(r)&&r.push(u),(0,g.trackDisposable)(u),u}),this.mEvent},enumerable:!1,configurable:!0}),e.prototype.fire=function(e){var t,n;if(this.listeners){this.deliveryQueue||(this.deliveryQueue=new Re);try{for(var r=(0,s.__values)(this.listeners),i=r.next();!i.done;i=r.next()){var o=i.value;this.deliveryQueue.push([o,e])}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}for(;this.deliveryQueue.size>0;){var a=(0,s.__read)(this.deliveryQueue.shift(),2),c=(o=a[0],a[1]);try{"function"==typeof o?o.call(void 0,c):o[0].call(o[1],c)}catch(e){console.error(e)}}}},e.prototype.dispose=function(){this.listeners&&this.listeners.clear(),this.deliveryQueue&&this.deliveryQueue.clear(),this.disposed=!0},e}();!function(e){e.LOADING="LOADING",e.LOADED="LOADED",e.ERROR="ERROR"}(Ce||(Ce={})),function(e){e[e.IDLE=1]="IDLE",e[e.ON_DEMAND=3]="ON_DEMAND",e[e.EAGER=7]="EAGER"}(be||(be={})),function(e){e.WAITING="waiting",e.LOADING="loading",e.ERROR="error",e.SUCCESS="success"}(De||(De={}));var Ne=new(function(){function e(){(0,r.Z)(this,e),this.loadCache=new Map,this.retryCountMap=new Map}return(0,i.Z)(e,[{key:"loadScript",value:function(e,t,n,r){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function i(){var o;return a().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(o=this.loadCache.get(t)){i.next=7;break}return this.setRetryCount(e,n),i.next=5,this.defferedLoadModule(e,t,r);case 5:o=i.sent,this.loadCache.set(t,o);case 7:return i.abrupt("return",o);case 8:case"end":return i.stop()}}),i,this)})))}},{key:"setRetryCount",value:function(e,t){this.retryCountMap.set(e,t)}},{key:"defferedLoadModule",value:function(e,t,n){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function r(){var i=this;return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",new Promise((function(r,o){var a={entryName:e,scriptUrl:t,isCss:n,curRetryCount:1,succCallback:r,failedCallback:o};i.loadInBrowser(a)})));case 1:case"end":return r.stop()}}),r)})))}},{key:"loadInBrowser",value:function(e){var t=this,r=e.entryName,i=e.scriptUrl,o=e.isCss,a=e.curRetryCount,s=e.succCallback,c=e.failedCallback,u=performance.now(),d=(o?this.buildLinkTag:this.buildScriptTag)(i,(function(){var e=performance.now()-u;xe.loadCost({module:r,url:i,cost:e,start:u});var t=n.g[r];(null==t?void 0:t.default)?s(t.default):s(null!=t?t:{})}),(function(){var e=t.retryCountMap.get(r)||0,n=performance.now()-u;if(xe.loadFail({module:r,url:i,info:"retryCount:".concat(e),cost:n,start:u}),a>e)c("failed to load module [".concat(r,"] after [").concat(a-1,"] retry times."));else{d.parentElement&&document.head.removeChild(d);var l={entryName:r,scriptUrl:i,isCss:o,curRetryCount:a+1,succCallback:s,failedCallback:c};t.loadInBrowser(l)}}));document.head.appendChild(d)}},{key:"buildLinkTag",value:function(e,t,n){var r=document.createElement("link");return r.rel="stylesheet",r.href=e,r.onload=t,r.onerror=n,r}},{key:"buildScriptTag",value:function(e,t,n){var r=document.createElement("script");return r.type="text/javascript",r.src=e,r.async=!1,r.crossOrigin="anonymous",r.onload=t,r.onerror=n,r}}]),e}()),Le=function(){function e(t,n,i){var o,a;(0,r.Z)(this,e),this.hookEmitter=new Oe,this.loadState=De.WAITING,this.entryName=t,this.resourceUrl=n,this.options=i,this.retryTimes=null!==(o=null==i?void 0:i.retryTimes)&&void 0!==o?o:e.defaultRetryTimes,this.isCss=null!==(a=null==i?void 0:i.isCss)&&void 0!==a&&a,this.setupHooks()}return(0,i.Z)(e,[{key:"loadModule",value:function(){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function t(){var n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.loadState=De.LOADING,this.hookEmitter.fire(Ce.LOADING),t.prev=2,t.next=5,e.scriptLoader.loadScript(this.entryName,this.resourceUrl,this.retryTimes,this.isCss);case 5:return n=t.sent,this.loadState=De.SUCCESS,this.hookEmitter.fire(Ce.LOADED),t.abrupt("return",n);case 11:throw t.prev=11,t.t0=t.catch(2),this.loadState=De.ERROR,this.hookEmitter.fire(Ce.ERROR),new ye(t.t0.message);case 16:case"end":return t.stop()}}),t,this,[[2,11]])})))}},{key:"setupHooks",value:function(){var e=this;this.hookEmitter.event((function(t){var n,r,i=null===(r=null===(n=e.options)||void 0===n?void 0:n.hooks)||void 0===r?void 0:r[t];i&&i()}))}}]),e}();function Ze(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.Z)(e);if(t){var i=(0,d.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.Z)(this,n)}}Le.defaultRetryTimes=2,Le.scriptLoader=Ne;var Ie=function(e){(0,c.Z)(n,e);var t=Ze(n);function n(e,i,o){var a;return(0,r.Z)(this,n),(a=t.call(this,e,i,o)).deferredModule=a.loadModule(),a}return(0,i.Z)(n,[{key:"getModule",value:function(){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.deferredModule);case 1:case"end":return e.stop()}}),e,this)})))}}]),n}(Le),Te=function(){function e(t){(0,r.Z)(this,e),this.url=t}return(0,i.Z)(e,[{key:"bootstrap",value:function(){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loader=new Ie(this.url,this.url),e.next=3,this.loader.getModule();case 3:case"end":return e.stop()}}),e,this)})))}}]),e}(),Ue=function(){function e(t,n){(0,r.Z)(this,e),this.name=t,this.cdnPrefix=n}return(0,i.Z)(e,[{key:"bootstrap",value:function(){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function t(){var n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n="".concat(this.cdnPrefix.replace(/\/*$/,"/")).concat(this.name),e.loadRecords.has(n)){t.next=6;break}return this.loader=new Ie(this.name,n,{isCss:!0}),t.next=5,this.loader.getModule();case 5:e.loadRecords.add(n);case 6:case"end":return t.stop()}}),t,this)})))}}]),e}();Ue.loadRecords=new Set;var Ae=function(){function e(){var t=this;(0,r.Z)(this,e),this.isInnerOpen=!1,this.innerPromise=new Promise((function(e){t.completePromise=e}))}return(0,i.Z)(e,[{key:"isOpen",value:function(){return this.isInnerOpen}},{key:"open",value:function(){this.isInnerOpen=!0,this.completePromise(!0)}},{key:"wait",value:function(){return this.innerPromise}}]),e}();function je(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.Z)(e);if(t){var i=(0,d.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.Z)(this,n)}}var Pe=function(e){(0,c.Z)(n,e);var t=je(n);function n(e,i,o){var a;return(0,r.Z)(this,n),(a=t.call(this,e,i,o)).schedulerHandler=E.scheduler,a.scheduleCallbackTask=a.loadWhenIdle(),a}return(0,i.Z)(n,[{key:"getModule",value:function(){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.loadState!==De.WAITING&&this.loadState!==De.ERROR){e.next=4;break}return this.schedulerHandler.cancelTask(this.scheduleCallbackTask),this.deferredModule=this.loadModule(),e.abrupt("return",this.deferredModule);case 4:return e.abrupt("return",this.deferredModule);case 5:case"end":return e.stop()}}),e,this)})))}},{key:"loadWhenIdle",value:function(){var e=this;return this.schedulerHandler.scheduleTask((function(){e.deferredModule=e.loadModule()}))}}]),n}(Le);function Ge(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.Z)(e);if(t){var i=(0,d.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.Z)(this,n)}}var Be,Fe=function(e){(0,c.Z)(n,e);var t=Ge(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,i.Z)(n,[{key:"getModule",value:function(){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.deferredModule=this.loadModule(),e.abrupt("return",this.deferredModule);case 2:case"end":return e.stop()}}),e,this)})))}}]),n}(Le),Ve=(Be={},(0,w.Z)(Be,be.ON_DEMAND,Fe),(0,w.Z)(Be,be.IDLE,Pe),(0,w.Z)(Be,be.EAGER,Ie),Be),We=function(){function e(t,n,i,o){(0,r.Z)(this,e),this.name=t,this.url=n,this.surpportLanguages=i,this.language=o,this.loadTypeMap=new Map}return(0,i.Z)(e,[{key:"bootstrap",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=null!==(e=this.loadTypeMap.get(t))&&void 0!==e?e:be.IDLE;this.loader=this.createLoader(n)}},{key:"addLoadType",value:function(e,t){this.loadTypeMap.set(null!=e?e:"",t)}},{key:"getInstance",value:function(){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.loader||this.bootstrap(),this.loader.loadState!==De.ERROR){e.next=3;break}throw new ye("load extension [".concat(this.name,"] error."));case 3:return e.next=5,this.waitSingletonInstance();case 5:return e.abrupt("return",this.instance);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"waitSingletonInstance",value:function(){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.instance){e.next=2;break}return e.abrupt("return");case 2:if(!this.barrier){e.next=7;break}return e.next=5,this.barrier.wait();case 5:e.next=17;break;case 7:return this.barrier=new Ae,e.next=10,this.loader.getModule();case 10:if("function"==typeof(t=e.sent)){e.next=14;break}throw xe.loadFail({cost:-1,module:this.name,url:this.url,info:"constructor type: ".concat((0,f.Z)(t))}),new ye("something went wrong in ".concat(this.name,"'s constructor."));case 14:this.instance=ke(new t,this.name,this.url),this.instance.bootstraped=!1,this.barrier.open();case 17:case"end":return e.stop()}}),e,this)})))}},{key:"dealUrlForMultLanguage",value:function(e){var t,n=Array.isArray(e)?null==e?void 0:e[0]:e,r=null==n?void 0:n.lastIndexOf(".js");return-1===r||(null===(t=this.surpportLanguages)||void 0===t?void 0:t.includes(this.language))&&(n="".concat(n.slice(0,r),".").concat(this.language,".js")),n}},{key:"createLoader",value:function(e){return new(0,Ve[e])(this.name,this.dealUrlForMultLanguage(this.url))}}]),e}(),qe=function(){function e(){(0,r.Z)(this,e)}return(0,i.Z)(e,[{key:"bootstrap",value:function(){throw new ye("genesis dependency node should not be called")}}]),e}();qe.nodeName="GENESIS_DEPENDENCY_NODE";var He=_.L.getConfig('npm["@tencent/ark-extensions"]'),Ke=(null==He?void 0:He.React)||"//docs.idqqimg.com/tim/docs/components/libs/react-common-16.13.1-2bf240.js",Ye=(null==He?void 0:He.ReactDOM)||"//docs.idqqimg.com/tim/docs/components/libs/react-common-16.13.1-2bf240.js",ze=(null==He?void 0:He.DEFAULT_COMPONENT_CDN_PREFIX)||"//docs.gtimg.com/docs_components",Qe={React:Ke,ReactDOM:Ye},Xe=function(){function e(t){(0,r.Z)(this,e),this.name=t}return(0,i.Z)(e,[{key:"bootstrap",value:function(){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Qe[this.name]){e.next=3;break}throw new ye("common lib [".concat(this.name,"] is illegal because it's not in white list."));case 3:if(void 0!==window[this.name]){e.next=7;break}return this.loader=new Ie(this.name,t),e.next=7,this.loader.getModule();case 7:case"end":return e.stop()}}),e,this)})))}}]),e}(),$e=function(){function e(t,n){(0,r.Z)(this,e),this.name=t,this.cdnPrefix=n}return(0,i.Z)(e,[{key:"bootstrap",value:function(){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function t(){var n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n="".concat(this.cdnPrefix.replace(/\/*$/,"/")).concat(this.name),e.loadRecords.has(n)){t.next=6;break}return this.loader=new Ie(this.name,n),t.next=5,this.loader.getModule();case 5:e.loadRecords.add(n);case 6:case"end":return t.stop()}}),t,this)})))}}]),e}();$e.loadRecords=new Set;var Je=function(){function e(t){(0,r.Z)(this,e),this.metadataLoader=t,this.createDepGraph()}return(0,i.Z)(e,[{key:"addExtensionConfig",value:function(e){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.metadataRecord){t.next=4;break}return t.next=3,this.metadataLoader.getMetadataRecord();case 3:this.metadataRecord=t.sent;case 4:this.language=this.metadataLoader.getLanguage(),this.addDepNodeByConfig(e);case 6:case"end":return t.stop()}}),t,this)})))}},{key:"addExtensionDescription",value:function(e){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function t(){var n,r,i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.metadataRecord){t.next=4;break}return t.next=3,this.metadataLoader.getMetadataRecord();case 3:this.metadataRecord=t.sent;case 4:return n=e.name,r=e.loadType,(i=this.addExtensionDependencyNode(n,r)).bootstrap(),t.abrupt("return",i);case 8:case"end":return t.stop()}}),t,this)})))}},{key:"getInstance",value:function(e){return(0,s.__awaiter)(this,arguments,void 0,(function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:qe.nodeName;return a().mark((function r(){var i,o,c,u,d,l,f,h,p,v,m,y;return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t.depGraph.directDependantsOf(e).includes(n)){r.next=4;break}throw xe.loadFail({module:e,url:"",cost:-1,info:"cannot find in metadata"}),new ye("Cannot get ".concat(e," extension in ").concat(n,", please add configuration !"));case 4:d=t.depGraph.getNodeData(e),l=t.depGraph.directDependenciesOf(e),r.prev=6,f=!0,h=(0,s.__asyncValues)(l);case 8:return r.next=10,h.next();case 10:if(p=r.sent,i=p.done){r.next=22;break}return u=p.value,f=!1,v=u,m=t.depGraph.getNodeData(v),r.next=19,m.bootstrap(e);case 19:f=!0,r.next=8;break;case 22:r.next=27;break;case 24:r.prev=24,r.t0=r.catch(6),o={error:r.t0};case 27:if(r.prev=27,r.prev=28,f||i||!(c=h.return)){r.next=32;break}return r.next=32,c.call(h);case 32:if(r.prev=32,!o){r.next=35;break}throw o.error;case 35:return r.finish(32);case 36:return r.finish(27);case 37:return r.next=39,d.getInstance();case 39:return y=r.sent,r.abrupt("return",y);case 41:case"end":return r.stop()}}),r,null,[[6,24,27,37],[28,,32,36]])}))()}))}},{key:"getDepGraph",value:function(){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.depGraph);case 1:case"end":return e.stop()}}),e,this)})))}},{key:"createDepGraph",value:function(){this.depGraph=new h.f;var e=new qe;this.depGraph.addNode(qe.nodeName,e)}},{key:"addDepNodeByConfig",value:function(e){var t=this;e.forEach((function(e){var n=e.name,r=e.loadType;try{var i=t.addExtensionDependencyNode(n,r);t.depGraph.addDependency(qe.nodeName,i.name)}catch(e){console.error(e)}}))}},{key:"addLibraryDependencyNode",value:function(e){var t=new Xe(e);this.depGraph.addNode(e,t)}},{key:"addModulesDependencyNode",value:function(e,t){var n=new $e(e,t);this.depGraph.addNode(e,n)}},{key:"addCSSDependencyNode",value:function(e,t){var n=new Ue(e,t);this.depGraph.addNode(e,n)}},{key:"addChunkDependencyNode",value:function(e){var t=new Te(e);this.depGraph.addNode(e,t)}},{key:"addExtensionDependencyNode",value:function(e,t,n){var r=this;if(this.depGraph.hasNode(e)){var i=this.depGraph.getNodeData(e);return i.addLoadType(n,t),i}var o=this.metadataRecord[e];if(!o)throw new ye("Cannot find ".concat(e," extension in metadata!"));var a=o.url,s=o.chunks,c=void 0===s?[]:s,u=o.dependencies,d=void 0===u?{}:u,l=o.surpportLanguages,f=void 0===l?[]:l,h=d.commonModules,p=void 0===h?[]:h,v=d.commonLibs,m=void 0===v?[]:v,y=d.extensions,g=void 0===y?[]:y,w=d.css,E=void 0===w?[]:w,_=new We(e,a,f,this.language);return _.addLoadType(n,t),this.depGraph.addNode(e,_),c.forEach((function(t){r.addChunkDependencyNode(t),r.depGraph.addDependency(e,t)})),m.forEach((function(t){r.addLibraryDependencyNode(t),r.depGraph.addDependency(e,t)})),p.forEach((function(t){r.addModulesDependencyNode(t,r.metadataLoader.COMPONENT_CDN_PREFIX),r.depGraph.addDependency(e,t)})),E.forEach((function(t){r.addCSSDependencyNode(t,r.metadataLoader.COMPONENT_CDN_PREFIX),r.depGraph.addDependency(e,t)})),g.forEach((function(t){var n;try{var i=null!==(n=be[t.loadType.toString()])&&void 0!==n?n:be.ON_DEMAND;r.addExtensionDependencyNode(t.name,i,e),r.depGraph.addDependency(e,t.name)}catch(e){console.error(e)}})),_}}]),e}();Je=(0,s.__decorate)([(0,s.__param)(0,Se),(0,s.__metadata)("design:paramtypes",[Object])],Je);var et,tt,nt=(0,p.y)("IExtensionManager");!function(e){e[e.WINDOW=0]="WINDOW",e[e.DOCUMENT=1]="DOCUMENT",e[e.DOCUMENT_BODY=2]="DOCUMENT_BODY"}(et||(et={})),function(e){e.RESIZE="resize",e.MOUSE_DOWN="mousedown",e.MOUSE_MOVE="mousemove",e.MOUSE_UP="mouseup",e.KEY_UP="keyup",e.KEY_DOWN="keydown",e.CLICK="click",e.TOUCH_START="touchstart",e.TOUCH_MOVE="touchmove",e.TOUCH_END="touchend",e.POP_STATE="popState",e.VISIBILITY_CHANGE="visibilitychange",e.ONLINE="online",e.OFFLINE="offline",e.MESSAGE="message",e.CUSTOM="custom"}(tt||(tt={}));var rt=function(){function e(){(0,r.Z)(this,e),this.eventListenerSet=new Set,this.customEventListenerMap=new Map}return(0,i.Z)(e,[{key:"listen",value:function(e){var t=e.type;switch(t){case tt.RESIZE:case tt.MOUSE_DOWN:case tt.MOUSE_MOVE:case tt.MOUSE_UP:case tt.KEY_UP:case tt.KEY_DOWN:case tt.CLICK:case tt.TOUCH_START:case tt.TOUCH_MOVE:case tt.TOUCH_END:case tt.POP_STATE:case tt.VISIBILITY_CHANGE:case tt.ONLINE:case tt.OFFLINE:case tt.MESSAGE:return this.bindEvent(e);case tt.CUSTOM:return this.bindCustomEvent(e);default:throw new ye("[".concat(t,"] event is not supported to use in extensions."))}}},{key:"listenCustomEvent",value:function(e){return this.bindCustomEvent(e),{name:e.name,fire:this.dispatchCustomEvent.bind(this,e.name)}}},{key:"dispatchCustomEvent",value:function(e,t){var n=new CustomEvent(e,{detail:t});this.node.dispatchEvent(n)}},{key:"remove",value:function(e){if(!this.eventListenerSet.has(e))throw new ye("unable to remove [".concat(e.type,"] event which is not in your namespace or not bound."));var t=e.name,n=e.type,r=e.fn,i=e.options;if(n===tt.CUSTOM)return this.node.removeEventListener(t,r,i),void this.customEventListenerMap.delete(t);this.node.removeEventListener(n,r,i),this.eventListenerSet.delete(e)}},{key:"removeAll",value:function(){var e=this;this.eventListenerSet.forEach((function(t){e.remove(t)})),this.customEventListenerMap.forEach((function(t){e.remove(t)}))}},{key:"bindEvent",value:function(e){if(this.eventListenerSet.has(e))throw new ye("duplicated [".concat(e.type,"] event."));var t=e.type,n=e.fn,r=e.options;this.node.addEventListener(t,n,r),this.eventListenerSet.add(e)}},{key:"bindCustomEvent",value:function(e){var t=e.name;if(this.customEventListenerMap.has(t))throw new ye("duplicated [".concat(t,"] event."));var n=t,r=e.fn,i=e.options;this.node.addEventListener(n,r,i),this.customEventListenerMap.set(t,e)}}]),e}();function it(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.Z)(e);if(t){var i=(0,d.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.Z)(this,n)}}var ot=function(e){(0,c.Z)(n,e);var t=it(n);function n(){var e;return(0,r.Z)(this,n),(e=t.apply(this,arguments)).node=document.body,e}return(0,i.Z)(n)}(rt);function at(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.Z)(e);if(t){var i=(0,d.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.Z)(this,n)}}var st=function(e){(0,c.Z)(n,e);var t=at(n);function n(){var e;return(0,r.Z)(this,n),(e=t.apply(this,arguments)).node=document,e}return(0,i.Z)(n)}(rt);function ct(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.Z)(e);if(t){var i=(0,d.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.Z)(this,n)}}var ut=function(e){(0,c.Z)(n,e);var t=ct(n);function n(){var e;return(0,r.Z)(this,n),(e=t.apply(this,arguments)).node=window,e}return(0,i.Z)(n)}(rt),dt=function(){function e(){(0,r.Z)(this,e),this.initEventManagerPool()}return(0,i.Z)(e,[{key:"addListener",value:function(e){var t=e.target;return this.eventManagerPool[t].listen(e)}},{key:"removeListener",value:function(e){var t=e.target;return this.eventManagerPool[t].remove(e)}},{key:"removeAllListener",value:function(){Object.values(this.eventManagerPool).forEach((function(e){e.removeAll()}))}},{key:"initEventManagerPool",value:function(){var e,t=new ut,n=new st,r=new ot;this.eventManagerPool=(e={},(0,w.Z)(e,et.WINDOW,t),(0,w.Z)(e,et.DOCUMENT,n),(0,w.Z)(e,et.DOCUMENT_BODY,r),e)}}]),e}(),lt=(0,p.y)("IExtensionEvent"),ft=(0,p.y)("IExtensionContainerService"),ht=function(){function e(t,n,i,o,a,s,c,u,d,l,f,h,p,v,m,y,g,w,E,_,x,k){(0,r.Z)(this,e),this.docMetaDomain=t,this.userInfoDomain=n,this.authDomain=i,this.fileDomain=o,this.likeDomain=a,this.folderDomain=s,this.templateDomain=c,this.accountDomain=u,this.loginDomain=d,this.notificationDomain=l,this.shareDomain=f,this.messageDomain=h,this.collaborateDomain=p,this.notifyScopeDomain=v,this.atMessageDomain=m,this.fileInfoDomain=y,this.connectionControllerService=g,this.accountApplication=w,this.enterpriseAccountApplication=E,this.docsManagementService=_,this.extensionEvent=x,this.extensionContainerService=k}return(0,i.Z)(e,[{key:"getExtensionService",value:function(e,t){return{getExtension:function(n){return e.safeGetExtension.call(e,n,t)},fireExtensionEvent:e.fireExtensionEvent.bind(e,t)}}},{key:"getDomainService",value:function(){return{docMetaDomain:this.docMetaDomain,userInfoDomain:this.userInfoDomain,authDomain:this.authDomain,fileDomain:this.fileDomain,likeDomain:this.likeDomain,folderDomain:this.folderDomain,templateDomain:this.templateDomain,accountDomain:this.accountDomain,loginDomain:this.loginDomain,notificationDomain:this.notificationDomain,shareDomain:this.shareDomain,messageDomain:this.messageDomain,collaborateDomain:this.collaborateDomain,notifyScopeDomain:this.notifyScopeDomain,atMessageDomain:this.atMessageDomain,fileInfoDomain:this.fileInfoDomain}}},{key:"getApplicationService",value:function(){return{accountApplication:this.accountApplication,enterpriseAccountApplication:this.enterpriseAccountApplication,connectionControllerService:this.connectionControllerService,docsManagementService:this.docsManagementService}}},{key:"getToolService",value:function(){return{networkRequest:ue.networkRequest,event:this.extensionEvent}}},{key:"getExtensionContainerService",value:function(e){return{createContainerIfUnspecified:this.extensionContainerService.createContainerIfUnspecified.bind(this.extensionContainerService,e),createSandboxContainerIfUnspecified:this.extensionContainerService.createSandboxContainerIfUnspecified.bind(this.extensionContainerService,e)}}}]),e}();ht=(0,s.__decorate)([(0,s.__param)(0,k.v),(0,s.__param)(1,C.m),(0,s.__param)(2,b.i),(0,s.__param)(3,D.G),(0,s.__param)(4,S.d),(0,s.__param)(5,M.r),(0,s.__param)(6,R.y),(0,s.__param)(7,O.b),(0,s.__param)(8,N.C),(0,s.__param)(9,L.Y),(0,s.__param)(10,Z.j),(0,s.__param)(11,I.x),(0,s.__param)(12,T.U),(0,s.__param)(13,U.Y),(0,s.__param)(14,A.B),(0,s.__param)(15,j.U),(0,s.__param)(16,x.jE),(0,s.__param)(17,x.aG),(0,s.__param)(18,x.Pf),(0,s.__param)(19,x.Mp),(0,s.__param)(20,lt),(0,s.__param)(21,ft),(0,s.__metadata)("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object])],ht);var pt=(0,p.y)("IDependentServiceCombinder"),vt=(0,p.y)("IExtensionConfigManager"),mt=function(){function e(t,n,i,o){(0,r.Z)(this,e),this.dependentServiceCombinder=t,this.extensionConfigManager=n,this.extensionManager=i,this.domainUpdater=o,this.extensionEventEmitter=new Oe}return(0,i.Z)(e,[{key:"updateDomainWithClientVars",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.domainUpdater.updateDomainWithClientVars(e,t)}},{key:"updateDomainWithRequests",value:function(e,t){this.domainUpdater.updateDomainWithRequests({docId:e,u:t})}},{key:"scanAndHandleExtensions",value:function(e){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.addExtensionConfig(e));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"addExtensionConfig",value:function(e){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.extensionConfigReadyBarrier){t.next=5;break}return t.next=3,this.extensionConfigReadyBarrier.wait();case 3:t.next=6;break;case 5:this.extensionConfigReadyBarrier=new Ae;case 6:return t.next=8,this.extensionConfigManager.addExtensionConfig(e);case 8:this.extensionConfigReadyBarrier.open();case 9:case"end":return t.stop()}}),t,this)})))}},{key:"addExtensionDescription",value:function(e){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.extensionConfigManager.addExtensionDescription(e);case 2:case"end":return t.stop()}}),t,this)})))}},{key:"subscribeExtensionEvent",value:function(e){this.extensionEventEmitter.event((function(t){e(t.extensionName,t.type)}))}},{key:"fireExtensionEvent",value:function(e,t){var n={extensionName:e,type:t};this.extensionEventEmitter.fire(n)}},{key:"getExtension",value:function(e){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.safeGetExtension(e));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"dispose",value:function(){throw new Error("Method not implemented.")}},{key:"disposeAllExtensions",value:function(){throw new Error("Method not implemented.")}},{key:"getExtensionConfig",value:function(){return this.extensionConfigManager.getExtensionConfig()}},{key:"getExtensionDepGraph",value:function(){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.extensionManager.getDepGraph());case 1:case"end":return e.stop()}}),e,this)})))}},{key:"safeGetExtension",value:function(e,t){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function n(){var r;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.extensionConfigReadyBarrier.wait();case 2:return n.next=4,this.extensionManager.getInstance(e,t);case 4:return r=n.sent,this.bootstrapExtension(e,r),n.abrupt("return",r);case 7:case"end":return n.stop()}}),n,this)})))}},{key:"bootstrapExtension",value:function(e,t){if(!t.bootstraped){var n=this.dependentServiceCombinder.getExtensionService(this,e),r=this.dependentServiceCombinder.getDomainService(),i=this.dependentServiceCombinder.getApplicationService(),o=this.dependentServiceCombinder.getToolService(),a=this.dependentServiceCombinder.getExtensionContainerService(e),s=this.extensionConfigManager.findExtensionDescription(e),c=null==s?void 0:s.containerId,u=this.getContainer(c);t.bootstrap({extensionService:n,domainService:r,toolService:o,applicationService:i,containerService:a,extensionName:e,container:u}),t.bootstraped=!0}}},{key:"getContainer",value:function(e){var t=null;return e&&(t=document.getElementById(e)),t}}]),e}();mt=(0,s.__decorate)([(0,s.__param)(0,pt),(0,s.__param)(1,vt),(0,s.__param)(2,nt),(0,s.__param)(3,P.e),(0,s.__metadata)("design:paramtypes",[Object,Object,Object,Object])],mt);var yt="ark_extension",gt="__ark_extends_init_error_handler__";function wt(){window[gt]||(window[gt]=!0,window.addEventListener(_e,(function(e){(0,le.tdwSingle)({opername:yt,module:e.detail.module,action:"load_fail",ver7:e.detail.url,ver8:e.detail.cost,ver9:e.detail.start,ver10:e.detail.info})})),window.addEventListener(Ee,(function(e){(0,le.tdw)({opername:yt,module:e.detail.module,action:"cost",ver7:e.detail.url,ver8:e.detail.cost,ver9:e.detail.start})})),window.addEventListener(we,(function(e){var t,n=e.detail.error instanceof Error?e.detail.error.stack:null===(t=e.detail.error)||void 0===t?void 0:t.toString();(0,le.tdwSingle)({opername:yt,module:e.detail.module,action:"call_error",ver7:e.detail.url,ver8:e.detail.cost,ver9:e.detail.function,ver10:n,ver11:e.detail.start})})),window.addEventListener(ge,(function(e){e.detail.cost<1e3||(0,le.tdw)({opername:yt,module:e.detail.module,action:"call",ver7:e.detail.url,ver8:e.detail.cost,ver9:e.detail.function,ver11:e.detail.start})})),window.addEventListener("error",(function(e){var t;if((null==e?void 0:e.error)instanceof Error){var n=he().parse(e.error),r=[];if(n.forEach((function(e){if(e.fileName){var t=function(e){var t=new RegExp(/(docs-component-.*)\..*\.js$/).exec(e);if(null==t?void 0:t[1])return t[1]}(e.fileName);t&&r.push(t)}})),0!==r.length){var i=r[r.length-1];(0,le.tdwSingle)({opername:yt,action:"js_error",module:i,ver7:e.message,ver8:null===(t=e.error)||void 0===t?void 0:t.stack,ver9:r.join("->")})}}})))}var Et=function(){function e(){(0,r.Z)(this,e),this.containerCollectionId="__unspesified_extension_container_collection__"}return(0,i.Z)(e,[{key:"createContainerIfUnspecified",value:function(e){this.unspecifiedContainerCollection=this.getUnspecifiedContainerCollection();var t=this.unspecifiedContainerCollection.querySelector("#".concat(e));return t||((t=document.createElement("div")).setAttribute("id",e),this.unspecifiedContainerCollection.appendChild(t),t)}},{key:"createSandboxContainerIfUnspecified",value:function(){throw new Error("Method not implemented.")}},{key:"getUnspecifiedContainerCollection",value:function(){var e=document.getElementById(this.containerCollectionId);return e||((e=document.createElement("div")).setAttribute("id",this.containerCollectionId),document.body.appendChild(e)),e}}]),e}(),_t=function(){function e(t){(0,r.Z)(this,e),this.extensionManager=t,this.extensionConfig=[]}return(0,i.Z)(e,[{key:"addExtensionConfig",value:function(e){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.extensionConfig=this.extensionConfig.concat(e),t.next=3,this.extensionManager.addExtensionConfig(e);case 3:case"end":return t.stop()}}),t,this)})))}},{key:"addExtensionDescription",value:function(e){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.assertNoDuplicatedDescription(e),this.extensionConfig.push(e),t.next=4,this.extensionManager.addExtensionDescription(e);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"getExtensionConfig",value:function(){return this.extensionConfig}},{key:"findExtensionDescription",value:function(e){return this.extensionConfig.find((function(t){return t.name===e}))}},{key:"iterateExtensionConfig",value:function(e){this.extensionConfig.forEach(e)}},{key:"assertNoDuplicatedDescription",value:function(e){if(this.extensionConfig.find((function(t){return t.name===e.name})))throw new ye("duplicated extension config of ".concat(e.name,"."))}}]),e}();_t=(0,s.__decorate)([(0,s.__param)(0,nt),(0,s.__metadata)("design:paramtypes",[Object])],_t);var xt=(0,p.y)("IExtensionService"),kt=Symbol.for("__META_REQUEST_CACHE__"),Ct=window.location,bt=Ct.protocol,Dt=Ct.host,St="".concat(bt,"//").concat(Dt,"/components/docs/metadata{{specifiedVersionKey}}.json?t={{time}}"),Mt=function(){function e(t){var n,i;(0,r.Z)(this,e),this.METADATA_URL=St,this.COMPONENT_CDN_PREFIX=null!==(n=t.componentCdnPrefix)&&void 0!==n?n:ze,this.specifiedVersionKey=t.specifiedVersion?".v".concat(t.specifiedVersion):"",this.language=null!==(i=t.language)&&void 0!==i?i:""}return(0,i.Z)(e,[{key:"metadataRequestCacheMap",get:function(){return void 0===globalThis[kt]&&(globalThis[kt]=new Map),globalThis[kt]}},{key:"getMetadataRecord",value:function(){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function e(){var t,n,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.metadataRequestCacheMap.has(this.specifiedVersionKey),n=t?this.metadataRequestCacheMap.get(this.specifiedVersionKey):this.requestMetadataRecord(),t||this.metadataRequestCacheMap.set(this.specifiedVersionKey,n),e.next=5,n;case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e,this)})))}},{key:"getLanguage",value:function(){return this.language}},{key:"requestMetadataRecord",value:function(){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function e(){var t,n,r,i,o,s,c,u,d=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.METADATA_URL.replace("{{specifiedVersionKey}}",this.specifiedVersionKey).replace("{{time}}",Date.now().toString()),n=performance.now(),e.next=4,ue.networkRequest.get(t);case 4:if(r=e.sent,i=performance.now(),o=i-n,xe.loadCost({module:"metadata",url:t,cost:o,start:n}),r.data){e.next=11;break}throw xe.loadFail({module:"metadata",url:t,info:r.status.toString(),cost:o,start:n}),new ye("request metadata error, error code: [".concat(r.status,"]."));case 11:return s=r.data,c=void 0===s?[]:s,u=Object.values(c).reduce((function(e,t){return Object.assign(Object.assign({},e),(0,w.Z)({},t.name,Object.assign(Object.assign({},t),{url:d.getMetadataUrl(t)})))}),{}),e.abrupt("return",u);case 14:case"end":return e.stop()}}),e,this)})))}},{key:"getMetadataUrl",value:function(e){var t=this;return Array.isArray(e.url)?e.url.map((function(e){return"".concat(t.COMPONENT_CDN_PREFIX,"/").concat(e)})):["".concat(this.COMPONENT_CDN_PREFIX,"/").concat(e.url)]}}]),e}(),Rt="__ARK_EXTENSION_INSTANTIATION_SERVICE__",Ot="__ARK_EXTENSION_SERVICE__";function Nt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=globalThis[Ot];if(t)return t;var n=new v.o,r=new m.y,i={serviceRegister:n,serviceCollection:r};Lt(i,e),Zt(i);var o=It(r);globalThis[Rt]=o;var a=globalThis[Ot]=function(e){return e.invokeFunction((function(e){return e.get(xt)}))}(o);return wt(),a}function Lt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.serviceRegister;r.register(xt,mt),r.register(vt,_t),r.register(Se,Mt,[null!==(t=n.metadataLoaderOptions||n.metadataLoader)&&void 0!==t?t:{}]),r.register(nt,Je)}(e,t),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.serviceRegister,r=t.isEnterprise;n.register(P.e,G.d),n.register(B._,F.L),n.register(b.i,V.n),n.register(L.Y,W.e),n.register(Z.j,q.d),n.register(T.U,H.u),n.register(O.b,K.D),n.register(Y.b,z.f),n.register(k.v,r?Q.I:X.L),n.register(C.m,$.$),n.register(D.G,J.v),n.register(j.U,ee.h),n.register(M.r,te.i),n.register(R.y,ne.Y),n.register(N.C,re.g),n.register(I.x,ie.i),n.register(U.Y,oe.l),n.register(A.B,ae.M),n.register(S.d,r?se.G:ce.W),n.register(x.jE,x.y5),n.register(x.aG,x.eU),n.register(x.Pf,x.TU),n.register(x.Mp,x.jR),n.register(pt,ht),n.register(lt,dt),n.register(ft,Et)}(e,t)}function Zt(e){var t=e.serviceRegister,n=e.serviceCollection;t.getServiceDescriptors().forEach((function(e){var t=(0,de.Z)(e,2),r=t[0],i=t[1];n.set(r,i)}))}function It(e){return new y.F(e)}var Tt=function(){function e(t){return(0,r.Z)(this,e),this.scriptLoader=t||window.ScriptLoader||window.SLR,new Proxy(this,{set:function(e,t,n){return void 0!==e.scriptLoader[t]?(e.scriptLoader[t]=n,!0):(e[t]=n,!0)},get:function(e,t){return e[t]?e[t]:e.scriptLoader[t]?"function"==typeof e.scriptLoader[t]?e.scriptLoader[t].bind(e.scriptLoader):e.scriptLoader[t]:void 0}})}return(0,i.Z)(e,[{key:"init",value:function(e,t,n,r){this.scriptLoader.init(e,t,n,r)}},{key:"load",value:function(e,t,n,r){this.scriptLoader.load(e,t,n,r)}},{key:"dispatch",value:function(e,t){this.scriptLoader.dispatch(e,t)}},{key:"listen",value:function(e,t){this.scriptLoader.listen(e,t)}}]),e}();function Ut(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.Z)(e);if(t){var i=(0,d.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.Z)(this,n)}}var At=function(e){(0,c.Z)(n,e);var t=Ut(n);function n(e){var i;return(0,r.Z)(this,n),(i=t.call(this,e)).__adpater__=!0,i.__version__="3.17.2",i.isReady=!1,i.onReadyEmitter=new Oe,i.fcModuleMap=new Map,i.extensionService=Nt(),i.domainUpdater=i.extensionService.domainUpdater,i.extensionService.getExtensionConfig()||i.extensionService.scanAndHandleExtensions([]),i.onReady=i.onReadyEmitter.event,i}return(0,i.Z)(n,[{key:"ready",value:function(){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.updateDomainWithClientVars();case 2:return setTimeout((function(){t.isReady=!0,t.onReadyEmitter.fire()}),0),e.abrupt("return",this);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"registerExternalModule",value:function(e,t){this.fcModuleMap.has(e)||(t.bootstrap(this.extensionService,this),this.fcModuleMap.set(e,t))}},{key:"loadExternalModule",value:function(e,t,n){var r=this.fcModuleMap.get(e);void 0!==r?t(r):null==n||n()}},{key:"load",value:function(e,t,r,i){var o=this;this.isReady?this.fcModuleMap.has(e)?this.loadExternalModule(e,t,r):(0,pe.Z)((0,d.Z)(n.prototype),"load",this).call(this,e,t,r,i):this.onReady((function(){o.load(e,t,r,i)}))}},{key:"updateDomainWithClientVars",value:function(){var e=this;return new Promise((function(t,n){setTimeout((function r(){try{if(!0===window.__DISALBE_AUTO_UPDATE_CLIENT_VARS__)return e.listen("updateDomainWithClientVars",(function(){e.domainUpdater.updateDomainWithClientVars(window.clientVars,!1)})),void t();if(void 0!==window.clientVars)return window.clientVars.padId&&e.domainUpdater.updateDomainWithClientVars(window.clientVars,!1),void t();setTimeout(r,0)}catch(e){n(e)}}),0)}))}}],[{key:"getInstance",value:function(e){return void 0===n.instance&&(n.instance=new n(e)),n.instance}}]),n}(Tt),jt=function(){return window.ScriptLoader||window.SLR};function Pt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:jt();if(void 0===e)throw new Error("window.ScriptLoader OR window.SLR is undefined, use `patchScriptLoader(scriptLoader)` to patch");if(e instanceof At||e.__adpater__)return e;var t=At.getInstance(e);return window.ScriptLoader=t,window.SLR=t,t}var Gt=function(){function e(){(0,r.Z)(this,e)}return(0,i.Z)(e,[{key:"bootstrap",value:function(e,t){this.extensionService=e,this.scriptLoader=t}},{key:"load",value:function(e){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.extension){t.next=2;break}return t.abrupt("return",this.extension);case 2:return t.next=4,this.extensionService.addExtensionDescription({name:this.name,branch:this.branch,containerId:e.id,loadType:be.EAGER});case 4:return t.next=6,this.extensionService.getExtension(this.name);case 6:return this.extension=t.sent,t.abrupt("return",this.extension);case 8:case"end":return t.stop()}}),t,this)})))}}]),e}()},785772:function(e,t,n){n.d(t,{L2:function(){return Ce},Zu:function(){return Ot}}),n(832733),n(88813),n(22474);var r=n(70324),i=n(178940),o=(n(266123),n(661487),n(928347),n(755728),n(649858),n(320701),n(757970),n(836554),n(621256),n(765274)),a=n.n(o),s=n(338104),c=(n(860903),n(568287),n(184253)),u=n(948763),d=n(493626),l=n(592870),f=(n(715360),n(133157)),h=(n(397583),n(789978),n(680778)),p=n(478247),v=n(46288),m=n(546855),y=n(94471),g=(n(884689),n(959293),n(495789)),w=(n(810839),n(305986),n(360841),n(836484),n(349807),n(930501),n(897612),n(183495),n(478861),n(840431),n(558352)),E=(n(887853),n(750477),n(134850)),_=n(646066),x=(n(628227),n(698312),n(166178)),k=n(734460),C=n(960844),b=n(908576),D=n(882918),S=n(816473),M=n(266173),R=n(2080),O=n(446134),N=n(694335),L=n(725412),Z=n(27249),I=n(727353),T=n(35742),U=n(321900),A=n(89207),j=n(345807),P=n(276183),G=n(472691),B=n(924251),F=n(156869),V=n(535669),W=n(257121),q=n(958444),H=n(132292),K=n(44041),Y=n(887689),z=n(257387),Q=n(519228),X=n(995193),$=n(122495),J=n(593722),ee=n(798477),te=n(779722),ne=n(908958),re=n(988455),ie=n(684363),oe=n(104591),ae=n(609782),se=n(887533),ce=n(137317),ue=n(972925),de=n(352177),le=(n(7991),n(93827),n(766506),n(744907),n(626734),n(617817)),fe=n(545154),he=n.n(fe);if(n(333885),n(917484),n(233339),n(936319),n(864102),"performance"in window||(window.performance={}),Date.now=Date.now||function(){return Date.now()},!("now"in window.performance)){var pe=Date.now();performance.timing&&performance.timing.navigationStart&&(pe=performance.timing.navigationStart),window.performance.now=function(){return Date.now()-pe}}function ve(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.Z)(e);if(t){var i=(0,d.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.Z)(this,n)}}var me=function(e){(0,c.Z)(n,e);var t=ve(n);function n(e){(0,r.Z)(this,n);var i="(Extension Error) ".concat(e);return t.call(this,i)}return(0,i.Z)(n)}((0,l.Z)(Error)),ye="ark_extension_function_cost",ge="ark_extension_function_error",we="ark_extension_load_cost",Ee="ark_extension_load_fail",_e=function(){function e(){(0,r.Z)(this,e)}return(0,i.Z)(e,null,[{key:"loadCost",value:function(e){var t=new CustomEvent(we,{detail:e});window.dispatchEvent(t)}},{key:"functionCallCost",value:function(e){var t=new CustomEvent(ye,{detail:e});window.dispatchEvent(t)}},{key:"functionCallError",value:function(e){var t=new CustomEvent(ge,{detail:e});window.dispatchEvent(t)}},{key:"loadFail",value:function(e){var t=new CustomEvent(Ee,{detail:e});window.dispatchEvent(t)}}]),e}();function xe(e,t,n){return"object"!==(0,f.Z)(e)?e:new Proxy(e,{get:function(e,r){var i=e[r];return i instanceof Function?function(){for(var e=performance.now(),o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];var c=i.call.apply(i,[this].concat(a));return c instanceof Promise&&(c.finally((function(){var i=performance.now()-e;_e.functionCallCost({module:t,function:r,cost:i,url:n,start:e})})),c.catch((function(i){var o=performance.now()-e;_e.functionCallError({module:t,function:r,cost:o,url:n,error:i,start:e})}))),c}:i}})}var ke,Ce,be,De=(0,p.y)("IMetadataLoader"),Se=function(){function e(t){this.element=t,this.next=e.Undefined,this.prev=e.Undefined}return e.Undefined=new e(void 0),e}(),Me=function(){function e(){this.first=Se.Undefined,this.last=Se.Undefined,this.mSize=0}return Object.defineProperty(e.prototype,"size",{get:function(){return this.mSize},enumerable:!1,configurable:!0}),e.prototype.isEmpty=function(){return this.first===Se.Undefined},e.prototype.clear=function(){this.first=Se.Undefined,this.last=Se.Undefined,this.mSize=0},e.prototype.unshift=function(e){return this.insert(e,!1)},e.prototype.push=function(e){return this.insert(e,!0)},e.prototype.shift=function(){if(this.first!==Se.Undefined){var e=this.first.element;return this.remove(this.first),e}},e.prototype.pop=function(){if(this.last!==Se.Undefined){var e=this.last.element;return this.remove(this.last),e}},e.prototype[Symbol.iterator]=function(){var e;return(0,s.__generator)(this,(function(t){switch(t.label){case 0:e=this.first,t.label=1;case 1:return e===Se.Undefined?[3,3]:[4,e.element];case 2:return t.sent(),e=e.next,[3,1];case 3:return[2]}}))},e.prototype.insert=function(e,t){var n=this,r=new Se(e);if(this.first===Se.Undefined)this.first=r,this.last=r;else if(t){var i=this.last;this.last=r,r.prev=i,i.next=r}else{var o=this.first;this.first=r,r.next=o,o.prev=r}this.mSize+=1;var a=!1;return function(){a||(a=!0,n.remove(r))}},e.prototype.remove=function(e){if(e.prev!==Se.Undefined&&e.next!==Se.Undefined){var t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===Se.Undefined&&e.next===Se.Undefined?(this.first=Se.Undefined,this.last=Se.Undefined):e.next===Se.Undefined?(this.last=this.last.prev,this.last.next=Se.Undefined):e.prev===Se.Undefined&&(this.first=this.first.next,this.first.prev=Se.Undefined);this.mSize-=1},e}(),Re=function(){function e(e){this.disposed=!1,this.options=e}return Object.defineProperty(e.prototype,"event",{get:function(){var e=this;return this.mEvent||(this.mEvent=function(t,n,r){var i,o,a;e.listeners||(e.listeners=new Me);var s=e.listeners.isEmpty();s&&(null===(i=e.options)||void 0===i?void 0:i.onFirstListenerAdd)&&e.options.onFirstListenerAdd(e);var c=e.listeners.push(n?[t,n]:t);s&&(null===(o=e.options)||void 0===o?void 0:o.onFirstListenerDidAdd)&&e.options.onFirstListenerDidAdd(e),(null===(a=e.options)||void 0===a?void 0:a.onListenerDidAdd)&&e.options.onListenerDidAdd(e,t,n);var u={dispose:function(){var t;e.disposed||(c(),(null===(t=e.options)||void 0===t?void 0:t.onLastListenerRemove)&&(e.listeners&&!e.listeners.isEmpty()||e.options.onLastListenerRemove(e))),(0,g.markTracked)(u)},disposableId:"event"};return Array.isArray(r)&&r.push(u),(0,g.trackDisposable)(u),u}),this.mEvent},enumerable:!1,configurable:!0}),e.prototype.fire=function(e){var t,n;if(this.listeners){this.deliveryQueue||(this.deliveryQueue=new Me);try{for(var r=(0,s.__values)(this.listeners),i=r.next();!i.done;i=r.next()){var o=i.value;this.deliveryQueue.push([o,e])}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}for(;this.deliveryQueue.size>0;){var a=(0,s.__read)(this.deliveryQueue.shift(),2),c=(o=a[0],a[1]);try{"function"==typeof o?o.call(void 0,c):o[0].call(o[1],c)}catch(e){console.error(e)}}}},e.prototype.dispose=function(){this.listeners&&this.listeners.clear(),this.deliveryQueue&&this.deliveryQueue.clear(),this.disposed=!0},e}();!function(e){e.LOADING="LOADING",e.LOADED="LOADED",e.ERROR="ERROR"}(ke||(ke={})),function(e){e[e.IDLE=1]="IDLE",e[e.ON_DEMAND=3]="ON_DEMAND",e[e.EAGER=7]="EAGER"}(Ce||(Ce={})),function(e){e.WAITING="waiting",e.LOADING="loading",e.ERROR="error",e.SUCCESS="success"}(be||(be={}));var Oe=new(function(){function e(){(0,r.Z)(this,e),this.loadCache=new Map,this.retryCountMap=new Map}return(0,i.Z)(e,[{key:"loadScript",value:function(e,t,n,r){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function i(){var o;return a().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(o=this.loadCache.get(t)){i.next=7;break}return this.setRetryCount(e,n),i.next=5,this.defferedLoadModule(e,t,r);case 5:o=i.sent,this.loadCache.set(t,o);case 7:return i.abrupt("return",o);case 8:case"end":return i.stop()}}),i,this)})))}},{key:"setRetryCount",value:function(e,t){this.retryCountMap.set(e,t)}},{key:"defferedLoadModule",value:function(e,t,n){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function r(){var i=this;return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",new Promise((function(r,o){var a={entryName:e,scriptUrl:t,isCss:n,curRetryCount:1,succCallback:r,failedCallback:o};i.loadInBrowser(a)})));case 1:case"end":return r.stop()}}),r)})))}},{key:"loadInBrowser",value:function(e){var t=this,r=e.entryName,i=e.scriptUrl,o=e.isCss,a=e.curRetryCount,s=e.succCallback,c=e.failedCallback,u=performance.now(),d=(o?this.buildLinkTag:this.buildScriptTag)(i,(function(){var e=performance.now()-u;_e.loadCost({module:r,url:i,cost:e,start:u});var t=n.g[r];(null==t?void 0:t.default)?s(t.default):s(null!=t?t:{})}),(function(){var e=t.retryCountMap.get(r)||0,n=performance.now()-u;if(_e.loadFail({module:r,url:i,info:"retryCount:".concat(e),cost:n,start:u}),a>e)c("failed to load module [".concat(r,"] after [").concat(a-1,"] retry times."));else{d.parentElement&&document.head.removeChild(d);var l={entryName:r,scriptUrl:i,isCss:o,curRetryCount:a+1,succCallback:s,failedCallback:c};t.loadInBrowser(l)}}));document.head.appendChild(d)}},{key:"buildLinkTag",value:function(e,t,n){var r=document.createElement("link");return r.rel="stylesheet",r.href=e,r.onload=t,r.onerror=n,r}},{key:"buildScriptTag",value:function(e,t,n){var r=document.createElement("script");return r.type="text/javascript",r.src=e,r.async=!1,r.crossOrigin="anonymous",r.onload=t,r.onerror=n,r}}]),e}()),Ne=function(){function e(t,n,i){var o,a;(0,r.Z)(this,e),this.hookEmitter=new Re,this.loadState=be.WAITING,this.entryName=t,this.resourceUrl=n,this.options=i,this.retryTimes=null!==(o=null==i?void 0:i.retryTimes)&&void 0!==o?o:e.defaultRetryTimes,this.isCss=null!==(a=null==i?void 0:i.isCss)&&void 0!==a&&a,this.setupHooks()}return(0,i.Z)(e,[{key:"loadModule",value:function(){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function t(){var n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.loadState=be.LOADING,this.hookEmitter.fire(ke.LOADING),t.prev=2,t.next=5,e.scriptLoader.loadScript(this.entryName,this.resourceUrl,this.retryTimes,this.isCss);case 5:return n=t.sent,this.loadState=be.SUCCESS,this.hookEmitter.fire(ke.LOADED),t.abrupt("return",n);case 11:throw t.prev=11,t.t0=t.catch(2),this.loadState=be.ERROR,this.hookEmitter.fire(ke.ERROR),new me(t.t0.message);case 16:case"end":return t.stop()}}),t,this,[[2,11]])})))}},{key:"setupHooks",value:function(){var e=this;this.hookEmitter.event((function(t){var n,r,i=null===(r=null===(n=e.options)||void 0===n?void 0:n.hooks)||void 0===r?void 0:r[t];i&&i()}))}}]),e}();function Le(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.Z)(e);if(t){var i=(0,d.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.Z)(this,n)}}Ne.defaultRetryTimes=2,Ne.scriptLoader=Oe;var Ze=function(e){(0,c.Z)(n,e);var t=Le(n);function n(e,i,o){var a;return(0,r.Z)(this,n),(a=t.call(this,e,i,o)).deferredModule=a.loadModule(),a}return(0,i.Z)(n,[{key:"getModule",value:function(){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.deferredModule);case 1:case"end":return e.stop()}}),e,this)})))}}]),n}(Ne),Ie=function(){function e(t){(0,r.Z)(this,e),this.url=t}return(0,i.Z)(e,[{key:"bootstrap",value:function(){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loader=new Ze(this.url,this.url),e.next=3,this.loader.getModule();case 3:case"end":return e.stop()}}),e,this)})))}}]),e}(),Te=function(){function e(t,n){(0,r.Z)(this,e),this.name=t,this.cdnPrefix=n}return(0,i.Z)(e,[{key:"bootstrap",value:function(){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function t(){var n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n="".concat(this.cdnPrefix.replace(/\/*$/,"/")).concat(this.name),e.loadRecords.has(n)){t.next=6;break}return this.loader=new Ze(this.name,n,{isCss:!0}),t.next=5,this.loader.getModule();case 5:e.loadRecords.add(n);case 6:case"end":return t.stop()}}),t,this)})))}}]),e}();Te.loadRecords=new Set;var Ue=function(){function e(){var t=this;(0,r.Z)(this,e),this.isInnerOpen=!1,this.innerPromise=new Promise((function(e){t.completePromise=e}))}return(0,i.Z)(e,[{key:"isOpen",value:function(){return this.isInnerOpen}},{key:"open",value:function(){this.isInnerOpen=!0,this.completePromise(!0)}},{key:"wait",value:function(){return this.innerPromise}}]),e}();function Ae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.Z)(e);if(t){var i=(0,d.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.Z)(this,n)}}var je=function(e){(0,c.Z)(n,e);var t=Ae(n);function n(e,i,o){var a;return(0,r.Z)(this,n),(a=t.call(this,e,i,o)).schedulerHandler=E.scheduler,a.scheduleCallbackTask=a.loadWhenIdle(),a}return(0,i.Z)(n,[{key:"getModule",value:function(){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.loadState!==be.WAITING&&this.loadState!==be.ERROR){e.next=4;break}return this.schedulerHandler.cancelTask(this.scheduleCallbackTask),this.deferredModule=this.loadModule(),e.abrupt("return",this.deferredModule);case 4:return e.abrupt("return",this.deferredModule);case 5:case"end":return e.stop()}}),e,this)})))}},{key:"loadWhenIdle",value:function(){var e=this;return this.schedulerHandler.scheduleTask((function(){e.deferredModule=e.loadModule()}))}}]),n}(Ne);function Pe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.Z)(e);if(t){var i=(0,d.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.Z)(this,n)}}var Ge,Be=function(e){(0,c.Z)(n,e);var t=Pe(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,i.Z)(n,[{key:"getModule",value:function(){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.deferredModule=this.loadModule(),e.abrupt("return",this.deferredModule);case 2:case"end":return e.stop()}}),e,this)})))}}]),n}(Ne),Fe=(Ge={},(0,w.Z)(Ge,Ce.ON_DEMAND,Be),(0,w.Z)(Ge,Ce.IDLE,je),(0,w.Z)(Ge,Ce.EAGER,Ze),Ge),Ve=function(){function e(t,n,i,o){(0,r.Z)(this,e),this.name=t,this.url=n,this.surpportLanguages=i,this.language=o,this.loadTypeMap=new Map}return(0,i.Z)(e,[{key:"bootstrap",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=null!==(e=this.loadTypeMap.get(t))&&void 0!==e?e:Ce.IDLE;this.loader=this.createLoader(n)}},{key:"addLoadType",value:function(e,t){this.loadTypeMap.set(null!=e?e:"",t)}},{key:"getInstance",value:function(){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.loader||this.bootstrap(),this.loader.loadState!==be.ERROR){e.next=3;break}throw new me("load extension [".concat(this.name,"] error."));case 3:return e.next=5,this.waitSingletonInstance();case 5:return e.abrupt("return",this.instance);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"waitSingletonInstance",value:function(){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.instance){e.next=2;break}return e.abrupt("return");case 2:if(!this.barrier){e.next=7;break}return e.next=5,this.barrier.wait();case 5:e.next=17;break;case 7:return this.barrier=new Ue,e.next=10,this.loader.getModule();case 10:if("function"==typeof(t=e.sent)){e.next=14;break}throw _e.loadFail({cost:-1,module:this.name,url:this.url,info:"constructor type: ".concat((0,f.Z)(t))}),new me("something went wrong in ".concat(this.name,"'s constructor."));case 14:this.instance=xe(new t,this.name,this.url),this.instance.bootstraped=!1,this.barrier.open();case 17:case"end":return e.stop()}}),e,this)})))}},{key:"dealUrlForMultLanguage",value:function(e){var t,n=Array.isArray(e)?null==e?void 0:e[0]:e,r=null==n?void 0:n.lastIndexOf(".js");return-1===r||(null===(t=this.surpportLanguages)||void 0===t?void 0:t.includes(this.language))&&(n="".concat(n.slice(0,r),".").concat(this.language,".js")),n}},{key:"createLoader",value:function(e){return new(0,Fe[e])(this.name,this.dealUrlForMultLanguage(this.url))}}]),e}(),We=function(){function e(){(0,r.Z)(this,e)}return(0,i.Z)(e,[{key:"bootstrap",value:function(){throw new me("genesis dependency node should not be called")}}]),e}();We.nodeName="GENESIS_DEPENDENCY_NODE";var qe=_.L.getConfig('npm["@tencent/ark-extensions"]'),He=(null==qe?void 0:qe.React)||"//docs.idqqimg.com/tim/docs/components/libs/react-common-16.13.1-2bf240.js",Ke=(null==qe?void 0:qe.ReactDOM)||"//docs.idqqimg.com/tim/docs/components/libs/react-common-16.13.1-2bf240.js",Ye=(null==qe?void 0:qe.DEFAULT_COMPONENT_CDN_PREFIX)||"//docs.gtimg.com/docs_components",ze={React:He,ReactDOM:Ke},Qe=function(){function e(t){(0,r.Z)(this,e),this.name=t}return(0,i.Z)(e,[{key:"bootstrap",value:function(){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=ze[this.name]){e.next=3;break}throw new me("common lib [".concat(this.name,"] is illegal because it's not in white list."));case 3:if(void 0!==window[this.name]){e.next=7;break}return this.loader=new Ze(this.name,t),e.next=7,this.loader.getModule();case 7:case"end":return e.stop()}}),e,this)})))}}]),e}(),Xe=function(){function e(t,n){(0,r.Z)(this,e),this.name=t,this.cdnPrefix=n}return(0,i.Z)(e,[{key:"bootstrap",value:function(){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function t(){var n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n="".concat(this.cdnPrefix.replace(/\/*$/,"/")).concat(this.name),e.loadRecords.has(n)){t.next=6;break}return this.loader=new Ze(this.name,n),t.next=5,this.loader.getModule();case 5:e.loadRecords.add(n);case 6:case"end":return t.stop()}}),t,this)})))}}]),e}();Xe.loadRecords=new Set;var $e=function(){function e(t){(0,r.Z)(this,e),this.metadataLoader=t,this.createDepGraph()}return(0,i.Z)(e,[{key:"addExtensionConfig",value:function(e){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.metadataRecord){t.next=4;break}return t.next=3,this.metadataLoader.getMetadataRecord();case 3:this.metadataRecord=t.sent;case 4:this.language=this.metadataLoader.getLanguage(),this.addDepNodeByConfig(e);case 6:case"end":return t.stop()}}),t,this)})))}},{key:"addExtensionDescription",value:function(e){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function t(){var n,r,i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.metadataRecord){t.next=4;break}return t.next=3,this.metadataLoader.getMetadataRecord();case 3:this.metadataRecord=t.sent;case 4:return n=e.name,r=e.loadType,(i=this.addExtensionDependencyNode(n,r)).bootstrap(),t.abrupt("return",i);case 8:case"end":return t.stop()}}),t,this)})))}},{key:"getInstance",value:function(e){return(0,s.__awaiter)(this,arguments,void 0,(function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:We.nodeName;return a().mark((function r(){var i,o,c,u,d,l,f,h,p,v,m,y;return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t.depGraph.directDependantsOf(e).includes(n)){r.next=4;break}throw _e.loadFail({module:e,url:"",cost:-1,info:"cannot find in metadata"}),new me("Cannot get ".concat(e," extension in ").concat(n,", please add configuration !"));case 4:d=t.depGraph.getNodeData(e),l=t.depGraph.directDependenciesOf(e),r.prev=6,f=!0,h=(0,s.__asyncValues)(l);case 8:return r.next=10,h.next();case 10:if(p=r.sent,i=p.done){r.next=22;break}return u=p.value,f=!1,v=u,m=t.depGraph.getNodeData(v),r.next=19,m.bootstrap(e);case 19:f=!0,r.next=8;break;case 22:r.next=27;break;case 24:r.prev=24,r.t0=r.catch(6),o={error:r.t0};case 27:if(r.prev=27,r.prev=28,f||i||!(c=h.return)){r.next=32;break}return r.next=32,c.call(h);case 32:if(r.prev=32,!o){r.next=35;break}throw o.error;case 35:return r.finish(32);case 36:return r.finish(27);case 37:return r.next=39,d.getInstance();case 39:return y=r.sent,r.abrupt("return",y);case 41:case"end":return r.stop()}}),r,null,[[6,24,27,37],[28,,32,36]])}))()}))}},{key:"getDepGraph",value:function(){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.depGraph);case 1:case"end":return e.stop()}}),e,this)})))}},{key:"createDepGraph",value:function(){this.depGraph=new h.f;var e=new We;this.depGraph.addNode(We.nodeName,e)}},{key:"addDepNodeByConfig",value:function(e){var t=this;e.forEach((function(e){var n=e.name,r=e.loadType;try{var i=t.addExtensionDependencyNode(n,r);t.depGraph.addDependency(We.nodeName,i.name)}catch(e){console.error(e)}}))}},{key:"addLibraryDependencyNode",value:function(e){var t=new Qe(e);this.depGraph.addNode(e,t)}},{key:"addModulesDependencyNode",value:function(e,t){var n=new Xe(e,t);this.depGraph.addNode(e,n)}},{key:"addCSSDependencyNode",value:function(e,t){var n=new Te(e,t);this.depGraph.addNode(e,n)}},{key:"addChunkDependencyNode",value:function(e){var t=new Ie(e);this.depGraph.addNode(e,t)}},{key:"addExtensionDependencyNode",value:function(e,t,n){var r=this;if(this.depGraph.hasNode(e)){var i=this.depGraph.getNodeData(e);return i.addLoadType(n,t),i}var o=this.metadataRecord[e];if(!o)throw new me("Cannot find ".concat(e," extension in metadata!"));var a=o.url,s=o.chunks,c=void 0===s?[]:s,u=o.dependencies,d=void 0===u?{}:u,l=o.surpportLanguages,f=void 0===l?[]:l,h=d.commonModules,p=void 0===h?[]:h,v=d.commonLibs,m=void 0===v?[]:v,y=d.extensions,g=void 0===y?[]:y,w=d.css,E=void 0===w?[]:w,_=new Ve(e,a,f,this.language);return _.addLoadType(n,t),this.depGraph.addNode(e,_),c.forEach((function(t){r.addChunkDependencyNode(t),r.depGraph.addDependency(e,t)})),m.forEach((function(t){r.addLibraryDependencyNode(t),r.depGraph.addDependency(e,t)})),p.forEach((function(t){r.addModulesDependencyNode(t,r.metadataLoader.COMPONENT_CDN_PREFIX),r.depGraph.addDependency(e,t)})),E.forEach((function(t){r.addCSSDependencyNode(t,r.metadataLoader.COMPONENT_CDN_PREFIX),r.depGraph.addDependency(e,t)})),g.forEach((function(t){var n;try{var i=null!==(n=Ce[t.loadType.toString()])&&void 0!==n?n:Ce.ON_DEMAND;r.addExtensionDependencyNode(t.name,i,e),r.depGraph.addDependency(e,t.name)}catch(e){console.error(e)}})),_}}]),e}();$e=(0,s.__decorate)([(0,s.__param)(0,De),(0,s.__metadata)("design:paramtypes",[Object])],$e);var Je,et,tt=(0,p.y)("IExtensionManager");!function(e){e[e.WINDOW=0]="WINDOW",e[e.DOCUMENT=1]="DOCUMENT",e[e.DOCUMENT_BODY=2]="DOCUMENT_BODY"}(Je||(Je={})),function(e){e.RESIZE="resize",e.MOUSE_DOWN="mousedown",e.MOUSE_MOVE="mousemove",e.MOUSE_UP="mouseup",e.KEY_UP="keyup",e.KEY_DOWN="keydown",e.CLICK="click",e.TOUCH_START="touchstart",e.TOUCH_MOVE="touchmove",e.TOUCH_END="touchend",e.POP_STATE="popState",e.VISIBILITY_CHANGE="visibilitychange",e.ONLINE="online",e.OFFLINE="offline",e.MESSAGE="message",e.CUSTOM="custom"}(et||(et={}));var nt=function(){function e(){(0,r.Z)(this,e),this.eventListenerSet=new Set,this.customEventListenerMap=new Map}return(0,i.Z)(e,[{key:"listen",value:function(e){var t=e.type;switch(t){case et.RESIZE:case et.MOUSE_DOWN:case et.MOUSE_MOVE:case et.MOUSE_UP:case et.KEY_UP:case et.KEY_DOWN:case et.CLICK:case et.TOUCH_START:case et.TOUCH_MOVE:case et.TOUCH_END:case et.POP_STATE:case et.VISIBILITY_CHANGE:case et.ONLINE:case et.OFFLINE:case et.MESSAGE:return this.bindEvent(e);case et.CUSTOM:return this.bindCustomEvent(e);default:throw new me("[".concat(t,"] event is not supported to use in extensions."))}}},{key:"listenCustomEvent",value:function(e){return this.bindCustomEvent(e),{name:e.name,fire:this.dispatchCustomEvent.bind(this,e.name)}}},{key:"dispatchCustomEvent",value:function(e,t){var n=new CustomEvent(e,{detail:t});this.node.dispatchEvent(n)}},{key:"remove",value:function(e){if(!this.eventListenerSet.has(e))throw new me("unable to remove [".concat(e.type,"] event which is not in your namespace or not bound."));var t=e.name,n=e.type,r=e.fn,i=e.options;if(n===et.CUSTOM)return this.node.removeEventListener(t,r,i),void this.customEventListenerMap.delete(t);this.node.removeEventListener(n,r,i),this.eventListenerSet.delete(e)}},{key:"removeAll",value:function(){var e=this;this.eventListenerSet.forEach((function(t){e.remove(t)})),this.customEventListenerMap.forEach((function(t){e.remove(t)}))}},{key:"bindEvent",value:function(e){if(this.eventListenerSet.has(e))throw new me("duplicated [".concat(e.type,"] event."));var t=e.type,n=e.fn,r=e.options;this.node.addEventListener(t,n,r),this.eventListenerSet.add(e)}},{key:"bindCustomEvent",value:function(e){var t=e.name;if(this.customEventListenerMap.has(t))throw new me("duplicated [".concat(t,"] event."));var n=t,r=e.fn,i=e.options;this.node.addEventListener(n,r,i),this.customEventListenerMap.set(t,e)}}]),e}();function rt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.Z)(e);if(t){var i=(0,d.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.Z)(this,n)}}var it=function(e){(0,c.Z)(n,e);var t=rt(n);function n(){var e;return(0,r.Z)(this,n),(e=t.apply(this,arguments)).node=document.body,e}return(0,i.Z)(n)}(nt);function ot(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.Z)(e);if(t){var i=(0,d.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.Z)(this,n)}}var at=function(e){(0,c.Z)(n,e);var t=ot(n);function n(){var e;return(0,r.Z)(this,n),(e=t.apply(this,arguments)).node=document,e}return(0,i.Z)(n)}(nt);function st(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,d.Z)(e);if(t){var i=(0,d.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.Z)(this,n)}}var ct=function(e){(0,c.Z)(n,e);var t=st(n);function n(){var e;return(0,r.Z)(this,n),(e=t.apply(this,arguments)).node=window,e}return(0,i.Z)(n)}(nt),ut=function(){function e(){(0,r.Z)(this,e),this.initEventManagerPool()}return(0,i.Z)(e,[{key:"addListener",value:function(e){var t=e.target;return this.eventManagerPool[t].listen(e)}},{key:"removeListener",value:function(e){var t=e.target;return this.eventManagerPool[t].remove(e)}},{key:"removeAllListener",value:function(){Object.values(this.eventManagerPool).forEach((function(e){e.removeAll()}))}},{key:"initEventManagerPool",value:function(){var e,t=new ct,n=new at,r=new it;this.eventManagerPool=(e={},(0,w.Z)(e,Je.WINDOW,t),(0,w.Z)(e,Je.DOCUMENT,n),(0,w.Z)(e,Je.DOCUMENT_BODY,r),e)}}]),e}(),dt=(0,p.y)("IExtensionEvent"),lt=(0,p.y)("IExtensionContainerService"),ft=function(){function e(t,n,i,o,a,s,c,u,d,l,f,h,p,v,m,y,g,w,E,_,x,k){(0,r.Z)(this,e),this.docMetaDomain=t,this.userInfoDomain=n,this.authDomain=i,this.fileDomain=o,this.likeDomain=a,this.folderDomain=s,this.templateDomain=c,this.accountDomain=u,this.loginDomain=d,this.notificationDomain=l,this.shareDomain=f,this.messageDomain=h,this.collaborateDomain=p,this.notifyScopeDomain=v,this.atMessageDomain=m,this.fileInfoDomain=y,this.connectionControllerService=g,this.accountApplication=w,this.enterpriseAccountApplication=E,this.docsManagementService=_,this.extensionEvent=x,this.extensionContainerService=k}return(0,i.Z)(e,[{key:"getExtensionService",value:function(e,t){return{getExtension:function(n){return e.safeGetExtension.call(e,n,t)},fireExtensionEvent:e.fireExtensionEvent.bind(e,t)}}},{key:"getDomainService",value:function(){return{docMetaDomain:this.docMetaDomain,userInfoDomain:this.userInfoDomain,authDomain:this.authDomain,fileDomain:this.fileDomain,likeDomain:this.likeDomain,folderDomain:this.folderDomain,templateDomain:this.templateDomain,accountDomain:this.accountDomain,loginDomain:this.loginDomain,notificationDomain:this.notificationDomain,shareDomain:this.shareDomain,messageDomain:this.messageDomain,collaborateDomain:this.collaborateDomain,notifyScopeDomain:this.notifyScopeDomain,atMessageDomain:this.atMessageDomain,fileInfoDomain:this.fileInfoDomain}}},{key:"getApplicationService",value:function(){return{accountApplication:this.accountApplication,enterpriseAccountApplication:this.enterpriseAccountApplication,connectionControllerService:this.connectionControllerService,docsManagementService:this.docsManagementService}}},{key:"getToolService",value:function(){return{networkRequest:ue.networkRequest,event:this.extensionEvent}}},{key:"getExtensionContainerService",value:function(e){return{createContainerIfUnspecified:this.extensionContainerService.createContainerIfUnspecified.bind(this.extensionContainerService,e),createSandboxContainerIfUnspecified:this.extensionContainerService.createSandboxContainerIfUnspecified.bind(this.extensionContainerService,e)}}}]),e}();ft=(0,s.__decorate)([(0,s.__param)(0,k.v),(0,s.__param)(1,C.m),(0,s.__param)(2,b.i),(0,s.__param)(3,D.G),(0,s.__param)(4,S.d),(0,s.__param)(5,M.r),(0,s.__param)(6,R.y),(0,s.__param)(7,O.b),(0,s.__param)(8,N.C),(0,s.__param)(9,L.Y),(0,s.__param)(10,Z.j),(0,s.__param)(11,I.x),(0,s.__param)(12,T.U),(0,s.__param)(13,U.Y),(0,s.__param)(14,A.B),(0,s.__param)(15,j.U),(0,s.__param)(16,x.jE),(0,s.__param)(17,x.aG),(0,s.__param)(18,x.Pf),(0,s.__param)(19,x.Mp),(0,s.__param)(20,dt),(0,s.__param)(21,lt),(0,s.__metadata)("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object,Object])],ft);var ht=(0,p.y)("IDependentServiceCombinder"),pt=(0,p.y)("IExtensionConfigManager"),vt=function(){function e(t,n,i,o){(0,r.Z)(this,e),this.dependentServiceCombinder=t,this.extensionConfigManager=n,this.extensionManager=i,this.domainUpdater=o,this.extensionEventEmitter=new Re}return(0,i.Z)(e,[{key:"updateDomainWithClientVars",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.domainUpdater.updateDomainWithClientVars(e,t)}},{key:"updateDomainWithRequests",value:function(e,t){this.domainUpdater.updateDomainWithRequests({docId:e,u:t})}},{key:"scanAndHandleExtensions",value:function(e){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.addExtensionConfig(e));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"addExtensionConfig",value:function(e){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.extensionConfigReadyBarrier){t.next=5;break}return t.next=3,this.extensionConfigReadyBarrier.wait();case 3:t.next=6;break;case 5:this.extensionConfigReadyBarrier=new Ue;case 6:return t.next=8,this.extensionConfigManager.addExtensionConfig(e);case 8:this.extensionConfigReadyBarrier.open();case 9:case"end":return t.stop()}}),t,this)})))}},{key:"addExtensionDescription",value:function(e){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.extensionConfigManager.addExtensionDescription(e);case 2:case"end":return t.stop()}}),t,this)})))}},{key:"subscribeExtensionEvent",value:function(e){this.extensionEventEmitter.event((function(t){e(t.extensionName,t.type)}))}},{key:"fireExtensionEvent",value:function(e,t){var n={extensionName:e,type:t};this.extensionEventEmitter.fire(n)}},{key:"getExtension",value:function(e){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.safeGetExtension(e));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"dispose",value:function(){throw new Error("Method not implemented.")}},{key:"disposeAllExtensions",value:function(){throw new Error("Method not implemented.")}},{key:"getExtensionConfig",value:function(){return this.extensionConfigManager.getExtensionConfig()}},{key:"getExtensionDepGraph",value:function(){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.extensionManager.getDepGraph());case 1:case"end":return e.stop()}}),e,this)})))}},{key:"safeGetExtension",value:function(e,t){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function n(){var r;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.extensionConfigReadyBarrier.wait();case 2:return n.next=4,this.extensionManager.getInstance(e,t);case 4:return r=n.sent,this.bootstrapExtension(e,r),n.abrupt("return",r);case 7:case"end":return n.stop()}}),n,this)})))}},{key:"bootstrapExtension",value:function(e,t){if(!t.bootstraped){var n=this.dependentServiceCombinder.getExtensionService(this,e),r=this.dependentServiceCombinder.getDomainService(),i=this.dependentServiceCombinder.getApplicationService(),o=this.dependentServiceCombinder.getToolService(),a=this.dependentServiceCombinder.getExtensionContainerService(e),s=this.extensionConfigManager.findExtensionDescription(e),c=null==s?void 0:s.containerId,u=this.getContainer(c);t.bootstrap({extensionService:n,domainService:r,toolService:o,applicationService:i,containerService:a,extensionName:e,container:u}),t.bootstraped=!0}}},{key:"getContainer",value:function(e){var t=null;return e&&(t=document.getElementById(e)),t}}]),e}();vt=(0,s.__decorate)([(0,s.__param)(0,ht),(0,s.__param)(1,pt),(0,s.__param)(2,tt),(0,s.__param)(3,P.e),(0,s.__metadata)("design:paramtypes",[Object,Object,Object,Object])],vt);var mt="ark_extension",yt="__ark_extends_init_error_handler__";function gt(){window[yt]||(window[yt]=!0,window.addEventListener(Ee,(function(e){(0,le.tdwSingle)({opername:mt,module:e.detail.module,action:"load_fail",ver7:e.detail.url,ver8:e.detail.cost,ver9:e.detail.start,ver10:e.detail.info})})),window.addEventListener(we,(function(e){(0,le.tdw)({opername:mt,module:e.detail.module,action:"cost",ver7:e.detail.url,ver8:e.detail.cost,ver9:e.detail.start})})),window.addEventListener(ge,(function(e){var t,n=e.detail.error instanceof Error?e.detail.error.stack:null===(t=e.detail.error)||void 0===t?void 0:t.toString();(0,le.tdwSingle)({opername:mt,module:e.detail.module,action:"call_error",ver7:e.detail.url,ver8:e.detail.cost,ver9:e.detail.function,ver10:n,ver11:e.detail.start})})),window.addEventListener(ye,(function(e){e.detail.cost<1e3||(0,le.tdw)({opername:mt,module:e.detail.module,action:"call",ver7:e.detail.url,ver8:e.detail.cost,ver9:e.detail.function,ver11:e.detail.start})})),window.addEventListener("error",(function(e){var t;if((null==e?void 0:e.error)instanceof Error){var n=he().parse(e.error),r=[];if(n.forEach((function(e){if(e.fileName){var t=function(e){var t=new RegExp(/(docs-component-.*)\..*\.js$/).exec(e);if(null==t?void 0:t[1])return t[1]}(e.fileName);t&&r.push(t)}})),0!==r.length){var i=r[r.length-1];(0,le.tdwSingle)({opername:mt,action:"js_error",module:i,ver7:e.message,ver8:null===(t=e.error)||void 0===t?void 0:t.stack,ver9:r.join("->")})}}})))}var wt=function(){function e(){(0,r.Z)(this,e),this.containerCollectionId="__unspesified_extension_container_collection__"}return(0,i.Z)(e,[{key:"createContainerIfUnspecified",value:function(e){this.unspecifiedContainerCollection=this.getUnspecifiedContainerCollection();var t=this.unspecifiedContainerCollection.querySelector("#".concat(e));return t||((t=document.createElement("div")).setAttribute("id",e),this.unspecifiedContainerCollection.appendChild(t),t)}},{key:"createSandboxContainerIfUnspecified",value:function(){throw new Error("Method not implemented.")}},{key:"getUnspecifiedContainerCollection",value:function(){var e=document.getElementById(this.containerCollectionId);return e||((e=document.createElement("div")).setAttribute("id",this.containerCollectionId),document.body.appendChild(e)),e}}]),e}(),Et=function(){function e(t){(0,r.Z)(this,e),this.extensionManager=t,this.extensionConfig=[]}return(0,i.Z)(e,[{key:"addExtensionConfig",value:function(e){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.extensionConfig=this.extensionConfig.concat(e),t.next=3,this.extensionManager.addExtensionConfig(e);case 3:case"end":return t.stop()}}),t,this)})))}},{key:"addExtensionDescription",value:function(e){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.assertNoDuplicatedDescription(e),this.extensionConfig.push(e),t.next=4,this.extensionManager.addExtensionDescription(e);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"getExtensionConfig",value:function(){return this.extensionConfig}},{key:"findExtensionDescription",value:function(e){return this.extensionConfig.find((function(t){return t.name===e}))}},{key:"iterateExtensionConfig",value:function(e){this.extensionConfig.forEach(e)}},{key:"assertNoDuplicatedDescription",value:function(e){if(this.extensionConfig.find((function(t){return t.name===e.name})))throw new me("duplicated extension config of ".concat(e.name,"."))}}]),e}();Et=(0,s.__decorate)([(0,s.__param)(0,tt),(0,s.__metadata)("design:paramtypes",[Object])],Et);var _t=(0,p.y)("IExtensionService"),xt=Symbol.for("__META_REQUEST_CACHE__"),kt=window.location,Ct=kt.protocol,bt=kt.host,Dt="".concat(Ct,"//").concat(bt,"/components/docs/metadata{{specifiedVersionKey}}.json?t={{time}}"),St=function(){function e(t){var n,i;(0,r.Z)(this,e),this.METADATA_URL=Dt,this.COMPONENT_CDN_PREFIX=null!==(n=t.componentCdnPrefix)&&void 0!==n?n:Ye,this.specifiedVersionKey=t.specifiedVersion?".v".concat(t.specifiedVersion):"",this.language=null!==(i=t.language)&&void 0!==i?i:""}return(0,i.Z)(e,[{key:"metadataRequestCacheMap",get:function(){return void 0===globalThis[xt]&&(globalThis[xt]=new Map),globalThis[xt]}},{key:"getMetadataRecord",value:function(){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function e(){var t,n,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.metadataRequestCacheMap.has(this.specifiedVersionKey),n=t?this.metadataRequestCacheMap.get(this.specifiedVersionKey):this.requestMetadataRecord(),t||this.metadataRequestCacheMap.set(this.specifiedVersionKey,n),e.next=5,n;case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e,this)})))}},{key:"getLanguage",value:function(){return this.language}},{key:"requestMetadataRecord",value:function(){return(0,s.__awaiter)(this,void 0,void 0,a().mark((function e(){var t,n,r,i,o,s,c,u,d=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.METADATA_URL.replace("{{specifiedVersionKey}}",this.specifiedVersionKey).replace("{{time}}",Date.now().toString()),n=performance.now(),e.next=4,ue.networkRequest.get(t);case 4:if(r=e.sent,i=performance.now(),o=i-n,_e.loadCost({module:"metadata",url:t,cost:o,start:n}),r.data){e.next=11;break}throw _e.loadFail({module:"metadata",url:t,info:r.status.toString(),cost:o,start:n}),new me("request metadata error, error code: [".concat(r.status,"]."));case 11:return s=r.data,c=void 0===s?[]:s,u=Object.values(c).reduce((function(e,t){return Object.assign(Object.assign({},e),(0,w.Z)({},t.name,Object.assign(Object.assign({},t),{url:d.getMetadataUrl(t)})))}),{}),e.abrupt("return",u);case 14:case"end":return e.stop()}}),e,this)})))}},{key:"getMetadataUrl",value:function(e){var t=this;return Array.isArray(e.url)?e.url.map((function(e){return"".concat(t.COMPONENT_CDN_PREFIX,"/").concat(e)})):["".concat(this.COMPONENT_CDN_PREFIX,"/").concat(e.url)]}}]),e}(),Mt="__ARK_EXTENSION_INSTANTIATION_SERVICE__",Rt="__ARK_EXTENSION_SERVICE__";function Ot(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=globalThis[Rt];if(t)return t;var n=new v.o,r=new m.y,i={serviceRegister:n,serviceCollection:r};!function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.serviceRegister;r.register(_t,vt),r.register(pt,Et),r.register(De,St,[null!==(t=n.metadataLoaderOptions||n.metadataLoader)&&void 0!==t?t:{}]),r.register(tt,$e)})(e,t),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.serviceRegister,r=t.isEnterprise;n.register(P.e,G.d),n.register(B._,F.L),n.register(b.i,V.n),n.register(L.Y,W.e),n.register(Z.j,q.d),n.register(T.U,H.u),n.register(O.b,K.D),n.register(Y.b,z.f),n.register(k.v,r?Q.I:X.L),n.register(C.m,$.$),n.register(D.G,J.v),n.register(j.U,ee.h),n.register(M.r,te.i),n.register(R.y,ne.Y),n.register(N.C,re.g),n.register(I.x,ie.i),n.register(U.Y,oe.l),n.register(A.B,ae.M),n.register(S.d,r?se.G:ce.W),n.register(x.jE,x.y5),n.register(x.aG,x.eU),n.register(x.Pf,x.TU),n.register(x.Mp,x.jR),n.register(ht,ft),n.register(dt,ut),n.register(lt,wt)}(e,t)}(i,e),function(e){var t=e.serviceRegister,n=e.serviceCollection,r=t.getServiceDescriptors();r.forEach((function(e){var t=(0,de.Z)(e,2),r=t[0],i=t[1];n.set(r,i)}))}(i);var o=function(e){return new y.F(e)}(r);globalThis[Mt]=o;var a=globalThis[Rt]=function(e){return e.invokeFunction((function(e){return e.get(_t)}))}(o);return gt(),a}}}]),"object"==typeof globalThis&&(globalThis.jsExecEndTimeStamp=Date.now(),globalThis.cachedPerformanceEntries||(globalThis.cachedPerformanceEntries=[]),globalThis.cachedPerformanceEntries.push({name:"jsExec: js/public-ark-extensions-4a90fd70.js",entryType:"jsExec",startTime:globalThis.jsExecStartTimeStamp,endTime:globalThis.jsExecEndTimeStamp}));
//# sourceMappingURL=public-ark-extensions-4a90fd70.js.map