"object"==typeof globalThis&&(globalThis.jsExecStartTimeStamp=Date.now()),(self.webpackChunkuni=self.webpackChunkuni||[]).push([[6453],{98813:function(e,t){t.Z={"fieldcode-draggable":"tdocs-fieldcode-draggable",fieldcodeDraggable:"tdocs-fieldcode-draggable"}},403403:function(e,t){t.Z={"doc-link-container":"tdocs-doc-link-container",docLinkContainer:"tdocs-doc-link-container","doc-link-container-active":"tdocs-doc-link-container-active",docLinkContainerActive:"tdocs-doc-link-container-active","doc-link-container-none":"tdocs-doc-link-container-none",docLinkContainerNone:"tdocs-doc-link-container-none","doc-link-container-lite":"tdocs-doc-link-container-lite",docLinkContainerLite:"tdocs-doc-link-container-lite","doc-link-container-canvas":"tdocs-doc-link-container-canvas",docLinkContainerCanvas:"tdocs-doc-link-container-canvas","doc-link-icon-wrapper":"tdocs-doc-link-icon-wrapper",docLinkIconWrapper:"tdocs-doc-link-icon-wrapper","doc-link-default":"tdocs-doc-link-default",docLinkDefault:"tdocs-doc-link-default","doc-link-doc":"tdocs-doc-link-doc",docLinkDoc:"tdocs-doc-link-doc","doc-link-sheet":"tdocs-doc-link-sheet",docLinkSheet:"tdocs-doc-link-sheet","doc-link-folder":"tdocs-doc-link-folder",docLinkFolder:"tdocs-doc-link-folder","doc-link-slide":"tdocs-doc-link-slide",docLinkSlide:"tdocs-doc-link-slide","doc-link-pdf":"tdocs-doc-link-pdf",docLinkPdf:"tdocs-doc-link-pdf","doc-link-form":"tdocs-doc-link-form",docLinkForm:"tdocs-doc-link-form","doc-link-card-wrapper":"tdocs-doc-link-card-wrapper",docLinkCardWrapper:"tdocs-doc-link-card-wrapper","doc-link-card-wrapper-mobile":"tdocs-doc-link-card-wrapper-mobile",docLinkCardWrapperMobile:"tdocs-doc-link-card-wrapper-mobile","doc-link-card-link-wrapper":"tdocs-doc-link-card-link-wrapper",docLinkCardLinkWrapper:"tdocs-doc-link-card-link-wrapper","doc-link-card-link-wrapper-missing-desc":"tdocs-doc-link-card-link-wrapper-missing-desc",docLinkCardLinkWrapperMissingDesc:"tdocs-doc-link-card-link-wrapper-missing-desc",left:"tdocs-left",placeholder:"tdocs-placeholder",right:"tdocs-right",title:"tdocs-title",desc:"tdocs-desc",url:"tdocs-url","button-wrapper":"tdocs-button-wrapper",buttonWrapper:"tdocs-button-wrapper","doc-link-card-link-app-wrapper":"tdocs-doc-link-card-link-app-wrapper",docLinkCardLinkAppWrapper:"tdocs-doc-link-card-link-app-wrapper","doc-link-card-link-app-overbtn":"tdocs-doc-link-card-link-app-overbtn",docLinkCardLinkAppOverbtn:"tdocs-doc-link-card-link-app-overbtn","doc-link-card-wedoc-wrapper":"tdocs-doc-link-card-wedoc-wrapper",docLinkCardWedocWrapper:"tdocs-doc-link-card-wedoc-wrapper","doc-link-card-wedoc-wrapper-preview":"tdocs-doc-link-card-wedoc-wrapper-preview",docLinkCardWedocWrapperPreview:"tdocs-doc-link-card-wedoc-wrapper-preview","doc-link-card-wedoc-wrapper-mobile":"tdocs-doc-link-card-wedoc-wrapper-mobile",docLinkCardWedocWrapperMobile:"tdocs-doc-link-card-wedoc-wrapper-mobile","melo-wedrive-file-card-wedoc-wrapper-preview":"tdocs-melo-wedrive-file-card-wedoc-wrapper-preview",meloWedriveFileCardWedocWrapperPreview:"tdocs-melo-wedrive-file-card-wedoc-wrapper-preview",success:"tdocs-success",loading:"tdocs-loading",error:"tdocs-error",deleted:"tdocs-deleted","file-icon":"tdocs-file-icon",fileIcon:"tdocs-file-icon",auth:"tdocs-auth",icon:"tdocs-icon","preview-text":"tdocs-preview-text",previewText:"tdocs-preview-text",action:"tdocs-action","inner-wrapper":"tdocs-inner-wrapper",innerWrapper:"tdocs-inner-wrapper","text-wrapper":"tdocs-text-wrapper",textWrapper:"tdocs-text-wrapper",text:"tdocs-text",wedrive:"tdocs-wedrive",creator:"tdocs-creator",actions:"tdocs-actions"}},467060:function(){},350154:function(e,t,n){n.r(t)},175257:function(e,t,n){n.d(t,{S9:function(){return r},fW:function(){return o},w0:function(){return s}});var r,o,i=n(839461),a=n(495155);!function(e){e.CREATEDOCCOPY="CREATEDOCCOPY",e.REFRESHANDFIX="refreshandfix",e.REFRESH="refresh",e.BEGINEDIT="beginedit",e.RELOGIN="relogin",e.CONTACT="contact",e.HOW2DEAL="how2deal",e.LEARNMORE="learnmore"}(r||(r={})),function(e){e.ON_CHANGESET_COMMIT_REJECTED="onChangesetCommitRejected",e.ON_CHANGESET_CHECK_INVALID="onChangesetCheckInvalid",e.ON_DISMISS_BLOCK_USER_EDIT="onDismissBlockUserEdit",e.ON_DISMISS_BLOCK_OFFLINE_EDIT="onDismissBlockOfflineEdit"}(o||(o={}));var s=function(e){function t(t){var n=e.call(this,o.ON_CHANGESET_COMMIT_REJECTED)||this;return n.blockInfo=t,n}return(0,i.__extends)(t,e),t}(a.Notification);(function(e){function t(t){var n=e.call(this,o.ON_CHANGESET_CHECK_INVALID)||this;return n.blockInfo=t,n}(0,i.__extends)(t,e)})(a.Notification),function(e){function t(t){var n=e.call(this,o.ON_DISMISS_BLOCK_USER_EDIT)||this;return n.target=t,n}(0,i.__extends)(t,e)}(a.Notification),function(e){function t(t){var n=e.call(this,o.ON_DISMISS_BLOCK_OFFLINE_EDIT)||this;return n.target=t,n}(0,i.__extends)(t,e)}(a.Notification)},798732:function(e,t,n){n.d(t,{N:function(){return r},l:function(){return a}});var r,o=n(839461),i=n(495155);!function(e){e.CONFIRM_CREATE_DOC_COPY="CONFIRM_CREATE_DOC_COPY"}(r||(r={}));var a=function(e){function t(){return e.call(this,r.CONFIRM_CREATE_DOC_COPY)||this}return(0,o.__extends)(t,e),t}(i.Notification)},328413:function(e,t,n){n.d(t,{l:function(){return c}});var r=n(732722),o=n(317999),i=n(814808),a=(n(495155),n(218581)),s=i.default,c=function(e){o.A.isMeetingEnv()?s.show({message:(0,a.$t)("演示中暂不支持打开链接"),autoClose:!0,duration:3e3}):(0,r.lY)(e)}},193506:function(e,t,n){n.d(t,{BP:function(){return b},Wo:function(){return E},ys:function(){return w},uF:function(){return y},Yy:function(){return C},AK:function(){return _}});var r=n(839461),o=n(768352),i=n(289312),a=n(986830),s=n(718807),c=n(153970),l=n(57481),u=n(216179),d=n(750670),p=n(826691),f=n(176654),h={ROW_DISABLE_TYPE:new Set(["addon-list"]),RICH_TEXT_BLOCK_DISABLE_TYPE:new Set(["addon-list"]),COMMON_ALLOW_TYPE:new Set(["copy","paragraph-format","delete-content-control","select_all"]),RICH_TEXT_INLINE_ALLOW_TYPE:new Set(["copy","cut","paste","paste-text","delete-content-control","comment","insert-comment","insert-image","insert-link","insert_link","insert-bookmark","bookmark","all-bookmark","paragraph-format","select_all","biu","insert-comment-ent","clear_format"]),PLAIN_TEXT_ALLOW_TYPE:new Set(["copy","cut","paste","paste-text","delete-content-control","insert-bookmark","bookmark","all-bookmark","paragraph-format","select_all","biu","clear_format"])},m={COMMON_DISABLED_TYPE:new Set(["insert-symbol","insert-breaks","insert-image","insert-table","insert-link","insert_link","insert-bookmark","bookmark","all-bookmark","insert-snippet","insert-codeblock","addon-countdown","addon-latex","doc-addon-mind_map","doc-addon-flow_chart","insert-comment","signature","insert-splitline","insert-splitline-color","insert-toc","addon-tencent_meeting_test","addon-tencent_meeting_release","insert-doc-link","embed-webpage","insert-page-break",p.Fv.INSERT_ATTACHMENT,"insert-qq-card","addon-insert_addons",p.aE.PARAGRAPH_LIGHTBLOCK,f.o4.UNOFFICIAL_ADDONS,p.Ak.SDT_WIDGET,p.aE.SDT_WIDGET,"comment","addon-list","context-addon-installed","context-addon-uninstalled","context-addon-none-installed",f.o4.INSERT_FOOTNOTE,f.o4.INSERT_ENDNOTE,f.o4.FOOTNOTE_ENDNOTE_SETTING,f.o4.NEXT_ENDNOTE,f.o4.PREV_ENDNOTE,f.o4.NEXT_FOOTNOTE,f.o4.PREV_FOOTNOTE,p.Ak.FOOTNOTE_ENDNOTE,p.Ak.JUMP_TO_NEXT_NOTE,"insert-from-album","insert-from-shooting","insert-mention","insert-doclink","insert-wedrivelink","insert-date-reminder","signature","insert-comment-ent","add-member-contact-card","add-cold-start-button","add-group-contact-card","insert-wxwork-calender","insert-wxwork-meeting","insert-app","insert-ocr","insert-location","insert-audiorecord","snippet-task-list","snippet-work-daily","snippet-work-report","snippet-conference-record",p.tV.INSERT_ATTACHMENT,"quick-shooting","addon-mobile-:menuid",p.Fv.GOVERNMENT_HEADER,p.Fv.GOVERNMENT_SEPERATOR,p.Fv.GOVERNMENT_SINGLE_AUTHORITY,p.Fv.GOVERNMENT_JOINT_AUTHORITY,p.Fv.GOVERNMENT_SINGLE_LINE_EDITION,p.Fv.GOVERNMENT_MUTIL_LINE_EDITION,p.aE.GOVERNMENT_HEADER,p.aE.GOVERNMENT_SEPERATOR,p.aE.GOVERNMENT_SINGLE_AUTHORITY,p.aE.GOVERNMENT_JOINT_AUTHORITY,p.aE.GOVERNMENT_SINGLE_LINE_EDITION,p.aE.GOVERNMENT_MUTIL_LINE_EDITION]),RICH_TEXT_BLOCK_DISABLED_TYPE:new Set(["insert-breaks","insert-snippet","addon-countdown","doc-addon-mind_map","doc-addon-flow_chart","insert-splitline","insert-splitline-color","addon-tencent_meeting_test","addon-tencent_meeting_release","insert-doc-link","embed-webpage","insert-page-break",p.Fv.INSERT_ATTACHMENT,"insert-qq-card","addon-insert_addons",p.aE.PARAGRAPH_LIGHTBLOCK,f.o4.UNOFFICIAL_ADDONS,"addon-list","context-addon-installed","context-addon-uninstalled","context-addon-none-installed","insert-doclink","insert-wedrivelink","insert-audiorecord","insert-date-reminder","add-member-contact-card","add-cold-start-button","add-group-contact-card","insert-wxwork-calender","insert-wxwork-meeting","insert-app","insert-ocr","insert-location","snippet-task-list","snippet-work-daily","snippet-work-report","snippet-conference-record",p.tV.INSERT_ATTACHMENT,"addon-mobile-:menuid",p.Fv.GOVERNMENT_HEADER,p.Fv.GOVERNMENT_SEPERATOR,p.Fv.GOVERNMENT_SINGLE_AUTHORITY,p.Fv.GOVERNMENT_JOINT_AUTHORITY,p.Fv.GOVERNMENT_SINGLE_LINE_EDITION,p.Fv.GOVERNMENT_MUTIL_LINE_EDITION,p.aE.GOVERNMENT_HEADER,p.aE.GOVERNMENT_SEPERATOR,p.aE.GOVERNMENT_SINGLE_AUTHORITY,p.aE.GOVERNMENT_JOINT_AUTHORITY,p.aE.GOVERNMENT_SINGLE_LINE_EDITION,p.aE.GOVERNMENT_MUTIL_LINE_EDITION]),RICH_TEXT_INLINE_DISABLED_TYPE:new Set(["insert-breaks","insert-table","insert-snippet","insert-codeblock","addon-countdown","doc-addon-mind_map","doc-addon-flow_chart","insert-splitline","insert-splitline-color","insert-toc","addon-tencent_meeting_test","addon-tencent_meeting_release","insert-doc-link","embed-webpage","insert-page-break",p.Fv.INSERT_ATTACHMENT,"insert-qq-card","addon-insert_addons",p.aE.PARAGRAPH_LIGHTBLOCK,f.o4.UNOFFICIAL_ADDONS,"addon-list","context-addon-installed","context-addon-uninstalled","context-addon-none-installed","insert-doclink","insert-wedrivelink","insert-audiorecord","insert-date-reminder","add-member-contact-card","add-cold-start-button","add-group-contact-card","insert-wxwork-calender","insert-wxwork-meeting","insert-app","insert-ocr","insert-location","snippet-task-list","snippet-work-daily","snippet-work-report","snippet-conference-record",p.tV.INSERT_ATTACHMENT,"addon-mobile-:menuid",p.Fv.GOVERNMENT_HEADER,p.Fv.GOVERNMENT_SEPERATOR,p.Fv.GOVERNMENT_SINGLE_AUTHORITY,p.Fv.GOVERNMENT_JOINT_AUTHORITY,p.Fv.GOVERNMENT_SINGLE_LINE_EDITION,p.Fv.GOVERNMENT_MUTIL_LINE_EDITION,p.aE.GOVERNMENT_HEADER,p.aE.GOVERNMENT_SEPERATOR,p.aE.GOVERNMENT_SINGLE_AUTHORITY,p.aE.GOVERNMENT_JOINT_AUTHORITY,p.aE.GOVERNMENT_SINGLE_LINE_EDITION,p.aE.GOVERNMENT_MUTIL_LINE_EDITION]),PLAIN_TEXT_DISABLED_TYPE:new Set(["insert-breaks","insert-image","insert-table","insert-link","insert_link","insert-snippet","insert-codeblock","addon-countdown","addon-latex","doc-addon-mind_map","doc-addon-flow_chart","insert-comment","signature","insert-splitline","insert-splitline-color","insert-toc","addon-tencent_meeting_test","addon-tencent_meeting_release","insert-doc-link","embed-webpage","insert-page-break",p.Fv.INSERT_ATTACHMENT,"insert-qq-card","addon-insert_addons",p.aE.PARAGRAPH_LIGHTBLOCK,f.o4.UNOFFICIAL_ADDONS,p.Ak.SDT_WIDGET,p.aE.SDT_WIDGET,p.Fv.REVIEW_INSERT_COMMENT,"comment","addon-list","context-addon-installed","context-addon-uninstalled","context-addon-none-installed",f.o4.INSERT_FOOTNOTE,f.o4.INSERT_ENDNOTE,f.o4.FOOTNOTE_ENDNOTE_SETTING,"insert-from-album","insert-from-shooting","insert-mention","insert-doclink","insert-wedrivelink","insert-date-reminder","insert-splitline","signature","insert-comment-ent","add-member-contact-card","add-cold-start-button","add-group-contact-card","insert-wxwork-calender","insert-wxwork-meeting","insert-app","insert-ocr","insert-location","insert-comment","insert-audiorecord","snippet-task-list","snippet-work-daily","snippet-work-report","snippet-conference-record",p.tV.INSERT_ATTACHMENT,"quick-shooting","addon-mobile-:menuid",p.Fv.GOVERNMENT_HEADER,p.Fv.GOVERNMENT_SEPERATOR,p.Fv.GOVERNMENT_SINGLE_AUTHORITY,p.Fv.GOVERNMENT_JOINT_AUTHORITY,p.Fv.GOVERNMENT_SINGLE_LINE_EDITION,p.Fv.GOVERNMENT_MUTIL_LINE_EDITION,p.aE.GOVERNMENT_HEADER,p.aE.GOVERNMENT_SEPERATOR,p.aE.GOVERNMENT_SINGLE_AUTHORITY,p.aE.GOVERNMENT_JOINT_AUTHORITY,p.aE.GOVERNMENT_SINGLE_LINE_EDITION,p.aE.GOVERNMENT_MUTIL_LINE_EDITION])},g=n(329961);function v(e,t){return 0===e.selection.gcpRange.len&&t.range.begin()===e.selection.gcpRange.begin()}var _=function(){function e(){}var t,n,u;return e.prototype.isDisabledInRichTextContent=function(e,t,n,r){var o,i;return!!e.property.isRichTextContent&&(r.selection.sdt.isInline?m.RICH_TEXT_INLINE_DISABLED_TYPE.has(n.name)||m.RICH_TEXT_INLINE_DISABLED_TYPE.has(null!==(o=null==t?void 0:t.matchPoint)&&void 0!==o?o:""):m.RICH_TEXT_BLOCK_DISABLED_TYPE.has(n.name)||m.RICH_TEXT_BLOCK_DISABLED_TYPE.has(null!==(i=null==t?void 0:t.matchPoint)&&void 0!==i?i:""))},e.prototype.isDisableInPlainTextContent=function(e,t,n){var r;return!!e.property.isPlainTextContent&&(m.PLAIN_TEXT_DISABLED_TYPE.has(n.name)||m.PLAIN_TEXT_DISABLED_TYPE.has(null!==(r=null==t?void 0:t.matchPoint)&&void 0!==r?r:""))},e.prototype.isDisableInCommon=function(e,t,n,r){var o;return!(!r.selection.sdt.isInSdt||!r.selection.getSdtSelection().isEditDisabledType(null,e)||!m.COMMON_DISABLED_TYPE.has(n.name)&&!m.COMMON_DISABLED_TYPE.has(null!==(o=null==t?void 0:t.matchPoint)&&void 0!==o?o:""))},e.prototype.use=function(e,t,n,r){var o;if(!(null===(o=null==r?void 0:r.selection)||void 0===o?void 0:o.sdt))return!1;var i=r.selection.sdt.activeSdts[0];return!!i&&!v(r,i)&&(this.isDisableInPlainTextContent(i,e,t)||this.isDisabledInRichTextContent(i,e,t,r)||!!this.isDisableInCommon(i,e,t,r))&&(n(),!0)},(0,r.__decorate)([(0,r.__param)(0,(0,i.g)()),(0,r.__param)(1,(0,a.z)()),(0,r.__param)(2,(0,s.o)()),(0,r.__param)(3,(0,c.M)()),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",["function"==typeof(t=void 0!==o.IActionPointInfo&&o.IActionPointInfo)?t:Object,"function"==typeof(n=void 0!==o.ToolbarConfig&&o.ToolbarConfig)?n:Object,Object,"function"==typeof(u=void 0!==d.MeloEditor&&d.MeloEditor)?u:Object]),(0,r.__metadata)("design:returntype",void 0)],e.prototype,"use",null),e=(0,r.__decorate)([(0,l.d)()],e)}(),y=function(){function e(){}var t,n,p;return e.prototype.isAllowInRowSdt=function(e,t,n){var r;return!!e.property.isRow&&!h.ROW_DISABLE_TYPE.has(n.name)&&!h.ROW_DISABLE_TYPE.has(null!==(r=null==t?void 0:t.matchPoint)&&void 0!==r?r:"")},e.prototype.isAllowInRichTextContent=function(e,t,n,r){var o,i;return!!e.property.isRichTextContent&&(r.selection.sdt.isInline?h.RICH_TEXT_INLINE_ALLOW_TYPE.has(n.name)||h.RICH_TEXT_INLINE_ALLOW_TYPE.has(null!==(o=null==t?void 0:t.matchPoint)&&void 0!==o?o:""):!h.RICH_TEXT_BLOCK_DISABLE_TYPE.has(n.name)&&!h.RICH_TEXT_BLOCK_DISABLE_TYPE.has(null!==(i=null==t?void 0:t.matchPoint)&&void 0!==i?i:""))},e.prototype.isAllowInPlainTextContent=function(e,t,n){var r;return!!e.property.isPlainTextContent&&(h.PLAIN_TEXT_ALLOW_TYPE.has(n.name)||h.PLAIN_TEXT_ALLOW_TYPE.has(null!==(r=null==t?void 0:t.matchPoint)&&void 0!==r?r:""))},e.prototype.isAllowInCommon=function(e,t,n,r){var o;return!(!r.selection.sdt.isInSdt||!r.selection.getSdtSelection().isEditDisabledType(null,e)||!h.COMMON_ALLOW_TYPE.has(n.name)&&!h.COMMON_ALLOW_TYPE.has(null!==(o=null==t?void 0:t.matchPoint)&&void 0!==o?o:""))},e.prototype.isAllowInWrappedSdt=function(e,t){return t.selection.getSdtSelection().isWrappedSdtByRange(null,e)},e.prototype.use=function(e,t,n,r){var o;if(e.from!==u.v.CONTEXT_MENU)return!1;if(!(null===(o=null==r?void 0:r.selection)||void 0===o?void 0:o.sdt))return!1;var i=r.selection.sdt.activeSdts[0];return!(!i||v(r,i)||this.isAllowInCommon(i,e,t,r)||this.isAllowInPlainTextContent(i,e,t)||this.isAllowInWrappedSdt(i,r)||this.isAllowInRichTextContent(i,e,t,r)||this.isAllowInRowSdt(i,e,t)||(n(),0))},(0,r.__decorate)([(0,r.__param)(0,(0,i.g)()),(0,r.__param)(1,(0,a.z)()),(0,r.__param)(2,(0,s.o)()),(0,r.__param)(3,(0,c.M)()),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",["function"==typeof(t=void 0!==o.IActionPointInfo&&o.IActionPointInfo)?t:Object,"function"==typeof(n=void 0!==o.ToolbarConfig&&o.ToolbarConfig)?n:Object,Object,"function"==typeof(p=void 0!==d.MeloEditor&&d.MeloEditor)?p:Object]),(0,r.__metadata)("design:returntype",void 0)],e.prototype,"use",null),e=(0,r.__decorate)([(0,l.d)()],e)}(),b=function(){function e(){}var t;return e.prototype.isDisableInCommon=function(e,t){return!(!t.selection.sdt.isInSdt||!t.selection.getSdtSelection().isEditDisabledType(null,e))},e.prototype.use=function(e,t){var n;if(!(null===(n=null==t?void 0:t.selection)||void 0===n?void 0:n.sdt))return!1;var r=t.selection.sdt.activeSdts[0];return!(!r||v(t,r)||!this.isDisableInCommon(r,t)||(e(),0))},(0,r.__decorate)([(0,r.__param)(0,(0,s.o)()),(0,r.__param)(1,(0,c.M)()),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object,"function"==typeof(t=void 0!==d.MeloEditor&&d.MeloEditor)?t:Object]),(0,r.__metadata)("design:returntype",void 0)],e.prototype,"use",null),e=(0,r.__decorate)([(0,l.d)()],e)}(),E=(function(){function e(){}var t;e.prototype.use=function(e,t){var n;if(!(null===(n=null==t?void 0:t.selection)||void 0===n?void 0:n.sdt))return!1;var r=t.selection.sdt.activeSdts[0];return!(!r||v(t,r)||!r.property.isRichTextContent||!t.selection.sdt.isInline||(e(),0))},(0,r.__decorate)([(0,r.__param)(0,(0,s.o)()),(0,r.__param)(1,(0,c.M)()),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object,"function"==typeof(t=void 0!==d.MeloEditor&&d.MeloEditor)?t:Object]),(0,r.__metadata)("design:returntype",void 0)],e.prototype,"use",null),e=(0,r.__decorate)([(0,l.d)()],e)}(),function(){function e(){}var t;e.prototype.use=function(e,t){var n;if(!(null===(n=null==t?void 0:t.selection)||void 0===n?void 0:n.sdt))return!1;var r=t.selection.sdt.activeSdts[0];return!(!r||v(t,r)||!r.property.isRichTextContent||r.property.isRichTextContent||(e(),0))},(0,r.__decorate)([(0,r.__param)(0,(0,s.o)()),(0,r.__param)(1,(0,c.M)()),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object,"function"==typeof(t=void 0!==d.MeloEditor&&d.MeloEditor)?t:Object]),(0,r.__metadata)("design:returntype",void 0)],e.prototype,"use",null),e=(0,r.__decorate)([(0,l.d)()],e)}(),function(){function e(){}var t;return e.prototype.use=function(e,t){var n;if(!(null===(n=null==t?void 0:t.selection)||void 0===n?void 0:n.sdt))return!1;var r=t.selection.sdt.activeSdts[0];return!(!r||v(t,r)||!r.property.isPlainTextContent||(e(),0))},(0,r.__decorate)([(0,r.__param)(0,(0,s.o)()),(0,r.__param)(1,(0,c.M)()),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object,"function"==typeof(t=void 0!==d.MeloEditor&&d.MeloEditor)?t:Object]),(0,r.__metadata)("design:returntype",void 0)],e.prototype,"use",null),e=(0,r.__decorate)([(0,l.d)()],e)}()),C=function(){function e(){}var t,n;return e.prototype.use=function(e,t){if(!e||!(0,g.B)(e))return!1;var n=e.selection.sdt.activeSdts[0];return!(!n||v(e,n)||!e.state.selection.getSdtSelection().isEditDisabledType()||(t(),0))},(0,r.__decorate)([(0,r.__param)(0,(0,c.M)()),(0,r.__param)(1,(0,s.o)()),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",["function"==typeof(t=void 0!==d.MeloEditor&&d.MeloEditor)?t:Object,"function"==typeof(n=void 0!==o.IStopAction&&o.IStopAction)?n:Object]),(0,r.__metadata)("design:returntype",void 0)],e.prototype,"use",null),e=(0,r.__decorate)([(0,l.d)()],e)}(),w=function(){function e(){}var t;return e.prototype.use=function(e,t){var n;if(!t||!(0,g.B)(t))return!1;var r=null===(n=t.service)||void 0===n?void 0:n.getSelection().range();if(!r)return!1;var o=t.state.getDataStream().getStoryStream().getSubStoryInfoFromGcp(r.begin()),i=o&&o.subStoryProp;return!!(o&&o.storyProp.storyType===d.STStoryType.textboxContent&&i instanceof d.PropertyFactory.getPropertyClass(d.PropertyType.TextboxStoryProperty)&&(i.isCodeBlock||i.isLightBlock))&&(e(),!0)},(0,r.__decorate)([(0,r.__param)(0,(0,s.o)()),(0,r.__param)(1,(0,c.M)()),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object,"function"==typeof(t=void 0!==d.MeloEditor&&d.MeloEditor)?t:Object]),(0,r.__metadata)("design:returntype",void 0)],e.prototype,"use",null),e=(0,r.__decorate)([(0,l.d)()],e)}()},734156:function(e,t,n){n.d(t,{bn:function(){return s},kR:function(){return u},kU:function(){return c},nB:function(){return d}});var r=n(839461),o=n(259356),i=n(584985),a=n(865213);function s(e){var t=this;return e.map((function(e){return new Promise((function(n){var r,a;(null===(r=t[e])||void 0===r?void 0:r.isReady)?n(!0):null===(a=t[e])||void 0===a||a.getModule().then((function(e){o.Am.get(i.U).mount([e]),n(!0)}))}))}))}function c(e){var t=this;return e.reduce((function(e,n){var r;return e&&(null===(r=t[n])||void 0===r?void 0:r.isReady)}),!0)}function l(e){}function u(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length&&e.push("loader"),function(t,n,o){void 0===o&&(o=(0,a.yH)(t,n));var i=o.value;o.value=function(){for(var t=this,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var a=c.call(this,e);if(a)return i.call.apply(i,(0,r.__spreadArray)([this],(0,r.__read)(n),!1));Promise.all(s.call(this,e)).then((function(){i.call.apply(i,(0,r.__spreadArray)([t],(0,r.__read)(n),!1)),a||l.call(t,e)}))}}}function d(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length&&e.push("loader"),function(t,n,o){void 0===o&&(o=(0,a.yH)(t,n));var i=o.value;o.value=function(){for(var t=this,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var a=c.call(this,e);return Promise.all(s.call(this,e)).then((function(){return a||l.call(t,e),i.call.apply(i,(0,r.__spreadArray)([t],(0,r.__read)(n),!1))}))}}}n(750670),n(495155)},252038:function(e,t,n){n.d(t,{J:function(){return r}});var r=function(){function e(){this._measure=document.createElement("div"),this.setInvisible(),document.body.appendChild(this._measure)}return e.prototype.setInvisible=function(){this._measure.style.display="none"},e.prototype.clear=function(){this._measure.innerHTML="",this._measure.removeAttribute("style"),this._measure.removeAttribute("class")},e.prototype.reset=function(){this.setInvisible()},e.prototype.attachStyle=function(e){var t=this;e.classname&&this._measure.classList.add(e.classname),e.style&&Object.keys(e.style).forEach((function(n){t._measure.style[n]=e.style[n]}))},e.prototype.getText=function(e,t){return t?t.replace(/%0/g,e):e},e.prototype.wrapWidth=function(e,t,n,r,o){void 0===r&&(r="..."),this.attachStyle(n),this.setInvisible(),this._measure.style.whiteSpace="nowrap";var i=this.getText(e,o);if(this._measure.innerText=i,this._measure.clientWidth>t)for(var a=e.substr(0,e.length-1);a.length>0&&(a=a.substr(0,a.length-1),i=this.getText("".concat(a).concat(r),o),this._measure.innerText=i,!(this._measure.clientWidth<t)););var s=this._measure.innerText;return this.reset(),s},e.prototype.wrapLine=function(e,t,n,r,o,i){void 0===o&&(o="..."),void 0===i&&(i=!0),this.attachStyle(r),this.setInvisible(),this._measure.style.width="".concat(t,"px"),this._measure.style.wordBreak="break-all",this._measure.style.whiteSpace="pre-wrap";var a=e.split("");this._measure.innerHTML="<span>".concat(o,"</span>\n").concat(a.map((function(e){return"<span>".concat(e,"</span>")})).join(""));for(var s=this._measure.firstElementChild,c=s.offsetWidth,l=s.offsetTop,u=-1,d=-1;s;){if(s.offsetTop>l&&(d+=1,l=s.offsetTop),d>=n){u-=1;break}if(d===n-1&&("\n"===s.innerHTML||s.offsetLeft+s.offsetWidth+c>t))break;u+=1,s=s.nextElementSibling}if(this.reset(),u===e.length)return e;var p=e.substr(0,u);return i?"".concat(p).concat(o):p},e}()},505586:function(e,t,n){n.d(t,{S:function(){return a},q:function(){return s}});var r=n(839461),o=n(750670),i=n(495155),a=function(){function e(){}return e.isInLiteTableCell=function(e){for(;e;){if((0,o.isTableCellLite)(e))return!0;e=e.parentBox}return!1},e.getTableCellWidth=function(e){if((0,o.isTableCellLite)(e)&&e.property&&e.parentBox&&e.parentBox.parentBox)return o.TablePropertyUtil.getWidth(e.property.tcW)},e.getParaSectionAndSpanProp=function(e){var t,n,r,o,i,a,s,c,l=e.parentBox,u=null===(t=e.parentBox)||void 0===t?void 0:t.parentBox;if(s=null===(n=e.parentBox)||void 0===n?void 0:n.property,a=null===(o=null===(r=e.parentBox)||void 0===r?void 0:r.parentBox)||void 0===o?void 0:o.property,c=null===(i=e.content)||void 0===i?void 0:i.property,s&&a&&l&&u)return{paraProp:s,paraBox:l,sectionOrTableCellProp:a,sectionOrTableCellBox:u,spanProp:c}},e.calcLiteBoxMaxWidth=function(e,t){var n=t.paddingLeft+t.paddingRight+t.marginLeft+t.marginRight,r=this.getParaSectionAndSpanProp(e),a=0;if(!r)return-1;var s=r.paraProp,c=r.sectionOrTableCellProp,l=r.paraBox,u=r.sectionOrTableCellBox,d=o.CssUtil.getFirstCharacterFontSize(l),p=o.CssUtil.getSpecialIndent(s,d),f=s.ind,h=f.left;0!==f.leftChars&&(h=f.leftChars*o.Defaults.fontSize);var m=f.right;if(0!==f.rightChars&&(m=f.rightChars*o.Defaults.fontSize),c instanceof o.PropertyFactory.getPropertyClass(o.PropertyType.SectionProperty))a=(0,i.twipsToPx)(c.pgSz.w-c.pgMar.left-c.pgMar.left-h-m-p)-n;else{var g=this.getTableCellWidth(u);g&&(a=(0,i.twipsToPx)(g-h-m-p)-n)}return a},e.getLiteStyle=function(e,t){var n=this.getParaSectionAndSpanProp(e);if(!n)return{};var o=n.spanProp,i=this.calcLiteBoxMaxWidth(e,t);i<0&&(i="none");var a=o?{color:o.color.val}:{};return(0,r.__assign)((0,r.__assign)((0,r.__assign)({},t),a),{maxWidth:i,verticalAlign:"text-bottom"})},e}(),s=function(){function e(){}return e.getCanvasStyle=function(e,t){var n=0,a="none",s=e.getAncestorOf(o.BoxKind.TableCell),c=e.getAncestorOf(o.BoxKind.RichTextArea);if(s&&c){var l=c.edge;n=(0,i.twipsToPx)(l.padding.left),l.recycle()}return t&&(n=t.paddingLeft+t.paddingRight+t.marginLeft+t.marginRight),s&&(a=(0,i.twipsToPx)(s.totalWidth)-n),(0,r.__assign)((0,r.__assign)({},t),{maxWidth:a,display:"flex",whiteSpace:"nowrap"})},e}()},445955:function(e,t,n){n.d(t,{Sw:function(){return o},bW:function(){return i}});var r=function(e,t){return"".concat(encodeURIComponent(e),"=").concat(encodeURIComponent("object"==typeof t?JSON.stringify(t):t))};function o(e){var t=[];return Object.keys(e).forEach((function(n){e[n]instanceof Array?e[n].forEach((function(e){t.push(r(n,e))})):t.push(r(n,e[n]))})),t.join("&")}function i(){var e=navigator.userAgent.toLowerCase().match(/wxwork\/([0-9.]*)/);return e?e[1]:""}},165168:function(e,t,n){n.d(t,{Mu:function(){return i},Nc:function(){return c},ZN:function(){return a},hr:function(){return s}});var r=n(750670),o=function(e,t){if(e===r.MutationType.is){var n=t;return{gcp:i=n.beginIndex,delta:n.text.length}}if(e===r.MutationType.ds){var o=t,i=o.beginIndex,a=o.endIndex;return{gcp:a,delta:i-a}}return null},i=function(e){var t=[];return e.forEach((function(e){var n=e.type,i=o(n,e);i&&t.push(i),n===r.MutationType.mlti&&e.content.forEach((function(e){var n=o(e.type,e);n&&t.push(n)}))})),t},a=function(e,t){var n=e;return t.forEach((function(e){n=function(e,t){var n=e,r=t.gcp,o=t.delta;return o>0&&n>=r?n+=o:o<0&&(n>=r?n+=o:n>=r+o&&(n=r+o)),n}(n,e)})),n},s=function(e,t){var n=e;return t.reverse().forEach((function(e){n=function(e,t){var n=e,r=t.gcp,o=t.delta;return(o>0&&n-o>=r||o<0&&n>=r+o)&&(n-=o),n}(n,e)})),n};function c(e){var t=[];return e.forEach((function(e){var n=e.changeset;null==n||n.forEach((function(e){e.mutations.forEach((function(e){t.push(e.mutation)}))}))})),t}},341524:function(e,t,n){n.d(t,{z:function(){return v}});var r=n(839461),o=n(223336),i=n.n(o),a=n(750670),s=n(139306),c=n(495155),l=n(462086),u=n.n(l),d=n(641415);function p(e){var t=[];return Object.keys(e).map((function(n){var r=e[n];Array.isArray(r)?r.forEach((function(e){t.push("".concat(encodeURIComponent(n),"=").concat(encodeURIComponent(e)))})):void 0!==r&&t.push("".concat(encodeURIComponent(n),"=").concat(encodeURIComponent(r)))})),t.join("&")}function f(e,t){var n,o;return(0,r.__awaiter)(this,void 0,void 0,(function(){var i,a,s,l;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:if(i=t.rsp.filter((function(e){return e.wedriveUin})),!(a=i.map((function(e){return e.wedriveUin}))).length)return[2,t];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,d.Z.post("/wedoc/doc_member_mgr",p({docid:e.padId,scode:(0,c.getUrlParameter)("scode")||"",func:8,wx_uin:a}))];case 2:return s=r.sent().data,0===(null===(n=s.head)||void 0===n?void 0:n.ret)&&(null===(o=s.body)||void 0===o?void 0:o.uin2xid)&&s.body.uin2xid.forEach((function(e){var t=i.findIndex((function(t){return t.wedriveUin===e.uin}));t>=0&&(i[t].xid=e.xid.toString())})),[3,4];case 3:return l=r.sent(),console.error(l),[3,4];case 4:return[2,t]}}))}))}function h(e,t){var n="[".concat(t.join(","),"]");return"[]"===n||!e.isLogin||e.userId.startsWith("g")?Promise.resolve({rsp:[]}):new Promise((function(t,r){i().ajax({url:"/sdc/getusermarkname",xhrFields:{withCredentials:!0},data:u().stringify({bkn:s.v.getBkn(),domainId:e.domainId,localPadId:e.localPadId,uids:n,xsrf:(0,a.getXsrf)()}),success:function(e){e&&0===e.retcode?t(e.result):r()},error:function(){r()}})}))}function m(e,t){return(0,r.__awaiter)(this,void 0,Promise,(function(){var e,n;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return t.filter((function(e){return e.startsWith("14")})).length,[2,{tinyIdToWedriveUin:{},wedriveUinToTinyId:{}}];case 1:return r.sent().rsp.forEach((function(t){t.wedriveUin&&(e[t.uid]=t.wedriveUin,n[t.wedriveUin]=t.uid)})),[2,{tinyIdToWedriveUin:e,wedriveUinToTinyId:n}]}}))}))}function g(e,t){var n,o;return(0,r.__awaiter)(this,void 0,void 0,(function(){var i,a,s,c,l,u;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return"[]"==="[".concat(t.join(","),"]")||!e.isLogin||e.userId.startsWith("g")?[2,{rsp:[]}]:[4,m(0,t)];case 1:i=r.sent(),a=i.tinyIdToWedriveUin,s=i.wedriveUinToTinyId,c=p({func:1,f:"json",auth_list:JSON.stringify({info:t.map((function(e){return{id:a[e]||e}}))})}),r.label=2;case 2:return r.trys.push([2,4,,5]),[4,d.Z.post("/webdisk/member_info",c,{withCredentials:!0})];case 3:return l=r.sent(),[3,5];case 4:return u=r.sent(),console.error(u),[3,5];case 5:return 0===(null===(n=null==l?void 0:l.data.head)||void 0===n?void 0:n.ret)&&(null===(o=null==l?void 0:l.data.body)||void 0===o?void 0:o.member)?[4,f(e,{rsp:l.data.body.member.map((function(e){return{markName:e.english_name&&e.real_name?"".concat(e.english_name,"(").concat(e.real_name,")"):e.name,userId:s[e.id]||e.id||e.vid.toString(),uid:s[e.id]||e.id||e.vid.toString(),userPic:e.avatar,corpName:e.corp_name||"",wedriveUin:s[e.id]?a[s[e.id]]:void 0}}))})]:[3,7];case 6:return[2,r.sent()];case 7:return[2,Promise.resolve({rsp:[]})]}}))}))}var v=function(){function e(){}return e.getRemark=function(e,t,n){return void 0===n&&(n=!1),(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(r){return[2,n?g(e,t):h(e,t)]}))}))},e}()},253879:function(e,t,n){n.d(t,{Ep:function(){return i},HJ:function(){return o},R0:function(){return r}});var r="commit-changes-contain-revert",o="changeset-error-alert",i="how-to-deal-copy-all-data"},434320:function(e,t,n){n.r(t),n.d(t,{IAddMobileFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(293325),a=n(870372),s=Symbol.for("feature:".concat(a.C.AdMobile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(8794).then(n.bind(n,432171))];case 1:return[2,e.sent().AdMobileHandler]}}))}))},on:i.iz.On({key:s,stages:[i.YV.Level2],platforms:[i.Ev.Pad,i.Ev.Mobile],load:!1})})},22405:function(e,t,n){n.r(t),n.d(t,{IAddCooperator:function(){return a}});var r=n(839461),o=n(259356),i=n(870372),a=Symbol.for("feature:".concat(i.C.AddCooperator));o.Ln.merge(a,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(5797).then(n.bind(n,317244))];case 1:return[2,e.sent().AddCollabStatusEntHandler]}}))}))}})},872302:function(e,t,n){n.r(t),n.d(t,{IAddFastAccessFeature:function(){return a}});var r=n(839461),o=n(259356),i=n(870372),a=Symbol.for("feature:".concat(i.C.AddFastAccess));o.Ln.merge(a,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(1474).then(n.bind(n,998514))];case 1:return[2,e.sent().AddFastAccessHandler]}}))}))}})},212553:function(e,t,n){n.r(t),n.d(t,{IAddToWedriveFeature:function(){return s},WeDriveStatus:function(){return r}});var r,o=n(839461),i=n(259356),a=n(870372);!function(e){e.External="external",e.Internal="internal"}(r||(r={}));var s=Symbol.for("feature:".concat(a.C.AddToWedrive));i.Ln.merge(s,{useFactory:function(){return(0,o.__awaiter)(void 0,void 0,void 0,(function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(5173).then(n.bind(n,701774))];case 1:return[2,e.sent().AddToWedriveHandler]}}))}))}})},192309:function(e,t,n){n.r(t),n.d(t,{IAddonMobileIframeFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=(n(495155),Symbol.for("feature:".concat(i.C.AddonMobileIframe)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5597),n.e(9820),n.e(5660)]).then(n.bind(n,783490))];case 1:return[2,e.sent().AddonMobileIframeHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2,a.YV.Publish],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad],load:!0})})},958890:function(e,t,n){n.r(t),n.d(t,{IAddonPasteHandler:function(){return s}});var r=n(839461),o=n(259356),i=n(293325),a=n(870372),s=Symbol.for("feature:".concat(a.C.AddonPaste));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5597),n.e(9820),n.e(7797),n.e(5049),n.e(8063),n.e(823),n.e(3974),n.e(4397),n.e(7021),n.e(7131)]).then(n.bind(n,988568))];case 1:return[2,e.sent().AddonPasteHandler]}}))}))},on:i.iz.On({stages:[i.YV.Level3],key:s,platforms:[i.Ev.Pc]})})},448392:function(e,t,n){n.r(t),n.d(t,{IAirPrintFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.AirPrint));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5070),n.e(9440),n.e(5597),n.e(9820),n.e(6649),n.e(6922),n.e(5049),n.e(8063),n.e(6205),n.e(8971),n.e(823),n.e(1997),n.e(9140),n.e(2557),n.e(3974),n.e(2878),n.e(2340),n.e(4292),n.e(4397),n.e(4427),n.e(5576),n.e(520)]).then(n.bind(n,673150))];case 1:return[2,e.sent().AirPrintHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2,a.YV.Publish],key:s})})},975084:function(e,t,n){n.r(t),n.d(t,{IAppGuideFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=(n(495155),Symbol.for("feature:".concat(i.C.AppGuide)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(4573).then(n.bind(n,379672))];case 1:return[2,e.sent().AppGuideHandler]}}))}))},on:a.iz.On({stages:[a.YV.Publish,a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad],load:!0})})},726979:function(e,t,n){n.r(t),n.d(t,{IAppGuidePcFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.AppGuidePc));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(848).then(n.bind(n,738727))];case 1:return[2,e.sent().AppGuidePcHandler]}}))}))},on:a.iz.On({stages:[a.YV.Publish],key:s,platforms:[a.Ev.Pc]})})},699382:function(e,t,n){n.r(t),n.d(t,{IAttachmentFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=(n(495155),Symbol.for("feature:".concat(i.C.Attachment)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5597),n.e(9820),n.e(7797),n.e(5049),n.e(8063),n.e(823),n.e(3974),n.e(4397),n.e(7021),n.e(7131)]).then(n.bind(n,893600))];case 1:return[2,e.sent().AttachmentHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3,a.YV.Publish],key:s,load:!0})})},172295:function(e,t,n){var r,o,i;n.d(t,{Ad:function(){return o},Wg:function(){return r},pJ:function(){return i}}),function(e){e.DOWNLOAD_FILE="downloadFile",e.SWITCH_MODE="switchMode",e.DELETE="delete",e.VIEW_FILE="viewFile",e.DOWNLOAD_FILE_WITH_DROPDOWN="downloadFileWithDropdown"}(r||(r={})),function(e){e[e.TEXT=0]="TEXT",e[e.INLINE=1]="INLINE",e[e.CARD=2]="CARD",e[e.PREVIEW=3]="PREVIEW"}(o||(o={})),function(e){e.Delete="st-button-delete",e.Download="st-button-download",e.VIP="st-button-vip"}(i||(i={}))},156317:function(e,t,n){n.d(t,{BK:function(){return r},CF:function(){return y},CX:function(){return _},Ri:function(){return E},Yo:function(){return v},c$:function(){return b},sn:function(){return f},yS:function(){return p}});var r,o=n(839461),i=n(750670),a=n(495155),s=n(458524),c=n(172295),l=n(240155),u=n(339106),d=n(259356);function p(e){var t,n,o,a,c,l,u=e.switches,d=void 0===u?{}:u,p=e.instructions,f=void 0===p?[]:p,h=null!==(t=d[r.FILENAME])&&void 0!==t?t:"",m=null!==(n=d[r.FILETYPE])&&void 0!==n?n:"",g=null!==(o=d[r.SIZE])&&void 0!==o?o:"",v=null!==(a=d[r.LAYOUT_TYPE])&&void 0!==a?a:i.FieldDisplayLayoutTypeChar.Inline,_=null!==(c=d[r.FILE_ID])&&void 0!==c?c:"",y=null!==(l=d[r.CLASSIFY])&&void 0!==l?l:s.FY.DOC;return{objectKey:null==f?void 0:f[0],filename:h,size:g,filetype:m,displayLayoutType:v,fileId:_,classify:y}}function f(e){return p(e.fieldCode)}function h(e){var t,n=e.objectKey,o=e.filename,i=e.size,a=e.filetype,s=e.displayLayoutType,c=e.fileId,l=e.classify,u=n?[n]:[];return{switches:(t={},t[r.FILENAME]=o,t[r.SIZE]=i,t[r.FILETYPE]=a,t[r.LAYOUT_TYPE]=s,t[r.FILE_ID]=c,t[r.CLASSIFY]=l,t),instructions:u}}!function(e){e.FILENAME="f",e.SIZE="s",e.FILETYPE="t",e.LAYOUT_TYPE="l",e.FILE_ID="i",e.CLASSIFY="c"}(r||(r={}));var m={overflow:"hidden",textOverflow:"ellipsis",width:"100%",height:"100%",wordBreak:"break-all",whiteSpace:"nowrap"};function g(e,t){void 0===t&&(t={});var n=(0,i.isFieldBox)(e)||function(e){return(0,i.isFieldContainerBox)(e)||(0,i.isContainerBoxLite)(e)}(e)?e:e.content.property,r=i.CssUtil.computeStyles(n);return(0,o.__assign)((0,o.__assign)((0,o.__assign)({},t),i.CssUtil.cssPropsToStyle(r.cssProperties)),{textDecoration:"none",lineHeight:"initial"})}function v(e){var t=g(e,m),n=t.fontSize,r=t.fontSize;return{".text-link":t,".file-icon":{height:n,width:r},".icon-wrapper":{height:n,width:r,minHeight:n,minWidth:r,maxHeight:n,maxWidth:r,paddingLeft:"6px",marginTop:0,marginBottom:0},".attachment-wrapper":(0,o.__assign)({height:"100%"},(0,l.$x)(e))}}function _(e){var t="auto";(0,i.isFieldBox)(e)?t=(0,a.twipsToPx)(e.rect.height):(0,i.isFieldContainerBox)(e)?t=(0,a.twipsToPx)(e.totalHeight)-2:(0,i.isContainerBoxLite)(e)&&(t=(0,a.twipsToPx)(e.property.inlineKeyword.extent.cy));var n="100%";return{".attachment-video-wrapper":{height:t,width:n},".attachment-picture-wrapper":{height:t,width:n},".attachment-audio-wrapper":{height:t,width:n},".attachment-card-wrapper":{height:t,width:n}}}function y(e){var t=d.Am.get(u.D),n=(0,o.__read)(t.getFieldByRange(e),1)[0];return n?p(n.fieldCode):null}function b(e,t){void 0===t&&(t={});var n=h(e),r=n.switches,a=n.instructions;return i.FieldUtil.encodeFieldCode(i.FieldName.ATTACHMENT,a,(0,o.__assign)((0,o.__assign)({},r),t))}function E(e){var t;switch(e){case c.Ad.TEXT:t=i.FieldDisplayLayoutTypeChar.Text;break;case c.Ad.INLINE:t=i.FieldDisplayLayoutTypeChar.Inline;break;case c.Ad.CARD:t=i.FieldDisplayLayoutTypeChar.Card;break;case c.Ad.PREVIEW:t=i.FieldDisplayLayoutTypeChar.Preview}return t}},557317:function(e,t,n){n.r(t),n.d(t,{IAutoNewlineFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.AutoNewline));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5070),n.e(9440),n.e(5597),n.e(9820),n.e(6649),n.e(6922),n.e(5049),n.e(8063),n.e(6205),n.e(8971),n.e(823),n.e(1997),n.e(9140),n.e(2557),n.e(3974),n.e(2878),n.e(2340),n.e(4292),n.e(4397),n.e(4427),n.e(5576),n.e(520)]).then(n.bind(n,666939))];case 1:return[2,e.sent().AutoNewlineHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Pc]})})},962886:function(e,t,n){n.r(t),n.d(t,{IBasicFormatFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.BasicFormat));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5597),n.e(9820),n.e(7797),n.e(5049),n.e(8063),n.e(823),n.e(3974),n.e(4397),n.e(7021),n.e(7131)]).then(n.bind(n,840707))];case 1:return[2,e.sent().BasicFormatHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s})})},652915:function(e,t,n){n.r(t),n.d(t,{IBottomBarMobileFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(293325),a=n(870372),s=(n(495155),Symbol.for("feature:".concat(a.C.BottomBar)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(3692).then(n.bind(n,184087))];case 1:return[2,e.sent().BottomBarHandler]}}))}))},on:i.iz.On({key:s,stages:[i.YV.Level2,i.YV.Publish],platforms:[i.Ev.Mobile,i.Ev.Pad],load:!0})})},246053:function(e,t,n){n.r(t),n.d(t,{ICertificationFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=(n(495155),Symbol.for("feature:".concat(i.C.Certification)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8487),n.e(5597),n.e(9820),n.e(1315),n.e(6922),n.e(6205),n.e(823),n.e(9111),n.e(1997),n.e(9140),n.e(9700),n.e(9445)]).then(n.bind(n,274671))];case 1:return[2,e.sent().CertificationHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level4],key:s,platforms:[a.Ev.Pc],load:!0})})},817957:function(e,t,n){n.r(t),n.d(t,{ICertificationMobileFeature:function(){return s}});var r=n(839461),o=(n(495155),n(259356)),i=n(293325),a=n(870372),s=Symbol.for("feature:".concat(a.C.CertificationMobile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(3886).then(n.bind(n,532912))];case 1:return[2,e.sent().CertificationMobileHandler]}}))}))},on:i.iz.On({stages:[i.YV.Level4],key:s,platforms:[i.Ev.Mobile,i.Ev.Pad],load:!0})})},942412:function(e,t,n){n.r(t),n.d(t,{ICollabCaretFeature:function(){return l}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=n(317999),c=n(669144),l=Symbol.for("feature:".concat(i.C.CollabCaret));o.Ln.merge(l,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(1337).then(n.bind(n,972036))];case 1:return[2,e.sent().CollabCaretHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:l,load:!s.A.isTencentMeetingInWework()&&!c.W.isApiDoc})})},94809:function(e,t,n){n.r(t),n.d(t,{ICollabStatusMobileFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=(n(495155),Symbol.for("feature:".concat(i.C.CollabStatusMobile)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(5697).then(n.bind(n,961563))];case 1:return[2,e.sent().CollabStatusMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Pad,a.Ev.Mobile],load:!0})})},842604:function(e,t,n){n.r(t),n.d(t,{ICollaboratorDetailMobileFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=(n(495155),Symbol.for("feature:".concat(i.C.CollaboratorDetailMobile)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(8728).then(n.bind(n,990418))];case 1:return[2,e.sent().CollaboratorDetailMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad],load:!1})})},467320:function(e,t,n){n.r(t),n.d(t,{ICollectMobileFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(293325),a=n(870372),s=(n(495155),Symbol.for("feature:".concat(a.C.CollectMobile)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(4732).then(n.bind(n,327366))];case 1:return[2,e.sent().CollectMobileHandler]}}))}))},on:i.iz.On({key:s,stages:[i.YV.Level2],platforms:[i.Ev.Pad,i.Ev.Mobile],load:!1})})},14813:function(e,t,n){n.r(t),n.d(t,{IColorFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.Color));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5597),n.e(9820),n.e(7797),n.e(5049),n.e(8063),n.e(823),n.e(3974),n.e(4397),n.e(7021),n.e(7131)]).then(n.bind(n,455641))];case 1:return[2,e.sent().ColorHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s})})},931021:function(e,t,n){n.r(t),n.d(t,{IColumnFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(293325),a=n(870372),s=Symbol.for("feature:".concat(a.C.Column));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5597),n.e(9820),n.e(7797),n.e(5049),n.e(8063),n.e(823),n.e(3974),n.e(4397),n.e(7021),n.e(7131)]).then(n.bind(n,382255))];case 1:return[2,e.sent().ColumnHandler]}}))}))},on:i.iz.On({key:s,stages:[i.YV.Level3],platforms:[i.Ev.Pc]})})},584952:function(e,t,n){n.r(t),n.d(t,{ICommentMobileFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=(n(495155),Symbol.for("feature:".concat(i.C.CommentMobile)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(2878),n.e(4427),n.e(9290)]).then(n.bind(n,793698))];case 1:return[2,e.sent().CommentMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad],load:!0})})},96630:function(e,t,n){n.r(t),n.d(t,{ICopyPasteProcessorFeature:function(){return s}});var r=n(839461),o=(n(495155),n(259356)),i=n(293325),a=n(870372),s=Symbol.for("feature:".concat(a.C.CopyPasteProcessor));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5597),n.e(9820),n.e(7797),n.e(5049),n.e(8063),n.e(823),n.e(3974),n.e(4397),n.e(7021),n.e(7131)]).then(n.bind(n,449444))];case 1:return[2,e.sent().CopyPasteProcessorHandler]}}))}))},on:i.iz.On({key:s,stages:[i.YV.Level3,i.YV.Publish],platforms:[i.Ev.Pc,i.Ev.Mobile,i.Ev.Pad],load:!0})})},563577:function(e,t,n){n.r(t),n.d(t,{ICoreEditHandler:function(){return a}});var r=n(839461),o=n(259356),i=n(870372),a=Symbol.for("feature:".concat(i.C.CoreEdit));o.Ln.merge(a,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.resolve().then(n.bind(n,86680))];case 1:return[2,e.sent().CoreEditHandler]}}))}))}})},86680:function(e,t,n){n.r(t),n.d(t,{CoreEditHandler:function(){return ue}});var r,o=n(839461),i=n(87363),a=n.n(i),s=n(661533),c=n.n(s),l=n(750670),u=n(707605),d=n(218581),p=n(328413),f=n(73709),h=n(814808),m=n(202532),g=n(175257),v=n(798732),_=n(136454),y=n(234877),b=n(592698),E=n(259356),C=n(584985),w=n(947229),T=n(45972),A=n(495155),S=n(429020),I=n(97303),R=n(253879),M=n(6297),O=n(378898),N=function(e){function t(t){var n=e.call(this,t)||this;return n._permissionCode=["60007","60015"],n._docNoexistCode=["40001"],n.onClickRefresh=function(){window.location&&window.multiAccountUtil.reload()},n.onClickRefreshAndFix=function(){var e=n.state.blockInfo?n.state.blockInfo.errCode:"",t=document.createEvent("CustomEvent");t.initCustomEvent("Melo_ClearOfflineData",!0,!0,{isBackup:!0,code:e,callback:function(){var e,t;null===(t=null===(e=window.multiAccountUtil)||void 0===e?void 0:e.reload)||void 0===t||t.call(e)}}),document.dispatchEvent(t)},n.onClick2Fix=function(){n.hideModal(),n.showConfirmModal()},n.onClickStartFix=function(){A.Logger.warn("clear offline data!!");var e=n.state.blockInfo?n.state.blockInfo.errCode:"",t=document.createEvent("CustomEvent");t.initCustomEvent("Melo_ClearOfflineData",!0,!0,{isBackup:!0,code:e,callback:function(){var e,t;null===(t=null===(e=window.multiAccountUtil)||void 0===e?void 0:e.reload)||void 0===t||t.call(e)}}),document.dispatchEvent(t)},n.onClickContact=function(){var e=n.state.blockInfo?n.state.blockInfo.errCode:"";n.eventEmitter.emit("$requestFeedback",e)},n.onClickHow2Deal=function(){var e=document.createEvent("CustomEvent");e.initCustomEvent(R.Ep,!0,!0,{}),document.dispatchEvent(e),n.showModal()},n.onClickLearnMore=function(){window.open(window.multiAccountUtil.getMultiUrl("https://".concat(window.location.hostname,"/doc/DWE9lbGhWTU9OV2VF?localnum=1&wxsdk=2.7.7")))},n.onClickCreateDocCopy=function(){n._editor.fire(new v.l)},n.onClickDetail=function(){var e;m.default.confirm({title:(0,d.$t)("提示"),content:a().createElement("div",{style:{overflow:"auto",maxHeight:"500px"}},null===(e=n.state.blockInfo)||void 0===e?void 0:e.errDetail),footer:null})},n.doExport=function(){var e=n.contextService.context.editor;if(e&&e instanceof l.MeloEditor){var t=n.contextService.context.clientVars;n.eventEmitter.emit("$requestExport",{editor:e,clientVars:t})}},n.showModal=function(){var e=n.state.blockInfo?n.state.blockInfo.errCode:"";e&&(-1!==n._docNoexistCode.indexOf(e)||n._permissionCode.indexOf(e)),n._modal=m.default.confirm({title:(0,d.$t)("如何处理"),content:n.renderContent(),footer:null})},n.hideModal=function(){n._modal&&n._modal.close()},n.showConfirmModal=function(){n._confirmModal=m.default.confirm({title:(0,d.$t)("提示"),content:n.renderConfirmContent(),footer:null})},n.hideConfirmModal=function(){n._confirmModal&&n._confirmModal.close()},n._editor=n.props.editor,n.state={visible:!1},l.GlobalContext.once(b.f8.BEFORE_REPLACE_URL,n.destory.bind(n),n),n}var n,r,i,s;return(0,o.__extends)(t,e),t.prototype.destory=function(){this.removeListener(),this.hideModal(),this.hideConfirmModal(),this.setState({visible:!1,blockInfo:void 0})},t.prototype.componentDidMount=function(){var e=this;this._editor&&(this._editor.on(g.fW.ON_CHANGESET_COMMIT_REJECTED,(function(t){A.Logger.info("BlockUserEditModal, commit rejected: ".concat(JSON.stringify(t.blockInfo))),e.setState({visible:!0,blockInfo:t.blockInfo}),u.qO.getInstance().setPrivilege({isBlocked:!0,isShutdown:!0}),t.blockInfo&&t.blockInfo.duration&&setTimeout((function(){e.setState({visible:!1})}),t.blockInfo.duration>1e3?t.blockInfo.duration:1e3),e.errorCodeReport({errorCode:t.blockInfo.errCode||"",message:g.fW.ON_CHANGESET_COMMIT_REJECTED,snackbarMsg:t.blockInfo.errMsg||""}),l.ReportHelper.weiMonitorCube({module:l.ICubeModule.Websocket,name:t.blockInfo.errCode,action:t.blockInfo.errMsg,msg:t.blockInfo.errDetail,ver1:JSON.stringify(t.blockInfo.action)})}),this),this._editor.on(g.fW.ON_CHANGESET_CHECK_INVALID,(function(t){A.Logger.info("BlockUserEditModal, check invalid: ".concat(JSON.stringify(t.blockInfo))),e.setState({visible:!0,blockInfo:t.blockInfo}),u.qO.getInstance().setPrivilege({isBlocked:!0}),t.blockInfo&&t.blockInfo.duration&&setTimeout((function(){e.setState({visible:!1})}),t.blockInfo.duration>1e3?t.blockInfo.duration:1e3),e.errorCodeReport({errorCode:t.blockInfo.errCode||"",message:g.fW.ON_CHANGESET_CHECK_INVALID,snackbarMsg:t.blockInfo.errMsg||""})}),this),this._editor.on(g.fW.ON_DISMISS_BLOCK_USER_EDIT,(function(t){e.state.blockInfo&&e.state.blockInfo.errCode===t.target&&(e.setState({visible:!1}),(0,_.Yi)().isOverConNum=!1,u.qO.getInstance().setPrivilege({isBlocked:!1}))}),this),this._editor.on(g.fW.ON_DISMISS_BLOCK_OFFLINE_EDIT,(function(){e.setState({visible:!1}),u.qO.getInstance().setPrivilege({isBlocked:!1})}),this))},t.prototype.componentWillUnmount=function(){this.removeListener()},t.prototype.removeListener=function(){l.GlobalContext.removeListener(b.f8.BEFORE_REPLACE_URL,this),this._editor&&(this._editor.removeListener(g.fW.ON_CHANGESET_COMMIT_REJECTED,this),this._editor.removeListener(g.fW.ON_CHANGESET_CHECK_INVALID,this),this._editor.removeListener(g.fW.ON_DISMISS_BLOCK_USER_EDIT,this),this._editor.removeListener(g.fW.ON_DISMISS_BLOCK_OFFLINE_EDIT,this))},t.prototype.getNowFormatDate=function(){var e=new Date,t=e.getFullYear(),n=e.getMonth()+1,r=e.getDate();return n>=1&&n<=9&&(n="0".concat(n)),r>=0&&r<=9&&(r="0".concat(r)),t+"-"+n+"-"+r},t.prototype.renderContent=function(){var e=this.state.blockInfo?this.state.blockInfo.errCode:"",t=((0,d.$t)("为防止内容丢失，已复制全文到剪贴板，请粘贴到本地备份，再点击修复。"),(0,d.$t)("为防止内容丢失，已复制全文到剪贴板，请粘贴到本地或导出文件进行备份，再点击修复。")),n=((0,d.$t)("编辑权限已被收回，内容无法上传。为防止内容丢失，已复制全文到剪贴板，请粘贴到本地备份，再点击修复。"),(0,d.$t)("编辑权限已被收回，内容无法上传。为防止内容丢失，已复制全文到剪贴板，请粘贴到本地或导出文件进行备份，再点击修复。")),r=((0,d.$t)("文件已被创建者删除，内容无法上传。为防止内容丢失，已复制全文到剪贴板，请粘贴到本地备份，再点击修复。"),(0,d.$t)("文件已被创建者删除，内容无法上传。为防止内容丢失，已复制全文到剪贴板，请粘贴到本地或导出文件进行备份，再点击修复。"));return e&&-1!==this._permissionCode.indexOf(e)?t=n:e&&-1!==this._docNoexistCode.indexOf(e)&&(t=r),!e||-1===this._docNoexistCode.indexOf(e)&&this._permissionCode.indexOf(e),a().createElement("div",{style:{width:"100%"}},a().createElement("div",{style:{lineHeight:"15pt",marginTop:"15px"}},a().createElement("span",null,t)),a().createElement("div",{style:{marginTop:"5px"}},a().createElement("span",{style:{color:"darkgrey"}},e?(0,d.$t)("core-edit:error-code-with-date",{errCode:e,date:this.getNowFormatDate()}):"")),a().createElement("div",{style:{display:"flex",justifyContent:"space-between",marginTop:30}},this.showContact&&a().createElement("div",{style:{paddingTop:"7px",cursor:"pointer"},onClick:this.onClickContact},(0,d.$t)("联系我们")),a().createElement("div",{style:{display:"flex"}},a().createElement(y.default,{style:{marginRight:16},onClick:this.onClick2Fix},(0,d.$t)("修复")),a().createElement(y.default,{type:"primary",onClick:this.doExport},(0,d.$t)("导出文档")))))},t.prototype.renderConfirmContent=function(){return a().createElement("div",{style:{width:"100%"}},a().createElement("div",{style:{lineHeight:"15pt",marginTop:"15px"}},a().createElement("span",null,(0,d.$t)("修复过程将会清除本地缓存，可能造成部分内容丢失。请确认内容已备份到本地，再开始修复。"))),a().createElement("div",{style:{display:"flex",justifyContent:"space-between",marginTop:30}},this.showContact&&a().createElement("div",{style:{paddingTop:"7px",cursor:"pointer"},onClick:this.onClickContact},(0,d.$t)("联系我们")),a().createElement("div",{style:{display:"flex"}},a().createElement(y.default,{type:"primary",style:{marginRight:16},onClick:this.onClickStartFix},(0,d.$t)("开始修复")))))},t.prototype.render=function(){var e=this.state.blockInfo?this.state.blockInfo.errMsg:"",t="";this.state.blockInfo&&this.state.blockInfo.action&&(t=this.state.blockInfo.action.join(","));var n={},r="info";-1!==t.indexOf("".concat(g.S9.HOW2DEAL.toString()))&&(n={background:"rgb(255, 125, 111)",color:"white",zIndex:9997},r="error");var i=[];if(-1!==t.indexOf("".concat(g.S9.REFRESHANDFIX.toString())))i.push({text:(0,d.$t)("刷新"),onClick:this.onClickRefreshAndFix});else if(-1!==t.indexOf("".concat(g.S9.REFRESH.toString()))||-1!==t.indexOf("".concat(g.S9.BEGINEDIT.toString()))){var s=-1!==t.indexOf("".concat(g.S9.REFRESH.toString()))?(0,d.$t)("刷新"):(0,d.$t)("开始编辑");i.push({text:s,onClick:this.onClickRefresh})}else-1!==t.indexOf("".concat(g.S9.RELOGIN.toString()))&&i.push({text:(0,d.$t)("刷新"),onClick:this.loginService.login});this.showContact&&-1!==t.indexOf("".concat(g.S9.CONTACT.toString()))&&i.push({text:(0,d.$t)("联系我们"),onClick:this.onClickContact}),-1!==t.indexOf("".concat(g.S9.LEARNMORE.toString()))&&i.push({text:(0,d.$t)("了解详情"),onClick:this.onClickLearnMore}),-1!==t.indexOf("".concat(g.S9.CREATEDOCCOPY.toString()))&&i.push({text:(0,d.$t)("生成副本"),onClick:this.onClickCreateDocCopy}),-1!==t.indexOf("".concat(g.S9.HOW2DEAL.toString()))&&i.push({text:(0,d.$t)("如何处理"),onClick:this.onClickHow2Deal});var c=[a().createElement(h.default,{key:"block-user-edit-tips",style:n,action:i,type:r,visible:this.state.visible,closable:!1},e)];return a().createElement.apply(a(),(0,o.__spreadArray)(["div",null],(0,o.__read)(c),!1))},t.prototype.errorCodeReport=function(e){var t=e.errorCode,n=e.message,r=e.snackbarMsg,o=void 0===r?"":r,i=e.type,a=void 0===i?"error":i,s=e.tipsCustom,c=void 0===s?"":s,l=window.location.href,u={errorCode:t,message:n,padType:"doc",uid:(0,I.getUid)()||"",url:l,snackbarMsg:o,tipsCustom:c,type:a,isLogin:(0,_.Yi)().isLogin};(0,S.webLogAndEsReport)(u)},(0,o.__decorate)([(0,E.tB)(),(0,o.__metadata)("design:type","function"==typeof(n=void 0!==C.U&&C.U)?n:Object)],t.prototype,"featureService",void 0),(0,o.__decorate)([(0,E.tB)(),(0,o.__metadata)("design:type","function"==typeof(r=void 0!==w.v&&w.v)?r:Object)],t.prototype,"eventEmitter",void 0),(0,o.__decorate)([(0,E.tB)(),(0,o.__metadata)("design:type","function"==typeof(i=void 0!==T.O&&T.O)?i:Object)],t.prototype,"contextService",void 0),(0,o.__decorate)([(0,E.tB)(),(0,o.__metadata)("design:type","function"==typeof(s=void 0!==M.r&&M.r)?s:Object)],t.prototype,"loginService",void 0),(0,o.__decorate)([(0,O.D)("feature.core_edit.showContact",!0),(0,o.__metadata)("design:type",Boolean)],t.prototype,"showContact",void 0),t}(a().Component),k=n(768352),L=n(996391),D=n(522142),P=n(137600);function x(){return x=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},x.apply(this,arguments)}function F(e){return i.createElement("svg",x({width:16,height:16,viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=i.createElement("path",{d:"M8 1a7 7 0 110 14A7 7 0 018 1zm0 1a6 6 0 100 12A6 6 0 008 2zm-.005 8.1c.22 0 .411.065.562.195.14.13.22.296.22.5 0 .204-.08.38-.23.51a.81.81 0 01-.552.195.817.817 0 01-.552-.204.627.627 0 01-.22-.5c0-.205.07-.371.22-.501a.81.81 0 01.552-.195zm.117-5.6c.662 0 1.202.158 1.61.492.408.325.611.77.611 1.336 0 .464-.132.845-.377 1.142-.091.093-.387.343-.876.733a1.47 1.47 0 00-.408.464c-.101.185-.152.38-.152.603v.13H7.348v-.13c0-.353.061-.659.204-.91.132-.25.53-.64 1.192-1.178l.122-.13c.183-.204.275-.427.275-.659 0-.306-.102-.547-.285-.724-.194-.176-.469-.26-.815-.26-.449 0-.764.121-.958.381-.173.213-.255.52-.255.91H5.667c0-.687.214-1.226.662-1.615.438-.39 1.03-.585 1.783-.585z",fill:"#CBCDD1",fillRule:"nonzero"})))}var B,U=n(870372),H=n(563577),W=n(103192),j=n(640273),G=n(801134),V=n.n(G),z=n(725771),Q="undo--ujaZd",Y="redo--EdsVl",Z="disabled--M32o2";function K(){return K=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},K.apply(this,arguments)}function J(e){return i.createElement("svg",K({width:48,height:48,viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg"},e),B||(B=i.createElement("path",{d:"M20 23.252a1 1 0 01-1.507.863L9.381 18.76a1 1 0 01-.046-1.696l9.113-6.036a1 1 0 011.552.834V16h10c6.075 0 11 4.925 11 11v1c0 6.075-4.925 11-11 11H13v-3h17a8 8 0 007.996-7.75L38 28v-1a8 8 0 00-7.75-7.996L30 19H20v4.252z",fill:"#464D5A",fillRule:"evenodd"})))}var q,X=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.render=function(){var e,t=this.props,n=t.disableMobileTitleBarUndo,r=t.onClick;return a().createElement("div",{className:V()(Q,(e={},e[Z]=n,e)),onClick:function(){n||r()}},a().createElement(J,null))},t}(a().Component),$=(0,z.x)(["disableMobileTitleBarUndo"])(X);function ee(){return ee=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ee.apply(this,arguments)}function te(e){return i.createElement("svg",ee({width:48,height:48,viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg"},e),q||(q=i.createElement("path",{d:"M29.166 11.31a1 1 0 011.386-.282l9.113 6.036a1 1 0 01-.046 1.696l-9.112 5.355A1 1 0 0129 23.252V19H19l-.25.004A8 8 0 0011 27v1l.004.25A8 8 0 0019 36h17v3H19c-6.075 0-11-4.925-11-11v-1c0-6.075 4.925-11 11-11h10v-4.138a1 1 0 01.107-.45z",fill:"#464D5A",fillRule:"evenodd"})))}var ne=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.render=function(){var e,t=this.props,n=t.disableMobileTitleBarRedo,r=t.onClick;return a().createElement("div",{className:V()(Y,(e={},e[Z]=n,e)),onClick:function(){n||r()}},a().createElement(te,null))},t}(a().Component),re=(0,z.x)(["disableMobileTitleBarRedo"])(ne),oe=n(913292),ie=n(991287),ae=n(841952),se=n(125235),ce="help-center-link--ddq+-",le="help-center-icon--84ELR",ue=function(){function e(e,t,n,r,o,i){var a=this;this.store=t,this.eventEmitter=n,this.mobileTitlebar=r,this.wxService=o,this.paragraphSHortcutMenuLoader=i,this.editor=null,this.isNotFullySupportTipsOn=!1,this.handleFixScroll=function(e){if(e.fromServer&&a.editor.docEnv.docViewType!==l.DocViewType.PresentationPreview){var t=a.editor.scrollHandler,n=a.editor.selection.gcpRange;if(!(n.length()>0)){var r=a.editor.getViewRangeFromGcpRange(n);if(r){var o=r.end.getDocumentOffset().y,i=t.getScrollTop();a.fixScrollHandler&&a.editor.removeCallBack(l.StateNotification.ModelChange,a.fixScrollHandler);try{var s=a.editor.createSelector(),c=a.editor.getDocumentBox().__node__.getBoundingClientRect(),u=c.left+c.width/2,d=i+t.getClientHeight()/2,p=a.getParaBoxByPos(s,u,d,r),f=a.getParaBoxOffsetY(p);a.fixScrollHandler=function(){var e=a.editor.getViewRangeFromGcpRange(a.editor.selection.gcpRange);if(e){var r,s=t.zoom();if(p.isValid()){var c=a.getParaBoxOffsetY(p,f);r=(0,A.twipsToPx)(c-f)}else r=e.end.getDocumentOffset().y-o;if(r){var l=i+r*s;document.body.classList.add("no-animation"),a.eventEmitter.emit("$requestRecalculatePosition",n),t.scrollTo(0,l,!1),document.body.classList.remove("no-animation")}}},a.editor.once(l.StateNotification.ModelChange,a.fixScrollHandler)}catch(e){A.Logger.error(e)}}}}},this.onEditorStateChange=function(e){[W.EditorState.STATE_EDIT,W.EditorState.STATE_INPUT,W.EditorState.STATE_MOBILE_BLOCK].includes(e)?a.showTitlebar():a.hideTitlebar()},this.onEfficientModelChange=function(){a.store.update("disableMobileTitleBarUndo",a.cannotUndo()),a.store.update("disableMobileTitleBarRedo",a.cannotRedo())},this.onClickUndo=function(){a.editor.run("undo"),a.updatePanel(),A.RAFJankUtil.log({key:"mTB_undo"})},this.onClickRedo=function(){a.editor.run("redo"),a.updatePanel()},this.context=e.context}var t,n,r,i,s,g;return Object.defineProperty(e.prototype,"paragraphShortcutMenuHandler",{get:function(){return this.paragraphSHortcutMenuLoader.instance},enumerable:!1,configurable:!0}),e.prototype.$onEditorOpen=function(e){this.editor=e,this.registerNotification(),this.mountToTitlebar();var t=document.createElement("div");t.id="block-user-edit-modal-container",document.body.appendChild(t),c().render(a().createElement(N,{editor:this.editor,context:this.context}),t),this.editor.clipboardManager.addPasteDstProcessor(l.PasteDstType.SubStory,f.F),this.useLimitedDataType&&e.once(l.ClipboardNotificationType.ON_BEFORE_ACTION,(function(){e.clipboardManager.setDataType(l.InnerDataType.LimitedData)}));var n=this.editor.view.getDom();n&&(n.addEventListener("copy",this.showCopyPermission),n.addEventListener("cut",this.showCopyPermission)),this.editor.on(l.StateNotification.BeforeApplyDelta,this.handleFixScroll),this.wxService.setup()},e.prototype.$onEditorClose=function(){var e;null===(e=this.$sub)||void 0===e||e.unsubscribe(),this.unregisterNotification(),this.unmountFromTitlebar(),this.isNotFullySupportTipsOn=!1,u.qO.getInstance().setPrivilege({isBlocked:!1});var t=document.getElementById("block-user-edit-modal-container");t&&(c().unmountComponentAtNode(t),document.body.removeChild(t));var n=this.editor.view.getDom();n&&(n.removeEventListener("copy",this.showCopyPermission),n.removeEventListener("cut",this.showCopyPermission)),this.editor.removeCallBack(l.StateNotification.BeforeApplyDelta,this.handleFixScroll),this.store.clear("disableMobileTitleBarUndo"),this.store.clear("disableMobileTitleBarRedo")},e.prototype.showPasteModal=function(e){void 0===e&&(e=!1);var t=A.PlatformUtil.isMac()?"⌘":"Ctrl";e&&(t+="+Shift"),m.Modal.confirm({title:(0,d.$t)("core-edit:right-click-paste-instructions"),content:(0,d.$t)("core-edit:use-shortcut-key-without-permission",{ctrl:t}),action:a().createElement("div",{className:ce},a().createElement("div",{style:{marginRight:"4px"}},(0,d.$t)("帮助中心")),a().createElement(F,{className:le})),onClickAction:function(){var e=ie.X.getInstance().getConfig("custom.links.pasteInstructions");(0,p.l)({url:(0,se.O1)(e)})},okText:(0,d.$t)("我知道了"),cancelText:null,maskClosable:!0})},e.prototype.getParaBoxByPos=function(e,t,n,r){var o;if(this.editor.docEnv.renderType===l.RenderType.Canvas){var i=e.findHitViewPoint(!1,!1,!1,{x:(0,A.pxToTwips)(t),y:(0,A.pxToTwips)(n)});o=this.getViewPortParaBox(i,r)}else o=e.getParaBoxLiteByClientY(n,this.editor.getDocumentBox().firstChild.children);return o},e.prototype.getViewPortParaBox=function(e,t){var n=e;return e||(n=t.end),n.lineBox.parentBox},e.prototype.getParaBoxOffsetY=function(e,t){var n;if((0,l.isParagraphBox)(e))n=l.LayoutUtil.getOffsetPoint(e,l.BoxKind.Document).y;else{if(!e.__node__)return t||0;n=(0,A.pxToTwips)(e.__node__.getBoundingClientRect().top)}return n},e.prototype.notEditable=function(){return this.context.permission&&!this.context.permission.isEditable},e.prototype.cannotUndo=function(){return!this.editor||this.notEditable()||!this.editor.run("isUndoAvailable")},e.prototype.cannotRedo=function(){return!this.editor||this.notEditable()||!this.editor.run("isRedoAvailable")},e.prototype.showTitlebar=function(){this.mobileTitlebar.show("mobile-titlebar-undo"),this.mobileTitlebar.show("mobile-titlebar-redo")},e.prototype.hideTitlebar=function(){this.mobileTitlebar.hide("mobile-titlebar-undo"),this.mobileTitlebar.hide("mobile-titlebar-redo")},e.prototype.mountToTitlebar=function(){this.mobileTitlebar.hydrate("mobile-titlebar-undo",a().createElement($,{onClick:this.onClickUndo})),this.mobileTitlebar.hydrate("mobile-titlebar-redo",a().createElement(re,{onClick:this.onClickRedo})),this.hideTitlebar()},e.prototype.unmountFromTitlebar=function(){this.mobileTitlebar.deHydrate("mobile-titlebar-undo"),this.mobileTitlebar.deHydrate("mobile-titlebar-redo")},e.prototype.registerNotification=function(){var e=this;this.editor.on(l.StateNotification.DeleteContainer,(function(t){if(!t.fromServer){var n=t.drawingList,r=[];if(n){var o=e.editor.getDrawingStream();o?n.forEach((function(e){var t=e.drawing.graphic.graphicData.wsp.txbx.contentId,n=o.getDrawingInfoFromContentId(t);n&&n.range.isValid()?A.Logger.warn("delete story waring: unexpected story to be deleted! content id = ".concat(t)):r.push(t)})):A.Logger.warn("delete story waring: ContainerManager invalid!"),r.length>0&&e.editor.service.getDocument().removeContainerStories(r,l.Type.DocDeleteCodeBlock)}}}),this),this.editor.on(l.StateNotification.DeleteFootnote,(function(t){if(!t.fromServer){var n=t.footnoteRefList,r=[];if(n){var o=e.editor.state.dataEngine.getDataManager().getNotesManager();o&&(e.collectSubStoryIdByNoteRefs(r,n,o),r.length>0&&e.editor.service.getDocument().removeContainerStories(r,l.Type.DocDeleteText))}}}),this),this.editor.on(l.StateNotification.DeleteEndnote,(function(t){if(!t.fromServer){var n=t.endnoteRefList,r=[];if(n){var o=e.editor.state.dataEngine.getDataManager().getNotesManager();o&&(e.collectSubStoryIdByNoteRefs(r,n,o),r.length>0&&e.editor.service.getDocument().removeContainerStories(r,l.Type.DocDeleteText))}}}),this),this.editor.on(l.ClipboardNotificationType.ON_COPY,(function(t){t&&(A.PlatformUtil.isIE()||A.PlatformUtil.isEdge())&&e.showNotFullySupportTips()}),this),this.editor.on(l.ClipboardNotificationType.ON_CUT,(function(t){t&&(A.PlatformUtil.isIE()||A.PlatformUtil.isEdge())&&e.showNotFullySupportTips()}),this),this.editor.on(l.ClipboardNotificationType.ON_PASTE,(function(t){t&&(A.PlatformUtil.isIE()||A.PlatformUtil.isEdge())&&e.showNotFullySupportTips()}),this),this.editor&&this.editor.on(l.StateNotification.ApplyDeltaCheck,(function(){e.showApplyDeltaCheckFailTips()}),this)},e.prototype.unregisterNotification=function(){this.editor.removeListener(l.StateNotification.DeleteContainer,this),this.editor.removeListener(l.ClipboardNotificationType.ON_COPY,this),this.editor.removeListener(l.ClipboardNotificationType.ON_CUT,this),this.editor.removeListener(l.ClipboardNotificationType.ON_PASTE,this),this.editor.removeListener(l.StateNotification.DeleteContainer,this),this.editor.removeListener(l.StateNotification.ApplyDeltaCheck,this),this.editor.removeCallBack(l.StateNotification.EfficientModelChange,this.onEfficientModelChange),this.editor.removeCallBack(l.StateNotification.BeforeApplyDelta,this.handleFixScroll)},e.prototype.collectSubStoryIdByNoteRefs=function(e,t,n){var r,i;try{for(var a=(0,o.__values)(t),s=a.next();!s.done;s=a.next()){var c=s.value;if(c){var l=c.id,u=n.notesLocator.getNoteSubStoryInfoById(l);u&&u.range&&u.range.isValid()&&u.property&&e.push(u.property.id)}}}catch(e){r={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}},e.prototype.showNotFullySupportTips=function(){var e=this;this.isNotFullySupportTipsOn||(h.Snackbar.show({message:(0,d.$t)("复制粘贴可能会有格式丢失，推荐使用Chrome浏览器或下载腾讯文档客户端。"),type:"info",autoClose:!1,closable:!0,action:(0,d.$t)("立即下载"),onClickAction:function(){window.open(ie.X.getInstance().getConfig("custom.links.downloadApp"))},onClose:function(){e.isNotFullySupportTipsOn=!1}}),this.isNotFullySupportTipsOn=!0)},e.prototype.showSafariOnlyTextTips=function(){var e=!1;A.PlatformUtil.isSafari()&&A.PlatformUtil.isMac()&&(e=navigator.userAgent.toLocaleLowerCase().indexOf("version/13.1")>-1),e&&h.Snackbar.show({message:(0,d.$t)("已复制文本"),autoClose:!0,closable:!1,action:(0,d.$t)("了解更多"),onClickAction:function(){m.Modal.confirm({title:(0,d.$t)("提示"),content:(0,d.$t)("当前Safari版本不支持富文本复制粘贴，请升级Safari版本或者下载腾讯文档客户端。"),cancelText:(0,d.$t)("取消"),okText:(0,d.$t)("下载"),onOk:function(){window.open(ie.X.getInstance().getConfig("custom.links.download"))}})}})},e.prototype.showCopyPermission=function(){u.qO.getInstance().isCopyable||h.Snackbar.show({message:(0,d.$t)("文档管理员限制了查看者的操作权限，无法复制内容。"),autoClose:!0,duration:3e3})},e.prototype.updatePanel=function(){var e=this.store.get(L.j.MobilePanels);e.next(e.getValue())},e.prototype.shouldDisableRedoUndo=function(){var e;return!!(null===(e=this.editor)||void 0===e?void 0:e.isInBlockState())},e.prototype.showApplyDeltaCheckFailTips=function(){h.Snackbar.show({message:(0,d.$t)("本次操作内容过多，无法应用。建议删减后重试。"),type:"info",autoClose:!0,closable:!1,duration:3e3}),l.ReportHelper.tdwReport&&l.ReportHelper.tdwReport({opername:"doc_core",module:"data",action:"verify"})},e.prototype.deleteParagraph=function(){var e,t,n,r,o,i,a,s=null===(e=this.paragraphShortcutMenuHandler)||void 0===e?void 0:e.getParagraphGCPRange(ae.CURSOR_TYPE.NULL,!0);s=null!==(n=null===(t=this.editor)||void 0===t?void 0:t.state.getDataStream().getSdtStream().shrinkParaRangeWithoutSingleSdt(s))&&void 0!==n?n:s,s=null!==(i=null===(o=null===(r=this.editor)||void 0===r?void 0:r.service)||void 0===o?void 0:o.getSelection().getCompleteParaRangeInSdt(s))&&void 0!==i?i:s,null===(a=this.editor)||void 0===a||a.onSelection().delete(s)},e.prototype.cutParagraph=function(){var e,t,n,r,o,i,a,s=null===(e=this.paragraphShortcutMenuHandler)||void 0===e?void 0:e.getParagraphGCPRange(ae.CURSOR_TYPE.NULL,!0);s=null!==(n=null===(t=this.editor)||void 0===t?void 0:t.state.getDataStream().getSdtStream().shrinkParaRangeWithoutSingleSdt(s))&&void 0!==n?n:s,s=null!==(i=null===(o=null===(r=this.editor)||void 0===r?void 0:r.service)||void 0===o?void 0:o.getSelection().getCompleteParaRangeInSdt(s))&&void 0!==i?i:s,null===(a=this.editor)||void 0===a||a.clipboardManager.cut(s)},e.prototype.copyParagraph=function(){var e,t,n,r,o,i,a,s=null===(e=this.paragraphShortcutMenuHandler)||void 0===e?void 0:e.getParagraphGCPRange(ae.CURSOR_TYPE.NULL,!0);s=null!==(n=null===(t=this.editor)||void 0===t?void 0:t.state.getDataStream().getSdtStream().shrinkParaRangeWithoutSingleSdt(s))&&void 0!==n?n:s,s=null!==(i=null===(o=null===(r=this.editor)||void 0===r?void 0:r.service)||void 0===o?void 0:o.getSelection().getCompleteParaRangeInSdt(s))&&void 0!==i?i:s,null===(a=this.editor)||void 0===a||a.clipboardManager.copy(s)},(0,o.__decorate)([(0,O.D)("feature.core_edit.useLimitedDataType",!1),(0,o.__metadata)("design:type",Boolean)],e.prototype,"useLimitedDataType",void 0),e=(0,o.__decorate)([(0,D.L)({name:U.C.CoreEdit,adapters:["melo"],provide:H.ICoreEditHandler}),(0,o.__param)(5,(0,E.aN)(ae.IParagraphShortcutMenuFeature)),(0,o.__metadata)("design:paramtypes",["function"==typeof(t=void 0!==T.O&&T.O)?t:Object,"function"==typeof(n=void 0!==P.O&&P.O)?n:Object,"function"==typeof(r=void 0!==w.v&&w.v)?r:Object,"function"==typeof(i=void 0!==j.E&&j.E)?i:Object,"function"==typeof(s=void 0!==oe.Do&&oe.Do)?s:Object,"function"==typeof(g=void 0!==k.IDynamicLoader&&k.IDynamicLoader)?g:Object])],e)}()},127586:function(e,t,n){n.r(t),n.d(t,{IDarkModeFeature:function(){return c}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=n(495155),c=Symbol.for("feature:".concat(i.C.DarkMode));o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(2536).then(n.bind(n,672536))];case 1:return[2,e.sent().DarkModeFeature]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:c,platforms:[a.Ev.Pc],load:"1"===(0,s.getUrlParameter)("darkMode")})})},987389:function(e,t,n){n.r(t),n.d(t,{IDiffViewFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.DiffView));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(823),n.e(9396),n.e(5497)]).then(n.bind(n,723))];case 1:return[2,e.sent().DiffViewHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s,platforms:[a.Ev.Pc],load:!1})})},889588:function(e,t,n){n.r(t),n.d(t,{IDiffViewMobileFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.DiffViewMobile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(823),n.e(9396),n.e(5497)]).then(n.bind(n,547574))];case 1:return[2,e.sent().DiffViewMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s,platforms:[a.Ev.Pad,a.Ev.Mobile],load:!1})})},419682:function(e,t,n){n.r(t),n.d(t,{IDocViewMobileFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.DocViewMobile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(548).then(n.bind(n,605205))];case 1:return[2,e.sent().DocViewMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad]})})},24537:function(e,t,n){n.r(t),n.d(t,{IDoclinkPasteHandler:function(){return s}});var r=n(839461),o=n(259356),i=n(293325),a=n(870372),s=Symbol.for("feature:".concat(a.C.DoclinkPaste));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5597),n.e(9820),n.e(7797),n.e(5049),n.e(8063),n.e(823),n.e(3974),n.e(4397),n.e(7021),n.e(7131)]).then(n.bind(n,733261))];case 1:return[2,e.sent().DoclinkPasteHandler]}}))}))},on:i.iz.On({key:s,platforms:[i.Ev.Pc],stages:[i.YV.Level3]})})},372722:function(e,t,n){n.r(t),n.d(t,{IEditFollowFeature:function(){return l}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=n(495155),c=n(317999),l=Symbol.for("feature:".concat(i.C.EditFollow));s.Logger.info("腾讯会议远程演示加载情况: ".concat(c.A.isMeetingEnv())&&"meeting"!==(0,s.getUrlParameter)("mode")&&"player"!==(0,s.getUrlParameter)("show")),o.Ln.merge(l,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(3417).then(n.bind(n,310683))];case 1:return[2,e.sent().EditFollowHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level1],key:l,load:c.A.isMeetingEnv()&&"meeting"!==(0,s.getUrlParameter)("mode")&&"player"!==(0,s.getUrlParameter)("show"),platforms:[a.Ev.Pc,a.Ev.Mobile,a.Ev.Pad]})})},770288:function(e,t,n){n.r(t),n.d(t,{IEditTipsMobileFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.EditTipsMobile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(764).then(n.bind(n,293799))];case 1:return[2,e.sent().EditTipsMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad]})})},126494:function(e,t,n){n.r(t),n.d(t,{IExternalTagFeature:function(){return s}});var r=n(839461),o=(n(495155),n(259356)),i=n(293325),a=n(870372),s=Symbol.for("feature:".concat(a.C.ExternalTag));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(7515).then(n.bind(n,115901))];case 1:return[2,e.sent().ExternalTagHandler]}}))}))},on:i.iz.On({key:s,platforms:[i.Ev.Pc],stages:[i.YV.Level2],load:!1})})},736287:function(e,t,n){n.r(t),n.d(t,{IFanbookFeature:function(){return c}});var r=n(839461),o=(n(495155),n(259356)),i=n(293325),a=n(991287),s=n(870372),c=Symbol.for("feature:".concat(s.C.Fanbook)),l="fanbook"===a.X.getInstance().getConfig("client");o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(9192).then(n.bind(n,841787))];case 1:return[2,e.sent().FanbookHandler]}}))}))},on:i.iz.On({key:c,platforms:[i.Ev.Mobile],stages:[i.YV.Level2],load:l})})},64815:function(e,t,n){n.d(t,{Hz:function(){return l},U5:function(){return r},cJ:function(){return c}});var r,o=n(87363),i=n.n(o),a=n(218581),s=n(452088);!function(e){e.Insert="fieldDemoInsert",e.Update="fieldDemoUpdate",e.Delete="fieldDemoDelete"}(r||(r={}));var c=[{name:r.Insert,content:(0,a.$t)("field:demo-insert"),respectOffline:!0}],l=[{name:r.Update,tooltip:(0,a.$t)("field:update"),icon:i().createElement("div",{className:s.jG.Edit})},{name:r.Delete,tooltip:(0,a.$t)("field:delete"),icon:i().createElement("div",{className:s.jG.Delete})}]},23760:function(e,t,n){n.r(t),n.d(t,{IFieldDemoFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.FieldDate));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5597),n.e(9820),n.e(7797),n.e(5049),n.e(8063),n.e(823),n.e(3974),n.e(4397),n.e(7021),n.e(7131)]).then(n.bind(n,826219))];case 1:return[2,e.sent().FieldDemoHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3,a.YV.Publish],key:s})})},685655:function(e,t,n){n.r(t),n.d(t,{IFieldFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.Field));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(9820),n.e(9250),n.e(9454)]).then(n.bind(n,172226))];case 1:return[2,e.sent().FieldHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level1,a.YV.Publish],key:s})})},125235:function(e,t,n){n.d(t,{$x:function(){return l},O1:function(){return u},ZR:function(){return h},k0:function(){return m},wA:function(){return d}});var r=n(839461),o=n(641415),i=n(750670),a=n(495155),s=n(991287),c=[{platformChecker:function(){return a.PlatformUtil.isMac()||!1},assistKeyChecker:function(e){return e.metaKey}},{platformChecker:function(){return!a.PlatformUtil.isMac()||!1},assistKeyChecker:function(e){return e.ctrlKey}}];function l(e){var t=c.find((function(e){return e.platformChecker()}));return!!(null==t?void 0:t.assistKeyChecker(e))}function u(e){return function(e){var t=s.X.getInstance().getConfig("custom.domains.qqDomain"),n=s.X.getInstance().getConfig("custom.domains.customerDomain"),r=s.X.getInstance().getConfig("custom.domains.businessDomain"),o=new RegExp(t),i=new RegExp(n),a=new RegExp(r);return o.test(e)&&!i.test(e)&&!a.test(e)}(e)&&a.PlatformUtil.isWXorQQMiniProgram()?"https://".concat(location.host,"/scenario/link.html?url=").concat(encodeURIComponent(e)):e}function d(){return!1}var p,f=o.Z.CancelToken,h=function(e,t){return(0,r.__awaiter)(void 0,void 0,Promise,(function(){return(0,r.__generator)(this,(function(n){return 0===t.length?[2,null]:(p&&p.cancel(),p=f.source(),[2,e.requestLinkToDocLink(t,p.token)])}))}))},m=function(e){var t=[],n=!0,r=!0;return e.forEachOp((function(e){var o,a;if(i.OperationParseUtil.isFieldStart(e))return n=!0,void(r=!0);if(i.OperationParseUtil.isModifyFieldEnd(e))return n=!1,void(r=!0);if(n&&e instanceof i.InsertOperation&&r){var s=e.param.text,c=i.FieldUtil.decodeFieldCode(s);if((null==c?void 0:c.name)===i.TDFieldType.fieldHyperlink){var l=null===(o=c.instructions)||void 0===o?void 0:o[0],u=null===(a=c.switches)||void 0===a?void 0:a[i.FieldCommonSwitchesName.key];u&&l&&t.push({key:u,url:l})}r=!1}})),t}},628199:function(e,t,n){n.d(t,{Io:function(){return d},_W:function(){return c},hC:function(){return u},kz:function(){return l}});var r=n(839461),o=n(750670),i=n(327297),a=n.n(i),s=n(218581);function c(e){var t=JSON.stringify({id:e.id,timestamp:e.timestamp,status:e.status,fullDay:e.fullDay,repeat:e.repeat,notify:e.notify,utimestamp:e.utimestamp});return"".concat(o.FieldName.DATE_REMINDER," ").concat(t)}function l(e,t){void 0===t&&(t=!1);try{var n=e;if(!t){var i=new RegExp("".concat(o.FieldName.DATE_REMINDER," (.*)")).exec(e);n=(0,r.__read)(i,2)[1]}var a=JSON.parse(n);return{timestamp:a.timestamp,id:a.id,status:a.status,fullDay:a.fullDay,repeat:a.repeat,notify:a.notify,utimestamp:a.utimestamp}}catch(e){return}}function u(e){var t=new Date(e.timestamp),n=new Date,r=t.getFullYear()===n.getFullYear(),o=!!e.fullDay,i=r?[(0,s.$t)("MM月DD日")]:[(0,s.$t)("YYYY年MM月DD日")];return o||i.push("HH:mm"),i.map((function(e){return a()(t).format(e)})).join(" ")}function d(e,t){var n=e.service.getSelection().getParaRange(t.begin());if(n){var r=new o.GCPRange(n.begin(),t.begin()-n.begin());return e.getRefText(r).slice(0,512)}}},745386:function(e,t,n){n.r(t),n.d(t,{IFieldcodeDateHandler:function(){return a}});var r=n(839461),o=n(870372),i=n(259356),a=(n(495155),Symbol.for("feature:".concat(o.C.FieldcodeDate)));i.Ln.merge(a,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5070),n.e(5781)]).then(n.bind(n,737692))];case 1:return[2,e.sent().FieldcodeDateHandler]}}))}))}})},94107:function(e,t,n){n.r(t),n.d(t,{IFieldCodeQQCardHandler:function(){return u},SHOULD_AUTO_LOAD:function(){return l}});var r=n(839461),o=n(508436),i=n(259356),a=n(293325),s=n(305775),c=n(870372),l=o.default.isQQ&&!o.default.isQQMiniProgram||(o.default.isTencentDocsApp||o.default.isPC)&&"qq"===(0,s.e)("utype"),u=Symbol.for("feature:".concat(c.C.FieldCodeQQCard));i.Ln.merge(u,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(5065).then(n.bind(n,496811))];case 1:return[2,e.sent().FieldCodeQQCardHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level4],key:u,load:l})})},562765:function(e,t,n){n.r(t),n.d(t,{IFileInfoPanelMobileFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.FileInfoPanelMobile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(3763).then(n.bind(n,349214))];case 1:return[2,e.sent().FileInfoPanelMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad]})})},270882:function(e,t,n){n.r(t),n.d(t,{IFileWechatFeature:function(){return c}});var r=n(839461),o=n(495155),i=n(259356),a=n(293325),s=n(870372),c=Symbol.for("feature:".concat(s.C.FileWechat)),l="file"===(0,o.getUrlParameter)("qq_doc_source"),u="true"===(0,o.getUrlParameter)("isexported");i.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(7836).then(n.bind(n,612304))];case 1:return[2,e.sent().FileWechatHandler]}}))}))},on:a.iz.On({key:c,stages:[a.YV.Level1],platforms:[a.Ev.Mobile,a.Ev.Pad,a.Ev.Pc],load:o.PlatformUtil.isWXMiniProgram()||o.PlatformUtil.isQQ()||l||u})})},287523:function(e,t,n){n.r(t),n.d(t,{IFormatPainterFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.FormatPainter));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5597),n.e(9820),n.e(7797),n.e(5049),n.e(8063),n.e(823),n.e(3974),n.e(4397),n.e(7021),n.e(7131)]).then(n.bind(n,13660))];case 1:return[2,e.sent().FormatPainterHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s})})},656739:function(e,t,n){n.r(t),n.d(t,{IGuideToWeworkFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=(n(495155),Symbol.for("feature:".concat(i.C.GuideToWework)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(3038).then(n.bind(n,392360))];case 1:return[2,e.sent().GuideToWeworkHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level1],key:s,load:!1})})},402807:function(e,t,n){n.r(t),n.d(t,{IHeadingFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.Heading));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5597),n.e(9820),n.e(7797),n.e(5049),n.e(8063),n.e(823),n.e(3974),n.e(4397),n.e(7021),n.e(7131)]).then(n.bind(n,725093))];case 1:return[2,e.sent().HeadingHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s})})},781559:function(e,t,n){n.r(t),n.d(t,{IHelpAndFeedBackCenterHandler:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=(n(495155),Symbol.for("feature:".concat(i.C.HelpAndFeedBack)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(9477).then(n.bind(n,720592))];case 1:return[2,e.sent().HelpAndFeedBackCenterHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level4],key:s,platforms:[a.Ev.Pc],load:!1})})},455279:function(e,t,n){n.r(t),n.d(t,{IHintFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.Hint));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5597),n.e(9820),n.e(7797),n.e(5049),n.e(8063),n.e(823),n.e(3974),n.e(4397),n.e(7021),n.e(7131)]).then(n.bind(n,448228))];case 1:return[2,e.sent().HintHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s})})},55328:function(e,t,n){n.r(t),n.d(t,{IMobileHomeFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(293325),a=n(870372),s=Symbol.for("feature:".concat(a.C.HomeMobile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(4212).then(n.bind(n,242435))];case 1:return[2,e.sent().MobileHomeHandler]}}))}))},on:i.iz.On({stages:[i.YV.Level2],key:s,platforms:[i.Ev.Mobile,i.Ev.Pad]})})},318905:function(e,t,n){n.r(t),n.d(t,{IImageFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.Image));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5597),n.e(9820),n.e(7797),n.e(5049),n.e(8063),n.e(823),n.e(3974),n.e(4397),n.e(7021),n.e(7131)]).then(n.bind(n,343315))];case 1:return[2,e.sent().ImageHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s})})},965811:function(e,t,n){n.r(t),n.d(t,{IImageMobileFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.ImageMobile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(9820),n.e(7021),n.e(6359)]).then(n.bind(n,133076))];case 1:return[2,e.sent().ImageMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad]})})},989653:function(e,t,n){n.r(t),n.d(t,{IImagePcFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(293325),a=n(870372),s=Symbol.for("feature:".concat(a.C.ImagePc));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5597),n.e(9820),n.e(7797),n.e(5049),n.e(8063),n.e(823),n.e(3974),n.e(4397),n.e(7021),n.e(7131)]).then(n.bind(n,505688))];case 1:return[2,e.sent().ImagePcHandler]}}))}))},on:i.iz.On({key:s,stages:[i.YV.Level3],platforms:[i.Ev.Pc]})})},212890:function(e,t,n){n.r(t),n.d(t,{IIpadAppKeyboardFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.IpadAppKeyboard));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(4709).then(n.bind(n,210168))];case 1:return[2,e.sent().IpadAppKeyboardHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s,platforms:[a.Ev.Pad]})})},510258:function(e,t,n){n.r(t),n.d(t,{ILandspaceStateFeature:function(){return c},IS_LANDSPACE:function(){return s}});var r=n(839461),o=(n(495155),n(259356)),i=n(293325),a=n(870372),s="IS_LANDSPACE",c=Symbol.for("feature:".concat(a.C.LandspaceState));o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(5273).then(n.bind(n,75273))];case 1:return[2,e.sent().LandspaceStateFeature]}}))}))},on:i.iz.On({stages:[i.YV.Level3],key:c,load:!1,platforms:[i.Ev.Mobile]})})},528252:function(e,t,n){n.r(t),n.d(t,{ILayoutTypeFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.LayoutType));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(9820),n.e(9250),n.e(9454)]).then(n.bind(n,907989))];case 1:return[2,e.sent().LayoutTypeHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level1,a.YV.Publish],key:s,platforms:[a.Ev.Pc,a.Ev.Mobile,a.Ev.Pad]})})},945409:function(e,t,n){n.d(t,{d:function(){return i}});var r=n(599132),o={status:!0};function i(){var e=r.$.getInstance().getToggleByToggleId("58",o);return!!(null==e?void 0:e.status)}},507270:function(e,t,n){n.d(t,{D:function(){return m},f:function(){return d}});var r=n(750670),o=n(495155),i=(n(259356),n(336338)),a=n(612981),s=n(317999),c=n(136454),l=n(996600),u=n(945409);function d(e){var t=(0,c.Yi)(),n=t.uin,r=t.globalPadId;(0,a.po)(l.WK,"".concat(n,"$").concat(r),e)}function p(e){var t=(0,c.Yi)();if(!(0,u.d)())return t.pagingFlag===l.$e.Paged?r.LayoutType.Paged:r.LayoutType.Scroll;var n=e.dataEngine.getDataManager().getSettingsManager().getDocSettingsProperty().layout.val;return n?(o.Logger.info("getServerLayoutType: layoutType=".concat(n)),n):t.pagingFlag===l.$e.Paged?r.LayoutType.Paged:t.pagingFlag===l.$e.Scroll?r.LayoutType.Scroll:l.d4}function f(e){if(i.cm){var t=(n=(0,c.Yi)(),r=n.uin,o=n.globalPadId,(0,a.cF)(l.WK,"".concat(r,"$").concat(o)));return t||l.ap}var n,r,o;return p(e)}function h(e){return function(e){var t;return(null===(t=null===window||void 0===window?void 0:window.isDefaultWeblayout)||void 0===t?void 0:t.call(window))||s.A.isTencentMeetingInWework(),f(e)}(e)}function m(e){return h(e)}},626127:function(e,t,n){n.r(t),n.d(t,{ILikeMobileFeature:function(){return c}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=(n(495155),n(707605)),c=Symbol.for("feature:".concat(i.C.LikeMobile));o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(899).then(n.bind(n,178296))];case 1:return[2,e.sent().LikeMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:c,platforms:[a.Ev.Mobile,a.Ev.Pad],load:!s.qO.getInstance().isOcrPreview})})},891088:function(e,t,n){n.r(t),n.d(t,{IListFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.List));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5597),n.e(9820),n.e(7797),n.e(5049),n.e(8063),n.e(823),n.e(3974),n.e(4397),n.e(7021),n.e(7131)]).then(n.bind(n,131145))];case 1:return[2,e.sent().ListHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s})})},890132:function(e,t,n){n.r(t),n.d(t,{ILocalAndDriveMobileFeature:function(){return c}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=(n(495155),n(669144)),c=Symbol.for("feature:".concat(i.C.LocalAndDriveMobile));o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(9440),n.e(8949)]).then(n.bind(n,791482))];case 1:return[2,e.sent().LocalAndDriveMobileFeature]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:c,platforms:[a.Ev.Pad,a.Ev.Mobile],load:s.v.isLocalEdit||s.v.isDriveFile})})},655116:function(e,t,n){n.r(t),n.d(t,{IMobileLocalEditFeature:function(){return c}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=(n(495155),n(336338)),c=Symbol.for("feature:".concat(i.C.LocalEditMobile));o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(9440),n.e(9399)]).then(n.bind(n,855632))];case 1:return[2,e.sent().MobileLocalEditFeature]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:c,platforms:[a.Ev.Pad,a.Ev.Mobile],load:s.cm&&!0})})},944177:function(e,t,n){n.d(t,{a:function(){return d}});var r=n(839461),o=n(602092),i=n(259356),a=n(137600),s=n(947229),c=n(826973),l=n(279311),u=n(495155),d=function(){function e(){var e=this;this.showRenameDocumentDialog=function(){window.mqq.invoke("docx","renameLocalFile",{},(function(t){"succeed"===t.result&&(o.v.getInstance().updateLocalEditInfo(t.data.path,t.data.title),e.onTitleConfirm(t.data.title))}))},this.initEvent=function(){e.$subRequestRename=e.eventEmitter.listen("$requestRename",e.showRenameDocumentDialog)},this.onTitleConfirm=function(t){var n=(0,l.HV)();document.title=n,window.clientVars&&(window.clientVars.title=t,window.clientVars.padTitle=t),e.updateLocalTitle(t)},this.updateLocalTitle=function(t){e.store.update("docTitle",t)},this.initEvent()}var t,n;return e.prototype.setTitleForDoc=function(e){this.updateLocalTitle(e)},e.prototype.autoUpdateTitle=function(e){this.updateLocalTitle(e)},e.prototype.updateDocInitTitle=function(){var e=new URL(location.href).searchParams;this.updateLocalTitle(e.get("title")||"")},e.prototype.setTitleToNativeTitlebar=function(){u.Logger.info("LocalEditTitleManager setTitleToNativeTitlebar")},e.prototype.destroy=function(){u.Logger.info("LocalEditTitleManager destroy")},(0,r.__decorate)([(0,i.tB)(),(0,r.__metadata)("design:type","function"==typeof(t=void 0!==a.O&&a.O)?t:Object)],e.prototype,"store",void 0),(0,r.__decorate)([(0,i.tB)(),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==s.v&&s.v)?n:Object)],e.prototype,"eventEmitter",void 0),e=(0,r.__decorate)([(0,c.t)(),(0,r.__metadata)("design:paramtypes",[])],e)}()},817183:function(e,t,n){n.r(t),n.d(t,{ILocalEditTitlebarConfigService:function(){return c}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=n(336338),c=(n(495155),Symbol.for("feature:".concat(i.C.MobileLocalEditHeader)));o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(9440),n.e(9399)]).then(n.bind(n,475532))];case 1:return[2,e.sent().LocalEditTitlebarConfigService]}}))}))},on:a.iz.On({stages:[a.YV.Level1],key:c,platforms:[a.Ev.Pad,a.Ev.Mobile],load:s.kE&&!0})})},333291:function(e,t,n){n.r(t),n.d(t,{ILocalFileSaveFeature:function(){return c}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=(n(495155),n(336338)),c=Symbol.for("feature:".concat(i.C.LocalFileSave));o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(3909).then(n.bind(n,442121))];case 1:return[2,e.sent().LocalFileSaveFeature]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:c,platforms:[a.Ev.Pc],load:s.cm&&!0})})},646820:function(e,t,n){n.r(t),n.d(t,{IManualOfflineFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(293325),a=n(870372),s=Symbol.for("feature:".concat(a.C.ManualOffline));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(9440),n.e(5597),n.e(313)]).then(n.bind(n,33646))];case 1:return[2,e.sent().ManualOfflineHandler]}}))}))},on:i.iz.On({stages:[i.YV.Level2],key:s,platforms:[i.Ev.Mobile,i.Ev.Pad]})})},932045:function(e,t,n){n.r(t),n.d(t,{IMarkdownFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.Markdown));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5597),n.e(9820),n.e(7797),n.e(5049),n.e(8063),n.e(823),n.e(3974),n.e(4397),n.e(7021),n.e(7131)]).then(n.bind(n,702896))];case 1:return[2,e.sent().MarkdownHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s})})},93946:function(e,t,n){n.r(t),n.d(t,{IMemberMobileFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.MemberMobile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(8495).then(n.bind(n,668110))];case 1:return[2,e.sent().MemberMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad]})})},972296:function(e,t,n){n.r(t),n.d(t,{IMiniListFeature:function(){return c}});var r=n(839461),o=n(259356),i=n(293325),a=n(870372),s=n(669144),c=(n(495155),Symbol.for("feature:".concat(a.C.MiniList)));o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(6978).then(n.bind(n,651810))];case 1:return[2,e.sent().MiniListHandler]}}))}))},on:i.iz.On({stages:[i.YV.Level1],key:c,platforms:[i.Ev.Pc],load:!s.W.isWeWortkEmbeddedDiscussionDoc})})},449889:function(e,t,n){n.r(t),n.d(t,{IMobileAutoScrollFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.MobileAutoScroll));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(5362).then(n.bind(n,390504))];case 1:return[2,e.sent().MobileAutoScrollHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad],load:!1})})},859604:function(e,t,n){n.r(t),n.d(t,{IMobileBlockInterface:function(){return s}});var r=n(839461),o=n(870372),i=n(259356),a=n(293325),s=(n(495155),Symbol.for("feature:".concat(o.C.MobileBlock)));i.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(2301).then(n.bind(n,882301))];case 1:return[2,e.sent().MobileBlockHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad],load:!0})})},139895:function(e,t,n){n.r(t),n.d(t,{IMobileBlockBottomBarFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(293325),a=n(870372),s=(n(495155),Symbol.for("feature:".concat(a.C.MobileBlockBottomBar)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(4351).then(n.bind(n,244351))];case 1:return[2,e.sent().MobileBlockBottomBarHandler]}}))}))},on:i.iz.On({stages:[i.YV.Level2],key:s,platforms:[i.Ev.Mobile,i.Ev.Pad],load:!0})})},954729:function(e,t,n){n.r(t),n.d(t,{IMobileGestureFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=(n(495155),Symbol.for("feature:".concat(i.C.MobileGesture)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(383).then(n.bind(n,20383))];case 1:return[2,e.sent().MobileBlockGestureHandler]}}))}))},on:a.iz.On({key:s,stages:[a.YV.Level2,a.YV.Publish],platforms:[a.Ev.Mobile,a.Ev.Pad],load:!0})})},938503:function(e,t,n){n.r(t),n.d(t,{IMobileHeaderFeature:function(){return c}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=n(495155),c=Symbol.for("feature:".concat(i.C.MobileHeader));o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(1198).then(n.bind(n,631608))];case 1:return[2,e.sent().MobileHeaderHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level1,a.YV.Publish],key:c,platforms:[a.Ev.Mobile,a.Ev.Pad],load:!(0,s.supportNativeTitleBar)("doc")})})},857314:function(e,t,n){n.r(t),n.d(t,{IMobileMoreMenuFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.MobileMoreMenu));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(9440),n.e(3392)]).then(n.bind(n,329651))];case 1:return[2,e.sent().MobileMoreMenuHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2,a.YV.Publish],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad]})})},943064:function(e,t,n){n.r(t),n.d(t,{IMobileTopBannerFeature:function(){return c}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=n(508436),c=Symbol.for("feature:".concat(i.C.MobileTopBanner));o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(3723).then(n.bind(n,95088))];case 1:return[2,e.sent().MobileTopBannerHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level4,a.YV.Publish],key:c,platforms:[a.Ev.Mobile],load:s.default.isWeChat||s.default.isQQ})})},681557:function(e,t,n){n.r(t),n.d(t,{IMobileViewFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.MobileView));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(7060).then(n.bind(n,974111))];case 1:return[2,e.sent().MobileViewHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad]})})},621896:function(e,t,n){n.r(t),n.d(t,{IMoveToMobileFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=(n(495155),Symbol.for("feature:".concat(i.C.MoveToMobile)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(1e3).then(n.bind(n,686307))];case 1:return[2,e.sent().MoveToMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad],load:!1})})},82216:function(e,t,n){n.r(t),n.d(t,{INativeMobileHeaderFeature:function(){return l}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=n(495155),c=n(336338),l=Symbol.for("feature:".concat(i.C.MobileNativeHeader));o.Ln.merge(l,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(9440),n.e(5038)]).then(n.bind(n,317056))];case 1:return[2,e.sent().NativeHeaderHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level1,a.YV.Publish],key:l,platforms:[a.Ev.Mobile,a.Ev.Pad],load:(0,s.supportNativeTitleBar)("doc")&&!c.cm})})},622454:function(e,t,n){n.r(t),n.d(t,{IOcrFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.Ocr));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5597),n.e(1863)]).then(n.bind(n,321890))];case 1:return[2,e.sent().OcrHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad]})})},912043:function(e,t,n){n.r(t),n.d(t,{IOcrPcFeature:function(){return c}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=n(669144),c=Symbol.for("feature:".concat(i.C.OcrPc));o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(3170).then(n.bind(n,364082))];case 1:return[2,e.sent().OcrPcHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:c,platforms:[a.Ev.Pc],load:!s.v.isEntAccount})})},162678:function(e,t,n){n.r(t),n.d(t,{IOcrPreviewFeature:function(){return c}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=n(495155),c=Symbol.for("feature:".concat(i.C.OcrPreview));o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5597),n.e(900)]).then(n.bind(n,681581))];case 1:return[2,e.sent().OcrPreviewHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:c,load:!!(0,s.getUrlParameter)("inToastPreview")||!!(0,s.getUrlParameter)("ocr")})})},797376:function(e,t,n){n.r(t),n.d(t,{IOfflineStatusFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.OfflineStatus));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(4354).then(n.bind(n,838053))];case 1:return[2,e.sent().OfflineStatusHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad]})})},151476:function(e,t,n){n.r(t),n.d(t,{IOpenAPIFeature:function(){return l}});var r=n(839461),o=n(495155),i=n(259356),a=n(293325),s=n(870372),c=n(991287),l=Symbol.for("feature:".concat(s.C.OpenAPI)),u=["fanbook","tencent_sign"],d=c.X.getInstance().getConfig("client");i.Ln.merge(l,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(2219),n.e(3052)]).then(n.bind(n,860781))];case 1:return[2,e.sent().OpenAPIHandler]}}))}))},on:a.iz.On({key:l,stages:[a.YV.Level2],load:"drive"===(0,o.getUrlParameter)("from")||u.includes(d)})})},822643:function(e,t,n){n.r(t),n.d(t,{IOutlineMobileFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.OutlineMobile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(1728).then(n.bind(n,705028))];case 1:return[2,e.sent().OutlineMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2,a.YV.Publish],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad]})})},446587:function(e,t,n){n.r(t),n.d(t,{IPageWebFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=(n(495155),Symbol.for("feature:".concat(i.C.PageWeb)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(9635).then(n.bind(n,566730))];case 1:return[2,e.sent().PageWebHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Pc],load:!1})})},567600:function(e,t,n){n.r(t),n.d(t,{IParagraphFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.Paragraph));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5597),n.e(9820),n.e(7797),n.e(5049),n.e(8063),n.e(823),n.e(3974),n.e(4397),n.e(7021),n.e(7131)]).then(n.bind(n,905878))];case 1:return[2,e.sent().ParagraphHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s})})},501317:function(e,t,n){n.r(t),n.d(t,{IParagraphDragMobileFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(293325),a=n(870372),s=Symbol.for("feature:".concat(a.C.ParagraphDragMobile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(5105).then(n.bind(n,345105))];case 1:return[2,e.sent().ParagraphDragMobileHandler]}}))}))},on:i.iz.On({stages:[i.YV.Level2],key:s,platforms:[i.Ev.Mobile,i.Ev.Pad]})})},890560:function(e,t,n){n.r(t),n.d(t,{IPdfTransformFeature:function(){return a}});var r=n(839461),o=n(259356),i=n(870372),a=Symbol.for("feature:".concat(i.C.PdfTransform));o.Ln.merge(a,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(2019).then(n.bind(n,127372))];case 1:return[2,e.sent().PdfTransformHandler]}}))}))}})},344071:function(e,t,n){n.r(t),n.d(t,{IPresentationPlayerFeature:function(){return c}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=n(495155),c=Symbol.for("feature:".concat(i.C.PresentationPlayer));o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(823),n.e(2557),n.e(902)]).then(n.bind(n,915454))];case 1:return[2,e.sent().PresentationPlayerHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:c,load:"player"===(0,s.getUrlParameter)("show")})})},677445:function(e,t,n){n.r(t),n.d(t,{IQuickToolsFeature:function(){return p},MobileActionSheetImageDownloadOption:function(){return o},QuickToolsTabIDMap:function(){return d}});var r,o,i=n(839461),a=n(259356),s=n(293325),c=n(870372),l=n(826691),u=n(74225);!function(e){e.CurrentOnly="currentOnly",e.Batches="bacthes"}(o||(o={}));var d=((r={})[l.Fv.QUICK_TOOLS_BATCH_RENAME_IMAGE]=u.N1.RENAME,r[l.Fv.QUICK_TOOLS_BATCH_ADD_WATERMARK_TO_IMAGE]=u.N1.WATERMARK,r[l.Fv.QUICK_TOOLS_BATCH_COMPRESS_IMAGE]=u.N1.COMPRESS,r),p=Symbol.for("feature:".concat(c.C.QuickTools));a.Ln.merge(p,{useFactory:function(){return(0,i.__awaiter)(void 0,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(8487),n.e(5597),n.e(9820),n.e(1315),n.e(6922),n.e(6205),n.e(823),n.e(9111),n.e(1997),n.e(9140),n.e(9700),n.e(9445)]).then(n.bind(n,448348))];case 1:return[2,e.sent().QuickToolsHandler]}}))}))},on:s.iz.On({key:p,stages:[s.YV.Level4]})})},267086:function(e,t,n){n.r(t),n.d(t,{IQuicklyVisitMobileFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=(n(495155),Symbol.for("feature:".concat(i.C.QuicklyVisitMobile)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(6101).then(n.bind(n,241808))];case 1:return[2,e.sent().QuicklyVisitMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad],load:!1})})},575574:function(e,t,n){n.r(t),n.d(t,{IReadonlyTipsFeature:function(){return c}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=(n(495155),n(317999)),c=Symbol.for("feature:".concat(i.C.ReadonlyTips));o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(9553).then(n.bind(n,245983))];case 1:return[2,e.sent().ReadonlyTipsHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:c,platforms:[a.Ev.Pc],load:!s.A.isTencentMeetingInWework()})})},706989:function(e,t,n){n.r(t),n.d(t,{IRepeatLastFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.RepeatLast));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5597),n.e(9820),n.e(7797),n.e(5049),n.e(8063),n.e(823),n.e(3974),n.e(4397),n.e(7021),n.e(7131)]).then(n.bind(n,958787))];case 1:return[2,e.sent().RepeatLastHandler]}}))}))},on:a.iz.On({key:s,platforms:[a.Ev.Pc],stages:[a.YV.Level3]})})},123886:function(e,t,n){n.r(t),n.d(t,{IResumeGuideMobileFeature:function(){return u},ImportScene:function(){return o},ImportType:function(){return r}});var r,o,i=n(839461),a=n(259356),s=n(870372),c=n(293325),l=n(336338);!function(e){e.LOCAL="local",e.ONLINE="online"}(r||(r={})),function(e){e.CREATE="create",e.REPLACE="replace"}(o||(o={}));var u=Symbol.for("feature:".concat(s.C.ResumeGuideMobile));a.Ln.merge(u,{useFactory:function(){return(0,i.__awaiter)(void 0,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(7588).then(n.bind(n,630974))];case 1:return[2,e.sent().ResumeGuideMobileHandler]}}))}))},on:c.iz.On({key:u,stages:[c.YV.Level4],platforms:[c.Ev.Mobile,c.Ev.Pad],load:!l.kE})})},927197:function(e,t,n){n.r(t),n.d(t,{IReviewFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.ReviewCore));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(9820),n.e(9250),n.e(9454)]).then(n.bind(n,186071))];case 1:return[2,e.sent().ReviewHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level1,a.YV.Publish],key:s})})},530625:function(e,t,n){n.r(t),n.d(t,{IReviewMobileFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.ReviewMobile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(4714).then(n.bind(n,910138))];case 1:return[2,e.sent().ReviewMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level1,a.YV.Publish],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad]})})},453368:function(e,t,n){n.r(t),n.d(t,{IReviewPcFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.ReviewPc));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(9820),n.e(9250),n.e(9454)]).then(n.bind(n,497101))];case 1:return[2,e.sent().ReviewPcHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level1,a.YV.Publish],key:s,platforms:[a.Ev.Pc]})})},110155:function(e,t,n){n.r(t),n.d(t,{IScrollbarHiddenMobileFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.ScrollbarHiddenMobile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(9186).then(n.bind(n,43344))];case 1:return[2,e.sent().ScrollbarHiddenMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile]})})},24990:function(e,t,n){n.r(t),n.d(t,{BTN_HEIGHT:function(){return c},BTN_PANEL_DISTANCE:function(){return d},ISelectivePasteHandler:function(){return p},PANEL_HEIGHT_2_ITEM:function(){return u},PANEL_HEIGHT_3_ITEM:function(){return l},PasteBtnType:function(){return r}});var r,o=n(839461),i=n(259356),a=n(870372),s=n(293325),c=32,l=114,u=82,d=4;!function(e){e[e.NORMAL=0]="NORMAL",e[e.LINK=1]="LINK"}(r||(r={}));var p=Symbol.for("feature:".concat(a.C.SelectivePaste));i.Ln.merge(p,{useFactory:function(){return(0,o.__awaiter)(void 0,void 0,void 0,(function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5597),n.e(9820),n.e(7797),n.e(5049),n.e(8063),n.e(823),n.e(3974),n.e(4397),n.e(7021),n.e(7131)]).then(n.bind(n,537053))];case 1:return[2,e.sent().SelectivePasteHandler]}}))}))},on:s.iz.On({stages:[s.YV.Level3],key:p})})},259991:function(e,t,n){n.r(t),n.d(t,{IShareMobileFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.ShareMobile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(4565).then(n.bind(n,928400))];case 1:return[2,e.sent().ShareMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad]})})},162489:function(e,t,n){n.r(t),n.d(t,{IShareMobileWebFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=(n(495155),Symbol.for("feature:".concat(i.C.ShareMobileWeb)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(4686).then(n.bind(n,631747))];case 1:return[2,e.sent().ShareMobileWebHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile],load:!1})})},508810:function(e,t,n){n.r(t),n.d(t,{IShowMoreFeature:function(){return a}});var r=n(839461),o=n(259356),i=n(870372),a=Symbol.for("feature:".concat(i.C.ShowMore));o.Ln.merge(a,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(3314).then(n.bind(n,324344))];case 1:return[2,e.sent().ShowMoreFeature]}}))}))}})},836935:function(e,t,n){n.r(t),n.d(t,{ISnapScreenMobileFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.SnapScreenMobile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5597),n.e(9820),n.e(6205),n.e(8971),n.e(823),n.e(1997),n.e(1822)]).then(n.bind(n,576705))];case 1:return[2,e.sent().SnapScreenMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad]})})},673112:function(e,t,n){n.r(t),n.d(t,{ISnippetFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.Snippet));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.resolve().then(n.bind(n,436278))];case 1:return[2,e.sent().SnippetHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad]})})},436278:function(e,t,n){n.r(t),n.d(t,{SnippetHandler:function(){return b}});var r=n(839461),o=n(768352),i=n(259356),a=n(522142),s=n(45972),c=n(750670),l=n(870372),u=n(495155),d=n(647279),p=n(545704),f=n(673112),h=n(218581),m=JSON.parse('[{"ty":"is","bi":0,"s":"\\r任务一\\r\\r\\r\\r\\r任务二\\r\\r\\r\\r\\r"},{"ty":"ms","mt":"numbering","pr":{"numbering":{"num":{"tdhnwo":{"numId":"tdhnwo","abstractNumId":{"val":"o3komj"}},"tbzdvb":{"numId":"tbzdvb","abstractNumId":{"val":"q3ivbu"}}},"num_dict_op":{"opType":"Update"},"abstractNum":{"o3komj":{"abstractNumId":"o3komj","lvl":{"0":{"pPr":{"ind":{"left":336,"hanging":336}},"ilvl":0,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_decimal"},"lvlText":{"val":"%1."}},"1":{"ilvl":1,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerLetter"},"lvlText":{"val":"%2."},"pPr":{"ind":{"left":776,"hanging":336}}},"2":{"ilvl":2,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerRoman"},"lvlText":{"val":"%3."},"pPr":{"ind":{"left":1216,"hanging":336}}},"3":{"ilvl":3,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_decimal"},"lvlText":{"val":"%4."},"pPr":{"ind":{"left":1656,"hanging":336}}},"4":{"ilvl":4,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerLetter"},"lvlText":{"val":"%5."},"pPr":{"ind":{"left":2096,"hanging":336}}},"5":{"ilvl":5,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerRoman"},"lvlText":{"val":"%6."},"pPr":{"ind":{"left":2536,"hanging":336}}},"6":{"ilvl":6,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_decimal"},"lvlText":{"val":"%7."},"pPr":{"ind":{"left":2976,"hanging":336}}},"7":{"ilvl":7,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerLetter"},"lvlText":{"val":"%8."},"pPr":{"ind":{"left":3416,"hanging":336}}}},"lvl_dict_op":{"opType":"Update"}},"q3ivbu":{"abstractNumId":"q3ivbu","lvl":{"0":{"pPr":{"ind":{"left":336,"hanging":336}},"ilvl":0,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_task"},"lvlText":{"val":""}}},"lvl_dict_op":{"opType":"Update"}}},"abstractNum_dict_op":{"opType":"Update"}}}},{"ty":"mp","bi":0,"ei":1,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":1,"ei":4,"mt":"run","pr":{"run":{"author":"","color":{"val":"1E6FFF"}}}},{"ty":"mp","bi":4,"ei":5,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":"","color":{"val":"1E6FFF"}}}},{"ty":"mp","bi":5,"ei":6,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":6,"ei":7,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":7,"ei":8,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":8,"ei":9,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":9,"ei":12,"mt":"run","pr":{"run":{"author":"","color":{"val":"1E6FFF"}}}},{"ty":"mp","bi":12,"ei":13,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":"","color":{"val":"1E6FFF"}}}},{"ty":"mp","bi":13,"ei":14,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":14,"ei":15,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":15,"ei":16,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":16,"ei":17,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":0,"ei":1,"mt":"paragraph","pr":{"paragraph":{"pStyle":{"val":"Normal"}}}},{"ty":"mp","bi":4,"ei":5,"mt":"paragraph","pr":{"paragraph":{"numPr":{"ilvl":{"val":0},"numId":{"val":"tdhnwo"}},"taskPr":{"taskState":"STTaskState_todo"},"pStyle":{"val":"heading 3"}}}},{"ty":"mp","bi":5,"ei":6,"mt":"paragraph","pr":{"paragraph":{"numPr":{"numId":{"val":"tbzdvb"},"ilvl":{"val":0}},"taskPr":{"taskState":"STTaskState_todo"},"pStyle":{"val":"Normal"},"hintType":"输入\\u0013mention\\u0014@\\u0015，邀请相关人员一起完成任务。"}}},{"ty":"mp","bi":6,"ei":7,"mt":"paragraph","pr":{"paragraph":{"numPr":{"numId":{"val":"tbzdvb"},"ilvl":{"val":0}},"taskPr":{"taskState":"STTaskState_todo"},"pStyle":{"val":"Normal"},"hintType":"插入\\u0013doc\\u0014腾讯文档\\u0015，快速插入相关文档。"}}},{"ty":"mp","bi":7,"ei":8,"mt":"paragraph","pr":{"paragraph":{"numPr":{"numId":{"val":"tbzdvb"},"ilvl":{"val":0}},"taskPr":{"taskState":"STTaskState_todo"},"pStyle":{"val":"Normal"},"hintType":"..."}}},{"ty":"mp","bi":8,"ei":9,"mt":"paragraph","pr":{"paragraph":{"pStyle":{"val":"Normal"}}}},{"ty":"mp","bi":12,"ei":13,"mt":"paragraph","pr":{"paragraph":{"numPr":{"ilvl":{"val":0},"numId":{"val":"tdhnwo"}},"taskPr":{"taskState":"STTaskState_todo"},"pStyle":{"val":"heading 3"}}}},{"ty":"mp","bi":13,"ei":14,"mt":"paragraph","pr":{"paragraph":{"numPr":{"numId":{"val":"tbzdvb"},"ilvl":{"val":0}},"taskPr":{"taskState":"STTaskState_todo"},"pStyle":{"val":"Normal"},"hintType":"输入\\u0013mention\\u0014@\\u0015，邀请相关人员一起完成任务。"}}},{"ty":"mp","bi":14,"ei":15,"mt":"paragraph","pr":{"paragraph":{"numPr":{"numId":{"val":"tbzdvb"},"ilvl":{"val":0}},"taskPr":{"taskState":"STTaskState_todo"},"pStyle":{"val":"Normal"},"hintType":"插入\\u0013doc\\u0014腾讯文档\\u0015，快速插入相关文档。"}}},{"ty":"mp","bi":15,"ei":16,"mt":"paragraph","pr":{"paragraph":{"numPr":{"numId":{"val":"tbzdvb"},"ilvl":{"val":0}},"taskPr":{"taskState":"STTaskState_todo"},"pStyle":{"val":"Normal"},"hintType":"..."}}},{"ty":"mp","bi":16,"ei":17,"mt":"paragraph","pr":{"paragraph":{"pStyle":{"val":"Normal"},"ind":{"left":0}}}}]'),g=JSON.parse('[{"ty":"is","bi":0,"s":"\\r\\u001a今日工作\\r\\u0007明日计划\\r\\u0007\\u0006\\r\\r\\u0007\\r\\r\\u0007\\u0006工作小结\\r\\u0007\\u0006\\r\\u0007\\u0006\\u001b\\r"},{"ty":"ms","mt":"numbering","pr":{"numbering":{"num":{"hwawmf":{"numId":"hwawmf","abstractNumId":{"val":"gsduof"}},"exb73x":{"numId":"exb73x","abstractNumId":{"val":"60it8z"}}},"num_dict_op":{"opType":"Update"},"abstractNum":{"gsduof":{"abstractNumId":"gsduof","lvl":{"0":{"pPr":{"ind":{"left":336,"hanging":336}},"ilvl":0,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_decimal"},"lvlText":{"val":"%1."}},"1":{"ilvl":1,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerLetter"},"lvlText":{"val":"%2."},"pPr":{"ind":{"left":776,"hanging":336}}},"2":{"ilvl":2,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerRoman"},"lvlText":{"val":"%3."},"pPr":{"ind":{"left":1216,"hanging":336}}},"3":{"ilvl":3,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_decimal"},"lvlText":{"val":"%4."},"pPr":{"ind":{"left":1656,"hanging":336}}},"4":{"ilvl":4,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerLetter"},"lvlText":{"val":"%5."},"pPr":{"ind":{"left":2096,"hanging":336}}},"5":{"ilvl":5,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerRoman"},"lvlText":{"val":"%6."},"pPr":{"ind":{"left":2536,"hanging":336}}},"6":{"ilvl":6,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_decimal"},"lvlText":{"val":"%7."},"pPr":{"ind":{"left":2976,"hanging":336}}},"7":{"ilvl":7,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerLetter"},"lvlText":{"val":"%8."},"pPr":{"ind":{"left":3416,"hanging":336}}}},"lvl_dict_op":{"opType":"Update"}},"60it8z":{"abstractNumId":"60it8z","lvl":{"0":{"pPr":{"ind":{"left":336,"hanging":336}},"ilvl":0,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_decimal"},"lvlText":{"val":"%1."}},"1":{"ilvl":1,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerLetter"},"lvlText":{"val":"%2."},"pPr":{"ind":{"left":776,"hanging":336}}},"2":{"ilvl":2,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerRoman"},"lvlText":{"val":"%3."},"pPr":{"ind":{"left":1216,"hanging":336}}},"3":{"ilvl":3,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_decimal"},"lvlText":{"val":"%4."},"pPr":{"ind":{"left":1656,"hanging":336}}},"4":{"ilvl":4,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerLetter"},"lvlText":{"val":"%5."},"pPr":{"ind":{"left":2096,"hanging":336}}},"5":{"ilvl":5,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerRoman"},"lvlText":{"val":"%6."},"pPr":{"ind":{"left":2536,"hanging":336}}},"6":{"ilvl":6,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_decimal"},"lvlText":{"val":"%7."},"pPr":{"ind":{"left":2976,"hanging":336}}},"7":{"ilvl":7,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerLetter"},"lvlText":{"val":"%8."},"pPr":{"ind":{"left":3416,"hanging":336}}}},"lvl_dict_op":{"opType":"Update"}}},"abstractNum_dict_op":{"opType":"Update"}}}},{"ty":"mp","bi":0,"ei":1,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":1,"ei":2,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":2,"ei":6,"mt":"run","pr":{"run":{"b":{"val":true},"color":{"val":"1E6FFF"},"author":""}}},{"ty":"mp","bi":6,"ei":7,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":7,"ei":8,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":8,"ei":12,"mt":"run","pr":{"run":{"color":{"val":"1E6FFF"},"b":{"val":true},"author":""}}},{"ty":"mp","bi":12,"ei":13,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":"","b":{"val":true}}}},{"ty":"mp","bi":13,"ei":14,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":14,"ei":15,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":15,"ei":16,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":16,"ei":17,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":17,"ei":18,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":18,"ei":19,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":19,"ei":20,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":20,"ei":21,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":21,"ei":22,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":22,"ei":26,"mt":"run","pr":{"run":{"author":"","b":{"val":true},"color":{"val":"005A5B"}}}},{"ty":"mp","bi":26,"ei":27,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":"","color":{"val":"005A5B"}}}},{"ty":"mp","bi":27,"ei":28,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":28,"ei":29,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":29,"ei":30,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":30,"ei":31,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":31,"ei":32,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":32,"ei":33,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":33,"ei":34,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":0,"ei":1,"mt":"paragraph","pr":{"paragraph":{"pBdr_i":true}}},{"ty":"mp","bi":1,"ei":2,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":6,"ei":7,"mt":"paragraph","pr":{"paragraph":{"pStyle_i":true,"pBdr_i":true,"ind_i":true,"jc":{"val":"STJcWml_center"},"outlineLvl_i":true}}},{"ty":"mp","bi":7,"ei":8,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":12,"ei":13,"mt":"paragraph","pr":{"paragraph":{"pStyle_i":true,"pBdr_i":true,"ind_i":true,"jc":{"val":"STJcWml_center"},"outlineLvl_i":true}}},{"ty":"mp","bi":13,"ei":14,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":14,"ei":15,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":15,"ei":16,"mt":"paragraph","pr":{"paragraph":{"pStyle_i":true,"numPr":{"numId":{"val":"hwawmf"},"ilvl":{"val":0}},"pBdr_i":true,"outlineLvl_i":true,"taskPr":{"taskState":"STTaskState_todo"},"hintType":"输入今日工作，并\\u0013mention\\u0014@相关人员\\u0015"}}},{"ty":"mp","bi":16,"ei":17,"mt":"paragraph","pr":{"paragraph":{"pStyle_i":true,"numPr":{"numId":{"val":"hwawmf"},"ilvl":{"val":0}},"pBdr_i":true,"outlineLvl_i":true,"taskPr":{"taskState":"STTaskState_todo"},"hintType":"也可以插入\\u0013doc\\u0014腾讯文档\\u0015"}}},{"ty":"mp","bi":17,"ei":18,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":18,"ei":19,"mt":"paragraph","pr":{"paragraph":{"pStyle_i":true,"numPr":{"numId":{"val":"exb73x"},"ilvl":{"val":0}},"pBdr_i":true,"outlineLvl_i":true,"taskPr":{"taskState":"STTaskState_todo"},"hintType":"输入今日工作，并\\u0013mention\\u0014@相关人员\\u0015"}}},{"ty":"mp","bi":19,"ei":20,"mt":"paragraph","pr":{"paragraph":{"pStyle_i":true,"numPr":{"numId":{"val":"exb73x"},"ilvl":{"val":0}},"pBdr_i":true,"outlineLvl_i":true,"taskPr":{"taskState":"STTaskState_todo"},"hintType":"也可以插入\\u0013doc\\u0014腾讯文档\\u0015"}}},{"ty":"mp","bi":20,"ei":21,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":21,"ei":22,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":26,"ei":27,"mt":"paragraph","pr":{"paragraph":{"pStyle_i":true,"pBdr_i":true,"ind_i":true,"outlineLvl_i":true,"jc":{"val":"STJcWml_center"}}}},{"ty":"mp","bi":27,"ei":28,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":28,"ei":29,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":29,"ei":30,"mt":"paragraph","pr":{"paragraph":{"pStyle_i":true,"pBdr_i":true,"ind_i":true,"outlineLvl_i":true,"spacing":{"line":240,"lineRule":"STLineSpacingRule_auto"},"hintType":"今日完成了..."}}},{"ty":"mp","bi":30,"ei":31,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":31,"ei":32,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":32,"ei":33,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":33,"ei":34,"mt":"paragraph","pr":{"paragraph":{}}},{"ty":"mp","bi":1,"ei":2,"mt":"table","pr":{"table":{"tblPr":{"isBegin":true}}}},{"ty":"mp","bi":32,"ei":33,"mt":"table","pr":{"table":{"tblPr":{"tblStyle":{"val":"Table Grid"},"nestingLevel":1}}}},{"ty":"mp","bi":32,"ei":33,"mt":"tableRow","pr":{"tableRow":{"isPlaceholder":true}},"mm":"merge"},{"ty":"mp","bi":32,"ei":33,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true}},"mm":"merge"},{"ty":"mp","bi":14,"ei":15,"mt":"tableRow","pr":{"tableRow":{"trHeight":{"val":661},"nestingLevel":1}}},{"ty":"mp","bi":21,"ei":22,"mt":"tableRow","pr":{"tableRow":{"trHeight":{"val":1696},"nestingLevel":1}}},{"ty":"mp","bi":28,"ei":29,"mt":"tableRow","pr":{"tableRow":{"trHeight":{"val":301},"nestingLevel":1}}},{"ty":"mp","bi":31,"ei":32,"mt":"tableRow","pr":{"tableRow":{"trHeight":{"val":2011},"nestingLevel":1}}},{"ty":"mp","bi":14,"ei":15,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true}},"mm":"merge"},{"ty":"mp","bi":21,"ei":22,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true}},"mm":"merge"},{"ty":"mp","bi":28,"ei":29,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true}},"mm":"merge"},{"ty":"mp","bi":31,"ei":32,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true}},"mm":"merge"},{"ty":"mp","bi":7,"ei":8,"mt":"tableCell","pr":{"tableCell":{"tcW":{"w":4140,"type":"STTblWidth_dxa"},"shd":{"fill":"E6F5FF"},"nestingLevel":1,"tcBorders":{"top":{"val":"STBorder_single","color":"999999","sz":4,"space":0},"left":{"val":"STBorder_single","color":"999999","sz":4,"space":0},"right":{"val":"STBorder_single","color":"999999","sz":4,"space":0},"bottom":{"val":"STBorder_single","color":"999999","sz":4,"space":0}}}}},{"ty":"mp","bi":13,"ei":14,"mt":"tableCell","pr":{"tableCell":{"tcW":{"w":4140,"type":"STTblWidth_dxa"},"shd":{"fill":"E6F5FF"},"nestingLevel":1,"tcBorders":{"top":{"val":"STBorder_single","color":"999999","sz":4,"space":0},"left":{"val":"STBorder_single","color":"999999","sz":4,"space":0},"right":{"val":"STBorder_single","color":"999999","sz":4,"space":0},"bottom":{"val":"STBorder_single","color":"999999","sz":4,"space":0}}}}},{"ty":"mp","bi":17,"ei":18,"mt":"tableCell","pr":{"tableCell":{"tcW":{"w":4140,"type":"STTblWidth_dxa"},"nestingLevel":1,"tcBorders":{"top":{"val":"STBorder_single","color":"999999","sz":4,"space":0},"left":{"val":"STBorder_single","color":"999999","sz":4,"space":0},"right":{"val":"STBorder_single","color":"999999","sz":4,"space":0},"bottom":{"val":"STBorder_single","color":"999999","sz":4,"space":0}}}}},{"ty":"mp","bi":20,"ei":21,"mt":"tableCell","pr":{"tableCell":{"tcW":{"w":4140,"type":"STTblWidth_dxa"},"nestingLevel":1,"tcBorders":{"top":{"val":"STBorder_single","color":"999999","sz":4,"space":0},"left":{"val":"STBorder_single","color":"999999","sz":4,"space":0},"right":{"val":"STBorder_single","color":"999999","sz":4,"space":0},"bottom":{"val":"STBorder_single","color":"999999","sz":4,"space":0}}}}},{"ty":"mp","bi":27,"ei":28,"mt":"tableCell","pr":{"tableCell":{"tcW":{"w":8280,"type":"STTblWidth_dxa"},"tcBorders":{"top":{"val":"STBorder_single","color":"999999","sz":4,"space":0},"left":{"val":"STBorder_single","color":"999999","sz":4,"space":0},"bottom":{"val":"STBorder_single","color":"999999","sz":4,"space":0},"right":{"val":"STBorder_single","color":"999999","sz":4,"space":0}},"shd":{"fill":"E0FBFA"},"nestingLevel":1}}},{"ty":"mp","bi":30,"ei":31,"mt":"tableCell","pr":{"tableCell":{"tcW":{"w":8280,"type":"STTblWidth_dxa"},"tcBorders":{"top":{"val":"STBorder_single","color":"999999","sz":4,"space":0},"left":{"val":"STBorder_single","color":"999999","sz":4,"space":0},"bottom":{"val":"STBorder_single","color":"999999","sz":4,"space":0},"right":{"val":"STBorder_single","color":"999999","sz":4,"space":0}},"nestingLevel":1,"vAlign":{"val":"STVerticalJc_top"}}}},{"ty":"mp","bi":1,"ei":2,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true,"nestingLevel":1}}},{"ty":"mp","bi":1,"ei":2,"mt":"tableRow","pr":{"tableRow":{"isPlaceholder":true,"nestingLevel":1}}}]'),v=JSON.parse('[{"ty":"is","bi":0,"s":"\\r本周工作内容\\r\\r\\r核心项目一\\r\\r\\r\\r\\r核心项目二\\r\\r\\r\\r\\r\\r\\r\\r下周工作计划\\r\\r\\r"},{"ty":"ms","mt":"numbering","pr":{"numbering":{"num":{"hozqep":{"numId":"hozqep","abstractNumId":{"val":"wrej51"}},"4unfpg":{"numId":"4unfpg","abstractNumId":{"val":"5hywrf"}},"3vcifm":{"numId":"3vcifm","abstractNumId":{"val":"3lc2wl"}}},"num_dict_op":{"opType":"Update"},"abstractNum":{"wrej51":{"abstractNumId":"wrej51","lvl":{"0":{"pPr":{"ind":{"left":336,"hanging":336}},"ilvl":0,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_bullet"},"rPr":{"rFonts":{"ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"},"color":{"val":"1E6FFF"},"kern":{"val":20},"sz":{"val":280},"szCs":{"val":280},"b":{"val":false},"bCs":{"val":true},"isPlaceholder":true,"author":"","i":{"val":false}},"lvlText":{"val":""}},"1":{"ilvl":1,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_bullet"},"lvlText":{"val":"¡"},"pPr":{"ind":{"left":776,"hanging":336}},"rPr":{"rFonts":{"ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}}},"2":{"ilvl":2,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_bullet"},"lvlText":{"val":""},"pPr":{"ind":{"left":1216,"hanging":336}},"rPr":{"rFonts":{"ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}}},"3":{"ilvl":3,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"lvlText":{"val":""},"numFmt":{"val":"STNumberFormat_bullet"},"pPr":{"ind":{"left":1656,"hanging":336}},"rPr":{"rFonts":{"ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}}},"4":{"ilvl":4,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"lvlText":{"val":"¡"},"numFmt":{"val":"STNumberFormat_bullet"},"pPr":{"ind":{"left":2096,"hanging":336}},"rPr":{"rFonts":{"ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}}},"5":{"ilvl":5,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"lvlText":{"val":""},"numFmt":{"val":"STNumberFormat_bullet"},"pPr":{"ind":{"left":2536,"hanging":336}},"rPr":{"rFonts":{"ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}}},"6":{"ilvl":6,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"lvlText":{"val":""},"numFmt":{"val":"STNumberFormat_bullet"},"pPr":{"ind":{"left":2976,"hanging":336}},"rPr":{"rFonts":{"ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}}},"7":{"ilvl":7,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"lvlText":{"val":"¡"},"numFmt":{"val":"STNumberFormat_bullet"},"pPr":{"ind":{"left":3416,"hanging":336}},"rPr":{"rFonts":{"ascii":"wingdings","hAnsi":"wingdings","eastAsia":"wingdings","cs":"wingdings"}}}},"lvl_dict_op":{"opType":"Update"}},"5hywrf":{"abstractNumId":"5hywrf","lvl":{"0":{"pPr":{"ind":{"left":336,"hanging":336}},"ilvl":0,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_decimal"},"lvlText":{"val":"%1."}},"1":{"ilvl":1,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerLetter"},"lvlText":{"val":"%2."},"pPr":{"ind":{"left":776,"hanging":336}}},"2":{"ilvl":2,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerRoman"},"lvlText":{"val":"%3."},"pPr":{"ind":{"left":1216,"hanging":336}}},"3":{"ilvl":3,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_decimal"},"lvlText":{"val":"%4."},"pPr":{"ind":{"left":1656,"hanging":336}}},"4":{"ilvl":4,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerLetter"},"lvlText":{"val":"%5."},"pPr":{"ind":{"left":2096,"hanging":336}}},"5":{"ilvl":5,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerRoman"},"lvlText":{"val":"%6."},"pPr":{"ind":{"left":2536,"hanging":336}}},"6":{"ilvl":6,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_decimal"},"lvlText":{"val":"%7."},"pPr":{"ind":{"left":2976,"hanging":336}}},"7":{"ilvl":7,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerLetter"},"lvlText":{"val":"%8."},"pPr":{"ind":{"left":3416,"hanging":336}}}},"lvl_dict_op":{"opType":"Update"}},"3lc2wl":{"abstractNumId":"3lc2wl","lvl":{"0":{"pPr":{"ind":{"left":336,"hanging":336}},"ilvl":0,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_decimal"},"lvlText":{"val":"%1."}},"1":{"ilvl":1,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerLetter"},"lvlText":{"val":"%2."},"pPr":{"ind":{"left":776,"hanging":336}}},"2":{"ilvl":2,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerRoman"},"lvlText":{"val":"%3."},"pPr":{"ind":{"left":1216,"hanging":336}}},"3":{"ilvl":3,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_decimal"},"lvlText":{"val":"%4."},"pPr":{"ind":{"left":1656,"hanging":336}}},"4":{"ilvl":4,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerLetter"},"lvlText":{"val":"%5."},"pPr":{"ind":{"left":2096,"hanging":336}}},"5":{"ilvl":5,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerRoman"},"lvlText":{"val":"%6."},"pPr":{"ind":{"left":2536,"hanging":336}}},"6":{"ilvl":6,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_decimal"},"lvlText":{"val":"%7."},"pPr":{"ind":{"left":2976,"hanging":336}}},"7":{"ilvl":7,"start":{"val":1},"lvlJc":{"val":"STJcWml_left"},"numFmt":{"val":"STNumberFormat_lowerLetter"},"lvlText":{"val":"%8."},"pPr":{"ind":{"left":3416,"hanging":336}}}},"lvl_dict_op":{"opType":"Update"}}},"abstractNum_dict_op":{"opType":"Update"}}}},{"ty":"mp","bi":0,"ei":1,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":1,"ei":7,"mt":"run","pr":{"run":{"author":""}}},{"ty":"mp","bi":7,"ei":8,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":8,"ei":9,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":9,"ei":10,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":10,"ei":15,"mt":"run","pr":{"run":{"author":"","color":{"val":"1E6FFF"}}}},{"ty":"mp","bi":15,"ei":16,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":"","color":{"val":"1E6FFF"}}}},{"ty":"mp","bi":16,"ei":17,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":17,"ei":18,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":18,"ei":19,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":19,"ei":20,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":20,"ei":25,"mt":"run","pr":{"run":{"author":"","color":{"val":"1E6FFF"}}}},{"ty":"mp","bi":25,"ei":26,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":"","color":{"val":"1E6FFF"}}}},{"ty":"mp","bi":26,"ei":27,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":27,"ei":28,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":28,"ei":29,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":29,"ei":30,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":30,"ei":31,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":31,"ei":32,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":32,"ei":33,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":33,"ei":39,"mt":"run","pr":{"run":{"author":""}}},{"ty":"mp","bi":39,"ei":40,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":40,"ei":41,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":41,"ei":42,"mt":"run","pr":{"run":{"isPlaceholder":true}}},{"ty":"mp","bi":0,"ei":1,"mt":"paragraph","pr":{"paragraph":{}}},{"ty":"mp","bi":7,"ei":8,"mt":"paragraph","pr":{"paragraph":{"pStyle":{"val":"heading 1"}}}},{"ty":"mp","bi":8,"ei":9,"mt":"paragraph","pr":{"paragraph":{"pStyle":{"val":"Normal"},"hintType":"添加工作总结描述"}}},{"ty":"mp","bi":9,"ei":10,"mt":"paragraph","pr":{"paragraph":{"pStyle":{"val":"Normal"}}}},{"ty":"mp","bi":15,"ei":16,"mt":"paragraph","pr":{"paragraph":{"numPr":{"ilvl":{"val":0},"numId":{"val":"hozqep"}},"taskPr":{"taskState":"STTaskState_todo"},"pStyle":{"val":"heading 3"}}}},{"ty":"mp","bi":16,"ei":17,"mt":"paragraph","pr":{"paragraph":{"numPr":{"numId":{"val":"4unfpg"},"ilvl":{"val":0}},"taskPr":{"taskState":"STTaskState_todo"},"pStyle":{"val":"Normal"},"hintType":"某某人：完成了XX工作，进度XX。输入\\u0013mention\\u0014@\\u0015，邀请他一起确认。"}}},{"ty":"mp","bi":17,"ei":18,"mt":"paragraph","pr":{"paragraph":{"numPr":{"numId":{"val":"4unfpg"},"ilvl":{"val":0}},"taskPr":{"taskState":"STTaskState_todo"},"pStyle":{"val":"Normal"},"hintType":"插入\\u0013doc\\u0014腾讯文档\\u0015，快速插入相关文档。"}}},{"ty":"mp","bi":18,"ei":19,"mt":"paragraph","pr":{"paragraph":{"numPr":{"numId":{"val":"4unfpg"},"ilvl":{"val":0}},"taskPr":{"taskState":"STTaskState_todo"},"pStyle":{"val":"Normal"},"hintType":"..."}}},{"ty":"mp","bi":19,"ei":20,"mt":"paragraph","pr":{"paragraph":{"taskPr":{"taskState":"STTaskState_todo"},"pStyle":{"val":"Normal"},"ind":{"leftChars":0,"left":0}}}},{"ty":"mp","bi":25,"ei":26,"mt":"paragraph","pr":{"paragraph":{"numPr":{"ilvl":{"val":0},"numId":{"val":"hozqep"}},"taskPr":{"taskState":"STTaskState_todo"},"pStyle":{"val":"heading 3"}}}},{"ty":"mp","bi":26,"ei":27,"mt":"paragraph","pr":{"paragraph":{"numPr":{"numId":{"val":"3vcifm"},"ilvl":{"val":0}},"taskPr":{"taskState":"STTaskState_todo"},"pStyle":{"val":"Normal"},"hintType":"某某人：完成了XX工作，进度XX。"}}},{"ty":"mp","bi":27,"ei":28,"mt":"paragraph","pr":{"paragraph":{"numPr":{"numId":{"val":"3vcifm"},"ilvl":{"val":0}},"taskPr":{"taskState":"STTaskState_todo"},"pStyle":{"val":"Normal"},"hintType":"某某人：完成了XX工作，进度XX。"}}},{"ty":"mp","bi":28,"ei":29,"mt":"paragraph","pr":{"paragraph":{"numPr":{"numId":{"val":"3vcifm"},"ilvl":{"val":0}},"taskPr":{"taskState":"STTaskState_todo"},"pStyle":{"val":"Normal"},"hintType":"..."}}},{"ty":"mp","bi":29,"ei":30,"mt":"paragraph","pr":{"paragraph":{"pStyle":{"val":"Normal"}}}},{"ty":"mp","bi":30,"ei":31,"mt":"paragraph","pr":{"paragraph":{"numPr":{"ilvl":{"val":0},"numId":{"val":"hozqep"}},"taskPr":{"taskState":"STTaskState_todo"},"pStyle":{"val":"heading 3"},"hintType":"..."}}},{"ty":"mp","bi":31,"ei":32,"mt":"paragraph","pr":{"paragraph":{"pStyle":{"val":"Normal"}}}},{"ty":"mp","bi":32,"ei":33,"mt":"paragraph","pr":{"paragraph":{"pStyle":{"val":"Normal"}}}},{"ty":"mp","bi":39,"ei":40,"mt":"paragraph","pr":{"paragraph":{"pStyle":{"val":"heading 1"}}}},{"ty":"mp","bi":40,"ei":41,"mt":"paragraph","pr":{"paragraph":{"pStyle":{"val":"Normal"},"hintType":"描述下周工作内容或者项目"}}},{"ty":"mp","bi":41,"ei":42,"mt":"paragraph","pr":{"paragraph":{"pStyle":{"val":"Normal"}}}}]'),_=JSON.parse('[{"ty":"is","bi":0,"s":"\\r参会人员：张三 ｜ 李四 ｜ 王五\\r会议时间：XXXX年XX月XX日\\r\\r会议讨论\\r\\u001a会议讨论主题一\\r\\u0007\\u0006\\r\\u0007\\u0006\\r\\u0007\\u0006\\r\\u0007\\u0006会议讨论主题二\\r\\u0007\\u0006\\r\\u0007\\u0006\\r\\u0007\\u0006\\r\\u0007\\u0006\\u001b\\r会议结论\\r\\u001a\\r\\u0007\\u0006\\r\\u0007\\u0006\\r\\u0007\\u0006\\u001b\\r"},{"ty":"mp","bi":0,"ei":1,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":1,"ei":18,"mt":"run","pr":{"run":{"author":""}}},{"ty":"mp","bi":18,"ei":19,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":19,"ei":35,"mt":"run","pr":{"run":{"author":""}}},{"ty":"mp","bi":35,"ei":36,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":36,"ei":37,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":37,"ei":41,"mt":"run","pr":{"run":{"author":"","sz":{"val":360}}}},{"ty":"mp","bi":41,"ei":42,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":"","sz":{"val":360}}}},{"ty":"mp","bi":42,"ei":43,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":43,"ei":50,"mt":"run","pr":{"run":{"author":"","color":{"val":"1E6FFF"},"sz":{"val":240},"b":{"val":true}}}},{"ty":"mp","bi":50,"ei":51,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":"","color":{"val":"1E6FFF"},"sz":{"val":240},"b":{"val":true}}}},{"ty":"mp","bi":51,"ei":52,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":52,"ei":53,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":53,"ei":54,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":54,"ei":55,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":55,"ei":56,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":56,"ei":57,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":57,"ei":58,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":58,"ei":59,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":59,"ei":60,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":60,"ei":61,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":61,"ei":62,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":62,"ei":69,"mt":"run","pr":{"run":{"author":"","b":{"val":true},"color":{"val":"1E6FFF"},"sz":{"val":240}}}},{"ty":"mp","bi":69,"ei":70,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":"","b":{"val":true},"color":{"val":"1E6FFF"},"sz":{"val":240}}}},{"ty":"mp","bi":70,"ei":71,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":71,"ei":72,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":72,"ei":73,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":73,"ei":74,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":74,"ei":75,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":75,"ei":76,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":76,"ei":77,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":77,"ei":78,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":78,"ei":79,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":79,"ei":80,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":80,"ei":81,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":81,"ei":82,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":82,"ei":83,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":83,"ei":87,"mt":"run","pr":{"run":{"author":"","sz":{"val":360},"b":{"val":true}}}},{"ty":"mp","bi":87,"ei":88,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":"","sz":{"val":360},"b":{"val":true}}}},{"ty":"mp","bi":88,"ei":89,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":89,"ei":90,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":"","sz":{"val":220},"b":{"val":false}}}},{"ty":"mp","bi":90,"ei":91,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":91,"ei":92,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":92,"ei":93,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":"","sz":{"val":220},"b":{"val":false}}}},{"ty":"mp","bi":93,"ei":94,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":94,"ei":95,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":95,"ei":96,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":"","sz":{"val":220},"b":{"val":false}}}},{"ty":"mp","bi":96,"ei":97,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":97,"ei":98,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":98,"ei":99,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":99,"ei":100,"mt":"run","pr":{"run":{"isPlaceholder":true,"author":""}}},{"ty":"mp","bi":0,"ei":1,"mt":"paragraph","pr":{"paragraph":{}}},{"ty":"mp","bi":18,"ei":19,"mt":"paragraph","pr":{"paragraph":{}}},{"ty":"mp","bi":35,"ei":36,"mt":"paragraph","pr":{"paragraph":{}}},{"ty":"mp","bi":36,"ei":37,"mt":"paragraph","pr":{"paragraph":{}}},{"ty":"mp","bi":41,"ei":42,"mt":"paragraph","pr":{"paragraph":{"pStyle":{"val":"heading 1"}}}},{"ty":"mp","bi":42,"ei":43,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":50,"ei":51,"mt":"paragraph","pr":{"paragraph":{"pStyle_i":true,"outlineLvl_i":true,"ind_i":true,"pBdr_i":true}}},{"ty":"mp","bi":51,"ei":52,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":52,"ei":53,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":53,"ei":54,"mt":"paragraph","pr":{"paragraph":{"pStyle_i":true,"outlineLvl_i":true,"ind_i":true,"pBdr_i":true,"hintType":"\\u0013mention\\u0014@相关人员：\\u0015描述讨论观点和关键内容"}}},{"ty":"mp","bi":54,"ei":55,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":55,"ei":56,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":56,"ei":57,"mt":"paragraph","pr":{"paragraph":{"pStyle_i":true,"outlineLvl_i":true,"ind_i":true,"pBdr_i":true,"hintType":"\\u0013mention\\u0014@相关人员：\\u0015描述讨论观点和关键内容"}}},{"ty":"mp","bi":57,"ei":58,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":58,"ei":59,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":59,"ei":60,"mt":"paragraph","pr":{"paragraph":{"pStyle_i":true,"outlineLvl_i":true,"ind_i":true,"pBdr_i":true,"hintType":"..."}}},{"ty":"mp","bi":60,"ei":61,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":61,"ei":62,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":69,"ei":70,"mt":"paragraph","pr":{"paragraph":{"pStyle_i":true,"outlineLvl_i":true,"ind_i":true,"pBdr_i":true}}},{"ty":"mp","bi":70,"ei":71,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":71,"ei":72,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":72,"ei":73,"mt":"paragraph","pr":{"paragraph":{"pStyle_i":true,"outlineLvl_i":true,"ind_i":true,"pBdr_i":true,"hintType":"\\u0013mention\\u0014@相关人员：\\u0015描述讨论观点和关键内容"}}},{"ty":"mp","bi":73,"ei":74,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":74,"ei":75,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":75,"ei":76,"mt":"paragraph","pr":{"paragraph":{"pStyle_i":true,"outlineLvl_i":true,"ind_i":true,"pBdr_i":true,"hintType":"\\u0013mention\\u0014@相关人员：\\u0015描述讨论观点和关键内容"}}},{"ty":"mp","bi":76,"ei":77,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":77,"ei":78,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":78,"ei":79,"mt":"paragraph","pr":{"paragraph":{"pStyle_i":true,"outlineLvl_i":true,"ind_i":true,"pBdr_i":true,"hintType":"..."}}},{"ty":"mp","bi":79,"ei":80,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":80,"ei":81,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":81,"ei":82,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":82,"ei":83,"mt":"paragraph","pr":{"paragraph":{"pStyle":{"val":"Normal"}}}},{"ty":"mp","bi":87,"ei":88,"mt":"paragraph","pr":{"paragraph":{"pStyle":{"val":"Normal"}}}},{"ty":"mp","bi":88,"ei":89,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":89,"ei":90,"mt":"paragraph","pr":{"paragraph":{"pStyle_i":true,"outlineLvl_i":true,"ind_i":true,"pBdr_i":true,"hintType":"结论一..., 输入\\u0013mention\\u0014@\\u0015，邀请相关人员。"}}},{"ty":"mp","bi":90,"ei":91,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":91,"ei":92,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":92,"ei":93,"mt":"paragraph","pr":{"paragraph":{"pStyle_i":true,"outlineLvl_i":true,"ind_i":true,"pBdr_i":true,"hintType":"结论二..., 输入\\u0013mention\\u0014@\\u0015，邀请相关人员。"}}},{"ty":"mp","bi":93,"ei":94,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":94,"ei":95,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":95,"ei":96,"mt":"paragraph","pr":{"paragraph":{"pStyle_i":true,"outlineLvl_i":true,"ind_i":true,"pBdr_i":true,"hintType":"..."}}},{"ty":"mp","bi":96,"ei":97,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":97,"ei":98,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":98,"ei":99,"mt":"paragraph","pr":{"paragraph":{"isPlaceholder":true}}},{"ty":"mp","bi":99,"ei":100,"mt":"paragraph","pr":{"paragraph":{}}},{"ty":"mp","bi":42,"ei":43,"mt":"table","pr":{"table":{"tblPr":{"isBegin":true}}}},{"ty":"mp","bi":81,"ei":82,"mt":"table","pr":{"table":{"tblPr":{"nestingLevel":1,"tblStyle":{"val":"Table Grid"}}}}},{"ty":"mp","bi":88,"ei":89,"mt":"table","pr":{"table":{"tblPr":{"isBegin":true}}}},{"ty":"mp","bi":98,"ei":99,"mt":"table","pr":{"table":{"tblPr":{"nestingLevel":1,"tblStyle":{"val":"Table Grid"}}}}},{"ty":"mp","bi":52,"ei":53,"mt":"tableRow","pr":{"tableRow":{"nestingLevel":1}}},{"ty":"mp","bi":55,"ei":56,"mt":"tableRow","pr":{"tableRow":{"nestingLevel":1}}},{"ty":"mp","bi":58,"ei":59,"mt":"tableRow","pr":{"tableRow":{"nestingLevel":1}}},{"ty":"mp","bi":61,"ei":62,"mt":"tableRow","pr":{"tableRow":{"nestingLevel":1}}},{"ty":"mp","bi":71,"ei":72,"mt":"tableRow","pr":{"tableRow":{"nestingLevel":1}}},{"ty":"mp","bi":74,"ei":75,"mt":"tableRow","pr":{"tableRow":{"nestingLevel":1}}},{"ty":"mp","bi":77,"ei":78,"mt":"tableRow","pr":{"tableRow":{"nestingLevel":1}}},{"ty":"mp","bi":80,"ei":81,"mt":"tableRow","pr":{"tableRow":{"nestingLevel":1}}},{"ty":"mp","bi":91,"ei":92,"mt":"tableRow","pr":{"tableRow":{"nestingLevel":1}}},{"ty":"mp","bi":94,"ei":95,"mt":"tableRow","pr":{"tableRow":{"nestingLevel":1}}},{"ty":"mp","bi":97,"ei":98,"mt":"tableRow","pr":{"tableRow":{"nestingLevel":1}}},{"ty":"mp","bi":51,"ei":52,"mt":"tableCell","pr":{"tableCell":{"nestingLevel":1,"tcW":{"w":8280,"type":"STTblWidth_dxa"},"tcBorders":{"top":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"left":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"right":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"bottom":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"}},"shd":{"fill":"E6F5FF"}}}},{"ty":"mp","bi":54,"ei":55,"mt":"tableCell","pr":{"tableCell":{"nestingLevel":1,"tcW":{"w":8280,"type":"STTblWidth_dxa"},"tcBorders":{"top":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"left":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"right":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"bottom":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"}}}}},{"ty":"mp","bi":57,"ei":58,"mt":"tableCell","pr":{"tableCell":{"nestingLevel":1,"tcW":{"w":8280,"type":"STTblWidth_dxa"},"tcBorders":{"top":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"left":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"right":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"bottom":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"}}}}},{"ty":"mp","bi":60,"ei":61,"mt":"tableCell","pr":{"tableCell":{"nestingLevel":1,"tcW":{"w":8280,"type":"STTblWidth_dxa"},"tcBorders":{"top":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"left":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"right":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"bottom":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"}}}}},{"ty":"mp","bi":70,"ei":71,"mt":"tableCell","pr":{"tableCell":{"nestingLevel":1,"tcW":{"w":8280,"type":"STTblWidth_dxa"},"tcBorders":{"top":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"left":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"right":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"bottom":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"}},"shd":{"fill":"E6F5FF"}}}},{"ty":"mp","bi":73,"ei":74,"mt":"tableCell","pr":{"tableCell":{"nestingLevel":1,"tcW":{"w":8280,"type":"STTblWidth_dxa"},"tcBorders":{"top":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"left":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"right":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"bottom":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"}}}}},{"ty":"mp","bi":76,"ei":77,"mt":"tableCell","pr":{"tableCell":{"nestingLevel":1,"tcW":{"w":8280,"type":"STTblWidth_dxa"},"tcBorders":{"top":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"left":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"right":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"bottom":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"}}}}},{"ty":"mp","bi":79,"ei":80,"mt":"tableCell","pr":{"tableCell":{"nestingLevel":1,"tcW":{"w":8280,"type":"STTblWidth_dxa"},"tcBorders":{"top":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"left":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"right":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"bottom":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"}}}}},{"ty":"mp","bi":90,"ei":91,"mt":"tableCell","pr":{"tableCell":{"nestingLevel":1,"tcW":{"w":8280,"type":"STTblWidth_dxa"},"tcBorders":{"top":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"left":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"right":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"bottom":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"}}}}},{"ty":"mp","bi":93,"ei":94,"mt":"tableCell","pr":{"tableCell":{"nestingLevel":1,"tcW":{"w":8280,"type":"STTblWidth_dxa"},"tcBorders":{"top":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"left":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"right":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"bottom":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"}}}}},{"ty":"mp","bi":96,"ei":97,"mt":"tableCell","pr":{"tableCell":{"nestingLevel":1,"tcW":{"w":8280,"type":"STTblWidth_dxa"},"tcBorders":{"top":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"left":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"right":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"},"bottom":{"val":"STBorder_single","sz":"4","space":"0","color":"999999"}}}}},{"ty":"mp","bi":42,"ei":43,"mt":"tableRow","pr":{"tableRow":{"isPlaceholder":true,"nestingLevel":1}}},{"ty":"mp","bi":42,"ei":43,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true,"nestingLevel":1}}},{"ty":"mp","bi":52,"ei":53,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true,"nestingLevel":1}}},{"ty":"mp","bi":55,"ei":56,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true,"nestingLevel":1}}},{"ty":"mp","bi":58,"ei":59,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true,"nestingLevel":1}}},{"ty":"mp","bi":61,"ei":62,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true,"nestingLevel":1}}},{"ty":"mp","bi":71,"ei":72,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true,"nestingLevel":1}}},{"ty":"mp","bi":74,"ei":75,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true,"nestingLevel":1}}},{"ty":"mp","bi":77,"ei":78,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true,"nestingLevel":1}}},{"ty":"mp","bi":80,"ei":81,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true,"nestingLevel":1}}},{"ty":"mp","bi":88,"ei":89,"mt":"tableRow","pr":{"tableRow":{"isPlaceholder":true,"nestingLevel":1}}},{"ty":"mp","bi":88,"ei":89,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true,"nestingLevel":1}}},{"ty":"mp","bi":91,"ei":92,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true,"nestingLevel":1}}},{"ty":"mp","bi":94,"ei":95,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true,"nestingLevel":1}}},{"ty":"mp","bi":97,"ei":98,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true,"nestingLevel":1}}},{"ty":"mp","bi":81,"ei":82,"mt":"tableRow","pr":{"tableRow":{"isPlaceholder":true,"nestingLevel":1}}},{"ty":"mp","bi":81,"ei":82,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true,"nestingLevel":1}}},{"ty":"mp","bi":98,"ei":99,"mt":"tableRow","pr":{"tableRow":{"isPlaceholder":true,"nestingLevel":1}}},{"ty":"mp","bi":98,"ei":99,"mt":"tableCell","pr":{"tableCell":{"isPlaceholder":true,"nestingLevel":1}}}]'),y=n(37416),b=function(){function e(e){var t=this;this.contextService=e,this.updateNumbering=function(e){var t=new Map;return e.forEachOp((function(e){if(e instanceof c.ModifyParagraphOperation&&e.param.property instanceof c.PropertyFactory.getPropertyClass(c.PropertyType.ParagraphProperty)){var n=e.param.property.numPr;if(n.isEmpty(n.tKeys.numId))return;var r=n.numId.val;if(t.has(r)&&t.get(r))e.param.property.numPr.numId.val=t.get(r);else{var o=u.StringUtil.generateRandomId();t.set(r,o),e.param.property.numPr.numId.val=o}}})),e.forEachOp((function(e){if(e instanceof c.CommonSettingOperation&&e.param.property instanceof c.PropertyFactory.getPropertyClass(c.PropertyType.NumberingProperty))for(var n=t.entries(),o=n.next();!o.done;){var i=(0,r.__read)(o.value,2),a=i[0],s=i[1],l=e.param.property.num.getProperty(a);if(!l)return;var d=l.abstractNumId.val,p=u.StringUtil.generateRandomId();l.numId=s,l.abstractNumId.val=p,e.param.property.num.appendProperty(l,l.numId),e.param.property.num.removeProperty(a,!0);var f=e.param.property.abstractNum.getProperty(d);if(!f)return;f.abstractNumId=p,e.param.property.abstractNum.appendProperty(f,f.abstractNumId),e.param.property.abstractNum.removeProperty(d,!0),o=n.next()}})),e},this.updateAuthorId=function(e){return e.forEachOp((function(e){e instanceof c.ModifyRunOperation&&e.param.property&&(e.param.property.author=t.context.clientVars.userId)})),e},this.updateTime=function(e){return e.forEachOp((function(e){var t=(0,h.$t)("XXXX年XX月XX日");if(e instanceof c.InsertOperation&&e.param.text.indexOf(t)>=0){var n=e.param,r=(0,p.p)(new Date,(0,h.$t)("yyyy年MM月dd日")),o=n.text,i=o.replace(t,r);o.length===i.length&&(n.text=i)}})),e},this.context=e.context}var t,n,b;return Object.defineProperty(e.prototype,"tableHandler",{get:function(){return this[d.ITableFeature].instance},enumerable:!1,configurable:!0}),e.prototype.$onEditorOpen=function(e){this.editor=e},e.prototype.processDelta=function(e){var t=this.editor,n=t.service,r=t.state,o=e;return this.processNeeded().map((function(e){o&&(o=e(o,n,r))})),o},e.prototype.processNeeded=function(){return[this.updatePosition,this.updateStyleId,this.updateAuthorId,this.updateTime,this.updateNumbering]},e.prototype.updateStyleId=function(e,t){return e.forEachOp((function(n){if(n instanceof c.ModifyParagraphOperation){var r=n.param.property.pStyle.val,o=t.getDocument().generateStyleProperty(e,r);o&&(n.param.property.pStyle.val=o.styleId)}if(n instanceof c.ModifyTableOperation){var i=n.param.property.tblPr.tblStyle.val,a=t.getDocument().generateStyleProperty(e,i);a&&(n.param.property.tblPr.tblStyle.val=a.styleId)}})),e},e.prototype.updatePosition=function(e,t,n){var r=t.getSelection(),o=r.getEnd();return e.forEachOp((function(e){c.OperationUtil.moveOffset(e,o)})),e.moveTo(r.range()),n.deleteText(r.range(),e),e},e.prototype.canAddTable=function(){return this[d.ITableFeature].instance.canAddTable()},e.prototype.insertTaskList=function(){this.apply(JSON.stringify(m).replace(/腾讯文档/g,window.productName))},e.prototype.insertWorkDaily=function(){this.apply(JSON.stringify(g).replace(/腾讯文档/g,window.productName))},e.prototype.insertWorkReport=function(){this.apply(JSON.stringify(v).replace(/腾讯文档/g,window.productName))},e.prototype.insertConferenceReport=function(){this.apply(JSON.stringify(_))},e.prototype.apply=function(e){var t=c.DeltaOption.createLocalDeltaOption(new c.GCPRange).buildDelta();this.editor.run("transMutationToDelta",t,e);var n=this.processDelta(t);if(n){var r=c.OperationUtil.getFixedGcpRange(n.operations,n.currentRange());n.moveTo(r),this.editor.applyDelta(n)}},b=d.ITableFeature,(0,r.__decorate)([(0,i.aN)(d.ITableFeature),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==o.IDynamicLoader&&o.IDynamicLoader)?n:Object)],e.prototype,b,void 0),(0,r.__decorate)([(0,y.z)(!0,[d.ITableFeature]),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Boolean)],e.prototype,"canAddTable",null),e=(0,r.__decorate)([(0,a.L)({name:l.C.Snippet,adapters:["melo"],provide:f.ISnippetFeature}),(0,r.__metadata)("design:paramtypes",["function"==typeof(t=void 0!==s.O&&s.O)?t:Object])],e)}()},558096:function(e,t,n){n.r(t),n.d(t,{ISpellcheckFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.Spellcheck));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5597),n.e(9820),n.e(7797),n.e(5049),n.e(8063),n.e(823),n.e(3974),n.e(4397),n.e(7021),n.e(7131)]).then(n.bind(n,328909))];case 1:return[2,e.sent().SpellcheckHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s,platforms:[a.Ev.Pc]})})},127497:function(e,t,n){n.r(t),n.d(t,{ISplitlineFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.Splitline));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5597),n.e(9820),n.e(7797),n.e(5049),n.e(8063),n.e(823),n.e(3974),n.e(4397),n.e(7021),n.e(7131)]).then(n.bind(n,345161))];case 1:return[2,e.sent().SplitlineHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s})})},322915:function(e,t,n){n.r(t),n.d(t,{IStarMobileFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.StarMobile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(9440),n.e(7462)]).then(n.bind(n,795211))];case 1:return[2,e.sent().StarMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad]})})},954583:function(e,t,n){n.r(t),n.d(t,{ISubscribeNoticeMobileFeature:function(){return c}});var r,o=n(839461),i=n(259356),a=n(870372),s=n(293325),c=(n(495155),Symbol.for("feature:".concat(a.C.SubscribeNoticeMobile)));i.Ln.merge(c,{useFactory:function(){return(0,o.__awaiter)(void 0,void 0,void 0,(function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(8317).then(n.bind(n,963273))];case 1:return[2,e.sent().SubscribeNoticeMobileHandler]}}))}))},on:s.iz.On({stages:[s.YV.Level4],key:c,platforms:[s.Ev.Mobile,s.Ev.Pad],load:(null===(r=window.tdocs)||void 0===r||r.setActionButtons,!1)})})},446077:function(e,t,n){n.r(t),n.d(t,{ISubscriptionNotificationFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=(n(495155),Symbol.for("feature:".concat(i.C.SubscriptionNotification)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5070),n.e(159)]).then(n.bind(n,365083))];case 1:return[2,e.sent().SubscriptionNotificationHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level4],key:s,platforms:[a.Ev.Pc],load:!1})})},162912:function(e,t,n){n.r(t),n.d(t,{ISubscriptionNotificationMenuFeature:function(){return s}});var r=n(839461),o=(n(495155),n(259356)),i=n(293325),a=n(870372),s=Symbol.for("feature:".concat(a.C.SubscriptionNotificationMenu));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(9243).then(n.bind(n,680545))];case 1:return[2,e.sent().SubscriptionNotificationMenuHandler]}}))}))},on:i.iz.On({stages:[i.YV.Level4],key:s,platforms:[i.Ev.Pc],load:!1})})},14092:function(e,t,n){n.r(t),n.d(t,{ISwitchCertificationMobileFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.SwitchCertificationMobile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(1585).then(n.bind(n,677399))];case 1:return[2,e.sent().SwitchCertificationMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level4],key:s,platforms:[a.Ev.Pad,a.Ev.Mobile]})})},221846:function(e,t,n){n.r(t),n.d(t,{ISyncTencentListMobileFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=(n(495155),Symbol.for("feature:".concat(i.C.SyncTencentListMobile)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(8709).then(n.bind(n,773875))];case 1:return[2,e.sent().SyncTencentListlMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad],load:!1})})},499689:function(e,t,n){n.r(t),n.d(t,{ISyncTencentListHandler:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=(n(495155),Symbol.for("feature:".concat(i.C.SyncTencentList)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(8969).then(n.bind(n,691570))];case 1:return[2,e.sent().SyncTencentListHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level4],key:s,platforms:[a.Ev.Pc],load:!1})})},278062:function(e,t,n){n.r(t),n.d(t,{TemplateRecommendationHandler:function(){return M}});var r=n(839461),o=n(87363),i=n.n(o),a=n(259356),s=n(947229),c=n(522142),l=n(45972),u=n(344695),d=n(750670),p=(n(783504),n(661533)),f=n.n(p),h=n(641415),m=n(252238),g=n(495155),v=n(305945),_=n(870372),y=n(523255),b=i().lazy((function(){return Promise.all([n.e(8487),n.e(8859),n.e(6370),n.e(9417)]).then(n.t.bind(n,829417,23)).then((function(e){return{default:e.TMallRecommendation}}))})),E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.containerId="template-recommendation-container",t.onClickButton=function(e){var n,r,o,i;g.Logger.info("点击模板卡片回调触发",e);var a=!!e.marketingId,s=null===(r=null===(n=null===window||void 0===window?void 0:window.discussionExt)||void 0===n?void 0:n.getTemplateSourceKey)||void 0===r?void 0:r.call(n);s&&localStorage.setItem(s,a?"2":"1"),null===(i=null===(o=null===window||void 0===window?void 0:window.discussionExt)||void 0===o?void 0:o.setTemplateId)||void 0===i||i.call(o,e.id),t.props.close(),t.applyTemplate(e,2===e.source)},t}return(0,r.__extends)(t,e),t.prototype.render=function(){return i().createElement("div",{id:this.containerId})},t.prototype.componentDidMount=function(){this.renderTMallRecommendation()},t.prototype.componentDidUpdate=function(){this.renderTMallRecommendation()},t.prototype.renderTMallRecommendation=function(){var e,t=this.props.close,n=document.getElementById(this.containerId),r=null===(e=this.state)||void 0===e?void 0:e.keyword;f().render(i().createElement(i().Suspense,{fallback:null},i().createElement(b,{type:"doc",className:"template-recommendation",fromPage:"doc_word_buttom_reco",id:"wordReco",onClickTemplate:this.onClickButton,onClose:t,container:n||void 0,keyword:r})),document.getElementById(this.containerId))},t.prototype.applyTemplate=function(e,t){var n=this;void 0===t&&(t=!1),this.getTemplateInfos(e.id,t).then((function(e){e&&(g.Logger.info("模板数据解析完毕，准备插入模板"),n.insertTemplate(e))})).catch((function(e){n.reportError("插入模板失败",e.message)}))},t.prototype.getTemplateInfos=function(e,t){var n;return void 0===t&&(t=!1),(0,r.__awaiter)(this,void 0,void 0,(function(){var o,i,a,s;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,(0,h.Z)({method:"POST",url:"/v2/mall/doc/content",data:{id:e,is_custom:t}})];case 1:return o=r.sent(),0!==(null==(i=o.data)?void 0:i.cgicode)||0!==(null==i?void 0:i.retcode)?(this.reportError("getTemplateInfos 获取模板数据失败",null==i?void 0:i.msg),[2]):(a=null===(n=null==i?void 0:i.result)||void 0===n?void 0:n.atext[0],[2,y._.getAllMutationWrappers(m.DS.decode(a.bytesText))]);case 2:return s=r.sent(),this.reportError("getTemplateInfos 获取并解析模板数据失败",s.message),[2];case 3:return[2]}}))}))},t.prototype.insertTemplate=function(e){var t=new v.QD({mutations:e}).dataEngine;if(t){var n=this.copyTemplate(t);n?this.props.editor.clipboardManager.pasteTemplate(n):this.reportError("插入模板失败：未找到模板 mainStory")}else this.reportError("插入模板失败：模板内容转换 delta 失败")},t.prototype.copyTemplate=function(e){var t=this,n=d.DeltaOption.createLocalDeltaOption(d.GCPRange.emptyRange()).buildDelta(),r=e.getDataStream().getStoryStream().getSubStoryInfoFromId(d.StoryID.MainDocId);if(r){var o=new d.GCPRange(r.range.begin(),r.range.length()-1),i=d.DataCollector.collectDataToDelta({dataEngine:e,delta:n,range:o}),a=[];this.props.editor.run("transDeltaToOperationData",n,a,e);var s=[];return i.forEach((function(n){var r=[];t.props.editor.run("transDeltaToOperationData",n.delta,r,e),s.push({storyId:n.storyId,storyOps:r,storyType:n.storyType})})),JSON.stringify({mainStory:a,subStory:s,srcGlobalPadId:""})}},t.prototype.reportError=function(e,t){void 0===t&&(t=""),d.ReportHelper.weiMonitorCube({module:d.ICubeModule.Feature,name:_.C.TemplateRecommendation,action:e,msg:t}),g.Logger.error(e,t)},t}(i().Component),C=E,w=n(429749),T=n(774767),A=n(218581),S=n(76619),I=(0,A.$t)("无标题文档"),R="9j7hoktz63r68xy6q6oer9jwta",M=function(){function e(e,t,n){var r=this;this.contextService=e,this.widgetService=t,this.configService=n,this.themeId=R,this.onTitleChanged=function(e){var t;null===(t=r.templateRecommendation)||void 0===t||t.setState({keyword:e===I?"":e})},this.onKeyDown=function(e){var t=e||window.event,n=t.code||t.key,o=t.keyCode||t.which||t.charCode;"enter"!==n&&o!==d.KeyCode.ENTER||r.close()},this.onModelChange=function(){var e,t=r.editor.getDocumentBox().getFirstDescendantOf(d.BoxKind.RichTextArea,(function(e){return e.firstVisibleChild}));if(t&&Array.isArray(t.children)&&(null===(e=t.children)||void 0===e?void 0:e.length)<=2){var n=t.lastChild;if(n&&(0,d.isParagraphBox)(n)&&r.titleBase.isParaEmpty(n)&&r.titleBase.isParaNormalHolderStyle(n.property))return}r.close()},this.themeId=R}var t,n,o,p;return e.prototype.showTemplate=function(){var e=this;this.isNewDoc()&&this.isOwner()&&this.isEmptyDoc()&&setTimeout((function(){e.show()}),0)},e.prototype.$onEditorOpen=function(e){var t=this;this.editor=e,this.titleBase=new T.H(e),this.editor.getRenderFinishAllPromise().then((function(){t.configService.get("custom.feature.template_recommend")&&t.showTemplate()}))},e.prototype.show=function(){var e=this;this.subscription=this.eventEmitter.listen("titleChanged",this.onTitleChanged),this.editor.on(d.StateNotification.ModelChange,this.onModelChange),this.widgetService.float({name:_.C.TemplateRecommendation,component:i().createElement(C,{ref:function(t){t&&(e.templateRecommendation=t)},templateThemeId:this.themeId,close:function(){e.close()},container:document.body,editor:this.editor||this.contextService.context.editor}),styles:{zIndex:1,position:"relative"}}),document.addEventListener("keydown",this.onKeyDown)},e.prototype.close=function(){this.widgetService.remove(_.C.TemplateRecommendation,"float"),document.removeEventListener("keydown",this.onKeyDown),this.subscription&&(this.subscription.unsubscribe(),this.subscription=void 0),this.editor.removeCallBack(d.StateNotification.ModelChange,this.onModelChange)},e.prototype.isNewDoc=function(){var e,t;return(null===(e=window.clientVars)||void 0===e?void 0:e.metaCreateTime)&&(null===(t=window.clientVars)||void 0===t?void 0:t.lastModifyTime)&&window.clientVars.lastModifyTime-window.clientVars.metaCreateTime<1e3},e.prototype.isEmptyDoc=function(){return 10===this.editor.service.getDocument().readText(0,Number.MAX_SAFE_INTEGER).length},e.prototype.isOwner=function(){var e,t,n;return window.clientVars&&(null===(e=window.clientVars)||void 0===e?void 0:e.ownerId)===(null===(n=null===(t=window.clientVars)||void 0===t?void 0:t.userInfo)||void 0===n?void 0:n.tinyId)},(0,r.__decorate)([(0,a.tB)(),(0,r.__metadata)("design:type","function"==typeof(p=void 0!==s.v&&s.v)?p:Object)],e.prototype,"eventEmitter",void 0),e=(0,r.__decorate)([(0,c.L)({name:_.C.TemplateRecommendation,adapters:["melo"],provide:S.ITemplateRecommendation}),(0,r.__metadata)("design:paramtypes",["function"==typeof(t=void 0!==l.O&&l.O)?t:Object,"function"==typeof(n=void 0!==u.i&&u.i)?n:Object,"function"==typeof(o=void 0!==w.ax&&w.ax)?o:Object])],e)}()},76619:function(e,t,n){n.r(t),n.d(t,{ITemplateRecommendation:function(){return c},canShowRecommendation:function(){return l}});var r=n(839461),o=n(259356),i=n(293325),a=n(870372),s=n(317999),c=(n(495155),Symbol.for("feature:".concat(a.C.TemplateRecommendation))),l=function(){return window.clientVars&&(null===(e=window.clientVars)||void 0===e?void 0:e.metaCreateTime)===(null===(t=window.clientVars)||void 0===t?void 0:t.lastModifyTime)&&function(){var e,t,n;return 10===(null===(n=null===(t=null===(e=null===window||void 0===window?void 0:window.__editor)||void 0===e?void 0:e.service)||void 0===t?void 0:t.getDocument)||void 0===n?void 0:n.call(t).readText(0,Number.MAX_SAFE_INTEGER).length)}()&&function(){var e;return window.clientVars&&(null===(e=window.clientVars)||void 0===e?void 0:e.isOwner)}()&&!s.A.isTencentMeetingInWework();var e,t};o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.resolve().then(n.bind(n,278062))];case 1:return[2,e.sent().TemplateRecommendationHandler]}}))}))},on:i.iz.On({stages:[i.YV.Level1],key:c,platforms:[i.Ev.Pc],load:!1})})},256136:function(e,t,n){n.r(t),n.d(t,{ITextDragPcFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.TextDragPc));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5597),n.e(9820),n.e(7797),n.e(5049),n.e(8063),n.e(823),n.e(3974),n.e(4397),n.e(7021),n.e(7131)]).then(n.bind(n,893626))];case 1:return[2,e.sent().TextDragPcHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s,platforms:[a.Ev.Pc]})})},721869:function(e,t,n){n.r(t),n.d(t,{ITitleFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.Title));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(9820),n.e(9250),n.e(9454)]).then(n.bind(n,984982))];case 1:return[2,e.sent().TitleHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level1,a.YV.Publish],key:s})})},984982:function(e,t,n){n.r(t),n.d(t,{TitleHandler:function(){return _}});var r=n(839461),o=n(228859),i=n(750670),a=n(102930),s=n(64102),c=n(996391),l=n(522142),u=n(137600),d=n(947229),p=n(45972),f=n(869993),h=n(684069),m=(n(495155),n(870372)),g=n(721869),v=n(378898),_=function(){function e(e,t,n,r){var l=this;this.store=e,this.eventEmitter=t,this.autoNamedId=0,this.userEdit=!1,this.hasStoreUserChange=!1,this.transferringDocstatus=!1,this.saveToList=function(e){l.hasStoreUserChange=!0;var t=l.context.clientVars;if(!l.userEdit||12!==t.docStatus||e!==a.fb.UserChangeset)return!1;l.transferringDocstatus||(l.transferringDocstatus=!0,s.y.docHumtrans(t).then((function(){var e;l.transferringDocstatus=!1,i.GlobalContext.unRegisterPlugin(((e={})[a.KM.SetData2Store]=l.setDataToStorePlugin,e))})))},this.userEditDoc=function(){if(l.userEdit){var e=l.context.editor;e instanceof i.MeloEditor&&setTimeout((function(){e.removeCallBack(i.StateNotification.EfficientModelChange,l.userEditDoc)}),0)}else l.userEdit=!0,l.hasStoreUserChange&&l.saveToList(a.fb.UserChangeset)},this.setTitle=function(e){o.q.getInstance().setTitleForDoc(e,(function(t){t&&0===t.retcode&&l.store.get(c.j.ModelState).next(e)}))},this.updateInitDocTitle=function(){o.q.getInstance().updateDocInitTitle()},this.getCurTitleReversion=function(){return s.y.getTitleReversionFromStore()},this.setTitleToNativeTitlebar=function(e){o.q.getInstance().setTitleToNativeTitlebar(e)},this.setDataToStorePlugin=function(e,t,n){l.saveToList(n),t()},this.context=r.context,this.$sub=this.eventEmitter.listen("setTitle",this.setTitle)}var t,n,_,y;return e.prototype.$onEditorOpen=function(e){var t,n=this;e.on(i.StateNotification.CollabToServer,(function(t){if(n.enableAutoUpdate){n.updateFirstParaContentInfo(e);var r=t.delta.operations;n.isTextChange(r)&&n.updateTitle(e,t.delta)}}),this),e.on(i.StateNotification.EfficientModelChange,this.userEditDoc),e.on(h.ZK.ON_TITLE_CHANGE,(function(t){n.updateFirstParaContentInfo(e);var r=t.newTitle;n.context.clientVars.padTitle=r,n.context.clientVars.title=r,n.store.update("docTitle",r)}),this),i.GlobalContext.registerPlugin(((t={})[a.KM.SetData2Store]=this.setDataToStorePlugin,t))},e.prototype.updateTitle=function(e,t){var n=this,r=t.globalOpts.originRange;this.checkIsInFirstPara(r)&&(this.updateFirstParaContentInfo(e),this.autoNamedId&&clearTimeout(this.autoNamedId),this.autoNamedId=setTimeout((function(){e.isCompositing()||e.isUpdating?n.updateTitle(e,t):n.autoUpdateTitle()}),500))},e.prototype.checkIsInFirstPara=function(e){var t,n=null===(t=this.firstParaContentInfo)||void 0===t?void 0:t.range;return!(!this.firstParaContentInfo||!e.intersect(this.firstParaContentInfo.range)&&(null==n?void 0:n.end())!==e.begin())},e.prototype.updateFirstParaContentInfo=function(e){this.firstParaContentInfo=e.getTitleContentInfo()},e.prototype.isTextChange=function(e){var t,n,o=!1;try{for(var a=(0,r.__values)(e),s=a.next();!s.done;s=a.next()){var c=s.value;if((c instanceof i.InsertOperation||c instanceof i.DeleteOperation||c instanceof i.DeleteRangeOperation||c instanceof i.InsertRangeOperation)&&this.checkIsInFirstPara(c.param.range)){if((c instanceof i.DeleteRangeOperation||c instanceof i.InsertRangeOperation)&&c.param.rangeType===i.RangeType.revisionRange){o=!0;break}if(c instanceof i.DeleteOperation||c instanceof i.InsertOperation&&![i.PlaceholderChar.ParagraphReturn,i.PlaceholderChar.PageBreak,i.PlaceholderChar.SectionBreak].includes(c.param.text)){o=!0;break}}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return o},e.prototype.autoUpdateTitle=function(){var e;this.firstParaContentInfo&&o.q.getInstance().autoUpdateTitle(null===(e=this.firstParaContentInfo)||void 0===e?void 0:e.content)},e.prototype.$onEditorClose=function(e){var t;o.q.getInstance().destroy(),e.removeListener(i.StateNotification.CollabToServer,this),e.removeCallBack(i.StateNotification.EfficientModelChange,this.userEditDoc),e.removeListener(h.ZK.ON_TITLE_CHANGE,this),this.autoNamedId=0,this.userEdit=!1,null===(t=this.$sub)||void 0===t||t.unsubscribe()},(0,r.__decorate)([(0,v.D)("feature.auto_update_title",!0),(0,r.__metadata)("design:type",Boolean)],e.prototype,"enableAutoUpdate",void 0),e=(0,r.__decorate)([(0,l.L)({name:m.C.Title,adapters:["melo"],provide:g.ITitleFeature}),(0,r.__metadata)("design:paramtypes",["function"==typeof(t=void 0!==u.O&&u.O)?t:Object,"function"==typeof(n=void 0!==d.v&&d.v)?n:Object,"function"==typeof(_=void 0!==f.TitlebarHandler&&f.TitlebarHandler)?_:Object,"function"==typeof(y=void 0!==p.O&&p.O)?y:Object])],e)}()},228859:function(e,t,n){n.d(t,{q:function(){return L}});var r=n(839461),o=n(750670),i=n(286966),a=n(218581),s=n(136454),c=n(64102),l=n(814808),u=n(996391),d=n(259356),p=n(137600),f=n(45972),h=n(947229),m=n(495155),g=n(612981),v=(n(223336),n(707605)),_=n(399267),y=(n(945398),n(766123),n(795398)),b=n(174084),E=n(991287),C=n(378898);function w(e){var t=window.navigator.userAgent,n=m.PlatformUtil.isWXMiniProgram()||m.PlatformUtil.isQQMiniProgram(),r=!(!t.match(/MicroMessenger/i)||n),o=m.PlatformUtil.isWeWork()&&!1;if((r&&!o||n)&&null!=e)if(document.getElementById("jweixinScript")||void 0!==window.wx)e();else{var i=document.createElement("script");i.id="jweixinScript";var a=m.PlatformUtil.isQQMiniProgram();i.src=a?E.X.getInstance().getConfig("runtime.library.TENCENT_DOCS_LIBRARY__qqjssdk_1_0_0"):E.X.getInstance().getConfig("runtime.library.TENCENT_DOCS_LIBRARY__jweixin_1_6_0"),i.onload=e,a&&(i.crossOrigin="anonymous"),null!==document.head&&document.head.appendChild(i)}}function T(e){var t=e.title,n=e.desc,r=e.share_url,i=e.image_url;window.wx&&(window.wx.onMenuShareAppMessage({title:t,desc:n,link:r,imgUrl:i,type:"",dataUrl:"",success:function(){o.ReportHelper.tdwReport({opername:"doc_share",module:"wecha_h5",action:"wechat_suc"})},cancel:function(){},trigger:function(){o.ReportHelper.tdwReport({opername:"doc_share",module:"wecha_h5",action:"share_wechat"})}}),window.wx.onMenuShareTimeline({title:t,link:r,imgUrl:i,success:function(){o.ReportHelper.tdwReport({opername:"doc_share",module:"wecha_h5",action:"moment_suc"})},cancel:function(){},trigger:function(){o.ReportHelper.tdwReport({opername:"doc_share",module:"wecha_h5",action:"share_moment"})}}),window.wx.onMenuShareQQ({title:t,desc:n,link:r,imgUrl:i,success:function(){},cancel:function(){}}))}var A=new(function(){function e(){}var t,n;return e.prototype.init=function(){this.slr=this.scriptLoaderService.getScriptLoader()},e.prototype.setShareInfo=function(e,t){if(!v.qO.getInstance().isDrivePreview&&this.isShareMobile){var n=t.shortLink,r=t.padTitle,o=t.newPad,i=t.isCreator,s=t.rightFlag,c=t.policy,l=t.domainId,u=t.padId,d=window.location,p=d.origin,f=d.pathname,h=d.href,g="".concat(p).concat(f),_=(0,b.pm)(h).dver||"",E=(y.Z["file_doc_150@2x"],y.Z["file_doc_transparent_150@2x"]),C=y.Z["file_doc_500@2x"],A={source_name:window.productName,desc:(0,a.$t)("".concat(window.productName,"-在线文档")),image_url:E,miniprogram_image_url:this.shareImageData?this.shareImageData:C,contentEdited:window.isContentEditedToNativeSend||!1,editable:v.qO.getInstance().isEditable,type:"docx",singleLineTitle:"",share_url:n||_?"".concat(g,"?dver=").concat(_):"".concat(g),localPadId:u,title:r,isCreator:i,rightFlag:s,policy:c,isNewCreate:o,domainId:l};A.singleLineTitle=A.title||"";var S=(0,m.getUrlParameter)("group_code");S&&(A.groupCode=S);var I=(0,m.getUrlParameter)("scode");S&&(A.scode=I),w((function(){T(A),setTimeout((function(){T(A)}),2e3)}));var R=this.isNewMobileApp();if(m.PlatformUtil.isTimQQ()){var M=window.mqq;A.showShareBtn=!R,M&&M.invoke("data","setShareInfo",A,(function(){}))}this.shareInfo=A}},e.prototype.isNewMobileApp=function(){return!1},(0,r.__decorate)([(0,d.tB)(),(0,r.__metadata)("design:type","function"==typeof(t=void 0!==p.O&&p.O)?t:Object)],e.prototype,"store",void 0),(0,r.__decorate)([(0,d.tB)(),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==_.$&&_.$)?n:Object)],e.prototype,"scriptLoaderService",void 0),(0,r.__decorate)([(0,C.D)("feature.shareInfo.isNeedSetShareInfo",!0),(0,r.__metadata)("design:type",Object)],e.prototype,"isShareMobile",void 0),e}()),S=n(336338),I=n(944177),R=n(669144),M=n(852105),O=/[\\/:*?"<>|]/,N=(0,a.$t)("title:forbidden-chars-pc"),k=((0,a.$t)("title:forbidden-chars-mobile"),function(){function e(){var e=this;this.autoNamedId=0;var t=this.store.get(u.j.IsOnline);t.getValue()&&this.checkAndUploadTitle(),this.$sub=t.subscribe((function(t){t&&e.checkAndUploadTitle()}))}var t,n,v;return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.$onReset=function(){var e;null===(e=this.$sub)||void 0===e||e.unsubscribe()},e.prototype.checkAndUploadTitle=function(){var e=this.readTitleFromStorage();if(e){if(e.isAuto&&1===(0,s.Yi)().isUserChangeTitle)return void this.persistTitleToStorage("",e.isAuto);this.setTitle(e.title,e.isAuto,null)}},e.prototype.setTitleForDoc=function(e,t){var n=e;0===n.length&&(n=this.getDefaultTitle()),(0,s.Yi)().padTitle!==n?this.setTitle(n,!1,(function(e){e&&0===e.retcode&&(null==t||t(e))})):this.setTitleToStore(n)},e.prototype.verifyTitle=function(e){var t=!new RegExp(O,"g").exec(e);return t||l.default.show({message:N,duration:2e3,autoClose:!0}),t},e.prototype.autoUpdateTitle=function(e){var t=this,n=(0,s.Yi)();if(1!==n.isUserChangeTitle)if(this.verifyTitle(e)){var r=this.readTitleFromStorage();if(!r||r.isAuto){var i=n.padTitle||this.getDefaultTitle();if(this.contextService.context.editor instanceof o.MeloEditor){var a=e.replace(/(:|\*|\\|\/|<|>|"|\?|\|)/gi,"");a.length>c.y.MAX_TITLE_LENGTH&&(a=a.substr(0,c.y.MAX_TITLE_LENGTH)),0===a.length&&(a=this.getDefaultTitle()),n.padTitle!==a?this.setTitle(a,!0,(function(e){e&&0===e.retcode||12e3===e.retcode&&(m.Logger.error("TitleService.setTitle Set title failed: ".concat(e)),t.restoreOriginalTitle(i))})):m.Logger.info("autoUpdateTitle condition [padTitle equal]")}else m.Logger.info("autoUpdateTitle condition [MeloEditor]")}else m.Logger.info("autoUpdateTitle condition [readTitleFromStorage]")}else m.Logger.info("autoUpdateTitle condition [title has illegal chars]");else m.Logger.info("autoUpdateTitle condition [IS_CAN_NOT_AUTO_CHANGE]")},e.prototype.needShowRenameTip=function(){var e=(0,s.Yi)();return(Number(m.LocalStorageUtil.getItem("auto_title_tips_".concat(e.padId)))||0)<1},e.prototype.getDefaultTitle=function(){return(0,a.$t)("无标题文档")},e.prototype.getDataHelper=function(){return window.App&&window.App.GlobalConfig.IsSupportStore?window.offlineDataHelperInstance:null},e.prototype._offlineSyncTitle=function(e){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t,n;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return!e||o.IS_LOCAL_EDIT?[2]:(t=this.getDataHelper())?(n=(0,s.Yi)(),[4,t.handleOfflineTitleChange(e,n)]):[2];case 1:return r.sent(),[2]}}))}))},e.prototype.updateLocalClientVarsTitle=function(e,t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var n,o;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return(n=this.getDataHelper())?(o=(0,s.Yi)(),t||(o.isUserChangeTitle=1),o.padTitle=e,o.title=e,[4,n.updateClientVars(o)]):[2];case 1:return r.sent(),[2]}}))}))},e.prototype.setTitle=function(e,t,n){var o=this,a=(0,s.Yi)(),u=a.padTitle||this.getDefaultTitle();this.persistTitleToStorage(e,t),this.autoNamedId&&clearTimeout(this.autoNamedId),this.setTitleToStore(e),this._offlineSyncTitle(e),(0,g.GI)("MODIFY",{domainId:a.domainId,localPadId:a.localPadId,title:e,actiontoserver:1});var d=t?200:0;this.autoNamedId=setTimeout((function(){return(0,r.__awaiter)(o,void 0,void 0,(function(){var o=this;return(0,r.__generator)(this,(function(r){return m.Logger.info("TitleService.setTitle Set title to: ".concat(e,", isAuto: ").concat(t)),c.y.setTitle(e,t,a,(function(r){var a={originalTitle:u,title:e,isAuto:t};r&&0===r.retcode?(o.setTitleSuccess(a),o.eventEmitter.emit(i.zW.TITLE_CHANGE,e)):(10020===r.retcode&&t?o.persistTitleToStorage("",t):12e3===r.retcode&&l.default.show({message:"标题不合规，请重新命名。",duration:2e3,autoClose:!0}),m.Logger.error("TitleService.setTitle Set title failed: ".concat(r)),o.restoreOriginalTitle(u)),n&&n(r)})).catch((function(e){m.Logger.error(e)})),[2]}))}))}),d)},e.prototype.setTitleSuccess=function(e){var t,n,r,o=(0,s.Yi)(),i="modify",a="automatic_fill",c="fill",l="modify_title";this.eventEmitter.emit("titleChanged",e.title),r=e.originalTitle?i:e.isAuto?a:c,this.dataReport({opername:"doc_word_editor",module:"doc_title",action:r,obj2:o.padTitle});var u=e.title;if(R.v.isDriveFile){var d=(0,M.xI)()||"docx";u+=".".concat(d)}null===(n=null===(t=window.tdocs)||void 0===t?void 0:t.setTitle)||void 0===n||n.call(t,{title:u});try{this.updateLocalClientVarsTitle(e.title,e.isAuto),(0,g.GI)("MODIFY",{domainId:o.domainId,localPadId:o.padId,title:e.title,actiontoserver:0});var p=m.LocalStorageUtil.getItem("tdsourcetag")||"";this.dataReport({opername:"doc_core",module:"edit",action:l,source3:p}),this.persistTitleToStorage("",e.isAuto)}catch(e){m.Logger.error("TitleService failed: ".concat(e))}},e.prototype.dataReport=function(e){var t,n=1===(null===(t=(0,s.Yi)().collab_client_vars)||void 0===t?void 0:t.dirty)?"limited":"normal",i=(0,r.__assign)({obj3:m.PlatformUtil.getBrowser(),ver5:n},e);o.ReportHelper.tdwReport(i)},e.prototype.persistTitleToStorage=function(e,t){var n=this.generateOfflineTitleKey();if(m.Logger.info("Set title to: ".concat(e,", isAuto: ").concat(t,", key: ").concat(n)),e){var r={title:e,isAuto:t};m.LocalStorageUtil.setItem(n,JSON.stringify(r))}else m.LocalStorageUtil.removeItem(n)},e.prototype.readTitleFromStorage=function(){var e=m.LocalStorageUtil.getItem(this.generateOfflineTitleKey());return e?JSON.parse(e):null},e.prototype.generateOfflineTitleKey=function(){var e=(0,s.Yi)().collab_client_vars.client.upid;return"offline_title_".concat(e)},e.prototype.setTitleToStore=function(e){this.store.upsert("docTitle",e)},e.prototype.getTitleFromStore=function(){var e=this.store.getValue("docTitle");return e||""},e.prototype.makeExtForTitle=function(e){if(R.v.isDriveFile){var t=(0,M.xI)()||"docx";return"".concat(e,".").concat(t)}return e},e.prototype.setTitleToNativeTitlebar=function(t){try{var n=this.makeExtForTitle(t);m.Logger.info("Set title to native: ".concat(n)),document.title=n;var r=(0,s.Yi)();r.padTitle=n,r.title=n,A.setShareInfo({},r),e.shareTitle(n)}catch(e){m.Logger.log("failed set title to mobile titlebar")}},e.shareTitle=function(e){var t,n,r;S.kE||(m.PlatformUtil.isWXMiniProgram()?null===(n=null===(t=window.wx)||void 0===t?void 0:t.miniProgram)||void 0===n||n.postMessage({data:{title:e}}):null===(r=window.mqq)||void 0===r||r.invoke("ui","setWebviewNaviTitle",{title:e,refreshDocList:!0,url:window.location.href}))},e.isIpadTencentDocsApp=function(){return!1},e.prototype.restoreOriginalTitle=function(e){(0,s.Yi)().padTitle=e,this.setTitleToStore(e),this.setTitleToNativeTitlebar(e),this.persistTitleToStorage(e,!0)},e.prototype.updateDocInitTitle=function(){var e=this,t=(0,s.Yi)().padTitle||(0,a.$t)("无标题文档"),n=this.readTitleFromStorage();m.Logger.info("Get title: ".concat(t,", local title: ").concat(n?n.title:"")),t=n&&n.title?n.title:t,this.setTitleToStore(t);var r=this.store.get("docTitle");this.pcNativeSubscription=r.subscribe((function(t){document.title=e.makeExtForTitle(t||(0,a.$t)("无标题文档"))})),this.setListPageTitle()},e.prototype.setListPageTitle=function(){var e=m.LocalStorageUtil.getItem(this.generateOfflineTitleKey());if(e){var t;try{t=JSON.parse(e)}catch(e){m.Logger.error("title parse error, titleInfo: ".concat(t))}this.autoUpdateTitle(t.title)}},e.prototype.destroy=function(){this.autoNamedId&&clearTimeout(this.autoNamedId),this.pcNativeSubscription&&this.pcNativeSubscription.unsubscribe()},(0,r.__decorate)([(0,d.tB)(),(0,r.__metadata)("design:type","function"==typeof(t=void 0!==p.O&&p.O)?t:Object)],e.prototype,"store",void 0),(0,r.__decorate)([(0,d.tB)(),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==f.O&&f.O)?n:Object)],e.prototype,"contextService",void 0),(0,r.__decorate)([(0,d.tB)(),(0,r.__metadata)("design:type","function"==typeof(v=void 0!==h.v&&h.v)?v:Object)],e.prototype,"eventEmitter",void 0),e}()),L=function(){function e(){}return e.getInstance=function(){return e.instance||(e.instance=S.kE?d.Am.get(I.a):new k),e.instance},e}()},266128:function(e,t,n){n.r(t),n.d(t,{ITitleMobileFeature:function(){return c}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=n(336338),c=Symbol.for("feature:".concat(i.C.TitleMobile));o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(1727).then(n.bind(n,223652))];case 1:return[2,e.sent().TitleMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:c,platforms:[a.Ev.Mobile,a.Ev.Pad],load:!s.kE})})},268562:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(839461),o=n(87363),i=n(618600),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props.type||"default",n=this.props.align||"left";return o.createElement("div",{className:"guide-tip-container"},o.createElement(i.Z,{in:this.props.show,timeout:800,classNames:"guide-ripple",unmountOnExit:!0},o.createElement("div",{className:"guide-tip-ripple"})),this.props.children,o.createElement(i.Z,{in:this.props.show,timeout:800,classNames:"guide-tip-fade",unmountOnExit:!0},o.createElement("div",{className:"guide-tip-animation-container ".concat(t)},o.createElement("div",{className:"guide-tip-triangle"}),o.createElement("div",{className:"guide-tip-wrapper ".concat(this.props.className||""," ").concat(n)},o.createElement("div",{className:"guide-tip-content ".concat(this.props.contentClassName||"")},this.props.content),o.createElement("div",{className:"guide-tip-button ".concat(this.props.buttonClassName||""),onClick:function(t){e.props.buttonClk&&e.props.buttonClk(t)}},this.props.button||"")))))},t}(o.Component),s=a},640273:function(e,t,n){n.d(t,{E:function(){return j}});var r=n(839461),o=n(661533),i=n.n(o),a=n(522142),s=n(137600),c=n(870372),l=n(87363),u=n.n(l),d="header-container--Pv-Zi",p="mobile-titlebar-title--VJw40",f="mobile-titlebar-collab--fhQp3",h="mobile-titlebar-tob-collab--Wmcf8",m="header-container-show--gVWtm",g="header-container-hide--TVYyQ",v="header-container-up--6FJ0q",_="left--RRPuF",y="left-pad-app--jwKsV",b="right--tKPXG",E=n(725771),C=n(750670),w=n(199235),T=n(259356),A=n(947229),S=n(268562),I=n(967948),R=n(515238),M=n(508436),O=n(399267),N=n(97303),k=n(393300),L=n(218581),D=n(6297),P=n(378898),x=function(e){function t(t){var n=e.call(this,t)||this;return n.unsubscribe$=new R.xQ,n.state={tipsProps:{}},M.default.isWeChat&&n.initJumpAppBox(),n}var n,o,i,a;return(0,r.__extends)(t,e),t.prototype.initJumpAppBox=function(){var e;return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){return null===(e=this.scriptLoader.getScriptLoader())||void 0===e||e.load("JumpAppMobile",(function(e){var t,n;e.show({url:window.location.href,corpId:null===(n=null===(t=window.clientVars)||void 0===t?void 0:t.userInfo)||void 0===n?void 0:n.corpId})})),[2]}))}))},t.prototype.componentDidMount=function(){var e=this;this.store.get("tipsProps").pipe((0,I.R)(this.unsubscribe$)).subscribe((function(t){e.setState({tipsProps:t})}));var t=this.eventEmitter.listen("$featureLoaded",(function(){e.forceUpdate(),t.unsubscribe()}))},t.prototype.render=function(){if(window.isPublishedURL||!this.showLoginTips)return null;var e=this.state.tipsProps,t=this.context.isFeatureLoaded;return!(0,N.isLogin)()&&t?u().createElement("div",null,u().createElement(S.Z,(0,r.__assign)({show:e.showRightTips},e.rightTipProps),u().createElement(k.Button,{style:{fontSize:"16px"},onClick:this.loginService.login},(0,L.$t)("登录腾讯文档")))):null},t.contextType=w.FN,(0,r.__decorate)([(0,T.tB)(),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==s.O&&s.O)?n:Object)],t.prototype,"store",void 0),(0,r.__decorate)([(0,T.tB)(),(0,r.__metadata)("design:type","function"==typeof(o=void 0!==A.v&&A.v)?o:Object)],t.prototype,"eventEmitter",void 0),(0,r.__decorate)([(0,T.tB)(),(0,r.__metadata)("design:type","function"==typeof(i=void 0!==O.$&&O.$)?i:Object)],t.prototype,"scriptLoader",void 0),(0,r.__decorate)([(0,T.tB)(),(0,r.__metadata)("design:type","function"==typeof(a=void 0!==D.r&&D.r)?a:Object)],t.prototype,"loginService",void 0),(0,r.__decorate)([(0,P.D)("feature.titlebar_mobile.showLoginTips",!0),(0,r.__metadata)("design:type",Boolean)],t.prototype,"showLoginTips",void 0),t}(l.PureComponent),F=n(495155),B=n(626091),U=n(317999),H=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isFirstRender=!0,t.rootRef=u().createRef(),t.onTouchEnd=function(e){var t;e.preventDefault();for(var n=e.target;"div"!==(null==n?void 0:n.nodeName.toLowerCase())&&"button"!==(null==n?void 0:n.nodeName.toLowerCase())&&(null==n?void 0:n.parentNode);)n=n.parentNode;null===(t=null==n?void 0:n.click)||void 0===t||t.call(n)},t}return(0,r.__extends)(t,e),t.prototype.componentDidMount=function(){var e,t,n;this.isFirstRender=!1,U.A.closeLoadingInEdit(),null===(e=this.rootRef.current)||void 0===e||e.addEventListener("touchend",this.onTouchEnd,!1),F.Logger.info("vip theme info",window.VipInfo,null===(n=null===(t=window.basicClientVars)||void 0===t?void 0:t.userInfo)||void 0===n?void 0:n.settings)},t.prototype.componentWillUnmount=function(){var e;null===(e=this.rootRef.current)||void 0===e||e.removeEventListener("touchend",this.onTouchEnd,!1)},t.prototype.matchClassName=function(){var e=[d],t=[_],n=g;return!1!==this.props.showMobileTitlebar&&(n=m),e.push(n),this.props.mobileTitlebarUp&&e.push(v),F.PlatformUtil.isTencentDocsIPadApp()&&t.push(y),{wrapperClass:e,left:t}},t.prototype.render=function(){var e=this.matchClassName().wrapperClass.join(" ");return!(0,F.supportNativeTitleBar)("doc")&&this.shouldShowTitlebar&&(0,B.NJ)()?(this.isFirstRender&&F.PlatformUtil.isWXorQQMiniProgram()&&(e=d),C.ReportHelper.tdwReport({opername:"doc_editor_topbar_pc",module:"more_menu",action:"view"}),u().createElement("div",{id:"header-container",className:e,ref:this.rootRef,style:{display:this.isFirstRender&&!this.shouldFirstShowTitlebar?"none":"flex"}},u().createElement("div",{className:this.matchClassName().left.join(" ")},u().createElement("div",{id:"mobile-titlebar-home"}),u().createElement("div",{id:"mobile-titlebar-done"}),u().createElement("div",{id:"mobile-titlebar-title",className:p}),u().createElement("div",{id:"mobile-titlebar-collab",className:f}),u().createElement("div",{id:"mobile-titlebar-offline"})),u().createElement("div",{className:b},u().createElement("div",{id:"mobile-titlebar-ai"}),u().createElement("div",{id:"mobile-titlebar-certification-tips"}),u().createElement("div",{id:"mobile-titlebar-star"}),u().createElement("div",{id:"mobile-titlebar-upload-success"}),u().createElement("div",{id:"mobile-titlebar-ent-collab"}),u().createElement("div",{id:"mobile-titlebar-tob-collab",className:h}),u().createElement("div",{id:"mobile-titlebar-member-button"}),u().createElement("div",{id:"mobile-titlebar-web-share"}),u().createElement("div",{id:"mobile-titlebar-share"}),u().createElement("div",{id:"mobile-titlebar-undo"}),u().createElement("div",{id:"mobile-titlebar-redo"}),u().createElement("div",{id:"mobile-titlebar-more-menu"}),u().createElement(x,null)))):null},t.flagMap={"mobile-titlebar-home":"home","mobile-titlebar-done":"done","mobile-titlebar-title":"title","mobile-titlebar-collab":"collaborators","mobile-titlebar-offline":"manual_offline","mobile-titlebar-star":"collect","mobile-titlebar-upload-success":"upload-cloud-success","mobile-titlebar-web-share":"share_web","mobile-titlebar-share":"share","mobile-titlebar-undo":"undo","mobile-titlebar-redo":"redo","mobile-titlebar-more-menu":"moreMenu","mobile-titlebar-certification-tips":"certification","mobile-titlebar-ai":"ai"},(0,r.__decorate)([(0,P.D)("common.titlebar",!0),(0,r.__metadata)("design:type",Boolean)],t.prototype,"shouldShowTitlebar",void 0),(0,r.__decorate)([(0,P.D)("feature.titlebar_mobile.read_titlebar",!0),(0,r.__metadata)("design:type",Boolean)],t.prototype,"shouldFirstShowTitlebar",void 0),t}(u().PureComponent),W=((0,E.x)(["showMobileTitlebar","mobileTitlebarUp"])(H),n(429749)),j=function(){function e(e,t){this.store=e,this.configService=t,this.store.register("tipsProps",{}),(0,F.supportNativeTitleBar)("doc")?(this.store.register("showMobileTitlebar",!1),this.store.register("showMobileNativeTitlebar",!0)):(this.store.register("showMobileTitlebar",!0),this.store.register("showMobileNativeTitlebar",!1)),this.store.register("mobileTitlebarUp",!1)}var t,n;return e.prototype.hydrate=function(e,t){var n=document.getElementById(e),r=H.flagMap[e],o=!0;r&&!this.configService.get("common.titlebar_mobile.".concat(r))&&(o=!1),n&&o?i().render(t,n):n&&!o&&n.remove()},e.prototype.deHydrate=function(e){var t=document.getElementById(e);t&&i().unmountComponentAtNode(t)},e.prototype.show=function(e){var t=document.getElementById(e),n=H.flagMap[e],r=!0;n&&!this.configService.get("common.titlebar_mobile.".concat(n))&&(r=!1),t&&r&&(t.style.display="block")},e.prototype.hide=function(e){var t=document.getElementById(e);t&&(t.style.display="none")},e=(0,r.__decorate)([(0,a.L)({name:c.C.TitlebarMobile,adapters:["melo"]}),(0,r.__metadata)("design:paramtypes",["function"==typeof(t=void 0!==s.O&&s.O)?t:Object,"function"==typeof(n=void 0!==W.ax&&W.ax)?n:Object])],e)}()},587809:function(e,t,n){n.r(t),n.d(t,{IToolbarFeature:function(){return a}});var r=n(839461),o=n(259356),i=n(870372),a=Symbol.for("feature:".concat(i.C.Toolbar));o.Ln.merge(a,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(9106).then(n.bind(n,509106))];case 1:return[2,e.sent().ToolbarHandler]}}))}))}})},541422:function(e,t,n){n.d(t,{g:function(){return b},n:function(){return o}});var r,o,i=n(87363),a=n.n(i),s=n(218581),c=n(750670),l=n(839461),u=n(110898),d=n(946191),p=n(507919),f=n(198568),h=n(837755),m=n(669872),g=n(399450),v=((r={})[c.STUnderline.single]=u.Z,r[c.STUnderline.double]=m.Z,r[c.STUnderline.thick]="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAATgAAAA8CAYAAADymabIAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACaSURBVHgB7dkxCoAgFIDhZ3SQlubuf4zmlm5ijRI0OASp3weCoq7/8iIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKBJaVm3HAD/l89jn2o+VD0GaInAAd0SOKBbAgd0a76XIQPwtRTvrXneledyr1UAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIziAumBCwws4+/eAAAAAElFTkSuQmCC",r[c.STUnderline.dotted]=d.Z,r[c.STUnderline.dash]=p.Z,r[c.STUnderline.dotDash]=f.Z,r[c.STUnderline.dotDotDash]=h.Z,r[c.STUnderline.wave]=g.Z,r),_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,l.__extends)(t,e),t.prototype.render=function(){return a().createElement("div",{style:{height:"30px",width:"140px",overflow:"hidden"}},a().createElement("img",{style:{height:"30px"},src:v[this.props.type]}))},t}(a().PureComponent),y=_;!function(e){e.NONE="none",e.SINGLE="single",e.DOUBLE="double",e.THICK="thick",e.DOTTED="dotted",e.DASH="dash",e.DOT_DASH="dotDash",e.DOT_DOT_DASH="dotDotDash",e.WAVE="wave"}(o||(o={}));var b=[{name:"underline-menu",content:(0,s.$t)("下划线"),popUpStyle:{overflow:"hidden"}},{name:o.NONE,tooltip:(0,s.$t)("清除下划线"),content:(0,s.$t)("清除下划线")},{name:o.SINGLE,icon:a().createElement(y,{type:c.STUnderline.single}),tooltip:(0,s.$t)("下划线")},{name:o.DOUBLE,icon:a().createElement(y,{type:c.STUnderline.double}),tooltip:(0,s.$t)("双下划线")},{name:o.THICK,icon:a().createElement(y,{type:c.STUnderline.thick}),tooltip:(0,s.$t)("粗下划线")},{name:o.DOTTED,icon:a().createElement(y,{type:c.STUnderline.dotted}),tooltip:(0,s.$t)("点式下划线")},{name:o.DASH,icon:a().createElement(y,{type:c.STUnderline.dash}),tooltip:(0,s.$t)("虚下划线")},{name:o.DOT_DASH,icon:a().createElement(y,{type:c.STUnderline.dotDash}),tooltip:(0,s.$t)("点-短下划线")},{name:o.DOT_DOT_DASH,icon:a().createElement(y,{type:c.STUnderline.dotDotDash}),tooltip:(0,s.$t)("点-点-短下划线")},{name:o.WAVE,icon:a().createElement(y,{type:c.STUnderline.wave}),tooltip:(0,s.$t)("波浪线")}]},167658:function(e,t,n){n.r(t),n.d(t,{IUpdateNoticeFeature:function(){return c},getUpdateNoticeUrl:function(){return l}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=n(139306),c=Symbol.for("feature:".concat(i.C.UpdateNotice));function l(){return s.v.getQuery("u_n_source")}o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(40).then(n.bind(n,744670))];case 1:return[2,e.sent().UpdateNoticeHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level4],key:c,platforms:[a.Ev.Pc],load:!!l()})})},414883:function(e,t,n){n.r(t),n.d(t,{IVisibilityChangeMobileFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.VisibilityChangeMobile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(5434).then(n.bind(n,123982))];case 1:return[2,e.sent().VisibilityChangeMobileHandler]}}))}))},on:a.iz.On({key:s,stages:[a.YV.Level3],platforms:[a.Ev.Mobile]})})},177492:function(e,t,n){n.r(t),n.d(t,{IVoiceInputFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.VoiceInput));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(2826).then(n.bind(n,21663))];case 1:return[2,e.sent().VoiceInputHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level3],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad]})})},865300:function(e,t,n){n.r(t),n.d(t,{IWebOfficeOpenAPIFeature:function(){return c}});var r=n(839461),o=n(259356),i=n(293325),a=n(870372),s=n(1792),c=Symbol.for("feature:".concat(a.C.WebOfficeOpenApi));o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(2219),n.e(2067),n.e(2768)]).then(n.bind(n,812054))];case 1:return[2,e.sent().OpenAPIHandler]}}))}))},on:i.iz.On({key:c,stages:[i.YV.Level2],load:s.dQ})})},286346:function(e,t,n){n.r(t),n.d(t,{IZoomMobileFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.ZoomMobile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(5511).then(n.bind(n,313778))];case 1:return[2,e.sent().ZoomMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad]})})},826691:function(e,t,n){var r,o,i,a,s,c,l;n.d(t,{Ak:function(){return o},Fv:function(){return i},aE:function(){return a},jz:function(){return r},tV:function(){return c},yW:function(){return s}}),function(e){e.CONTEXT_TOOLBAR="context-toolbar"}(r||(r={})),function(e){e.PARAGRAPH_SHORTCUT_MENU="paragraph-shortcut-menu",e.PARAGRAPH_SHORTCUT_MENU_NULL="paragraph-shortcut-menu-null",e.TOOLBAR_PARAGRAPH_MENU="toolbar-paragraph-menu",e.WORD_COUNT_MENU="word-count-menu",e.TABLE_SHORTCUT_MENU="table-shortcut-menu",e.TOC_SHORTCUT_MENU="toc-shortcut-menu",e.TOC_TOOLBAR_MENU="toc-toolbar-menu",e.HEADER_FOOTER_FLOAT_TOOLBAR="header-footer-float-toolbar",e.SNIPPETS="snippets-dropdown-menu",e.FOOTNOTE_ENDNOTE="footnote-endnote",e.JUMP_TO_NEXT_NOTE="jump-to-next-note",e.SDT_WIDGET="sdt-widget-dropdown-menu",e.RICH_TEXT_CONTENT_CONTROL="richtext-content-control",e.DROP_DOWN_LIST_CONTENT_CONTROL="dropdown_list_content_control"}(o||(o={})),function(e){e.PARAGRAPH_MENU_TOOLBAR="paragraph-menu-toolbar",e.PARAGRAPH_MENU_TOOLBAR_INSERT="paragraph-menu-toolbar_insert",e.PARAGRAPH_TABLE_PANEL="paragraph-table-panel",e.PARAGRAPH_INERT="paragraph-insert",e.PARAGRAPH_COPY="paragraph-copy",e.PARAGRAPH_CUT="paragraph-cut",e.PARAGRAPH_DELETE="paragraph-delete",e.PARAGRAPH_STYLE_GREY="paragraph-style-grey",e.PARAGRAPH_INERT_GREY="paragraph-insert-grey",e.PARAGRAPH_SIGNATURE="paragraph-signature",e.PARAGRAPH_LATEX="addon-latex",e.PARAGRAPH_ADDON_TOOL="paragraph-addon_tool",e.INSERT_ATTACHMENT="insert-attachment",e.COUNT_INFO="word_count_information",e.COUNT="word_count",e.COUNT_NO_PUNCTUATION="word_count_not_punctuation",e.COUNT_CHARACTERS="characters_count",e.COUNT_CHARACTERS_NO_SPACES="characters_count_not_spaces",e.COUNT_LOADING="count-loading",e.WXWORK_QUOTE="wxwork-quote",e.TABLE_ADJUST="table-adjust",e.TABLE_ADJUST_AUTO="adjustPageWidth",e.TABLE_ADJUST_ROW="averageRowHeight",e.TABLE_ADJUST_COL="averageColWidth",e.TABLE_HORIZON_ALIGN="tableHorizonAlign",e.TABLE_HORIZON_ALIGN_LEFT="tableHorizonLeftAlign",e.TABLE_HORIZON_ALIGN_CENTER="tableHorizonCenterAlign",e.TABLE_HORIZON_ALIGN_RIGHT="tableHorizonRightAlign",e.TABLE_STYLE_THEME="table-style-theme",e.TABLE_STYLE_THEME_PREVIEW="table-style-theme-preview",e.TABLE_INSERT="table-insert",e.TABLE_COPY="table-copy",e.TABLE_CUT="table-cut",e.TABLE_DELETE="table-delete",e.TOC_COPY="toc-copy",e.TOC_CUT="toc-cut",e.TOC_DELETE="toc-delete",e.TOC_INSERT="toc-insert",e.TOC_STYLE_GREY="toc-style-grey",e.TOC_MENU_TOOLBAR="toc-menu-toolbar",e.DELETE_HEADER="delete-header",e.DELETE_FOOTER="delete-footer",e.DELETE_PAGE_NUM="delete-page-num",e.TOGGLE_TITLE_PAGE="toggle_title_page",e.TOGGLE_EVEN_AND_ODD_HEADERS="toggle_even_and_odd_headers",e.TOGGLE_HEADER_SEPARATOR="toggle_header_separator",e.PDF_TRANSFORM="pdf-transform",e.PDF_TRANSFORM_DOC_TO_PDF="pdf-transform-docs-to-pdf",e.PDF_TRANSFORM_PDF_TO_WORD="pdf-transform-pdf-to-word",e.PDF_TRANSFORM_PDF_TO_EXCEL="pdf-transform-pdf-to-excel",e.PDF_TRANSFORM_PDF_TO_PPT="pdf-transform-pdf-to-ppt",e.QUICK_TOOLS="quick-tools",e.QUICK_TOOLS_BATCH_PROCESS_IMAGE="quick-tools-batch-process-image",e.QUICK_TOOLS_BATCH_DOWNLOAD_IMAGE="quick-tools-batch-download-image",e.QUICK_TOOLS_BATCH_RENAME_IMAGE="quick-tools-batch-rename-image",e.PREFERENCE_SETTINGS="preference-settings",e.QUICK_TOOLS_BATCH_ADD_WATERMARK_TO_IMAGE="quick-tools-batch-add-watermark-to-image",e.QUICK_TOOLS_BATCH_COMPRESS_IMAGE="quick-tools-batch-compress-image",e.AI_PARAGRAPH_FLOATING_BAR="ai-paragraph-floating-bar",e.AI_TABLE_FLOATING_BAR="ai-table-floating-bar",e.GOVERNMENT_TEMPLATE="government_template",e.GOVERNMENT_TEMPLATE_CONTENT="government_template_content",e.GOVERNMENT_HEADER="government_header",e.GOVERNMENT_HEADER_CONTENT="government_header_content",e.GOVERNMENT_SEPERATOR="government_seperator",e.GOVERNMENT_SINGLE_AUTHORITY="government_single_authority",e.GOVERNMENT_SINGLE_AUTHORITY_CONTENT="government_single_authority_content",e.GOVERNMENT_JOINT_AUTHORITY="government_joint_authority",e.GOVERNMENT_JOINT_AUTHORITY_CONTENT="government_joint_authority_content",e.GOVERNMENT_SINGLE_LINE_EDITION="government_single_line_edition",e.GOVERNMENT_SINGLE_LINE_EDITION_CONTENT="government_single_line_edition_content",e.GOVERNMENT_MUTIL_LINE_EDITION="government_multi_line_edition",e.GOVERNMENT_MUTIL_LINE_EDITION_CONTENT="government_multi_line_edition_content",e.REVIEW="review",e.REVIEW_INSERT_COMMENT="review-insert-comment",e.TOGGLE_TRACK_CHANGES="toggle-track-changes",e.REVISION_MARKUP_OPTIONS="revision-markup-options",e.FINAL_MODE_WITH_MARKUP="final-mode-with-markup",e.FINAL_MODE="final-mode",e.ORIGINAL_MODE_WITH_MARKUP="original-mode-with-markup",e.ORIGINAL_MODE="original-mode",e.ACCEPT_REVISION="accept-revision",e.ACCEPT_CURRENT_REVISION="accept-current-revision",e.ACCEPT_ALL_FORMAT_REVISIONS="accept-all-format-revisions",e.ACCEPT_ALL_REVISIONS="accept-all-revisions",e.REJECT_REVISION="reject-revision",e.REJECT_CURRENT_REVISION="reject-current-revision",e.REJECT_ALL_FORMAT_REVISIONS="reject-all-format-revisions",e.REJECT_ALL_REVISIONS="reject-all-revisions",e.MOVE_TO_PREVIOUS_REVISION="move-to-previous-revision",e.MOVE_TO_NEXT_REVISION="move-to-next-revision",e.RESTRICT_EDIT="restrict-edit-switch"}(i||(i={})),function(e){e.PARAGRAPH_TEXT="paragraph_text",e.PARAGRAPH_HEADING1="paragraph-heading1",e.PARAGRAPH_HEADING2="paragraph-heading2",e.PARAGRAPH_HEADING3="paragraph-heading3",e.PARAGRAPH_HEADING4="paragraph-heading4",e.PARAGRAPH_HEADING5="paragraph-heading5",e.PARAGRAPH_HEADING6="paragraph-heading6",e.PARAGRAPH_BOLD="paragraph-bold",e.PARAGRAPH_ITALIC="paragraph-italic",e.PARAGRAPH_BULLET_LIST="paragraph-bullet-list",e.PARAGRAPH_NUMBERED_LIST="paragraph-numbered-list",e.PARAGRAPH_TASK_LIST="paragraph-task-list",e.PARAGRAPH_ALIGN_LEFT="paragraph-align-left",e.PARAGRAPH_ALIGN_CENTER="paragraph-align-center",e.PARAGRAPH_ALIGN_RIGHT="paragraph-align-right",e.PARAGRAPH_ALIGN_JUSTIFY="paragraph-align-justify",e.PARAGRAPH_ALIGN_DISTRIBUTE="paragraph-align-distribute",e.PARAGRAPH_QUOTE="paragraph-quote",e.BLOCK_INCREASE_FONT_SIZE="block-increase-font-size",e.BLOCK_DECREASE_FONT_SIZE="block-decrease-font-size",e.BLOCK_BOLD="block-bold",e.BLOCK_ITALIC="block-italic",e.BLOCK_UNDER_LINE="block-under-line",e.BLOCK_DELETE_LINE="block-delete-line",e.BLOCK_FONT_COLOR="block-font-color",e.BLOCK_TEXT_HIGHLIGHT="block-text-highlight",e.FLOAT_TOOLBAR_BOLD="bold",e.FLOAT_TOOLBAR_ITALIC="italic",e.FLOAT_TOOLBAR_UNDERLINE="underline",e.FLOAT_TOOLBAR_STRIKE_THROUGH="strike-through",e.FLOAT_FONT_COLOR="font-color",e.FONT_BACKGROUND_COLOR="font-background-color",e.INSERT_ATTACHMENT="insert-attachment",e.PARAGRAPH_LIGHTBLOCK="paragraph-lightblock",e.INSERT_PAGE_NUM="insert-page-num",e.PAGE_NUM_SETTING="page-num-setting",e.HEADER_SETTING="header-setting",e.FOOTER_SETTING="footer-setting",e.LINK_TO_PREV_SECTION="link-to-prev-section",e.DELETE_HEADER_FOOTER="delete-header-footer",e.PDF_TRANSFORM="pdf-transform",e.GENERATE_IMAGE="generate-image",e.FORMAT_CONVERSION_SHELTER="format-conversion-shelter",e.QUICK_TOOLS="quick-tools",e.AI_FLOATING_BAR="ai-floating-bar",e.GOVERNMENT_TEMPLATE="government_template",e.GOVERNMENT_HEADER="government_header",e.GOVERNMENT_SEPERATOR="government_seperator",e.GOVERNMENT_SINGLE_AUTHORITY="government_single_authority",e.GOVERNMENT_JOINT_AUTHORITY="government_joint_authority",e.GOVERNMENT_SINGLE_LINE_EDITION="government_single_line_edition",e.GOVERNMENT_MUTIL_LINE_EDITION="government_multi_line_edition",e.RESTRICT_EDIT="restrict-edit-toggle",e.SDT_WIDGET="toolbar-sdt-widget",e.REVIEW_INSERT_COMMENT="review-insert-comment",e.TOGGLE_TRACK_CHANGES="toggle-track-changes",e.REVISION_MARKUP_OPTIONS="revision-markup-options",e.ACCEPT_REVISION="accept-revision",e.REJECT_REVISION="reject-revision",e.MOVE_TO_PREVIOUS_REVISION="move-to-previous-revision",e.MOVE_TO_NEXT_REVISION="move-to-next-revision"}(a||(a={})),function(e){e.PREVIEW_FILE="preview_file",e.DOWNLOAD_FILE="download_file",e.DELETE_FILE="delete_file",e.SWITCH_MODE="switch_mode"}(s||(s={})),function(e){e.INSERT_ATTACHMENT="insert-attachment"}(c||(c={})),function(e){e.INSERT_ATTACHMENT="insert-attachment"}(l||(l={}))},639463:function(e,t,n){n.r(t),n.d(t,{IAutoFocusFeature:function(){return l}});var r,o,i=n(839461),a=n(259356),s=n(293325),c=n(870372),l=Symbol.for("feature:".concat(c.C.TdocsAutoFocus));a.Ln.merge(l,{useFactory:function(){return(0,i.__awaiter)(void 0,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(7556).then(n.bind(n,114910))];case 1:return[2,e.sent().AutoFocusHandler]}}))}))},on:s.iz.On({key:l,stages:[s.YV.Level1],platforms:[s.Ev.Mobile,s.Ev.Pad],load:null!==(o=null===(r=window.editableWhenCreateState)||void 0===r?void 0:r.editableWhenCreate)&&void 0!==o&&o})})},429500:function(e,t,n){n.r(t),n.d(t,{IFollowLineButtonsFeature:function(){return s}});var r=n(839461),o=(n(495155),n(259356)),i=n(293325),a=n(870372),s=Symbol.for("feature:".concat(a.C.TdocsFollowLineButtons));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5597),n.e(9820),n.e(7797),n.e(5049),n.e(8063),n.e(823),n.e(3974),n.e(4397),n.e(7021),n.e(7131)]).then(n.bind(n,259216))];case 1:return[2,e.sent().FollowLineButtonsHandler]}}))}))},on:i.iz.On({key:s,stages:[i.YV.Level3],platforms:[i.Ev.Pc],load:!0})})},58648:function(e,t,n){n.r(t),n.d(t,{IApiDocEntFeature:function(){return s}});var r=n(839461),o=(n(495155),n(259356)),i=n(293325),a=n(870372),s=Symbol.for("feature:".concat(a.C.ApiDocEnt));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(7379).then(n.bind(n,786964))];case 1:return[2,e.sent().ApiDocEntHandler]}}))}))},on:i.iz.On({key:s,stages:[i.YV.Level2],platforms:[i.Ev.Pc],load:!1})})},851192:function(e,t,n){n.r(t),n.d(t,{IApiDocEntMobileFeature:function(){return s}});var r=n(839461),o=(n(495155),n(259356)),i=n(293325),a=n(870372),s=Symbol.for("feature:".concat(a.C.ApiDocEntMobile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(5627).then(n.bind(n,584570))];case 1:return[2,e.sent().ApiDocEntMobileHandler]}}))}))},on:i.iz.On({key:s,stages:[i.YV.Level2],platforms:[i.Ev.Mobile,i.Ev.Pad],load:!1})})},143250:function(e,t,n){n.r(t),n.d(t,{IAtRecordScrollFeature:function(){return s}});var r=n(839461),o=n(259356),i=(n(495155),n(870372)),a=n(293325),s=Symbol.for("feature:".concat(i.C.AtRecordScroll));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(8491).then(n.bind(n,634682))];case 1:return[2,e.sent().AtRecordScrollHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,load:!1})})},64121:function(e,t,n){n.r(t),n.d(t,{ICallTreeViewer:function(){return c}});var r=n(839461),o=n(259356),i=n(495155),a=n(870372),s=n(293325),c=Symbol.for("feature:".concat(a.C.CallTreeViewer));o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(1227).then(n.bind(n,587644))];case 1:return[2,e.sent().CallTreeViewerHandler]}}))}))},on:s.iz.On({stages:[s.YV.Level2],key:c,load:!!(0,i.getUrlParameter)("call_tree_viewer")})})},372684:function(e,t,n){n.r(t),n.d(t,{ICollabStatusEntMobileFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=(n(495155),Symbol.for("feature:".concat(i.C.CollabStatusEntMobile)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5070),n.e(5530)]).then(n.bind(n,801648))];case 1:return[2,e.sent().CollabStatusEntMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad],load:!1})})},337154:function(e,t,n){n.r(t),n.d(t,{ICommentEntFeature:function(){return s}});var r=n(839461),o=(n(495155),n(259356)),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.CommentEnt));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(2878),n.e(5576),n.e(2272)]).then(n.bind(n,912289))];case 1:return[2,e.sent().CommentEntHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,load:!1})})},950834:function(e,t,n){n.r(t),n.d(t,{ICommentEntMobileFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=(n(495155),Symbol.for("feature:".concat(i.C.CommentEntMobile)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5070),n.e(5446)]).then(n.bind(n,544066))];case 1:return[2,e.sent().CommentEntMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad],load:!1})})},918150:function(e,t,n){n.r(t),n.d(t,{ICommentEntPcFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=(n(495155),Symbol.for("feature:".concat(i.C.CommentEntPc)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(5121).then(n.bind(n,125060))];case 1:return[2,e.sent().CommentEntPcHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Pc],load:!1})})},396937:function(e,t,n){n.r(t),n.d(t,{IWedocsDiscussFeature:function(){return s}});var r=n(839461),o=n(259356),i=(n(495155),n(870372)),a=n(293325),s=Symbol.for("feature:".concat(i.C.WedocsDiscuss));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(2961).then(n.bind(n,514095))];case 1:return[2,e.sent().WedocsDiscussHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Pc],load:!1})})},886289:function(e,t,n){n.r(t),n.d(t,{IDiscussionEntFeature:function(){return s}});var r=n(839461),o=n(259356),i=(n(495155),n(870372)),a=n(293325),s=Symbol.for("feature:".concat(i.C.DiscussionEnt));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(5622).then(n.bind(n,676019))];case 1:return[2,e.sent().DiscussionEntHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Pc],load:!1})})},480527:function(e,t,n){n.r(t),n.d(t,{IDiscussionEntMobileFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=(n(495155),Symbol.for("feature:".concat(i.C.DiscussionEntMobile)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5070),n.e(8021)]).then(n.bind(n,647862))];case 1:return[2,e.sent().DiscussionEntMobileHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad],load:!1})})},474396:function(e,t,n){n.r(t),n.d(t,{IFieldcodeWeixinMentionFeature:function(){return s}});var r=n(839461),o=n(870372),i=n(259356),a=(n(495155),n(293325)),s=Symbol.for("feature:".concat(o.C.FieldcodeWeixinMention));i.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5070),n.e(8176)]).then(n.bind(n,682258))];case 1:return[2,e.sent().FieldcodeWeixinMentionHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,load:!1})})},733284:function(e,t,n){n.r(t),n.d(t,{IFieldcodeWxworkAppFeature:function(){return a}});var r=n(839461),o=n(259356),i=n(870372),a=Symbol.for("feature:".concat(i.C.WxworkApp));o.Ln.merge(a,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(7547).then(n.bind(n,37086))];case 1:return[2,e.sent().FieldcodeWxworkAppHandler]}}))}))}})},170752:function(e,t,n){n.r(t),n.d(t,{IFieldcodeWxworkCalenderFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=(n(495155),Symbol.for("feature:".concat(i.C.WxworkCalender)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(9587).then(n.bind(n,900454))];case 1:return[2,e.sent().FieldcodeWxworkCalenderHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2,a.YV.Publish],key:s,load:!1})})},823030:function(e,t,n){n.r(t),n.d(t,{IFieldcodeWxworkColdStartButtonFeature:function(){return a}});var r=n(839461),o=n(259356),i=n(870372),a=Symbol.for("feature:".concat(i.C.WxworkColdStartButton));o.Ln.merge(a,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(8117).then(n.bind(n,900176))];case 1:return[2,e.sent().FieldcodeWxworkColdStartButtonHandler]}}))}))}})},822416:function(e,t,n){n.r(t),n.d(t,{IFieldcodeWxworkGroupChatFeature:function(){return s}});var r=n(839461),o=(n(495155),n(870372)),i=n(259356),a=n(293325),s=Symbol.for("feature:".concat(o.C.WxworkGroupChat));i.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(8292).then(n.bind(n,15200))];case 1:return[2,e.sent().FieldcodeWxworkGroupChatHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,load:!1})})},281976:function(e,t,n){n.r(t),n.d(t,{IFieldcodeWxworkGroupContactCardFeature:function(){return a}});var r=n(839461),o=n(259356),i=n(870372),a=Symbol.for("feature:".concat(i.C.WxworkGroupContactCard));o.Ln.merge(a,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(9746).then(n.bind(n,118478))];case 1:return[2,e.sent().FieldcodeWxworkGroupContactCardHandler]}}))}))}})},25138:function(e,t,n){n.r(t),n.d(t,{IFieldcodeWxworkMeetingFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=(n(495155),Symbol.for("feature:".concat(i.C.WxworkMeeting)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(8718).then(n.bind(n,334971))];case 1:return[2,e.sent().FieldcodeWxworkMeetingHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2,a.YV.Publish],key:s,load:!1})})},477874:function(e,t,n){n.r(t),n.d(t,{IFieldcodeWxworkMemberContactCardFeature:function(){return a}});var r=n(839461),o=n(259356),i=n(870372),a=Symbol.for("feature:".concat(i.C.WxworkMemberContactCard));o.Ln.merge(a,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(4323).then(n.bind(n,110638))];case 1:return[2,e.sent().FieldcodeWxworkMemberContactCardHandler]}}))}))}})},245774:function(e,t,n){n.r(t),n.d(t,{IListQwxTodoFeature:function(){return s}});var r=n(839461),o=n(259356),i=(n(495155),n(870372)),a=n(293325),s=Symbol.for("feature:".concat(i.C.ListQwxTodo));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(9182).then(n.bind(n,669237))];case 1:return[2,e.sent().ListQwxTodoHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,load:!1})})},700419:function(e,t,n){var r,o,i;n.d(t,{hw:function(){return r},wL:function(){return i}}),function(e){e[e.kToDoList=0]="kToDoList",e[e.kToDoUpdate=1]="kToDoUpdate",e[e.kToDoCreateOrModify=2]="kToDoCreateOrModify",e[e.kToDoUpdateTodoStatus=3]="kToDoUpdateTodoStatus"}(r||(r={})),function(e){e[e.kToDoUserUnFinished=0]="kToDoUserUnFinished",e[e.kToDoUserFinished=1]="kToDoUserFinished",e[e.kToDoUserREJECT=2]="kToDoUserREJECT"}(o||(o={})),function(e){e[e.UNDONE=0]="UNDONE",e[e.DONE=1]="DONE",e[e.DELETE=2]="DELETE"}(i||(i={}))},413182:function(e,t,n){n.d(t,{U:function(){return a},o:function(){return r}});var r,o=n(839461),i=n(495155);!function(e){e.ON_UPDATE="api_list_todo_update"}(r||(r={}));var a=function(e){function t(t){var n=e.call(this,r.ON_UPDATE)||this;return n.todoItem=t,n}return(0,o.__extends)(t,e),t}(i.Notification)},612426:function(e,t,n){n.r(t),n.d(t,{IMiniListEntFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(293325),a=n(870372),s=(n(495155),Symbol.for("feature:".concat(a.C.MiniListEnt)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(4785).then(n.bind(n,597630))];case 1:return[2,e.sent().MiniListHandler]}}))}))},on:i.iz.On({stages:[i.YV.Level2],key:s,platforms:[i.Ev.Pc],load:!1})})},715085:function(e,t,n){n.r(t),n.d(t,{IMobileTipsFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=Symbol.for("feature:".concat(i.C.MobileTips));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(9440),n.e(2026)]).then(n.bind(n,485656))];case 1:return[2,e.sent().MobileTipsHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad]})})},871034:function(e,t,n){n.r(t),n.d(t,{IMoveFileFeature:function(){return s}});var r=n(839461),o=(n(495155),n(259356)),i=n(293325),a=n(870372),s=Symbol.for("feature:".concat(a.C.TitlebarMoveFile));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(7538).then(n.bind(n,229577))];case 1:return[2,e.sent().MoveFileHandler]}}))}))},on:i.iz.On({stages:[i.YV.Level2],key:s,platforms:[i.Ev.Pc],load:!1})})},225678:function(e,t,n){n.r(t),n.d(t,{IPreloadPreviewImageFeature:function(){return c},PreloadPreviewImagePriority:function(){return r}});var r,o=n(839461),i=n(259356),a=n(870372),s=n(293325),c=(n(495155),Symbol.for("feature:".concat(a.C.PreloadPreviewImage)));!function(e){e.high="high",e.medium="medium",e.default="default"}(r||(r={})),i.Ln.merge(c,{useFactory:function(){return(0,o.__awaiter)(void 0,void 0,void 0,(function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(8546).then(n.bind(n,294856))];case 1:return[2,e.sent().PreloadPreviewImageHandler]}}))}))},on:s.iz.On({stages:[s.YV.Level2],platforms:[s.Ev.Mobile],key:c,load:!1})})},467149:function(e,t,n){n.r(t),n.d(t,{IQuoteBaseFeature:function(){return s}});var r=n(839461),o=(n(495155),n(259356)),i=n(293325),a=n(870372),s=Symbol.for("feature:".concat(a.C.QuoteBase));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(317).then(n.bind(n,62069))];case 1:return[2,e.sent().QuoteBaseHandler]}}))}))},on:i.iz.On({key:s,load:!1,stages:[i.YV.Level2]})})},532531:function(e,t,n){n.r(t),n.d(t,{ITitlebarCollectFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=(n(495155),Symbol.for("feature:".concat(i.C.TitlebarCollect)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(4571).then(n.bind(n,481280))];case 1:return[2,e.sent().TitlebarCollectHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Pc],load:!1})})},660461:function(e,t,n){n.r(t),n.d(t,{ITobReadonlyTipsFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=(n(495155),Symbol.for("feature:".concat(i.C.TobReadonlyTips)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(9553).then(n.bind(n,374577))];case 1:return[2,e.sent().TobReadonlyTipsHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,load:!1})})},944161:function(e,t,n){n.r(t),n.d(t,{ITobRecentInputTextHandler:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=(n(495155),Symbol.for("feature:".concat(i.C.TobRecentInputText)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(4563).then(n.bind(n,483508))];case 1:return[2,e.sent().TobRecentInputTextHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:s,platforms:[a.Ev.Pc],load:!1})})},260663:function(e,t,n){n.r(t),n.d(t,{IUserAvatarFeature:function(){return c}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=n(669144),c=(n(495155),Symbol.for("feature:".concat(i.C.UserAvatar)));o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(9725).then(n.bind(n,538930))];case 1:return[2,e.sent().UserAvatarHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:c,platforms:[a.Ev.Pc],load:!s.W.isWeWortkDiscussionDoc&&!1})})},853546:function(e,t,n){n.r(t),n.d(t,{IWedocsProcessonFeature:function(){return s}});var r=n(839461),o=n(259356),i=(n(495155),n(293325)),a=n(870372),s=Symbol.for("feature:".concat(a.C.WedocsProcesson));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(243).then(n.bind(n,848157))];case 1:return[2,e.sent().WedocsProcessonHandler]}}))}))},on:i.iz.On({stages:[i.YV.Level2],key:s,load:!1})})},613114:function(e,t,n){n.r(t),n.d(t,{IWxworkFollowLineButtonsFeature:function(){return s}});var r=n(839461),o=n(259356),i=(n(495155),n(870372)),a=n(293325),s=Symbol.for("feature:".concat(i.C.WxworkFollowLineButtons));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(9543).then(n.bind(n,133024))];case 1:return[2,e.sent().WxworkFollowLineButtonsHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],platforms:[a.Ev.Pc],key:s,load:!1})})},745904:function(e,t,n){n.r(t),n.d(t,{IWxworkHelpAndFeedbackFeature:function(){return s}});var r=n(839461),o=n(259356),i=(n(495155),n(293325)),a=n(870372),s=Symbol.for("feature:".concat(a.C.WxworkHelpAndFeedback));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(2488).then(n.bind(n,92307))];case 1:return[2,e.sent().WxworkHelpAndFeedbackHandler]}}))}))},on:i.iz.On({stages:[i.YV.Level2],key:s,platforms:[i.Ev.Pad,i.Ev.Mobile],load:!1})})},839851:function(e,t,n){n.r(t),n.d(t,{IWxworkHintFeature:function(){return c},WXWORK_HINT_GUIDE_STORE_KEY:function(){return l},shouldShowWxworkHintGuide:function(){return u}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=n(669144),c=Symbol.for("feature:".concat(i.C.WxworkHint)),l="WXWORK_HINT_GUIDE_STORE_KEY",u=function(){return window.isWxworkReportTemplate&&!localStorage.getItem(l)};o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(9212).then(n.bind(n,448468))];case 1:return[2,e.sent().WxworkQuoteHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2,a.YV.Publish],key:c,load:s.v.isTencentFreegoEnv})})},335671:function(e,t,n){n.r(t),n.d(t,{IMobileNativeEnterpriseHeaderFeature:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=(n(495155),Symbol.for("feature:".concat(i.C.MobileEnterpriseHeader)));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(5070),n.e(5303)]).then(n.bind(n,995586))];case 1:return[2,e.sent().NativeWeixinHeaderHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level1,a.YV.Publish],key:s,platforms:[a.Ev.Mobile,a.Ev.Pad],load:!1})})},727639:function(e,t,n){n.r(t),n.d(t,{IWxworkQuoteFeature:function(){return c},QuoteClickFrom:function(){return r}});var r,o=n(839461),i=n(259356),a=(n(495155),n(870372)),s=n(293325);!function(e){e.ParagraphShortCut="shortcut",e.PCToolbar="toolbar",e.MobileContextMenu="mobile_context_menu",e.PCContextMenu="context_menu"}(r||(r={}));var c=Symbol.for("feature:".concat(a.C.WxworkQuote));i.Ln.merge(c,{useFactory:function(){return(0,o.__awaiter)(void 0,void 0,void 0,(function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(7747).then(n.bind(n,808141))];case 1:return[2,e.sent().WxworkQuoteHandler]}}))}))},on:s.iz.On({stages:[s.YV.Level2],key:c,load:!1})})},499067:function(e,t,n){n.r(t),n.d(t,{IWxworkRevisionRecordFeature:function(){return s}});var r=n(839461),o=(n(495155),n(259356)),i=n(293325),a=n(870372),s=Symbol.for("feature:".concat(a.C.WxworkRevisionRecord));o.Ln.merge(s,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([n.e(823),n.e(2738)]).then(n.bind(n,107403))];case 1:return[2,e.sent().WxworkRevisionRecordHandler]}}))}))},on:i.iz.On({stages:[i.YV.Level2],key:s,load:!1})})},473222:function(e,t,n){n.r(t),n.d(t,{IZoomWxworkFeature:function(){return c},NEED_LOAD_ZOOM_WXWORK:function(){return s}});var r=n(839461),o=n(259356),i=n(870372),a=n(293325),s=(n(495155),!1),c=Symbol.for("feature:".concat(i.C.ZoomWxwork));o.Ln.merge(c,{useFactory:function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(5199).then(n.bind(n,456989))];case 1:return[2,e.sent().ZoomWxworkHandler]}}))}))},on:a.iz.On({stages:[a.YV.Level2],key:c,platforms:[a.Ev.Pc],load:s})})},520273:function(e,t,n){n.r(t),n.d(t,{AbtestExpId:function(){return Gr.AbtestExpId},AnonymousStatus:function(){return g.AnonymousStatus},BTN_HEIGHT:function(){return rn.BTN_HEIGHT},BTN_PANEL_DISTANCE:function(){return rn.BTN_PANEL_DISTANCE},BackgroundType:function(){return w.BackgroundType},CURSOR_TYPE:function(){return Rt.CURSOR_TYPE},ControlGroupId:function(){return Gr.ControlGroupId},EditorState:function(){return ee.EditorState},ExperimentalGroupId:function(){return Gr.ExperimentalGroupId},IAIFeature:function(){return h.IAIFeature},IAccessibilityFeature:function(){return r.IAccessibilityFeature},IAddCooperator:function(){return i.IAddCooperator},IAddFastAccessFeature:function(){return a.IAddFastAccessFeature},IAddMobileFeature:function(){return o.IAddMobileFeature},IAddToWedriveFeature:function(){return s.IAddToWedriveFeature},IAddonHinaFeature:function(){return c.IAddonHinaFeature},IAddonIframeFeature:function(){return l.IAddonIframeFeature},IAddonMobileIframeFeature:function(){return u.IAddonMobileIframeFeature},IAddonNewFeature:function(){return d.IAddonNewFeature},IAddonPasteHandler:function(){return p.IAddonPasteHandler},IAddonSceneFeature:function(){return f.IAddonSceneFeature},IAirPrintFeature:function(){return m.IAirPrintFeature},IAnonymousFeature:function(){return g.IAnonymousFeature},IApiDocEntFeature:function(){return or.IApiDocEntFeature},IApiDocEntMobileFeature:function(){return ir.IApiDocEntMobileFeature},IAppGuideFeature:function(){return v.IAppGuideFeature},IAppGuidePcFeature:function(){return _.IAppGuidePcFeature},IAtRecordScrollFeature:function(){return ar.IAtRecordScrollFeature},IAttachmentFeature:function(){return y.IAttachmentFeature},IAttachmentReadonlyFeature:function(){return b.IAttachmentReadonlyFeature},IAudioFeature:function(){return E.IAudioFeature},IAutoFocusFeature:function(){return tr.IAutoFocusFeature},IAutoNewlineFeature:function(){return C.IAutoNewlineFeature},IBackgroundFeature:function(){return w.IBackgroundFeature},IBasicFormatFeature:function(){return T.IBasicFormatFeature},IBookmarkFeature:function(){return A.IBookmarkFeature},IBottomBarMobileFeature:function(){return S.IBottomBarMobileFeature},ICallTreeViewer:function(){return sr.ICallTreeViewer},ICertificationFeature:function(){return I.ICertificationFeature},ICertificationMobileFeature:function(){return R.ICertificationMobileFeature},ICodeblockFeature:function(){return M.ICodeblockFeature},ICollabCaretFeature:function(){return O.ICollabCaretFeature},ICollabStatusEntHandler:function(){return cr.ICollabStatusEntHandler},ICollabStatusEntMobileFeature:function(){return lr.ICollabStatusEntMobileFeature},ICollabStatusFeature:function(){return N.ICollabStatusFeature},ICollabStatusMobileFeature:function(){return k.ICollabStatusMobileFeature},ICollaboratorDetailMobileFeature:function(){return L.ICollaboratorDetailMobileFeature},ICollectMobileFeature:function(){return D.ICollectMobileFeature},ICollectPcFeature:function(){return P.ICollectPcFeature},IColorFeature:function(){return x.IColorFeature},IColumnFeature:function(){return F.IColumnFeature},ICommentEntFeature:function(){return ur.ICommentEntFeature},ICommentEntMobileFeature:function(){return dr.ICommentEntMobileFeature},ICommentEntPcFeature:function(){return pr.ICommentEntPcFeature},ICommentFeature:function(){return B.ICommentFeature},ICommentMobileFeature:function(){return U.ICommentMobileFeature},ICommentPcFeature:function(){return H.ICommentPcFeature},ICommonLoaderFeature:function(){return W.ICommonLoaderFeature},ICommonShortcutMenuHandler:function(){return cn.ICommonShortcutMenuHandler},IContextmenuMobileFeature:function(){return j.IContextmenuMobileFeature},ICopyPasteProcessorFeature:function(){return G.ICopyPasteProcessorFeature},ICopySharelinkFeature:function(){return V.ICopySharelinkFeature},ICoreEditHandler:function(){return z.ICoreEditHandler},IDarkModeFeature:function(){return Q.IDarkModeFeature},IDiffViewFeature:function(){return Y.IDiffViewFeature},IDiffViewMobileFeature:function(){return Z.IDiffViewMobileFeature},IDiscussionEntFeature:function(){return hr.IDiscussionEntFeature},IDiscussionEntMobileFeature:function(){return mr.IDiscussionEntMobileFeature},IDocPreviewFeature:function(){return K.IDocPreviewFeature},IDocViewMobileFeature:function(){return J.IDocViewMobileFeature},IDoclinkPasteHandler:function(){return q.IDoclinkPasteHandler},IEditFollowFeature:function(){return X.IEditFollowFeature},IEditTipsMobileFeature:function(){return $.IEditTipsMobileFeature},IEditorStateFeature:function(){return ee.IEditorStateFeature},IEmbeddedObjectFeature:function(){return te.IEmbeddedObjectFeature},IExternalTagFeature:function(){return ne.IExternalTagFeature},IFanbookFeature:function(){return re.IFanbookFeature},IFastEditFeature:function(){return oe.IFastEditFeature},IFieldCodeQQCardHandler:function(){return he.IFieldCodeQQCardHandler},IFieldDemoFeature:function(){return ie.IFieldDemoFeature},IFieldFeature:function(){return ae.IFieldFeature},IFieldPageRefFeature:function(){return ce.IFieldPageRefFeature},IFieldcodeDateHandler:function(){return de.IFieldcodeDateHandler},IFieldcodeDocLinkHandler:function(){return pe.IFieldcodeDocLinkHandler},IFieldcodeMentionFeature:function(){return fe.IFieldcodeMentionFeature},IFieldcodeWeixinMentionFeature:function(){return gr.IFieldcodeWeixinMentionFeature},IFieldcodeWxworkAppFeature:function(){return vr.IFieldcodeWxworkAppFeature},IFieldcodeWxworkCalenderFeature:function(){return _r.IFieldcodeWxworkCalenderFeature},IFieldcodeWxworkColdStartButtonFeature:function(){return yr.IFieldcodeWxworkColdStartButtonFeature},IFieldcodeWxworkGroupChatFeature:function(){return br.IFieldcodeWxworkGroupChatFeature},IFieldcodeWxworkGroupContactCardFeature:function(){return Er.IFieldcodeWxworkGroupContactCardFeature},IFieldcodeWxworkMeetingFeature:function(){return Cr.IFieldcodeWxworkMeetingFeature},IFieldcodeWxworkMemberContactCardFeature:function(){return wr.IFieldcodeWxworkMemberContactCardFeature},IFileBaseFeature:function(){return me.IFileBaseFeature},IFileExportHandler:function(){return ge.IFileExportHandler},IFileInfoPanelMobileFeature:function(){return ve.IFileInfoPanelMobileFeature},IFileInfoPanelPcFeature:function(){return _e.IFileInfoPanelPcFeature},IFileMobileFeature:function(){return ye.IFileMobileFeature},IFilePcFeature:function(){return be.IFilePcFeature},IFileWechatFeature:function(){return Ee.IFileWechatFeature},IFloatToolbarFeature:function(){return Ce.IFloatToolbarFeature},IFollowLineButtonsFeature:function(){return nr.IFollowLineButtonsFeature},IFontFeature:function(){return we.IFontFeature},IFormatPainterFeature:function(){return Te.IFormatPainterFeature},IFullscreenFeature:function(){return Ae.IFullscreenFeature},IGuideToWeworkFeature:function(){return Se.IGuideToWeworkFeature},IHeadingFeature:function(){return Ie.IHeadingFeature},IHelpAndFeedBackCenterHandler:function(){return Me.IHelpAndFeedBackCenterHandler},IHelpCenterFeature:function(){return Re.IHelpCenterFeature},IHintFeature:function(){return Oe.IHintFeature},IHyperlinkFeature:function(){return se.IHyperlinkFeature},IImageFeature:function(){return ke.IImageFeature},IImageMobileFeature:function(){return Le.IImageMobileFeature},IImagePcFeature:function(){return De.IImagePcFeature},IImageReadonlyFeature:function(){return Pe.IImageReadonlyFeature},IInactivityGuideFeature:function(){return xe.IInactivityGuideFeature},IInactivityGuideMobileFeature:function(){return xe.IInactivityGuideMobileFeature},IIpadAppKeyboardFeature:function(){return Fe.IIpadAppKeyboardFeature},IKeymapListFeature:function(){return Be.IKeymapListFeature},ILandspaceStateFeature:function(){return Ue.ILandspaceStateFeature},ILatexFeature:function(){return He.ILatexFeature},ILayoutTypeFeature:function(){return We.ILayoutTypeFeature},ILightBlockFeature:function(){return je.ILightBlockFeature},ILikeMobileFeature:function(){return Ge.ILikeMobileFeature},IListFeature:function(){return Ve.IListFeature},IListQwxTodoFeature:function(){return Tr.IListQwxTodoFeature},IListReadonlyFeature:function(){return ze.IListReadonlyFeature},ILocalAndDriveMobileFeature:function(){return Qe.ILocalAndDriveMobileFeature},ILocalEditTitlebarConfigService:function(){return Ze.ILocalEditTitlebarConfigService},ILocalFileSaveFeature:function(){return Ke.ILocalFileSaveFeature},ILocationFeature:function(){return Je.ILocationFeature},IManualOfflineFeature:function(){return qe.IManualOfflineFeature},IMarkdownFeature:function(){return Xe.IMarkdownFeature},IMathFeature:function(){return $e.IMathFeature},IMemberMobileFeature:function(){return et.IMemberMobileFeature},IMiniListEntFeature:function(){return Ar.IMiniListEntFeature},IMiniListFeature:function(){return tt.IMiniListFeature},IMobileAutoScrollFeature:function(){return nt.IMobileAutoScrollFeature},IMobileBlockBottomBarFeature:function(){return ot.IMobileBlockBottomBarFeature},IMobileBlockInterface:function(){return rt.IMobileBlockInterface},IMobileGestureFeature:function(){return it.IMobileGestureFeature},IMobileHeaderFeature:function(){return at.IMobileHeaderFeature},IMobileHomeFeature:function(){return Ne.IMobileHomeFeature},IMobileLocalEditFeature:function(){return Ye.IMobileLocalEditFeature},IMobileMoreMenuFeature:function(){return st.IMobileMoreMenuFeature},IMobileNativeEnterpriseHeaderFeature:function(){return Ur.IMobileNativeEnterpriseHeaderFeature},IMobileTipsFeature:function(){return Sr.IMobileTipsFeature},IMobileTopBannerFeature:function(){return ct.IMobileTopBannerFeature},IMobileViewFeature:function(){return lt.IMobileViewFeature},IMoveFileFeature:function(){return Ir.IMoveFileFeature},IMoveToFeature:function(){return ut.IMoveToFeature},IMoveToMobileFeature:function(){return dt.IMoveToMobileFeature},INativeMobileHeaderFeature:function(){return pt.INativeMobileHeaderFeature},INoteFeature:function(){return ft.INoteFeature},INotifyPcClientFeature:function(){return ht.INotifyPcClientFeature},IOcrFeature:function(){return mt.IOcrFeature},IOcrPcFeature:function(){return gt.IOcrPcFeature},IOcrPreviewFeature:function(){return vt.IOcrPreviewFeature},IOfflineEditFeature:function(){return _t.IOfflineEditFeature},IOfflineStatusFeature:function(){return yt.IOfflineStatusFeature},IOpenAPIFeature:function(){return bt.IOpenAPIFeature},IOutlineFeature:function(){return Et.IOutlineFeature},IOutlineMobileFeature:function(){return Ct.IOutlineMobileFeature},IPageFeature:function(){return wt.IPageFeature},IPageShadeFeature:function(){return Tt.IPageShadeFeature},IPageWebFeature:function(){return At.IPageWebFeature},IParagraphDragMobileFeature:function(){return It.IParagraphDragMobileFeature},IParagraphFeature:function(){return St.IParagraphFeature},IParagraphShortcutMenuFeature:function(){return Rt.IParagraphShortcutMenuFeature},IPdfTransformFeature:function(){return Mt.IPdfTransformFeature},IPermissionRangeFeature:function(){return Ot.IPermissionRangeFeature},IPreferenceFeature:function(){return Nt.IPreferenceFeature},IPreloadPreviewImageFeature:function(){return Rr.IPreloadPreviewImageFeature},IPresentationFeature:function(){return kt.IPresentationFeature},IPresentationPlayerFeature:function(){return Lt.IPresentationPlayerFeature},IPrintFeature:function(){return Dt.IPrintFeature},IPublishFeature:function(){return Pt.IPublishFeature},IQuickToolsFeature:function(){return xt.IQuickToolsFeature},IQuicklyVisitMobileFeature:function(){return Ft.IQuicklyVisitMobileFeature},IQuoteBaseFeature:function(){return Mr.IQuoteBaseFeature},IQuoteFeature:function(){return Bt.IQuoteFeature},IReadRecordFeature:function(){return Ut.IReadRecordFeature},IReadonlyTipsFeature:function(){return Ht.IReadonlyTipsFeature},IRecoverDocFeature:function(){return Wt.IRecoverDocFeature},IRepeatLastFeature:function(){return jt.IRepeatLastFeature},IResizeAdaptFeature:function(){return Gt.IResizeAdaptFeature},IRestrictEditFeature:function(){return Vt.IRestrictEditFeature},IResumeGuideFeature:function(){return zt.IResumeGuideFeature},IResumeGuideMobileFeature:function(){return Qt.IResumeGuideMobileFeature},IReviewFeature:function(){return Yt.IReviewFeature},IReviewMobileFeature:function(){return Zt.IReviewMobileFeature},IReviewPcFeature:function(){return Kt.IReviewPcFeature},IRevisionRecordFeature:function(){return Jt.IRevisionRecordFeature},IRulerFeature:function(){return qt.IRulerFeature},IS_LANDSPACE:function(){return Ue.IS_LANDSPACE},IS_RULER_SHOW:function(){return qt.IS_RULER_SHOW},IScrollPositionFeature:function(){return Xt.IScrollPositionFeature},IScrollbarHiddenMobileFeature:function(){return $t.IScrollbarHiddenMobileFeature},ISdtFeature:function(){return en.ISdtFeature},ISearchFeature:function(){return tn.ISearchFeature},ISectionFeature:function(){return nn.ISectionFeature},ISelectivePasteHandler:function(){return rn.ISelectivePasteHandler},IShareFeature:function(){return on.IShareFeature},IShareMobileFeature:function(){return an.IShareMobileFeature},IShareMobileWebFeature:function(){return sn.IShareMobileWebFeature},IShowMoreFeature:function(){return ln.IShowMoreFeature},ISignatureFeature:function(){return un.ISignatureFeature},ISnapScreenMobileFeature:function(){return dn.ISnapScreenMobileFeature},ISnapScreenPcFeature:function(){return pn.ISnapScreenPcFeature},ISnippetFeature:function(){return fn.ISnippetFeature},ISpellcheckFeature:function(){return hn.ISpellcheckFeature},ISplitlineFeature:function(){return mn.ISplitlineFeature},IStarMobileFeature:function(){return gn.IStarMobileFeature},IStatusTipsFeature:function(){return vn.IStatusTipsFeature},ISubscribeFeature:function(){return _n.ISubscribeFeature},ISubscribeNoticeMobileFeature:function(){return yn.ISubscribeNoticeMobileFeature},ISubscriptionNotificationFeature:function(){return bn.ISubscriptionNotificationFeature},ISubscriptionNotificationMenuFeature:function(){return En.ISubscriptionNotificationMenuFeature},ISwitchCertificationFeature:function(){return Cn.ISwitchCertificationFeature},ISwitchCertificationMobileFeature:function(){return wn.ISwitchCertificationMobileFeature},ISymbolFeature:function(){return Tn.ISymbolFeature},ISyncTencentListHandler:function(){return An.ISyncTencentListHandler},ISyncTencentListMobileFeature:function(){return Sn.ISyncTencentListMobileFeature},ITabService:function(){return Gr.ITabService},ITableFeature:function(){return Rn.ITableFeature},ITableShortcutMenuFeature:function(){return In.ITableShortcutMenuFeature},ITdocsDeferredRenderFeature:function(){return rr.ITdocsDeferredRenderFeature},ITemplateInfoFeature:function(){return Mn.ITemplateInfoFeature},ITemplateRecommendation:function(){return On.ITemplateRecommendation},ITextDragPcFeature:function(){return Nn.ITextDragPcFeature},ITextFlowFeature:function(){return kn.ITextFlowFeature},ITextFrameFeature:function(){return Ln.ITextFrameFeature},ITitleColorFeature:function(){return Pn.ITitleColorFeature},ITitleDefaultAddFeature:function(){return xn.ITitleDefaultAddFeature},ITitleFeature:function(){return Dn.ITitleFeature},ITitleMobileFeature:function(){return Fn.ITitleMobileFeature},ITitlebarCollectFeature:function(){return Or.ITitlebarCollectFeature},ITitlebarFeature:function(){return Bn.ITitlebarFeature},ITitlebarFoldHandler:function(){return Un.ITitlebarFoldHandler},ITobReadonlyTipsFeature:function(){return Nr.ITobReadonlyTipsFeature},ITobRecentInputTextHandler:function(){return kr.ITobRecentInputTextHandler},ITocFeature:function(){return ue.ITocFeature},ITocShortcutMenuHandler:function(){return le.ITocShortcutMenuHandler},IToolbarFeature:function(){return Wn.IToolbarFeature},IToolbarToggleFeature:function(){return Hn.IToolbarToggleFeature},ITranslateFeature:function(){return jn.ITranslateFeature},IUnreadNotifyHandler:function(){return Gn.IUnreadNotifyHandler},IUpdateNoticeFeature:function(){return Vn.IUpdateNoticeFeature},IUserAvatarFeature:function(){return Lr.IUserAvatarFeature},IVipFeature:function(){return zn.IVipFeature},IVisibilityChangeMobileFeature:function(){return Qn.IVisibilityChangeMobileFeature},IVoiceInputFeature:function(){return Yn.IVoiceInputFeature},IWatermarkFeature:function(){return Zn.IWatermarkFeature},IWebOfficeOpenAPIFeature:function(){return Kn.IWebOfficeOpenAPIFeature},IWedocsDiscussFeature:function(){return fr.IWedocsDiscussFeature},IWedocsProcessonFeature:function(){return Dr.IWedocsProcessonFeature},IWedriveAttachmentFeature:function(){return Pr.IWedriveAttachmentFeature},IWordCountFeature:function(){return Jn.IWordCountFeature},IWxworkFollowLineButtonsFeature:function(){return xr.IWxworkFollowLineButtonsFeature},IWxworkHelpAndFeedbackFeature:function(){return Fr.IWxworkHelpAndFeedbackFeature},IWxworkHintFeature:function(){return Br.IWxworkHintFeature},IWxworkQuoteFeature:function(){return Hr.IWxworkQuoteFeature},IWxworkRevisionRecordFeature:function(){return Wr.IWxworkRevisionRecordFeature},IZoomBaseFeature:function(){return qn.IZoomBaseFeature},IZoomMeloFeature:function(){return Xn.IZoomMeloFeature},IZoomMobileFeature:function(){return $n.IZoomMobileFeature},IZoomPcFeature:function(){return er.IZoomPcFeature},IZoomWxworkFeature:function(){return jr.IZoomWxworkFeature},ImportScene:function(){return Qt.ImportScene},ImportType:function(){return Qt.ImportType},InsertTocTemplateId:function(){return ue.InsertTocTemplateId},MELO_DATA_CHANGED_EVENT:function(){return _n.MELO_DATA_CHANGED_EVENT},MobileActionSheetImageDownloadOption:function(){return xt.MobileActionSheetImageDownloadOption},NEED_LOAD_ZOOM_WXWORK:function(){return jr.NEED_LOAD_ZOOM_WXWORK},PAGE_FOOTER:function(){return nn.PAGE_FOOTER},PAGE_HEADER:function(){return nn.PAGE_HEADER},PANEL_HEIGHT_2_ITEM:function(){return rn.PANEL_HEIGHT_2_ITEM},PANEL_HEIGHT_3_ITEM:function(){return rn.PANEL_HEIGHT_3_ITEM},PageNumberPosition:function(){return nn.PageNumberPosition},PasteBtnType:function(){return rn.PasteBtnType},PreloadPreviewImagePriority:function(){return Rr.PreloadPreviewImagePriority},QuickToolsTabIDMap:function(){return xt.QuickToolsTabIDMap},QuoteClickFrom:function(){return Hr.QuoteClickFrom},SHOULD_AUTO_LOAD:function(){return he.SHOULD_AUTO_LOAD},ShadeEntrance:function(){return Tt.ShadeEntrance},TriggerType:function(){return Dt.TriggerType},USER_SET_TOOLBAR_MODE_KEY:function(){return Hn.USER_SET_TOOLBAR_MODE_KEY},WXWORK_HINT_GUIDE_STORE_KEY:function(){return Br.WXWORK_HINT_GUIDE_STORE_KEY},WeDriveStatus:function(){return s.WeDriveStatus},canShowRecommendation:function(){return On.canShowRecommendation},getUpdateNoticeUrl:function(){return Vn.getUpdateNoticeUrl},isAudioAvalible:function(){return E.isAudioAvalible},shouldAutoLoad:function(){return kt.shouldAutoLoad},shouldShowWxworkHintGuide:function(){return Br.shouldShowWxworkHintGuide}});var r=n(95410),o=n(434320),i=n(22405),a=n(872302),s=n(212553),c=n(53631),l=n(494190),u=n(192309),d=n(464871),p=n(958890),f=n(292060),h=n(451662),m=n(448392),g=n(671923),v=n(975084),_=n(726979),y=n(699382),b=n(220705),E=n(608290),C=n(557317),w=n(817635),T=n(962886),A=n(608402),S=n(652915),I=n(246053),R=n(817957),M=n(68106),O=n(942412),N=n(25683),k=n(94809),L=n(842604),D=n(467320),P=n(547387),x=n(14813),F=n(931021),B=n(901792),U=n(584952),H=n(361625),W=n(913812),j=n(410253),G=n(96630),V=n(640123),z=n(563577),Q=n(127586),Y=n(987389),Z=n(889588),K=n(281558),J=n(419682),q=n(24537),X=n(372722),$=n(770288),ee=n(103192),te=n(148850),ne=n(126494),re=n(736287),oe=n(515772),ie=n(23760),ae=n(685655),se=n(539957),ce=n(278874),le=n(965014),ue=n(866098),de=n(745386),pe=n(596740),fe=n(952884),he=n(94107),me=n(759429),ge=n(503642),ve=n(562765),_e=n(613603),ye=n(726496),be=n(594185),Ee=n(270882),Ce=n(707894),we=n(649172),Te=n(287523),Ae=n(798627),Se=n(656739),Ie=n(402807),Re=n(756897),Me=n(781559),Oe=n(455279),Ne=n(55328),ke=n(318905),Le=n(965811),De=n(989653),Pe=n(929410),xe=n(751732),Fe=n(212890),Be=n(487271),Ue=n(510258),He=n(258032),We=n(528252),je=n(579556),Ge=n(626127),Ve=n(891088),ze=n(749378),Qe=n(890132),Ye=n(655116),Ze=n(817183),Ke=n(333291),Je=n(772189),qe=n(646820),Xe=n(932045),$e=n(608605),et=n(93946),tt=n(972296),nt=n(449889),rt=n(859604),ot=n(139895),it=n(954729),at=n(938503),st=n(857314),ct=n(943064),lt=n(681557),ut=n(150327),dt=n(621896),pt=n(82216),ft=n(752789),ht=n(61390),mt=n(622454),gt=n(912043),vt=n(162678),_t=n(141082),yt=n(797376),bt=n(151476),Et=n(340052),Ct=n(822643),wt=n(338461),Tt=n(715036),At=n(446587),St=n(567600),It=n(501317),Rt=n(841952),Mt=n(890560),Ot=n(943024),Nt=n(97371),kt=n(249997),Lt=n(344071),Dt=n(830447),Pt=n(319533),xt=n(677445),Ft=n(267086),Bt=n(380501),Ut=n(834980),Ht=n(575574),Wt=n(105485),jt=n(706989),Gt=n(837391),Vt=n(585991),zt=n(387090),Qt=n(123886),Yt=n(927197),Zt=n(530625),Kt=n(453368),Jt=n(189299),qt=n(86951),Xt=n(709303),$t=n(110155),en=n(266208),tn=n(892385),nn=n(479697),rn=n(24990),on=n(817153),an=n(259991),sn=n(162489),cn=n(128059),ln=n(508810),un=n(457517),dn=n(836935),pn=n(203663),fn=n(673112),hn=n(558096),mn=n(127497),gn=n(322915),vn=n(87709),_n=n(894237),yn=n(954583),bn=n(446077),En=n(162912),Cn=n(658384),wn=n(14092),Tn=n(649176),An=n(499689),Sn=n(221846),In=n(229537),Rn=n(647279),Mn=n(995864),On=n(76619),Nn=n(256136),kn=n(352462),Ln=n(443363),Dn=n(721869),Pn=n(32394),xn=n(462200),Fn=n(266128),Bn=n(459879),Un=n(193065),Hn=n(361217),Wn=n(587809),jn=n(395028),Gn=n(989640),Vn=n(167658),zn=n(739103),Qn=n(414883),Yn=n(177492),Zn=n(497612),Kn=n(865300),Jn=n(518103),qn=n(82965),Xn=n(994556),$n=n(286346),er=n(451693),tr=n(639463),nr=n(429500),rr=n(148799),or=n(58648),ir=n(851192),ar=n(143250),sr=n(64121),cr=n(831830),lr=n(372684),ur=n(337154),dr=n(950834),pr=n(918150),fr=n(396937),hr=n(886289),mr=n(480527),gr=n(474396),vr=n(733284),_r=n(170752),yr=n(823030),br=n(822416),Er=n(281976),Cr=n(25138),wr=n(477874),Tr=n(245774),Ar=n(612426),Sr=n(715085),Ir=n(871034),Rr=n(225678),Mr=n(467149),Or=n(532531),Nr=n(660461),kr=n(944161),Lr=n(260663),Dr=n(853546),Pr=n(536186),xr=n(613114),Fr=n(745904),Br=n(839851),Ur=n(335671),Hr=n(727639),Wr=n(499067),jr=n(473222),Gr=n(94277);n(95410),n(434320),n(22405),n(872302),n(212553),n(53631),n(494190),n(192309),n(464871),n(958890),n(292060),n(451662),n(448392),n(671923),n(975084),n(726979),n(699382),n(220705),n(608290),n(557317),n(817635),n(962886),n(608402),n(652915),n(246053),n(817957),n(68106),n(942412),n(25683),n(94809),n(842604),n(467320),n(547387),n(14813),n(931021),n(901792),n(584952),n(361625),n(913812),n(410253),n(96630),n(640123),n(563577),n(127586),n(987389),n(889588),n(281558),n(419682),n(24537),n(372722),n(770288),n(103192),n(148850),n(126494),n(736287),n(515772),n(23760),n(685655),n(539957),n(278874),n(965014),n(866098),n(745386),n(596740),n(952884),n(94107),n(759429),n(503642),n(562765),n(613603),n(726496),n(594185),n(270882),n(707894),n(649172),n(287523),n(798627),n(656739),n(402807),n(756897),n(781559),n(455279),n(55328),n(318905),n(965811),n(989653),n(929410),n(751732),n(212890),n(487271),n(510258),n(258032),n(528252),n(579556),n(626127),n(891088),n(749378),n(890132),n(655116),n(817183),n(333291),n(772189),n(646820),n(932045),n(608605),n(93946),n(972296),n(449889),n(859604),n(139895),n(954729),n(938503),n(857314),n(943064),n(681557),n(150327),n(621896),n(82216),n(752789),n(61390),n(622454),n(912043),n(162678),n(141082),n(797376),n(151476),n(340052),n(822643),n(338461),n(715036),n(446587),n(567600),n(501317),n(841952),n(890560),n(943024),n(97371),n(249997),n(344071),n(830447),n(319533),n(677445),n(267086),n(380501),n(834980),n(575574),n(105485),n(706989),n(837391),n(585991),n(387090),n(123886),n(927197),n(530625),n(453368),n(189299),n(86951),n(709303),n(110155),n(266208),n(892385),n(479697),n(24990),n(817153),n(259991),n(162489),n(128059),n(508810),n(457517),n(836935),n(203663),n(673112),n(558096),n(127497),n(322915),n(87709),n(894237),n(954583),n(446077),n(162912),n(658384),n(14092),n(649176),n(499689),n(221846),n(229537),n(647279),n(995864),n(76619),n(256136),n(352462),n(443363),n(721869),n(32394),n(462200),n(266128),n(459879),n(193065),n(361217),n(587809),n(395028),n(989640),n(167658),n(739103),n(414883),n(177492),n(497612),n(865300),n(518103),n(82965),n(994556),n(286346),n(451693),n(639463),n(429500),n(148799),n(58648),n(851192),n(143250),n(64121),n(831830),n(372684),n(337154),n(950834),n(918150),n(396937),n(886289),n(480527),n(474396),n(733284),n(170752),n(823030),n(822416),n(281976),n(25138),n(477874),n(245774),n(612426),n(715085),n(871034),n(225678),n(467149),n(532531),n(660461),n(944161),n(260663),n(853546),n(536186),n(613114),n(745904),n(839851),n(335671),n(727639),n(499067),n(473222),n(94277)},458524:function(e,t,n){var r,o,i,a,s;n.d(t,{FY:function(){return o},V7:function(){return s},Zx:function(){return i},aV:function(){return a}}),function(e){e.LOADING="LOADING",e.PENDING="PENDING",e.PAUSING="PAUSING",e.UPLOADING="UPLOADING",e.ERROR="ERROR",e.SUCCESS="SUCCESS"}(r||(r={})),function(e){e.VIDEO="video",e.AUDIO="audio",e.DOC="doc",e.IMAGE="image"}(o||(o={})),function(e){e.SIMPLE_TEXT="simpleText",e.TEXT="text",e.CARD="card",e.NONE="none",e.PREVIEW="preview"}(i||(i={})),function(e){e[e.SIMPLE_TEXT=0]="SIMPLE_TEXT",e[e.TEXT=1]="TEXT",e[e.CARD=2]="CARD",e[e.PREVIEW=3]="PREVIEW"}(a||(a={})),function(e){e.VISITOR="visitor",e.VIEW="view",e.EDIT="edit",e.OWNER="owner"}(s||(s={}))},912571:function(e,t,n){var r;n.d(t,{k:function(){return r}}),function(e){e.DATA_CALLBACK="DATA_CALLBACK"}(r||(r={}))},787087:function(e,t,n){n.d(t,{EG:function(){return i},JM:function(){return m},Ov:function(){return o},QM:function(){return r},_E:function(){return h},cm:function(){return d},lv:function(){return f},p3:function(){return g}});var r,o,i,a=n(839461),s=n(495155),c=n(327297),l=n.n(c),u=n(218581);!function(e){e[e.Active=1]="Active",e[e.Expire=2]="Expire",e[e.Disabled=3]="Disabled"}(r||(r={})),function(e){e.BEGIN="begin",e.FIVE_MINUTES_BEFORE="five_minutes_before",e.FIFTEEN_MINUTES_BEFORE="fifteen_minutes_before",e.ONE_HOUR_BEFORE="one_hour_before",e.ONE_DAY_BEFORE="one_day_before"}(o||(o={})),function(e){e.THAT_DAY="that-day",e.ONE_DAY="one-day",e.TWO_DAYS="two-days",e.ONE_WEEK="one-week"}(i||(i={}));var d,p="9:00";new Map([[i.THAT_DAY,(0,u.$t)("当天 {{- clock}}",{clock:p})],[i.ONE_DAY,(0,u.$t)("1 天前 {{- clock}}",{clock:p})],[i.TWO_DAYS,(0,u.$t)("2 天前 {{- clock}}",{clock:p})],[i.ONE_WEEK,(0,u.$t)("1 周前 {{- clock}}",{clock:p})]]),new Map([[o.BEGIN,(0,u.$t)("事件开始时")],[o.FIVE_MINUTES_BEFORE,(0,u.$t)("提前 5 分钟")],[o.FIFTEEN_MINUTES_BEFORE,(0,u.$t)("提前 15 分钟")],[o.ONE_HOUR_BEFORE,(0,u.$t)("提前 1 小时")],[o.ONE_DAY_BEFORE,(0,u.$t)("提前 1 天")]]),function(e){e.NEVER="never",e.EVERY_DAY="every-day",e.WORK_DAY="work-day",e.EVERY_WEEK="every-week",e.EVERY_TWO_WEEKS="every-two-weeks",e.EVERY_MONTH="every-month"}(d||(d={}));var f=new Map([[d.NEVER,(0,u.$t)("不重复")],[d.EVERY_DAY,(0,u.$t)("每天")],[d.WORK_DAY,(0,u.$t)("工作日")],[d.EVERY_WEEK,(0,u.$t)("每周")],[d.EVERY_TWO_WEEKS,(0,u.$t)("每两周")],[d.EVERY_MONTH,(0,u.$t)("每月")]]),h="REFRESH_DATE_REMINDER",m=function(e){function t(t){var n=e.call(this,h)||this;return n.reminderId=t,n}return(0,a.__extends)(t,e),t}(s.Notification),g=function(e,t){var n=l()();return n=(n=(n=n.add(1,"hour")).set("minute",0)).set("second",0),(0,a.__assign)({id:e,timestamp:+n.toDate(),repeat:d.NEVER,reminderUsers:[],remindAll:!0,fullDay:!1,notify:o.BEGIN,status:r.Active},t)}},513516:function(e,t,n){n.d(t,{Di:function(){return i},ox:function(){return r},uO:function(){return o}});var r=2,o=2,i=1.3},276106:function(e,t,n){n.d(t,{m:function(){return v}});var r,o=n(839461),i=n(87363),a=n.n(i),s=n(801134),c=n.n(s),l=n(495155),u=n(750670),d=n(181355),p=n(513516),f=n(887390),h=n(403403),m=n(577050),g=n(252783);!function(e){e.None="doc-link-container-none",e.Hover="doc-link-container-hover",e.Active="doc-link-container-active"}(r||(r={}));var v=function(e){function t(t){var n=e.call(this,t)||this;n.defaultStyle={padding:p.uO,margin:p.ox},n.respondEventTimer=null,n.docLinkRef=a().createRef(),n.onWheel=function(e){if(!(Math.abs(e.deltaY)>Math.abs(e.deltaX))||e.shiftKey){if(!n.respondEventTimer){if(n.docLinkRef.current){var t=(0,m.s)(n.docLinkRef.current,2);t&&(t.style.pointerEvents="none")}n.respondEventTimer=(0,l.debounce)((function(){if(n.docLinkRef.current){var e=(0,m.s)(n.docLinkRef.current,2);e&&(e.style.pointerEvents="all")}n.respondEventTimer=null}),300)}n.respondEventTimer()}},n.setBackgroundToActive=function(){n.setState({backgroundStats:r.Active})},n.setBackgroundToNone=function(){n.setState({backgroundStats:r.None})},n.state={backgroundStats:r.None};var o=t.layoutBox,i=t.docLink,s=t.editor;return n.interactive=(0,f.e)({isDirectOpenLink:function(){var e,t;return!!i.internalJump||!!(null===(t=null===(e=n.client)||void 0===e?void 0:e.isDirectOpenLink)||void 0===t?void 0:t.call(e,s))},showPCToolbar:function(){var e,t;return null===(t=null===(e=n.client)||void 0===e?void 0:e.showPCHyperlinkToolbar)||void 0===t?void 0:t.call(e,o,{onMouseEnterToolbar:n.interactive.onMouseEnterToolbar,onMouseLeaveToolbar:n.interactive.onMouseLeaveToolbar})},hidePCToolbar:function(){var e,t;return null===(t=null===(e=n.client)||void 0===e?void 0:e.hidePCHyperlinkToolbar)||void 0===t?void 0:t.call(e)},showMobileToolbar:function(){var e,t;return null===(t=null===(e=n.client)||void 0===e?void 0:e.showMobileHyperlinkToolbar)||void 0===t?void 0:t.call(e,o)},openLink:function(){var e,t,r,o;return null===(t=null===(e=n.client)||void 0===e?void 0:e.openLink)||void 0===t?void 0:t.call(e,i.fileUrl,i.fileExt,i.fileName,null===(o=null===(r=n.props.fieldInfo)||void 0===r?void 0:r.fieldResult)||void 0===o?void 0:o.range)},canEnterEdit:function(){var e,t;return null===(t=null===(e=n.client)||void 0===e?void 0:e.canEnterEdit)||void 0===t?void 0:t.call(e)},isEditable:function(){var e,t;return null===(t=null===(e=n.client)||void 0===e?void 0:e.isEditable)||void 0===t?void 0:t.call(e)},isWedriveImage:function(){return i.fileExt===g.Au.WEDRIVE_IMAGE||i.fileExt===g.Au.WEDRIVE_VIDEO}}),n}return(0,o.__extends)(t,e),t.prototype.componentWillUnmount=function(){var e,t;null===(t=null===(e=this.client)||void 0===e?void 0:e.hidePCHyperlinkToolbar)||void 0===t||t.call(e)},t.prototype.renderIcon=function(e,t){return"string"==typeof e?a().createElement("img",{src:e,style:t}):a().cloneElement(e,{style:t})},t.prototype.renderInner=function(e,t,n){var r=this.defaultStyle.padding;return a().createElement(i.Fragment,null,a().createElement("span",{className:"".concat(h.Z["doc-link-icon-wrapper"]),style:{left:r}},this.renderIcon(e,t)),a().createElement("span",{className:"text-wrapper",style:{paddingLeft:"".concat(this.iconWidth,"px"),height:"100%",display:"flex",alignItems:"center"}},n))},Object.defineProperty(t.prototype,"fontSizePx",{get:function(){var e,t,n,r=this.props.layoutBox;return(0,u.isLeafContainer)(r)||(0,u.isContainerBoxLite)(r)?0:(0,u.isFieldBox)(r)?(0,l.twipsToPx)((null===(e=r.content)||void 0===e?void 0:e.textStyle.renderFontSize)||0):(0,l.twipsToPx)((null===(n=null===(t=r.content)||void 0===t?void 0:t.property)||void 0===n?void 0:n.renderFontSize)||0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"iconWidth",{get:function(){return this.fontSizePx*p.Di},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"client",{get:function(){if(this.props.bridge){var e=this.props.bridge,t=e.instance,n=e.bridgeKey;return t.get(n)}},enumerable:!1,configurable:!0}),t.prototype.getContainerStyleFromOtherRenderType=function(e){var t={};return e.renderType===u.RenderType.Canvas&&(0,u.isFieldBox)(this.props.layoutBox)?t=this.getCanvasStyle(this.props.layoutBox):e.renderType===u.RenderType.Lite&&(0,u.isFieldBoxLite)(this.props.layoutBox)&&(t=this.getLiteStyle(this.props.layoutBox)),t},t.prototype.getLiteStyle=function(e){var t,n=null===(t=e.content)||void 0===t?void 0:t.property;return n?(0,o.__assign)((0,o.__assign)({},{maxWidth:"100%"}),n?{color:n.color.val}:{}):{}},t.prototype.getCanvasStyle=function(e){return{maxWidth:(0,l.twipsToPx)(e.totalWidth)-this.defaultStyle.margin}},t.prototype.render=function(){var e,t=this.props,n=t.children,r=t.docLink,i=t.editor,s=t.overrideStyle,l=i.docEnv,p=this.defaultStyle,f="".concat(this.fontSizePx,"px"),m={minWidth:f,maxWidth:f,width:f,height:f},g=(0,d.kb)(r),v=this.getContainerStyleFromOtherRenderType(l),_=c()(((e={})["field-code-draggable"]=!0,e["".concat(h.Z["doc-link-container"])]=!0,e["".concat(h.Z[this.state.backgroundStats])]=!0,e["".concat(h.Z["doc-link-container-lite"])]=l.renderType===u.RenderType.Lite,e["".concat(h.Z["doc-link-container-canvas"])]=l.renderType===u.RenderType.Canvas,e));return a().createElement("span",{className:_,style:(0,o.__assign)((0,o.__assign)((0,o.__assign)((0,o.__assign)({padding:"0px ".concat(p.padding,"px"),margin:"0px ".concat(p.margin,"px"),fontSize:"".concat(this.fontSizePx,"px")},v),{height:"100%"}),u.CssUtil.cssPropsToStyle(s)),{display:"flex",alignItems:"center"}),onTouchStart:this.interactive.onTouchStart,onTouchMove:this.interactive.onTouchMove,onTouchEnd:this.interactive.onTouchEnd,onMouseEnter:this.interactive.onMouseEnter,onMouseLeave:this.interactive.onMouseLeave,onClick:this.interactive.onClick,onWheel:this.onWheel,ref:this.docLinkRef},this.renderInner(g,m,n))},t}(i.Component)},240155:function(e,t,n){n.d(t,{$x:function(){return c},_y:function(){return s}});var r=n(839461),o=n(750670),i=(n(495155),n(505586)),a={marginLeft:0,marginRight:0,paddingLeft:0,paddingRight:0};function s(e){return 9*e/8}function c(e,t,n){void 0===t&&(t=a);var s={};return(0,o.isFieldBox)(e)?s=i.q.getCanvasStyle(e,t):(0,o.isFieldBoxLite)(e)&&(s=i.S.getLiteStyle(e,t)),(0,r.__assign)((0,r.__assign)({},s),o.CssUtil.cssPropsToStyle(n))}},887390:function(e,t,n){n.d(t,{e:function(){return s}});var r=n(839461),o=n(750670),i=(n(495155),n(125235)),a=function(e){function t(t){var n=e.call(this,t)||this;return n.options=t,n.onMouseEnter=function(e){var t,r,o,i;(null===(r=(t=n.options).isEditable)||void 0===r?void 0:r.call(t))||(null===(i=(o=n.options).isDirectOpenLink)||void 0===i?void 0:i.call(o))||(setTimeout((function(){var t,r;n.isMouseInside&&(null===(r=(t=n.options).showPCToolbar)||void 0===r||r.call(t,e))}),300),n.isMouseInside=!0)},n.onMouseLeave=function(){var e,t,r,o;(null===(t=(e=n.options).isEditable)||void 0===t?void 0:t.call(e))||(null===(o=null===(r=n.options)||void 0===r?void 0:r.isDirectOpenLink)||void 0===o?void 0:o.call(r))||(window.setTimeout((function(){var e,t,r;n.isMouseInside||(null===(t=(e=n.options).hidePCToolbar)||void 0===t||t.call(e),null===(r=n.subscriber)||void 0===r||r.unsubscribe())}),300),n.isMouseInside=!1)},n.onClick=function(e){var t,r,o,a;!(null===(r=(t=n.options).isEditable)||void 0===r?void 0:r.call(t))||n.options.isDirectOpenLink()||(0,i.$x)(e.nativeEvent)?setTimeout((function(){var e,t;return null===(t=(e=n.options).openLink)||void 0===t?void 0:t.call(e)}),0):null===(a=(o=n.options).showPCToolbar)||void 0===a||a.call(o,e)},n.onTouch=function(e){var t,r,i,a,s,c,l,u;e.stopPropagation(),e.preventDefault(),null===(r=(t=n.options).onTouch)||void 0===r||r.call(t,e),n.touchAction=o.TouchAction.TOUCH,n.options.isDirectOpenLink()||(null===(a=(i=n.options).canEnterEdit)||void 0===a?void 0:a.call(i))?null===(c=(s=n.options).openLink)||void 0===c||c.call(s):!n.options.notAutoShowMobileToolbarOnTouch&&(null===(u=(l=n.options).showMobileToolbar)||void 0===u||u.call(l,e))},n}return(0,r.__extends)(t,e),t}(function(){function e(e){var t=this;this.options=e,this.initPosition={x:0,y:0},this.touchStartTime=0,this.touchEndTime=0,this.touchAction=o.TouchAction.NONE,this.longTouchStartTimeout=void 0,this.hasMove=!1,this.isMouseInside=!1,this.onMouseEnter=function(e){var n,r;(null===(r=(n=t.options).isDirectOpenLink)||void 0===r?void 0:r.call(n))||(setTimeout((function(){var n,r;t.isMouseInside&&(null===(r=(n=t.options).showPCToolbar)||void 0===r||r.call(n,e))}),300),t.isMouseInside=!0)},this.onMouseLeave=function(){var e,n;(null===(n=null===(e=t.options)||void 0===e?void 0:e.isDirectOpenLink)||void 0===n?void 0:n.call(e))||(window.setTimeout((function(){var e,n,r;t.isMouseInside||(null===(n=(e=t.options).hidePCToolbar)||void 0===n||n.call(e),null===(r=t.subscriber)||void 0===r||r.unsubscribe())}),300),t.isMouseInside=!1)},this.onClick=function(e){var n,r;null===(r=(n=t.options).openLink)||void 0===r||r.call(n)},this.onTouchStart=function(){},this.onTouchMove=function(){},this.onTouchEnd=function(){},this.onMouseEnterToolbar=function(){t.isMouseInside=!0},this.onMouseLeaveToolbar=function(){t.isMouseInside=!1,t.onMouseLeave()},this.onLongTouch=function(e){var n,r;e.stopPropagation(),e.preventDefault(),t.touchAction=o.TouchAction.LONG_TOUCH,null===(r=(n=t.options).showMobileToolbar)||void 0===r||r.call(n,e)},this.onTouch=function(e){var n,r,i,a,s,c,l,u;e.stopPropagation(),e.preventDefault(),t.touchAction=o.TouchAction.TOUCH,null===(r=(n=t.options).onTouch)||void 0===r||r.call(n,e),(null===(a=(i=t.options).isWedriveImage)||void 0===a?void 0:a.call(i))?t.options.isDirectOpenLink()||(null===(c=(s=t.options).canEnterEdit)||void 0===c?void 0:c.call(s))?setTimeout((function(){var e,n;return null===(n=(e=t.options).openLink)||void 0===n?void 0:n.call(e)}),0):null===(u=(l=t.options).showMobileToolbar)||void 0===u||u.call(l,e):setTimeout((function(){var e,n;return null===(n=(e=t.options).openLink)||void 0===n?void 0:n.call(e)}),0)}}return e.prototype.touchInterval=function(e,t){return t-e<300},e}());function s(e){return new a(e)}},242901:function(e,t,n){n.d(t,{AQ:function(){return l},Wo:function(){return a},bB:function(){return u},di:function(){return c}});var r=n(839461),o=n(750670),i=n(218581),a={APP_TEXT:(0,i.$t)("card:app"),WEAPP_TEXT:(0,i.$t)("card:weapp")};function s(e){return{icon_url:e.icon_url,thumb_url:e.thumb_url,name:e.name,title:e.title,app_key:e.app_key,username:e.username,layout:e.layout}}function c(e){return"1"===e.type}function l(e){var t=s(e),n=JSON.stringify(t);return"".concat(o.FieldName.WXWORK_APP," ").concat(n)}function u(e,t){void 0===t&&(t=!1);try{var n=e;if(!t){var i=new RegExp("".concat(o.FieldName.WXWORK_APP," (.*)")).exec(e);n=(0,r.__read)(i,2)[1]}return s(JSON.parse(n))}catch(e){return}}},359291:function(e,t,n){n.d(t,{BW:function(){return l},J2:function(){return u},uF:function(){return c}});var r,o=n(839461),i=n(750670),a=n(495155);function s(e){return{schedule_id:e.schedule_id,sharekey:e.sharekey,subject:e.subject,content:e.content,place:e.place,meetting_room:e.meetting_room,create_name:e.create_name,create_id:e.create_id,create_from:e.create_from,create_user_avatar:e.create_user_avatar,is_joined:e.is_joined,start_time:e.start_time,end_time:e.end_time,flag:e.flag,attend_list:e.attend_list||[],attach:e.attach||[],repeat:e.repeat,id:e.id||a.StringUtil.generateRandomId(),layout:e.layout,height:e.height}}function c(e,t){var n=JSON.stringify((0,o.__assign)((0,o.__assign)({},e),{id:t}));return"".concat(i.FieldName.WXWORK_CALENDER," ").concat(n)}function l(e){var t=s(e),n=JSON.stringify(t);return"".concat(i.FieldName.WXWORK_CALENDER," ").concat(n)}function u(e,t){void 0===t&&(t=!1);try{var n=e;if(!t){var r=new RegExp("".concat(i.FieldName.WXWORK_CALENDER," (.*)")).exec(e);n=(0,o.__read)(r,2)[1]}return s(JSON.parse(n))}catch(e){return}}!function(e){e.LOADED_CALLBACK="LOADED_CALLBACK"}(r||(r={}))},979633:function(e,t,n){n.d(t,{Bf:function(){return a},TU:function(){return i}});var r=n(839461),o=n(750670);function i(e){var t=JSON.stringify({id:e.id,chatMessageId:e.chatMessageId,jsonData:{groupName:e.jsonData.groupName,chatList:e.jsonData.chatList.map((function(e){return{username:e.username,iconurl:e.iconurl,timestamp:e.timestamp,textContent:e.textContent}}))},layout:e.layout});return"".concat(o.FieldName.WXWORK_GROUP_CHAT," ").concat(t)}function a(e,t){void 0===t&&(t=!1);try{var n=e;if(!t){var i=new RegExp("".concat(o.FieldName.WXWORK_GROUP_CHAT," (.*)")).exec(e);n=(0,r.__read)(i,2)[1]}var a=JSON.parse(n);return{id:a.id,chatMessageId:a.chatMessageId,jsonData:{groupName:a.jsonData.groupName,chatList:a.jsonData.chatList.map((function(e){return{username:e.username,iconurl:e.iconurl,timestamp:e.timestamp,textContent:e.textContent}}))},layout:a.layout}}catch(e){return}}},646932:function(e,t,n){n.d(t,{$F:function(){return a},yD:function(){return s}});var r,o=n(839461),i=n(750670);function a(e){var t=JSON.stringify({vcode:e.vcode,iconurl:e.iconurl,name:e.name,expire:e.expire,qrcodeurl:e.qrcodeurl,qrshortcodeurl:e.qrshortcodeurl,create_time:e.create_time,joinUrl:e.joinUrl,external:e.external,layout:e.layout});return"".concat(i.FieldName.GROUP_CONTACT_CARD," ").concat(t)}function s(e,t){void 0===t&&(t=!1);try{var n=e;if(!t){var r=new RegExp("".concat(i.FieldName.GROUP_CONTACT_CARD," (.*)")).exec(e);n=(0,o.__read)(r,2)[1]}var a=JSON.parse(n);return{vcode:a.vcode,iconurl:a.iconurl,name:a.name,expire:a.expire,qrcodeurl:a.qrcodeurl,qrshortcodeurl:a.qrshortcodeurl,create_time:a.create_time,joinUrl:a.joinUrl,external:a.external,layout:a.layout}}catch(e){return}}!function(e){e.LOADED_CALLBACK="LOADED_CALLBACK"}(r||(r={}))},323503:function(e,t,n){n.d(t,{Yz:function(){return c},ZW:function(){return l},ph:function(){return u}});var r,o=n(839461),i=n(750670),a=n(495155);function s(e){return{meeting_id:e.meeting_id,submeeting_id:e.submeeting_id,meeting_code:e.meeting_code,access_url:e.access_url,sharekey:e.sharekey,subject:e.subject,content:e.content,is_api_create:e.is_api_create,place:e.place,meeting_room:e.meeting_room,creator_vid:e.creator_vid,creator_name:e.creator_name,creator_source:e.creator_source,start_time:e.start_time,end_time:e.end_time,attend_list:e.attend_list||[],repeat:e.repeat,id:e.id||a.StringUtil.generateRandomId(),layout:e.layout,height:e.height}}function c(e,t){var n=JSON.stringify((0,o.__assign)((0,o.__assign)({},e),{id:t}));return"".concat(i.FieldName.WXWORK_MEETING," ").concat(n)}function l(e){var t=s(e),n=JSON.stringify(t);return"".concat(i.FieldName.WXWORK_MEETING," ").concat(n)}function u(e,t){void 0===t&&(t=!1);try{var n=e;if(!t){var r=new RegExp("".concat(i.FieldName.WXWORK_MEETING," (.*)")).exec(e);n=(0,o.__read)(r,2)[1]}return s(JSON.parse(n))}catch(e){return}}!function(e){e.LOADED_CALLBACK="LOADED_CALLBACK"}(r||(r={}))},356815:function(e,t,n){n.d(t,{TK:function(){return a},bi:function(){return i}});var r=n(839461),o=n(750670);function i(e){var t=JSON.stringify({iconurl:e.iconurl,name:e.name,position:e.position,gender:e.gender,profile_code:e.profile_code,qrcodeurl:e.qrcodeurl,type:e.type,corp_name:e.corp_name,layout:e.layout});return"".concat(o.FieldName.MEMBER_CONTACT_CARD," ").concat(t)}function a(e,t){void 0===t&&(t=!1);try{var n=e;if(!t){var i=new RegExp("".concat(o.FieldName.MEMBER_CONTACT_CARD," (.*)")).exec(e);n=(0,r.__read)(i,2)[1]}var a=JSON.parse(n);return{iconurl:a.iconurl,name:a.name,position:a.position,gender:a.gender,profile_code:a.profile_code,qrcodeurl:a.qrcodeurl,type:a.type,corp_name:a.corp_name,layout:a.layout}}catch(e){return}}},243562:function(e,t,n){n.d(t,{Z:function(){return S}});var r,o,i,a,s=n(839461),c=n(87363),l=n.n(c),u=n(826973),d=n(45972),p=n(344695),f=n(750670),h=n(282790),m=n(83034),g={Inline:"tdocs-Inline",inline:"tdocs-Inline",Card:"tdocs-Card",card:"tdocs-Card",align_left:"tdocs-align_left",alignLeft:"tdocs-align_left",align_center:"tdocs-align_center",alignCenter:"tdocs-align_center",align_right:"tdocs-align_right",alignRight:"tdocs-align_right"},v=n(218581),_="layout",y="alignment",b=((r={})[f.FieldDisplayLayoutTypeChar.Inline]=(0,v.$t)("文字链"),r[f.FieldDisplayLayoutTypeChar.Card]=(0,v.$t)("card:card"),r),E=((o={})[f.STJcWml.left]=(0,v.$t)("左对齐"),o[f.STJcWml.center]=(0,v.$t)("居中对齐"),o[f.STJcWml.right]=(0,v.$t)("右对齐"),o),C=((i={})[f.STJcWml.right]="align_right",i[f.STJcWml.center]="align_center",i[f.STJcWml.left]="align_left",i),w=function(e){function t(t){var n=e.call(this,t)||this;return n.closeTimer=0,n.hide=function(){n.setState({show:!1})},n.scheduleHide=function(){n.cancelScheduleHide(),n.closeTimer=window.setTimeout(n.hide,300)},n.cancelScheduleHide=function(){n.closeTimer&&(window.clearTimeout(n.closeTimer),n.closeTimer=0)},n.handleClickItem=function(e,t,r,o){var i=n.props,a=i.onChangeLayout,s=i.onChangeAlignment,c=n.state,l=c.selectedLayout,u=c.selectedAlignment,d=o.id;t===_&&d!==l?(n.setState({selectedLayout:d,buttons:n.buildButtonConfig(d,n.state.selectedAlignment)}),n.handleMouseLeave(),a(d)):t===y&&d!==u&&(n.setState({selectedAlignment:d,buttons:n.buildButtonConfig(n.state.selectedLayout,d)}),n.handleMouseLeave(),s(d))},n.handleMouseLeave=function(){var e;null===(e=n.ref.current)||void 0===e||e.hideDropdown(),n.hide()},n.handleMouseEnter=function(){n.cancelScheduleHide()},n.state={show:!1,posX:0,posY:0,selectedLayout:f.FieldDisplayLayoutTypeChar.Card,selectedAlignment:f.STJcWml.left,buttons:n.buildButtonConfig(f.FieldDisplayLayoutTypeChar.Card,f.STJcWml.left)},n.ref=(0,c.createRef)(),n}return(0,s.__extends)(t,e),t.prototype.show=function(e){var t=e.posX,n=void 0===t?0:t,r=e.posY,o=void 0===r?0:r,i=e.layout,a=void 0===i?f.FieldDisplayLayoutTypeChar.Card:i,s=e.align,c=void 0===s?f.STJcWml.left:s;this.cancelScheduleHide();var l=c;[f.STJcWml.left,f.STJcWml.center,f.STJcWml.right].includes(c)||(l=f.STJcWml.left),this.setState({posX:n,posY:o,show:!0,selectedLayout:a,selectedAlignment:l,buttons:this.buildButtonConfig(a,l)})},t.prototype.buildButtonConfig=function(e,t){return[{id:_,type:h.F.DropdownButton,config:{icon:g[e],items:[f.FieldDisplayLayoutTypeChar.Inline,f.FieldDisplayLayoutTypeChar.Card].map((function(t){return{id:t,icon:g[t],name:b[t],isSelected:t===e}}))}},{id:y,type:h.F.DropdownButton,config:{icon:g[C[t]||C[f.STJcWml.left]],items:[f.STJcWml.left,f.STJcWml.center,f.STJcWml.right].map((function(e){return{id:e,name:E[e],icon:g["align_".concat(e)],isSelected:t===e}}))}}]},t.prototype.componentWillUnmount=function(){this.cancelScheduleHide()},t.prototype.render=function(){var e=this.state,t=e.show,n=e.posX,r=e.posY,o=e.buttons;return l().createElement(m.n,{ref:this.ref,visible:t,buttons:o,posX:n,posY:r,onClickCallback:function(){},onSelectedItemCallback:this.handleClickItem,onMouseLeave:this.handleMouseLeave,onMouseEnter:this.handleMouseEnter})},t}(l().Component),T=w;!function(e){e[e.Calendar=0]="Calendar",e[e.Meeting=1]="Meeting",e[e.GroupChat=2]="GroupChat",e[e.GroupContact=3]="GroupContact",e[e.MemberContact=4]="MemberContact",e[e.MiniProgram=5]="MiniProgram"}(a||(a={}));var A=function(){function e(e,t){var n=this;this.contextService=e,this.widgetService=t,this.toggleToolbar=function(e){return(0,s.__awaiter)(n,void 0,void 0,(function(){var t;return(0,s.__generator)(this,(function(n){return e.show?this.scheduleShow(e):(this.cancelShow(),null===(t=this.toolbar)||void 0===t||t.scheduleHide()),[2]}))}))},this.quitOnMobileConetxtMenuHide=function(){var e=n.getEditor();e&&e.on(f.RenderNotificationTypes.SELECTION_CHANGE,(function(e){null!=e.option&&null!=e.option.mobileContextMenu&&e.option.mobileContextMenu!==f.MobileContextMenuType.Hide||n.mobileContextMenuShow&&(n.mobileContextMenuShow=!1)}),n)},this.handleChangeLayout=function(e,t){t&&n.onChangeLayout&&n.onChangeLayout(e,t)},this.handleChangeAlignment=function(e,t){n.onChangeAlignment&&n.onChangeAlignment(e,t)},this.defaultChangeAlignment=function(e){var t=n.getEditor();if(t&&n.editingFieldIndex){var r=t.getRangeFromIndex(n.editingFieldIndex.first,n.editingFieldIndex.last);r.isValid()&&(t.setRangeTo(new f.GCPRange(r.begin())),t.service.getSelection().getParagraphFormat().setParagraphAlignment(e))}},this.mobileContextMenuShow=!1,this.mobileContextMenuHideBinded=!1}var t,n;return e.prototype.$onReset=function(){var e;this.toolbar=void 0,this.editingFieldIndex=void 0,this.displayTimer&&clearTimeout(this.displayTimer),this.onChangeLayout=void 0,this.onChangeAlignment=void 0,this.layout=void 0,this.type=void 0,this.mobileContextMenuShow=!1,this.mobileContextMenuHideBinded=!1,null===(e=this.getEditor())||void 0===e||e.removeListener(f.RenderNotificationTypes.SELECTION_CHANGE,this)},e.prototype.shouldHideMobileContextMenu=function(){return!this.mobileContextMenuShow},e.prototype.getCardType=function(){return this.type},e.prototype.setCardType=function(e){this.type=e},e.prototype.getFieldIndex=function(){return this.editingFieldIndex},e.prototype.setFieldIndex=function(e){this.editingFieldIndex=e},e.prototype.getLayout=function(){return this.layout||f.FieldDisplayLayoutTypeChar.Card},e.prototype.showMobileContextMenu=function(e){var t=this,n=e.type,r=e.fieldIndex,o=e.layout;this.type=n,this.editingFieldIndex=r,this.layout=o,this.mobileContextMenuShow=!0;var i=this.getEditor();if(i){var a=i.getRangeFromIndex(this.editingFieldIndex.first,this.editingFieldIndex.last),s=i.getViewRangeFromGcpRange(a);i.service.getSelection().setRange(a.begin(),a.end()),setTimeout((function(){s&&(i.fire(new f.ContextMenuMobileNotification(s)),t.mobileContextMenuHideBinded||(t.quitOnMobileConetxtMenuHide(),t.mobileContextMenuHideBinded=!0))}),50)}},e.prototype.scheduleShow=function(e){var t=this;this.cancelShow(),this.displayTimer=window.setTimeout((function(){t.show(e)}),500)},e.prototype.cancelShow=function(){this.displayTimer&&(window.clearTimeout(this.displayTimer),this.displayTimer=0)},e.prototype.show=function(e){var t=this,n=e.onChangeLayout,r=e.onChangeAlignment,o=void 0===r?this.defaultChangeAlignment:r,i=e.fieldIndex,a=(0,s.__rest)(e,["onChangeLayout","onChangeAlignment","fieldIndex"]);a.show&&(this.editingFieldIndex=i,this.onChangeLayout=n,this.onChangeAlignment=o),null==this.toolbar?(this.widgetService.embed({name:"wxwork-card-toolbar",component:l().createElement(T,{ref:function(e){e&&(t.toolbar=e)},onChangeLayout:function(e){return t.handleChangeLayout(e,t.editingFieldIndex)},onChangeAlignment:function(e){return t.handleChangeAlignment(e,t.editingFieldIndex)}})}),window.setTimeout((function(){var e;null===(e=t.toolbar)||void 0===e||e.show(a)}),10)):this.toolbar.show(a)},e.prototype.getEditor=function(){if(this.contextService.context.editor instanceof f.MeloEditor)return this.contextService.context.editor},e=(0,s.__decorate)([(0,u.t)(),(0,s.__metadata)("design:paramtypes",["function"==typeof(t=void 0!==d.O&&d.O)?t:Object,"function"==typeof(n=void 0!==p.i&&p.i)?n:Object])],e)}(),S=A},378898:function(e,t,n){n.d(t,{D:function(){return i}});var r=n(259356),o=n(429749);function i(e,t){return void 0===t&&(t=!0),function(n,i,a){if(void 0===a){var s=e.startsWith("common.")?e:"custom.".concat(e);return{get:function(){return r.Am.get(o.ax).get(s,t)}}}return a}}},6297:function(e,t,n){n.d(t,{r:function(){return p}});var r=n(839461),o=n(826973),i=n(947229),a=n(814808),s=n(869263),c=n.n(s),l=n(218581),u=n(243607),d=n(97303),p=function(){function e(e,t){var n=this;this.eventEmitter=e,this.extensionService=t,this.authExpTipsShowed=!1,this.login=function(){return(0,d.loginOnce)({extensionService:n.extensionService.extensionService})}}var t,n;return e.prototype.init=function(){var e=this;this.$sub=this.eventEmitter.listen("$requestLogin",this.login),c().setCallback((function(t){1e4===(null==t?void 0:t.code)?e.accountSwitched():10001===(null==t?void 0:t.code)&&e.onLoginExpire()}))},e.prototype.$onEditorClose=function(){var e;null===(e=this.$sub)||void 0===e||e.unsubscribe()},e.prototype.onLoginExpire=function(){this.authExpTipsShowed||(a.default.show({message:(0,l.$t)("登录过期"),action:(0,l.$t)("重新登录"),autoClose:!1,onClickAction:this.login}),this.authExpTipsShowed=!0)},e.prototype.accountSwitched=function(){a.default.show({message:(0,l.$t)("帐号信息变化"),action:(0,l.$t)("刷新"),type:"info",autoClose:!1,id:"checkIfAccountSwitched-1",closable:!0,onClickAction:function(){window.multiAccountUtil.reload()}})},e=(0,r.__decorate)([(0,o.t)(),(0,r.__metadata)("design:paramtypes",["function"==typeof(t=void 0!==i.v&&i.v)?t:Object,"function"==typeof(n=void 0!==u.$&&u.$)?n:Object])],e)}()},74225:function(e,t,n){n.d(t,{Ci:function(){return i},JS:function(){return r},Ku:function(){return c},N1:function(){return o},dY:function(){return a},ld:function(){return s}});var r,o,i=Symbol.for("service:multipleImagesExtension");!function(e){e.MOBILE_PIC_TOOLBAR="mobile_pictoolbar",e.PC_PIC_PREVIEW="pc_picpreview",e.PC_TOOLBAR="pc_toolbar",e.PC_PIC_TOOLBAR="pc_pictoolbar",e.PC_PIC_RIGHT_MENU="pc_picrightmenu",e.PC_DOC_TOAST="pc_doctoast"}(r||(r={})),function(e){e.RENAME="rename",e.CROP="crop",e.WATERMARK="watermark",e.COMPRESS="compress"}(o||(o={}));var a=2097152,s="2M",c=5184e3},94277:function(e,t,n){n.r(t),n.d(t,{AbtestExpId:function(){return r},ControlGroupId:function(){return o},ExperimentalGroupId:function(){return i},ITabService:function(){return c}});var r,o,i,a=n(839461),s=n(259356);!function(e){e.innerImageOCR="EXP_20211117_Word_ocr"}(r||(r={})),function(e){e[e.innerImageOCR=3138342]="innerImageOCR"}(o||(o={})),function(e){e[e.innerImageOCR=3138343]="innerImageOCR"}(i||(i={}));var c=Symbol.for("service:tab");s.Ln.merge(c,{useFactory:function(){return(0,a.__awaiter)(void 0,void 0,void 0,(function(){return(0,a.__generator)(this,(function(e){switch(e.label){case 0:return[4,n.e(7173).then(n.bind(n,767173))];case 1:return[2,e.sent().TabService]}}))}))}})},64102:function(e,t,n){n.d(t,{y:function(){return g}});var r=n(839461),o=n(750670),i=n(223336),a=n.n(i),s=n(136454),c=n(259356),l=n(45972),u=n(947229),d=n(495155),p=n(243607),f=n(508436),h=n(411812),m=n(339144),g=function(){function e(){}var t,n,i;return e.setTitle=function(e,t,n,i){return(0,r.__awaiter)(this,void 0,void 0,(function(){var s,c;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return f.default.isPC?[4,this.extensionService.getExtension(m.xT)]:[3,3];case 1:return[4,r.sent().changeTitle({title:e,wait:h.network.isOnline,autoChange:t})];case 2:return s=r.sent(),h.network.isOnline||(s={retcode:0,cgicode:0,doc_info:{title:e}}),null==i||i(s),[2,s];case 3:return c=n.domainId,e=e.replace(/[\r\n]/gi,""),[2,new Promise((function(r,s){a().ajax({url:"/cgi-bin/online_docs/doc_changetitle",data:{domain_id:c,pad_id:n.padId,title:e,xsrf:(0,o.getXsrf)(),version:2,auto_change:t?1:0},success:function(o){o&&0===o.retcode?(t||(n.isUserChangeTitle=1),n.padTitle=e,n.title=e,r(o)):o&&10020===o.retcode?(n.isUserChangeTitle=1,s("changeTitle error: ERROR_AUTO_CHANGE_TITLE_DENIED")):o&&12e3===o.retcode?s("changeTitle error: ERROR_TITLE_BEAT_BY_SEC"):s("changeTitle error: ".concat(o.retcode)),i&&i(o)},error:function(){s()}})}))]}}))}))},e.updateTitleReversion=function(e){var t=(0,s.Yi)();d.LocalStorageUtil.setItem("offline_title_reversion".concat(t.padId),e.toString())},e.getTitleReversionFromStore=function(){var e=(0,s.Yi)(),t=d.LocalStorageUtil.getItem("offline_title_reversion".concat(e.padId));return t?parseInt(t,10):0},e.docHumtrans=function(e){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t=this;return(0,r.__generator)(this,(function(n){return[2,new Promise((function(n,r){a().ajax({url:"/cgi-bin/online_docs/doc_humtrans",type:"POST",data:{domain_id:e.domainId,pad_id:e.padId,xsrf:(0,o.getXsrf)()},xhrFields:{withCredentials:!0},success:function(e){var r;0===e.cgicode&&0===e.retcode&&((0,s.Yi)().docStatus=0),null===(r=window.SLR)||void 0===r||r.dispatch("DOC_HUMTRANS_DONE"),t.eventEmitter.emit("$humtransDone"),n(e)},error:function(e){r(e)}})}))]}))}))},e.MAX_TITLE_LENGTH=128,(0,r.__decorate)([(0,c.tB)(),(0,r.__metadata)("design:type","function"==typeof(t=void 0!==l.O&&l.O)?t:Object)],e,"contextService",void 0),(0,r.__decorate)([(0,c.tB)(),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==u.v&&u.v)?n:Object)],e,"eventEmitter",void 0),(0,r.__decorate)([(0,c.tB)(),(0,r.__metadata)("design:type","function"==typeof(i=void 0!==p.$&&p.$)?i:Object)],e,"extensionService",void 0),e}()},913292:function(e,t,n){n.d(t,{Do:function(){return l}});var r=n(839461),o=n(495155),i=n(641415),a=n(826973),s=n(991287),c="wx9612c6e5a5e43176",l=function(){function e(){var e=this;this.jssdk=s.X.getInstance().getConfig("custom.library.TENCENT_DOCS_LIBRARY__jweixin_1_6_0"),this.isEnt=!1,this.apiList=["chooseImage","getLocalImgData","getClipboardData","setClipboardData"],this.setupClient=function(){return e.loadJSSDK().then((function(){return e.getSignature()})).then((function(t){var n=t.noncestr,r=t.signature,o=t.timestamp;return new Promise((function(t,i){window.wx.config({appId:"wx46dfe750eef96da7",nonceStr:n,timestamp:o,signature:r,jsApiList:e.apiList}),window.wx.ready((function(){t()})),window.wx.error((function(e){i("wx set jsApiList fail, error msg: ".concat(e))}))}))}))},this.setupEnv=function(){return e.loadJSSDK().then((function(){return e.xhrGetWxConfig()})).then((function(t){var n=t.noncestr,r=t.signature,o=t.timestamp;return new Promise((function(t,i){window.wx.config({appId:c,nonceStr:n,timestamp:o,signature:r,jsApiList:e.apiList}),window.wx.ready((function(){t()})),window.wx.error((function(e){i("wx set jsApiList fail, error msg: ".concat(e))}))}))}))},this.loadJSSDK=function(){return new Promise((function(t,n){if(e.hasLoadedSDK())return t();document.head.appendChild(Object.assign(document.createElement("script"),{src:e.jssdk,crossOrigin:"anonymous",onload:function(){o.Logger.log("加载微信 sdk 接口 sucess"),t()},onerror:function(e){o.Logger.log("加载微信 sdk 接口 error",e),n()}}))}))},this.hasLoadedSDK=function(){if(void 0!==window.wx)return!0},this.getSignature=function(){return new Promise((function(t,n){(0,i.Z)({method:"get",url:"/v2/util/wechat/signature",params:{withCredentials:!0,url:e.getPageOriginHref()}}).then((function(e){var r=e.data,o=r.cgicode,i=r.retcode,a=r.msg;0===o&&0===i||n("wx get signature error, retcode: ".concat(i,", error msg: ").concat(a)),t(r)}))}))}}return e.prototype.setup=function(){(o.PlatformUtil.isWXFamily()||o.PlatformUtil.isWeWork())&&(this.isEnt?this.setupEnv():this.setupClient())},e.prototype.xhrGetWxConfig=function(){var e=new FormData;return e.append("url",window.location.href.split("#")[0]),e.append("appid",c),i.Z.post("/webdisk/jsapi",e)},e.prototype.getPageOriginHref=function(){try{return localStorage.getItem("tdocs-page-origin-href")||window.location.href}catch(e){return window.location.href}},e=(0,r.__decorate)([(0,a.t)()],e)}()},527954:function(e,t,n){n.d(t,{l3:function(){return r},r2:function(){return f}});var r,o=n(839461),i=n(495155),a=n(826973),s=n(750670),c=n(814808),l=n(317999),u=n(218581),d=n(445955),p=n(870372);!function(e){e[e.WholeDay=1]="WholeDay",e[e.Deleted=4096]="Deleted",e[e.CanJoin=524288]="CanJoin",e[e.Repeat=8]="Repeat"}(r||(r={}));var f=Symbol.for("service:IWxworkGroupchatService"),h=function(e){c.default.show({message:e,type:"info",autoClose:!0,duration:5e3})},m=function(e,t,n,r){if(0!==e){var o=r.isCalender,a=void 0!==o&&o,s=r.isMeeting;void 0!==s&&s&&function(e,t,n){switch(e){case 2:break;case 1:case 4:case 14007:h((0,u.$t)("操作失败"));break;case 6:h((0,u.$t)("无法使用，管理员已停用会议功能"));break;case 9:h((0,u.$t)("会议已被发起人取消"));break;case-66000036:h((0,u.$t)("帐号异常，会议功能暂时无法使用"));break;case-66000017:h((0,u.$t)("当前日程参与人数已达上限"));break;case-66000021:h((0,u.$t)("该日程已过期"));break;case-66000019:h((0,u.$t)("该日程已被组织人删除"));break;case-66000018:h((0,u.$t)("日程组织者已设置不允许加入"));break;case-66000022:case 139491e3:h((0,u.$t)("无法加入，会议参与人数已达上限"));break;case 10100005:h((0,u.$t)("会议进行中，无法修改会议"));break;case-66000024:h((0,u.$t)("操作失败，请稍后再试"));break;case-66000027:h((0,u.$t)("保存失败"));break;case 139491002:h((0,u.$t)("加入该会议需输入密码，请升级客户端版本"));break;case 139491001:h((0,u.$t)("密码错误"));break;case 139491003:h((0,u.$t)("该会议为网络研讨会，暂不支持添加成员"));break;case-66000039:h((0,u.$t)("会议进行中，请进入会议后邀请"));break;default:h(t)}}(e,t),a&&function(e,t,n){if(i.PlatformUtil.compareVersion((0,d.bW)(),"4.1.2")<0&&0!==e)h(t);else switch(e){case 2:break;case 6:h((0,u.$t)("无法使用，管理员已停用日程功能"));break;case 14007:h((0,u.$t)("操作失败"));break;default:h(t)}}(e,t)}},g=function(e,t,n,r){if(void 0===n&&(n=!0),void 0===r&&(r={}),window.tdocs[e])return window.tdocs[e](t).then((function(e){var t;if(0!==(null!==(t=e.retcode)&&void 0!==t?t:e.err_code))throw e;return e})).catch((function(e){var t,o=null!==(t=e.retcode)&&void 0!==t?t:e.err_code,i=e.errMsg||"操作失败，请重试[".concat(o,"]");throw n&&h(i),m(o,i,0,r),e}));if(n){if(l.A.isTencentMeetingInWework())return void h((0,u.$t)("演示中暂不支持此功能"));i.PlatformUtil.isWeWork()?h("请升级企业微信版本以使用此功能"):h("请在企业微信中使用此功能")}return Promise.reject()};function v(e){return function(t,n,r){var i=r.value;r.value=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(0,o.__awaiter)(this,void 0,void 0,(function(){var r;return(0,o.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,i.call.apply(i,(0,o.__spreadArray)([this],(0,o.__read)(t),!1))];case 1:return[2,a.sent()];case 2:return r=a.sent(),s.ReportHelper.weiMonitorCube((0,o.__assign)((0,o.__assign)({},e),{module:s.ICubeModule.Feature,msg:null==r?void 0:r.message,code:null==r?void 0:r.retcode,action:"[jsapi]".concat(n),ver1:null==r?void 0:r.stack})),[3,3];case 3:return[2]}}))}))}}}!function(){function e(){}var t,n,r,s,c,l,u,d,m,_,y,b,E,C,w,T,A,S,I,R,M,O;e.prototype.$onReset=function(){},e.prototype.isEnabled=function(){var e;return i.PlatformUtil.isWeWork()&&(null===(e=window.tdocs)||void 0===e?void 0:e.insertWxworkGroupChat)},e.prototype.insertWxworkGroupChat=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,g("insertWxworkGroupChat",e)]}))}))},e.prototype.isInWxworkGroupChat=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,g("isInWxworkGroupChat",e,!1)]}))}))},e.prototype.joinWxworkGroupChat=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,g("joinWxworkGroupChat",e)]}))}))},e.prototype.enterWxworkGroupChat=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,g("enterWxworkGroupChat",e)]}))}))},e.prototype.createWxworkNameCardSelf=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,g("createWxworkNameCardSelf",e)]}))}))},e.prototype.enterWxworkNameCard=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,g("enterWxworkNameCard",e)]}))}))},e.prototype.canChatWithWxworkNameCard=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,g("canChatWithWxworkNameCard",e)]}))}))},e.prototype.createWxworkCalender=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,g("createWxworkCalender",(0,o.__assign)((0,o.__assign)({},e),{type:"0"}),!1,{isCalender:!0})]}))}))},e.prototype.selectWxworkCalenderList=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,g("selectWxworkCalenderList",(0,o.__assign)({},e),!1,{isCalender:!0})]}))}))},e.prototype.viewDetailWxworkCalender=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,g("viewDetailWxworkCalender",e,!1,{isCalender:!0})]}))}))},e.prototype.queryWxworkCalenderInfo=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,g("queryWxworkCalenderInfo",e,!1)]}))}))},e.prototype.joinWxworkCalender=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,g("joinWxworkCalender",e,!1,{isCalender:!0})]}))}))},e.prototype.createWxworkMeeting=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,g("createWxworkCalender",(0,o.__assign)((0,o.__assign)({},e),{type:"1"}),!1,{isMeeting:!0})]}))}))},e.prototype.selectWxworkMeetingList=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,g("selectWxworkMeetingList",(0,o.__assign)({},e),!1,{isMeeting:!0})]}))}))},e.prototype.viewDetailWxworkMeeting=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,g("viewDetailWxworkMeeting",{docid:e.docid,meeting_id:e.meeting_id,submeeting_id:e.submeeting_id,meeting_code:e.meeting_code,sharekey:e.sharekey,access_url:e.access_url,creator_source:e.creator_source,x:e.x,y:e.y},!1,{isMeeting:!0})]}))}))},e.prototype.enterWxworkMeeting=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,g("enterWxworkMeeting",{docid:e.docid,meeting_id:e.meeting_id,submeeting_id:e.submeeting_id,meeting_code:e.meeting_code,sharekey:e.sharekey,access_url:e.access_url,creator_source:e.creator_source,x:e.x,y:e.y},!1,{isMeeting:!0})]}))}))},e.prototype.joinWxworkMeeting=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,g("joinWxworkMeeting",{docid:e.docid,meeting_id:e.meeting_id,submeeting_id:e.submeeting_id,meeting_code:e.meeting_code,sharekey:e.sharekey,access_url:e.access_url,creator_source:e.creator_source,x:e.x,y:e.y},!1,{isMeeting:!0})]}))}))},e.prototype.openMeetingRecord=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,g("openMeetingRecord",{url:e.url},!1,{isMeeting:!0})]}))}))},e.prototype.createTransferedChatMessageInfo=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,g("createTransferedChatMessageInfo",e,!1)]}))}))},e.prototype.openChatMessageDetail=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,g("openChatMessageDetail",e)]}))}))},e.prototype.insertApp=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return[2,g("insertApp",e)]}))}))},e.prototype.openMiniProgram=function(e){return(0,o.__awaiter)(this,void 0,Promise,(function(){return(0,o.__generator)(this,(function(t){return i.PlatformUtil.isMac()?(h("Mac暂不支持打开小程序"),[2,{retcode:0,errMsg:""}]):[2,g("openMiniProgram",e,!1)]}))}))},(0,o.__decorate)([v({name:p.C.WxworkGroupContactCard}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(t="undefined"!=typeof Promise&&Promise)?t:Object)],e.prototype,"insertWxworkGroupChat",null),(0,o.__decorate)([v({name:p.C.WxworkGroupContactCard}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(n="undefined"!=typeof Promise&&Promise)?n:Object)],e.prototype,"isInWxworkGroupChat",null),(0,o.__decorate)([v({name:p.C.WxworkGroupContactCard}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(r="undefined"!=typeof Promise&&Promise)?r:Object)],e.prototype,"joinWxworkGroupChat",null),(0,o.__decorate)([v({name:p.C.WxworkGroupContactCard}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(s="undefined"!=typeof Promise&&Promise)?s:Object)],e.prototype,"enterWxworkGroupChat",null),(0,o.__decorate)([v({name:p.C.WxworkMemberContactCard}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(c="undefined"!=typeof Promise&&Promise)?c:Object)],e.prototype,"createWxworkNameCardSelf",null),(0,o.__decorate)([v({name:p.C.WxworkMemberContactCard}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(l="undefined"!=typeof Promise&&Promise)?l:Object)],e.prototype,"enterWxworkNameCard",null),(0,o.__decorate)([v({name:p.C.WxworkMemberContactCard}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(u="undefined"!=typeof Promise&&Promise)?u:Object)],e.prototype,"canChatWithWxworkNameCard",null),(0,o.__decorate)([v({name:p.C.WxworkCalender}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(d="undefined"!=typeof Promise&&Promise)?d:Object)],e.prototype,"createWxworkCalender",null),(0,o.__decorate)([v({name:p.C.WxworkCalender}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(m="undefined"!=typeof Promise&&Promise)?m:Object)],e.prototype,"selectWxworkCalenderList",null),(0,o.__decorate)([v({name:p.C.WxworkCalender}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(_="undefined"!=typeof Promise&&Promise)?_:Object)],e.prototype,"viewDetailWxworkCalender",null),(0,o.__decorate)([v({name:p.C.WxworkCalender}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(y="undefined"!=typeof Promise&&Promise)?y:Object)],e.prototype,"queryWxworkCalenderInfo",null),(0,o.__decorate)([v({name:p.C.WxworkCalender}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(b="undefined"!=typeof Promise&&Promise)?b:Object)],e.prototype,"joinWxworkCalender",null),(0,o.__decorate)([v({name:p.C.WxworkMeeting}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(E="undefined"!=typeof Promise&&Promise)?E:Object)],e.prototype,"createWxworkMeeting",null),(0,o.__decorate)([v({name:p.C.WxworkMeeting}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(C="undefined"!=typeof Promise&&Promise)?C:Object)],e.prototype,"selectWxworkMeetingList",null),(0,o.__decorate)([v({name:p.C.WxworkMeeting}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(w="undefined"!=typeof Promise&&Promise)?w:Object)],e.prototype,"viewDetailWxworkMeeting",null),(0,o.__decorate)([v({name:p.C.WxworkMeeting}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(T="undefined"!=typeof Promise&&Promise)?T:Object)],e.prototype,"enterWxworkMeeting",null),(0,o.__decorate)([v({name:p.C.WxworkMeeting}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(A="undefined"!=typeof Promise&&Promise)?A:Object)],e.prototype,"joinWxworkMeeting",null),(0,o.__decorate)([v({name:p.C.WxworkMeeting}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(S="undefined"!=typeof Promise&&Promise)?S:Object)],e.prototype,"openMeetingRecord",null),(0,o.__decorate)([v({name:p.C.WxworkGroupChat}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(I="undefined"!=typeof Promise&&Promise)?I:Object)],e.prototype,"createTransferedChatMessageInfo",null),(0,o.__decorate)([v({name:p.C.WxworkGroupChat}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(R="undefined"!=typeof Promise&&Promise)?R:Object)],e.prototype,"openChatMessageDetail",null),(0,o.__decorate)([v({name:p.C.WxworkApp}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(M="undefined"!=typeof Promise&&Promise)?M:Object)],e.prototype,"insertApp",null),(0,o.__decorate)([v({name:p.C.WxworkApp}),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype","function"==typeof(O="undefined"!=typeof Promise&&Promise)?O:Object)],e.prototype,"openMiniProgram",null),e=(0,o.__decorate)([(0,a.t)({provide:f})],e)}()},813200:function(e,t,n){n(225525);var r=n(732722);window.multiAccountUtil={getMultiUrl:r.FJ,reload:function(e){var t=(0,r.FJ)(window.location.href);e?window.location.assign(t):window.location.href=t}}},508303:function(e,t,n){var r=n(839461),o=(n(813200),n(415220)),i=n(429020),a=function(){function e(){}return e.prototype.tdwReport=function(e,t){(0,i.tdw)(e,t)},e.prototype.tdwReportSingle=function(e){(0,i.tdwSingle)(e)},e.prototype.setPadType=function(e){window.clientVars&&(window.clientVars.padType=e,(0,i.resetDefaultTdwData)())},e}();window.ClientVarsPromise&&window.ClientVarsPromise.then((function(){(0,i.resetDefaultTdwData)()}));var s,c=n(136454),l=function(){function e(){}return e.prototype.zzsStatus=function(e){var t,n;(0,i.zzsStatus)({attrid:e.attributeId,status:e.status,errmsg:e.errorMessage,dimensions:(0,r.__spreadArray)([this.getDocVersion(),String(null!==(t=e.errorCode)&&void 0!==t?t:0)],(0,r.__read)(null!==(n=e.otherDimensions)&&void 0!==n?n:[]),!1)})},e.prototype.zzsValue=function(e,t){var n=window.location,r=n.origin,o=n.pathname;(0,i.zzsValue)({attrid:e,value:t,dimensions:[this.getDocVersion(),(0,c.Yi)().padId,"".concat(r).concat(o)]})},e.prototype.getDocVersion=function(){var e,t;return null===(t=null===(e=(0,c.Yi)().collab_client_vars)||void 0===e?void 0:e.dver)||void 0===t?void 0:t.substr(0,3)},e}(),u=function(){function e(){}return e.prototype.idkeyReport=function(e,t,n){(0,i.idkey)(t,e,n)},e}(),d=n(750670),p=n(495155),f=((s={})[d.OSSPlatformType.Default]=function(){return p.PlatformUtil.isMac()?"mac":"win"},s[d.OSSPlatformType.Wedoc]=function(){return p.PlatformUtil.isWeWork()?/isConversationEmbedded=1/.test(window.location.search)?"timeline":"client":p.PlatformUtil.isWXFamily()?"wechat":"browser"},s),h=function(){function e(){}return e.prototype.ossReport=function(e){i.KVR.oss(e)},e.prototype.getPlatform=function(e){var t;return void 0===e&&(e=d.OSSPlatformType.Default),null===(t=f[e])||void 0===t?void 0:t.call(f)},e}(),m=function(){function e(){}return e.prototype.aegisSetConfig=function(e){var t;null===(t=window.aegis)||void 0===t||t.setConfig(e)},e.prototype.aegisReportEvent=function(e){var t;null===(t=window.aegis)||void 0===t||t.reportEvent(e)},e.prototype.reportError=function(e){var t;null===(t=window.aegis)||void 0===t||t.error(e)},e.prototype.aegisReportTime=function(e,t){var n;null===(n=window.aegis)||void 0===n||n.reportTime(e,t)},e.prototype.aegisTime=function(e){var t;null===(t=window.aegis)||void 0===t||t.time(e)},e.prototype.aegisTimeEnd=function(e){var t;null===(t=window.aegis)||void 0===t||t.timeEnd(e)},e}(),g=new Map([["playBackgroundMusic",d.MonitorName.IGNORE_JS_ERROR_PLAY_BACKGROUND_MUSIC],["setKeyboardHeight is not defined",d.MonitorName.IGNORE_JS_ERROR_SET_KEYBOARD_HEIGHT],["Cannot read property 'test' of undefined",d.MonitorName.IGNORE_JS_ERROR_TEST],["WeixinJSBridge",d.MonitorName.IGNORE_JS_ERROR_WEIXIN_JSBRIDGE],["__wx._ready is not a function",d.MonitorName.IGNORE_JS_ERROR_WEIXIN_JSBRIDGE],["captured exception, need break and refresh",d.MonitorName.IGNORE_JS_ERROR_CAPTURED_EXCEPTION],["reLocateForNative is not defined",d.MonitorName.IGNORE_JS_ERROR_RELOCATEFORNATIVE],["null is not an object (evaluating 'document.getElementById('common-banner-mo').style')",d.MonitorName.IGNORE_JS_ERROR_COMMON_BANNER],["vivoNewsDetailPage",d.MonitorName.IGNORE_JS_ERROR_VIVO],["x5onSkinSwitch is not defined",d.MonitorName.IGNORE_JS_ERROR_X5],["cefQuery is not defined",d.MonitorName.IGNORE_JS_ERROR_CEFQUERY],["ExecuteJsInterface",d.MonitorName.IGNORE_JS_ERROR_EXECUTE_JS_INTERFACE],["qtconfig is not defined",d.MonitorName.IGNORE_JS_ERROR_QTCONFIG],["null is not an object (evaluating 'document.getElementById('np_id').innerText')",d.MonitorName.IGNORE_JS_ERROR_QTCONFIG],["null is not an object (evaluating 'document.getElementById('p_is_not_community').innerText')",d.MonitorName.IGNORE_JS_ERROR_QTCONFIG],["$skyuc_src",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["MacPlayer",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["Player is not defined",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["Can't find variable: Player",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["theurl is not defined",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["Can't find variable: theurl",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["null is not an object (evaluating 'document.getElementById('Xfplay').innerHTML')",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["window.parent.param",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["window.mttLongPressVar.tagName",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["ToutiaoJSBridge",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["OnReceiveTransparentMsg",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["processRandomSelector",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["ucbrowser",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["updateBookMallStatus",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["Umeditor",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["ZhihuiOS",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["document.getElementsByTagName('video')[0].setAttribute",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["Cannot read property 'content' of undefined",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["extractNovelContent",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["zhShareHandler",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["window.bannerNight is not a function",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["ResizeObserver loop limit exceeded",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["Cannot read property 'Webview' of undefined",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION],["ResizeObserver loop limit exceeded",d.MonitorName.IGNORE_JS_ERROR_LOWB_INJECTION]]),v=Array.from(g.keys()),_=new Map([[d.MonitorName.JQUERY_REWRITE_ERROR,33871763],[d.MonitorName.FRAME_DROP_NORMAL,33670974],[d.MonitorName.FRAME_DROP_SERIOUS,33711514],[d.MonitorName.FRAME_DROP_REPORT,35340879]]),y=new Map([]),b=new Map([[d.MonitorName.JQUERY_REWRITE_ERROR,"72001"],[d.MonitorName.CHANGESET_ERROR_DELTA2CS,"72101"],[d.MonitorName.CHANGESET_ERROR_VERIFY,"72102"],[d.MonitorName.CHANGESET_ERROR_VERIFY_MODELEN,"72103"],[d.MonitorName.CHANGESET_ERROR_APPLY_ONLINE,"72104"],[d.MonitorName.CHANGESET_ERROR_APPLY_DELTA,"72108"],[d.MonitorName.CHANGESET_ERROR_APPLY_MUTATION,"72109"]]),E="log",C="4";function w(){if(window.location.pathname.indexOf("txdoc/")>=0)return e=null,(t=window.location.search)&&(e=t.match(/(\\?|&)docid=([^&]*)(&|$)/)),e?decodeURIComponent(e[2]):"";var e,t,n=window.location.href.split("?")[0].split("/");return n[n.length-1]}var T=n(223336),A=n.n(T),S=n(259356),I=n(45972),R="BaseMonitorHandler",M=function(){function e(){this.lastJquery=A(),this.hasJqueryErrorReport=!1,this.didLogError=!1,this.logErrorCount=0,this.isAutoTest=!1,this.mutLenDimensionsStr=""}var t;return e.prototype.initMonitorErrorReport=function(){var e=this;try{window.addEventListener("error",(function(t){e.handleJsError(t)}))}catch(e){console.error(e)}var t=o.M.getUrlParameter("currentEnv");t&&"autotest"===t&&(this.isAutoTest=!0)},e.prototype.monitor=function(e){this.monitor007Status(e);var t=this.getMonitorId(e);t&&t>0?this.doMonitor(t):p.Logger.error(R,"monitor(".concat(e,") with monitorId:").concat(t," is not allowed"))},e.prototype.monitorWtihPlatform=function(e){this.monitor007Status(e);var t=this.getMonitorInfo(e);if(t){var n=void 0;(n=p.PlatformUtil.isMac()?t.MAC:t.PC)>0?this.doMonitor(n):p.Logger.error(R,"monitorWtihPlatform(".concat(e,") with monitorId:").concat(n," is not allowed")),t.TOTAL>0?this.doMonitor(t.TOTAL):p.Logger.error(R,"monitorWtihPlatform(".concat(e,") with monitorId:").concat(t.TOTAL," is not allowed"))}else p.Logger.error(R,"monitorWtihPlatform(".concat(e,") with monitorInfo:").concat(t," is not allowed"))},e.prototype.monitor007Status=function(e,t,n,r){var o,a,s;void 0===t&&(t=d.Status007.SUCCESS);var l=null!==(o=null==r?void 0:r.errorCode)&&void 0!==o?o:0,u=null!==(a=null==r?void 0:r.isOffline)&&void 0!==a&&a;(0,i.zzsStatus)({attrid:e,status:t,errmsg:n,dimensions:[null===(s=(0,c.Yi)().collab_client_vars.dver)||void 0===s?void 0:s.substr(0,3),String(l),String(u),this.getChunk(),this.getMutLenDimensionsStr()]})},e.prototype.monitor007Value=function(e,t){var n,r=window.location,o=r.origin,a=r.pathname;(0,i.zzsValue)({attrid:e,value:t,dimensions:[null===(n=(0,c.Yi)().collab_client_vars.dver)||void 0===n?void 0:n.substr(0,3),(0,c.Yi)().padId,"".concat(o).concat(a),this.getChunk(),this.getMutLenDimensionsStr()]})},e.prototype.getChunk=function(){var e;return(null===(e=(0,c.Yi)().collab_client_vars)||void 0===e?void 0:e.isChunked)?"chunk":""},e.prototype.getMutLenDimensionsStr=function(){if(this.mutLenDimensionsStr)return this.mutLenDimensionsStr;if(!window.pad)return"";var e=window.pad.editor.state.dataEngine.getMutNum()||0;return e?(this.mutLenDimensionsStr=0<=e&&e<500?"MUT_0_500":e<1e3?"MUT_500_1K":e<2e3?"MUT_1K_2K":e<5e3?"MUT_2K_5K":e<1e4?"MUT_5K_10K":e<2e4?"MUT_10K_20K":e<5e4?"MUT_20K_50K":e<1e5?"MUT_50K_100K":"MUT_100K_INF",this.mutLenDimensionsStr):""},e.prototype.doMonitor=function(e){(0,i.monitor)(e)},e.prototype.getMonitorId=function(e){return _.get(e)},e.prototype.getMonitorInfo=function(e){return y.get(e)},e.prototype.validateErrorEvent=function(e){return!(o.M.isDevEvn()||(this.isAutoTest?(d.ReportHelper.captureException(d.MonitorName.AUTO_TEST_ERROR,{},e.error),1):this.checkNonEditError(e)||this.checkInjectError(e)))},e.prototype.handleJsError=function(e){var t=e||{},n=t.lineno,r=t.message,i=t.colno,a=t.filename,s=t.error,c="".concat(r," ").concat(a,":").concat(n,":").concat(i);if(p.Logger.error(R,c,null==s?void 0:s.message,null==s?void 0:s.stack),this.validateErrorEvent(e)&&(this.checkJqueryRewriteError(),!this.reportIgnoreError(e))){this.monitorWtihPlatform(d.MonitorName.JS_ERROR_RELEASE),o.M.isGrayEvn()&&this.monitorWtihPlatform(d.MonitorName.JS_ERROR_GRAY);var l=this.contextService.context.appid;l&&this.monitor(d.MonitorName.JS_ERROR_TOB),this.didLogError||(this.didLogError=!0,this.monitor007Status(d.MonitorName.JS_ERROR_RELEASE_ONCE_3_0),this.monitorWtihPlatform(d.MonitorName.JS_ERROR_RELEASE_ONCE),d.ReportHelper.aegisReportEvent({name:d.ReportName.JS_ERROR_RELEASE_ONCE}),l&&this.monitorWtihPlatform(d.MonitorName.JS_ERROR_TOB_ONCE),d.ReportHelper.tdwReport({opername:"tech_melo_quality",module:"page_detail",action:"js_error",ver5:c,ver6:null==s?void 0:s.stack,ver7:window.__globalReleaseVersion})),this.logErrorCount+=1,10!==this.logErrorCount&&100!==this.logErrorCount||d.ReportHelper.captureException(10===this.logErrorCount?d.MonitorName.JS_ERROR_FREQUENT:d.MonitorName.JS_ERROR_FREQUENT_HUNDRED,{},e.error)}},e.prototype.checkNonEditError=function(e){var t=e&&e.error&&e.error.stack;if(t){var n=t.split("\n    at ");if(n&&n[1]){if(n[1].indexOf("tim/docs/components")>=0)return d.ReportHelper.captureException(d.MonitorName.NON_EDIT_ERROR,{logger:d.RavenLogger.NON_EDIT_ERROR},e.error),!0;if(n[1].indexOf("chrome-extension")>=0)return!0}}return!1},e.prototype.checkJqueryRewriteError=function(){this.hasJqueryErrorReport||this.lastJquery===A()||(d.ReportHelper.captureException(d.MonitorName.JQUERY_REWRITE_ERROR,{option:{needBreakAndRefresh:!0}}),this.hasJqueryErrorReport=!0)},e.prototype.reportIgnoreError=function(e){var t=this,n=e&&e.message||"",r=!1;return g.forEach((function(e,o){n.match(o)&&(t.monitor(e),r=!0)})),r},e.prototype.checkInjectError=function(e){if(e&&!e.error&&"Script error."===e.message&&["lofter","tieba","MiuiBrowser","zhihu","HuaweiBrowser","VivoBrowser","UCBrowser"].some((function(e){return navigator.userAgent.match(e)})))return!0;var t=e&&e.error&&e.error.stack;return!(!t||t.split("\n    at ").slice(1).some((function(e){return e.indexOf("<anonymous>:")<0})))},(0,r.__decorate)([(0,S.tB)(),(0,r.__metadata)("design:type","function"==typeof(t=void 0!==I.O&&I.O)?t:Object)],e.prototype,"contextService",void 0),e}(),O=n(991287),N=O.X.getInstance().getConfig("custom.links.defaultDsn"),k=[{test:function(e){return e&&e.logger&&e.logger===d.RavenLogger.CHANGESET_COMMIT},dsn:O.X.getInstance().getConfig("custom.links.changesetCommitDsn"),project:"1117"},{test:function(e){return e&&e.logger&&e.logger===d.RavenLogger.ACTIVE_REPORT},dsn:O.X.getInstance().getConfig("custom.links.activeReportDsn"),project:"1136"},{test:function(e){return e&&e.logger&&e.logger===d.RavenLogger.NON_EDIT_ERROR},dsn:O.X.getInstance().getConfig("custom.links.nonEditErrorDsn"),project:"1794"},{test:function(){return!0},dsn:N,project:"1232"}],L=new Map([[d.MonitorName.WHITESCREEN,0],[d.MonitorName.CHANGESET_ERROR_RELEASE,34602383],[d.MonitorName.CHANGESET_ERROR_GRAY,34602384],[d.MonitorName.CHANGESET_ERROR_TOB,35130144],[d.MonitorName.CHANGESET_ERROR_ONCE,34725847],[d.MonitorName.CHANGESET_ERROR_CONTINUE,34793477],[d.MonitorName.CHANGESET_ERROR_INIT,34643531],[d.MonitorName.CHANGESET_ERROR_APPLY_DELTA,34643532],[d.MonitorName.CHANGESET_ERROR_DELTA2CS,34643533],[d.MonitorName.CHANGESET_ERROR_APPLY_OFFLINE,34643534],[d.MonitorName.CHANGESET_ERROR_APPLY_ONLINE,34643535],[d.MonitorName.CHANGESET_ERROR_EASYSYNC,34643536],[d.MonitorName.CHANGESET_ERROR_VERIFY,34643537],[d.MonitorName.CHANGESET_ERROR_VERIFY_MODELEN,34866646],[d.MonitorName.CHANGESET_ERROR_MAIN_RANGE,34644993],[d.MonitorName.JS_ERROR_TOB,35130141],[d.MonitorName.HTML_PARSE_ERROR,34622047],[d.MonitorName.NON_EDIT_ERROR,34760843],[d.MonitorName.AUTO_TEST_ERROR,34884338],[d.MonitorName.DATA_PRODUCE,34784731],[d.MonitorName.DATA_PRODUCE_TABLE_HEADER,34784732],[d.MonitorName.DATA_PRODUCE_TABLE,34784733],[d.MonitorName.DATA_TRANSFORM,34784734],[d.MonitorName.DATA_TRANSFORM_TABLE,34784735],[d.MonitorName.DATA_VERIFY,34784736],[d.MonitorName.DATA_COMPOSE,34784737],[d.MonitorName.DATA_COMPOSE_TABLE_HEADER,34784738],[d.MonitorName.DATA_COMPOSE_TABLE,34784739],[d.MonitorName.DATA_ACCEPT,34784740],[d.MonitorName.DATA_ACCEPT_TABLE_HEADER,34784741],[d.MonitorName.DATA_ACCEPT_TABLE,34784742],[d.MonitorName.DATA_PRODUCE_ERROR_FRONT,34784743],[d.MonitorName.DATA_PRODUCE_ERROR_BACK,34784744],[d.MonitorName.DATA_PRODUCE_ERROR_TIMEOUT,34868728],[d.MonitorName.DATA_PRODUCE_ERROR_TIPS,34868729],[d.MonitorName.DATA_PRODUCE_LITTLE_UNCOMMIT,34868730],[d.MonitorName.HOT_UPGRADE,34793469],[d.MonitorName.HOT_UPGRADE_STOCK,34795331],[d.MonitorName.TABLE_MERGE,34972282],[d.MonitorName.HAS_TABLE,35097880],[d.MonitorName.PV_PUBLISH,35023644],[d.MonitorName.PV_TOB,35118503],[d.MonitorName.TABLE_DATA_CHECK_FAILED,35081471],[d.MonitorName.TABLE_DATA_FIX_FAILED,35089798],[d.MonitorName.COMMENT_INVALID_PLACEHOLDER,35118873],[d.MonitorName.COMMENT_REPEAT_FIX,35130600],[d.MonitorName.COMMENT_UPGRADE,35129282],[d.MonitorName.LAYOUT_MISSING_CONTENT,35567498],[d.MonitorName.LAYOUT_TABLE_FAILED,35666218],[d.MonitorName.REFLOWLAYOUT_TABLE_FAILED,35677667]]),D=new Map([[d.MonitorName.WHITESCREEN,0],[d.MonitorName.CHANGESET_ERROR_RELEASE,1],[d.MonitorName.CHANGESET_ERROR_GRAY,2],[d.MonitorName.CHANGESET_ERROR_TOB,3],[d.MonitorName.CHANGESET_ERROR_ONCE,4],[d.MonitorName.CHANGESET_ERROR_CONTINUE,5],[d.MonitorName.CHANGESET_ERROR_INIT,6],[d.MonitorName.CHANGESET_ERROR_APPLY_DELTA,7],[d.MonitorName.CHANGESET_ERROR_DELTA2CS,8],[d.MonitorName.CHANGESET_ERROR_APPLY_OFFLINE,9],[d.MonitorName.CHANGESET_ERROR_APPLY_ONLINE,10],[d.MonitorName.CHANGESET_ERROR_EASYSYNC,11],[d.MonitorName.CHANGESET_ERROR_VERIFY,12],[d.MonitorName.CHANGESET_ERROR_VERIFY_MODELEN,13],[d.MonitorName.CHANGESET_ERROR_MAIN_RANGE,14],[d.MonitorName.JS_ERROR_TOB,15],[d.MonitorName.HTML_PARSE_ERROR,16],[d.MonitorName.NON_EDIT_ERROR,17],[d.MonitorName.AUTO_TEST_ERROR,18],[d.MonitorName.DATA_PRODUCE,19],[d.MonitorName.DATA_PRODUCE_TABLE_HEADER,20],[d.MonitorName.DATA_PRODUCE_TABLE,21],[d.MonitorName.DATA_TRANSFORM,22],[d.MonitorName.DATA_TRANSFORM_TABLE,23],[d.MonitorName.DATA_VERIFY,24],[d.MonitorName.DATA_COMPOSE,25],[d.MonitorName.DATA_COMPOSE_TABLE_HEADER,26],[d.MonitorName.DATA_COMPOSE_TABLE,27],[d.MonitorName.DATA_ACCEPT,28],[d.MonitorName.DATA_ACCEPT_TABLE_HEADER,29],[d.MonitorName.DATA_ACCEPT_TABLE,30],[d.MonitorName.DATA_PRODUCE_ERROR_FRONT,31],[d.MonitorName.DATA_PRODUCE_ERROR_BACK,32],[d.MonitorName.DATA_PRODUCE_ERROR_TIMEOUT,33],[d.MonitorName.DATA_PRODUCE_ERROR_TIPS,34],[d.MonitorName.DATA_PRODUCE_LITTLE_UNCOMMIT,35],[d.MonitorName.HOT_UPGRADE,36],[d.MonitorName.HOT_UPGRADE_STOCK,37],[d.MonitorName.TABLE_MERGE,38],[d.MonitorName.HAS_TABLE,39],[d.MonitorName.PV_PUBLISH,40],[d.MonitorName.PV_TOB,41],[d.MonitorName.TABLE_DATA_CHECK_FAILED,42],[d.MonitorName.TABLE_DATA_FIX_FAILED,43],[d.MonitorName.COMMENT_INVALID_PLACEHOLDER,44],[d.MonitorName.COMMENT_REPEAT_FIX,45],[d.MonitorName.COMMENT_UPGRADE,46],[d.MonitorName.LAYOUT_MISSING_CONTENT,47],[d.MonitorName.LAYOUT_TABLE_FAILED,48],[d.MonitorName.REFLOWLAYOUT_TABLE_FAILED,49],[d.MonitorName.REACT_ERROR_BOUNDARY,50],[d.MonitorName.OPENDOC30_WITH_21DATA,51],[d.MonitorName.LAYOUT_ERROR,52],[d.MonitorName.SYNC_IMPORT_FAILED,53]]);D.forEach((function(e,t){D.set(t,e+60)}));var P,x=new Map([[d.MonitorName.JS_ERROR_RELEASE,{ANDROID:34278275,IOS:34278276,MAC:34278277,PC:34278278,TOTAL:34278279}],[d.MonitorName.JS_ERROR_RELEASE_ONCE,{ANDROID:34278280,IOS:34278281,MAC:34278282,PC:34278283,TOTAL:34278284}],[d.MonitorName.JS_ERROR_GRAY,{ANDROID:34278285,IOS:34278286,MAC:34278287,PC:34278288,TOTAL:34278289}],[d.MonitorName.JS_ERROR_TOB_ONCE,{ANDROID:35148829,IOS:35148830,MAC:35148831,PC:35148832,TOTAL:35137422}],[d.MonitorName.PV,{ANDROID:34446817,IOS:34446818,MAC:34446819,PC:34446820,TOTAL:34446821}]]),F=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),t.prototype.getMonitorId=function(t){return L.has(t)?L.get(t):e.prototype.getMonitorId.call(this,t)},t.prototype.getMonitorInfo=function(t){return x.has(t)?x.get(t):e.prototype.getMonitorInfo.call(this,t)},t.prototype.monitor=function(t){e.prototype.monitor.call(this,t)},t.prototype.monitorWtihPlatform=function(t){e.prototype.monitorWtihPlatform.call(this,t)},t.prototype.reportIdKey=function(e){var t=D.get(e);void 0!==t&&d.ReportHelper.idkeyReport(t,d.IdkeyType.MONITOR)},t}(M),B=n(305945),U=n(97303),H=n(634667),W=n(625321),j=n(218581),G=function(){function e(){}return e.prototype.zzsReport=function(e){var t;(0,i.zzsStatus)({attrid:e,status:d.Status007.FAIL,dimensions:[null===(t=(0,c.Yi)().collab_client_vars.dver)||void 0===t?void 0:t.substr(0,3)]})},e.prototype.reportToWebLog=function(e,t){["40001","60007","60015","70001","60006"].includes(e)||t&&["INACTIVE"].includes(t)||setTimeout((function(){var t,n,r=Date.now(),o=r-36e5,i="".concat("WORD_COLLAB_CENTER_DISCONNECT").concat(e.length>0?"_".concat(e):"UNKNOWN");null===(n=null===(t=window.log)||void 0===t?void 0:t.report)||void 0===n||n.call(t,i,{query:{startTs:o,endTs:r}})}),1e3)},e}(),V=new G,z=n(175257),Q=n(284885),Y=n(732948),Z=n(102930),K=n(523255),J=function(){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return(e=window.App.changesetManager.getChanges().filter((function(e){return 0!==e.changeset.length}))).length?[2,e]:[4,window.App.offlineEditAdapter.getChanges()];case 1:return(t=n.sent()).length?(t.forEach((function(e){e.changeset=K._.getMutationCommands(e.changesetString)})),[2,t]):(p.Logger.error("getChanges length is zero."),[2,[]])}}))}))},q=function(e){var t,n=0,r=0;return null===(t=e.forEach)||void 0===t||t.call(e,(function(e){var t;e.changeset&&(n+=(0,Z.Re)(e.changeset),r+=null!==(t=e.changeSetCount)&&void 0!==t?t:1)})),{charCount:n,csCount:r}},X=n(378898);!function(e){e.GRAY_TIPS="GRAY_TIPS",e.RED_TIPS="RED_TIPS"}(P||(P={}));var ee=new Map([[[H.RoomWebsocketErrorCode.SOCKET_DATA_SAVE_FAIL,H.RoomWebsocketErrorCode.SOCKET_COLLAB_ROOM_TIMEOUT,H.RoomWebsocketErrorCode.SOCKET_COLLAB_SERVER_TIMEOUT,H.RoomWebsocketErrorCode.SOCKET_SERVER_STORAGE_TIMEOUT,H.RoomWebsocketErrorCode.SOCKET_SERVER_CGI_TIMEOUT,H.RoomWebsocketErrorCode.SOCKET_HACKPAD_TIMEOUT,H.RoomWebsocketErrorCode.SOCKET_SERVER_WAITTING_TOO_LONG,H.RoomWebsocketErrorCode.SOCKET_SERVER_WAITTING_TIMEOUT,H.RoomWebsocketErrorCode.SOCKET_AUTH_TIMEOUT,H.RoomWebsocketErrorCode.SOCKET_GET_PRIVILEGE_TIMEOUT],{PC:(0,j.$t)("服务器处理超时，请刷新重试。"),Mobile:(0,j.$t)("服务器超时，请刷新重试。"),Action1:z.S9.REFRESH,Action2:z.S9.CONTACT,Idkey:[d.IdkeyName.SERVER_ERROR,d.IdkeyName.WEBSOCKET_ERROR]}],[[H.RoomWebsocketErrorCode.SOCKET_CLIENT_NOT_READY_ERROR],{PC:(0,j.$t)("服务器连接超时，请刷新重试。"),Mobile:(0,j.$t)("服务器超时，请刷新重试。"),Action1:z.S9.REFRESH,Action2:z.S9.CONTACT,Idkey:[d.IdkeyName.SERVER_ERROR,d.IdkeyName.WEBSOCKET_ERROR]}],[[Y.p.CollabRoomGetMisschangFail,Y.p.CollabRoomCommittingTimeOut,Y.p.CollabRoomCommitCSFailByCGI,Y.p.CollabRoomGetChunkFail],{PC:(0,j.$t)("网络异常，请刷新重试。"),Action1:z.S9.REFRESH,Idkey:[d.IdkeyName.COLLAB_ROOM_ERR]}],[[H.RoomWebsocketErrorCode.SOCKET_FREQUENCY_LIMIT],{PC:(0,j.$t)("你的操作太频繁，请稍后再试。"),Action1:z.S9.REFRESH,Duration:3e3}],[[H.RoomWebsocketErrorCode.SOCKET_SERVER_ERROR,H.RoomWebsocketErrorCode.SOCKET_LAYER_ERROR,Y.p.CollabRoomCommitCheckTimeOut],{PC:(0,j.$t)("服务器异常，请刷新重试。"),Action1:z.S9.REFRESH,Action2:z.S9.CONTACT,Idkey:[d.IdkeyName.SERVER_ERROR,d.IdkeyName.WEBSOCKET_ERROR]}],[[H.RoomWebsocketErrorCode.SOCKET_USER_AUTH_FAILED,H.RoomWebsocketErrorCode.LOGIN_INVALIDATE],{PC:(0,j.$t)("登录过期，点击刷新。"),Action1:z.S9.RELOGIN,Idkey:[d.IdkeyName.AUTH_FAILED]}],[[H.RoomWebsocketErrorCode.SOCKET_COLLAB_ROOM_MEMBER_FULL,H.RoomWebsocketErrorCode.SOCKET_COLLABROOM_NOT_VIP_FULL],{PC:(0,j.$t)("编辑或查看人数较多，转为只能查看。"),Action1:z.S9.BEGINEDIT}],[[H.RoomWebsocketErrorCode.SOCKET_GRAY_VERSION_INCONFORMITY,H.RoomWebsocketErrorCode.SOCKET_CLIENT_VERSION_TOO_OLD,Y.p.CollabRoomDataBaseChange,Y.p.InitWhiteScreen],{PC:(0,j.$t)("文档状态有更新。"),Action1:z.S9.REFRESH}],[[Y.p.InitWhiteScreen],{PC:(0,j.$t)("文档状态有更新。"),Action1:z.S9.REFRESH,Action2:z.S9.CONTACT}],[[H.RoomWebsocketErrorCode.SOCKET_DOCUMENT_EDIT_COLLAB_LIMIT],{PC:(0,j.$t)("此内容因违规无法编辑。"),Action1:z.S9.LEARNMORE}],[[Y.p.CollabRoomSwitchAccout],{PC:(0,j.$t)("帐号信息变化，点击刷新。"),Action1:z.S9.REFRESH}]]),te=new Map([[[Y.p.CollabRoomDefaultErrCode,Y.p.CollabRoomCHANGESETERRORAPPLYOFFLINE,Y.p.CollabRoomChangsetErrorEasysync,Y.p.CollabRoomJQUERYREWRITEERROR,Y.p.CollabRoomGetMisschangAndFollowError,Y.p.CollabRoomDelta2CS,Y.p.CollabRoomVerify,Y.p.CollabRoomVerifyModel,Y.p.CollabRoomApplyOnline,H.RoomWebsocketErrorCode.SOCKET_CLIENT_DATA_ERROR,H.RoomWebsocketErrorCode.SOCKET_USER_CHANGE_PARAM_ERROR,H.RoomWebsocketErrorCode.SOCKET_COMMAND_NOT_SUPPORTED,H.RoomWebsocketErrorCode.SOCKET_DATA_DOC_NOT_EXIST,H.RoomWebsocketErrorCode.SOCKET_DATA_SUBID_ERROR,H.RoomWebsocketErrorCode.SOCKET_DATA_ACTION_LENGTH,40030],{LittleContent:{PC:(0,j.$t)("文档编辑状态发生变化，点击刷新。"),Mobile:(0,j.$t)("文档编辑状态变化，点击刷新。"),Action:[z.S9.REFRESHANDFIX,z.S9.CONTACT]},MuchContent:{PC:(0,j.$t)("编辑内容暂无法保存。"),Action:[z.S9.HOW2DEAL]},Idkey:[d.IdkeyName.COLLAB_ROOM_ERR,d.IdkeyName.WEBSOCKET_ERROR]}],[[H.RoomWebsocketErrorCode.SOCKET_DATA_SERVER_ERROR],{LittleContent:{PC:(0,j.$t)("服务器异常，编辑内容暂无法保存。"),Mobile:(0,j.$t)("编辑内容无法保存。"),Action:[z.S9.REFRESHANDFIX,z.S9.CONTACT]},MuchContent:{PC:(0,j.$t)("服务器异常，编辑内容暂无法保存。"),Mobile:(0,j.$t)("编辑内容无法保存。"),Action:[z.S9.HOW2DEAL]},Idkey:[d.IdkeyName.SERVER_ERROR,d.IdkeyName.WEBSOCKET_ERROR]}],[[H.RoomWebsocketErrorCode.SOCKET_DATA_CHANGESET_EASYSYNC,H.RoomWebsocketErrorCode.SOCKET_DATA_READ_FAIL,H.RoomWebsocketErrorCode.SOCKET_DATA_BASEREV_ERROR,H.RoomWebsocketErrorCode.SOCKET_DATA_NOT_SUPPORTED_TYPE,H.RoomWebsocketErrorCode.SOCKET_DATA_NOT_SUPPORTED_PROTO,H.RoomWebsocketErrorCode.SOCKET_DATA_DOCID_ERROR,H.RoomWebsocketErrorCode.SOCKET_DATA_PROTOCOL_TYPE_ERROR,H.RoomWebsocketErrorCode.SOCKET_DATA_SERVER_UNKNOWN_ERROR,H.RoomWebsocketErrorCode.SOCKET_DATA_PROTOCOL_FIELD_LACK,W.OFFLINE_EDIT_CODE.RESUBMIT_FAIL],{LittleContent:{PC:(0,j.$t)("服务器异常，编辑内容暂无法保存。"),Mobile:(0,j.$t)("服务器异常，编辑内容无法保存。"),Action:[z.S9.REFRESHANDFIX,z.S9.CONTACT]},MuchContent:{PC:(0,j.$t)("服务器异常，编辑内容暂无法保存。"),Mobile:(0,j.$t)("服务器异常，编辑内容无法保存。"),Action:[z.S9.HOW2DEAL]},Idkey:[d.IdkeyName.SERVER_ERROR,d.IdkeyName.WEBSOCKET_ERROR]}],[[H.RoomWebsocketErrorCode.SOCKET_DOC_PRIVILEGE_FAILED,H.RoomWebsocketErrorCode.SOCKET_USER_DOC_NOPRIVILEGE],{LittleContent:{PC:(0,j.$t)("权限发生变更无法继续编辑。"),Mobile:(0,j.$t)("权限发生变更无法继续编辑。。"),Action:[z.S9.REFRESHANDFIX,z.S9.CONTACT]},MuchContent:{PC:(0,j.$t)("权限发生变更无法继续编辑。"),Mobile:(0,j.$t)("权限发生变更无法继续编辑。"),Action:[z.S9.HOW2DEAL]}}],[[H.RoomWebsocketErrorCode.SOCKET_PACKAGE_SIZE_TOO_LARGE,H.RoomWebsocketErrorCode.SOCKET_DATA_CONTENT_LIMIT,H.RoomWebsocketErrorCode.SOCKET_DATA_EASYSYNC_TIMEOUT,Y.p.PAYLOADTOOLARGE],{LittleContent:{PC:(0,j.$t)("本次操作内容过多，暂无法保存。"),Action:[z.S9.REFRESHANDFIX,z.S9.CONTACT]},MuchContent:{PC:(0,j.$t)("本次操作内容过多，暂无法保存。"),Action:[z.S9.HOW2DEAL]}}],[[H.RoomWebsocketErrorCode.COMMIT_CHANGES_CONTAIN_REVERT],{LittleContent:{PC:(0,j.$t)("文档存在数据更新，请点击刷新。"),Action:[z.S9.REFRESHANDFIX]},MuchContent:{PC:(0,j.$t)("编辑内容暂无法保存。"),Action:[z.S9.CREATEDOCCOPY,z.S9.HOW2DEAL]}}],[[W.OFFLINE_EDIT_CODE.RESUBMIT_FAIL],{LittleContent:{PC:(0,j.$t)("服务器异常，编辑内容暂无法保存。"),Mobile:(0,j.$t)("服务器异常，编辑内容无法保存。"),Action:[z.S9.HOW2DEAL]},MuchContent:{PC:(0,j.$t)("服务器异常，编辑内容暂无法保存。"),Mobile:(0,j.$t)("服务器异常，编辑内容无法保存。"),Action:[z.S9.HOW2DEAL]},Idkey:[d.IdkeyName.SERVER_ERROR,d.IdkeyName.WEBSOCKET_ERROR]}]]),ne=function(){function e(e){this.notificationCenter=e,this.maxCharLength=5,this.maxChangesetCount=2}return e.prototype.showWarnTipsNotClear=function(e,t){var n=!1;if(e||t){var r="",o=0,i=[];e&&ee.forEach((function(t,a){if(a&&a instanceof Array&&a.indexOf(e)>-1){t&&t.Mobile;var s=t&&t.PC||"";r=s,t.Action1&&i.push(t.Action1),t.Action2&&i.push(t.Action2),t.Duration&&(o=t.Duration),n=!0,r=r.replace(/.$/,"(".concat(e,")。")),t.Idkey&&d.ReportHelper.idkeyReport(t.Idkey)}})),r&&(Q.j.info("showWarnTipsNotClear, context, ".concat(r)),this.notificationCenter.fire(new z.w0({errDetail:t,errMsg:"".concat(r),errCode:"".concat(e),action:this.showTipsAction?i:[],duration:o||void 0})))}var a=window.App.changesetManager.getUncommitedInfo();return d.ReportHelper.tdwReport({opername:"doc_core",module:"data_lost",action:"show_tips",ver5:t&&t.indexOf("INACTIVE")>-1?72100:e||72005,ver6:a.charCount,ver7:a.csCount,ver8:"warntips"}),n&&V.zzsReport(P.GRAY_TIPS),n},e.prototype.getErrorMsg=function(e,t,n){var o="",i=[],a=[];return e&&te.forEach((function(s,c){if(c&&c instanceof Array&&c.indexOf(e)>-1){var l=t?s.MuchContent:s.LittleContent,u=(l&&l.Mobile,l&&l.PC||"");o=(o=u).replace(/.$/,"(".concat(null!=n?n:e,")。")),l&&l.Action&&(i=i.concat(l.Action)),s.Idkey&&a.push.apply(a,(0,r.__spreadArray)([],(0,r.__read)(s.Idkey),!1))}})),{msg:o,action:this.showTipsAction?i:[],idkeys:a}},e.prototype.showErrorTips=function(e,t,n){return void 0===n&&(n=!1),(0,r.__awaiter)(this,void 0,void 0,(function(){var o,i,a,s,c,l,u,p,f,h;return(0,r.__generator)(this,(function(m){switch(m.label){case 0:return o=[Y.p.CollabRoomShutDownNotOpen],e&&o.includes(e)?[2]:(i=e||Y.p.CollabRoomDefaultErrCode,a="",s=0,c=[],l=[],[4,(g=n,void 0===g&&(g=!1),(0,r.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return(e=window.App.changesetManager.getUncommitedInfo()).charCount>0||e.csCount?[2,e]:g?[4,J()]:[3,2];case 1:return t=n.sent(),[2,q(t)];case 2:return[2,e]}}))})))]);case 1:return u=m.sent(),p=!(u.charCount<=this.maxCharLength&&u.csCount<=this.maxChangesetCount),f=this.getErrorMsg(i,p),a=f.msg,c=f.action,l=f.idkeys,a||(h=this.getErrorMsg(Y.p.CollabRoomDefaultErrCode,p,i),a=h.msg,c=h.action,l=h.idkeys),a&&(this.notificationCenter.fire(new z.w0({errDetail:t,errMsg:"".concat(a),errCode:"".concat(i),action:c,duration:s||void 0})),u.charCount<=10&&d.ReportHelper.monitor(d.MonitorName.DATA_PRODUCE_LITTLE_UNCOMMIT),d.ReportHelper.monitor(d.MonitorName.DATA_PRODUCE_ERROR_TIPS),d.ReportHelper.tdwReport({opername:"doc_core",module:"data_lost",action:"show_tips",ver5:t&&t.indexOf("INACTIVE")>-1?72100:e||72005,ver6:u.charCount,ver7:u.csCount}),d.ReportHelper.idkeyReport(l),V.zzsReport(P.RED_TIPS)),[2]}var g}))}))},e.prototype.showTips=function(e,t,n){Q.j.info("showTips, code:".concat(e,", reason:").concat(t,", canEdit:").concat(n)),this.showWarnTipsNotClear(e,t)||this.showErrorTips(e,t),V.reportToWebLog("".concat(e),"".concat(t))},e.isINACTIVE=!1,(0,r.__decorate)([(0,X.D)("feature.tips.showAction",!0),(0,r.__metadata)("design:type",Boolean)],e.prototype,"showTipsAction",void 0),e}(),re=function(){function e(){}return e.show=function(e,t){var n;(null===(n=window.App.collabCenterAdapter)||void 0===n?void 0:n.disconnect)?window.App.collabCenterAdapter.disconnect(t,Number(e)):(new ne(window.pad.editor.notificationCenter).showTips(Y.p.InitWhiteScreen),V.zzsReport("WORD_InitWhiteScreen_".concat(Y.p.InitWhiteScreen)))},e}(),oe=function(e){function t(){var n=e.call(this,"captured exception, need break and refresh")||this;return Object.setPrototypeOf(n,t.prototype),n}return(0,r.__extends)(t,e),t}(Error),ie=function(){function e(){this.didLogError=!1,this.needBreakAndRefresh=!1}var t;return e.prototype.captureException=function(e,t,n){var r,i=t.option||{};if(delete t.option,n instanceof oe&&i.needBreakAndRefresh)throw n;var a=n||new Error,s=o.M.isDevEvn()?"_DEV":"",c=a.name?"_".concat(a.name):"";if(a.name="".concat(e).concat(c).concat(s),t.logger===d.RavenLogger.CHANGESET_COMMIT&&(this.didLogError&&(a.name+="_CONTINUE"),a.message+="\ntype: ".concat(a.name,",changesetLog: ").concat(JSON.stringify(d.GlobalContext.run(B.Rh.get))),null===(r=window.aegis)||void 0===r||r.error(a)),this.buildAdditionalData(e,t),window.Raven&&window.Raven.captureException(a,t),o.M.isDevEvn()||(d.ReportHelper.monitor(e),t.logger===d.RavenLogger.CHANGESET_COMMIT&&(d.ReportHelper.monitor(d.MonitorName.CHANGESET_ERROR_RELEASE),o.M.isGrayEvn()&&d.ReportHelper.monitor(d.MonitorName.CHANGESET_ERROR_GRAY),this.contextService.context.appid&&d.ReportHelper.monitor(d.MonitorName.CHANGESET_ERROR_TOB),this.didLogError?d.ReportHelper.monitor(d.MonitorName.CHANGESET_ERROR_CONTINUE):(this.didLogError=!0,d.ReportHelper.monitor(d.MonitorName.CHANGESET_ERROR_ONCE)))),i.needBreakAndRefresh){this.needBreakAndRefresh=!0;var l=i.errorCode||function(e){return b.get(e)||"72999"}(e);throw p.Logger.info("captureException","errorCode:".concat(l)),re.show(Number(l),a.toString()),new oe}},e.prototype.buildAdditionalData=function(e,t){t.extra||(t.extra={}),t.tags||(t.tags={});var n=(0,c.Yi)();return n&&(t.extra.padId=n.padId,t.tags.padId=n.padId),t},e.prototype.initSentryErrorReport=function(){var e,t,n=this,r=0;if(window.addEventListener("error",(function(){r+=1})),this.setTagsContext(),window.Raven&&window.Raven.config(this.getDefaultDsn(),{release:window.__globalReleaseVersion,ignoreErrors:v,dataCallback:function(e){n.dataCallback(e)},autoBreadcrumbs:{xhr:!1},sampleRate:.1,shouldSendCallback:function(){var e;return!(!(null===(e=window.__globalReleaseVersion)||void 0===e?void 0:e.match("(release_|hotfix_)"))||r>9)}}).install(),window.aegis){var i=null!==(e=window.__globalReleaseVersion)&&void 0!==e?e:"",a=null===(t=(0,c.Yi)().collab_client_vars.dver)||void 0===t?void 0:t.substr(0,3);window.aegis.setConfig({version:"".concat(a,"_").concat(i),beforeRequest:function(e){var t,n,r;if(o.M.isDevEvn())return!1;if(e.logType===E&&(null===(t=null==e?void 0:e.logs)||void 0===t?void 0:t.level)===C&&(null===(n=null==e?void 0:e.logs)||void 0===n?void 0:n.msg)){var a=v.some((function(t){var n;return null===(n=null==e?void 0:e.logs)||void 0===n?void 0:n.msg.match(t)}));if(a)return!1;var s=i.split("-").pop();return e.logs.msg="[".concat(s,"]").concat(e.logs.msg),e}return e.logType!==E||(null===(r=e.logs)||void 0===r?void 0:r.ext3)||(e.logs.ext3=w()),e}}),window.aegis.reportEvent("page_view")}},e.prototype.dataCallback=function(e){var t=this.getSentryConfigList();if(t&&t.length>0)for(var n=0;n<t.length;n++){var r=t[n];if(r.test&&r.test(e)){e.project!==r.project&&(window.Raven&&window.Raven.setDSN(r.dsn),e.project=r.project);break}}return p.Logger.raven(e)},e.prototype.setTagsContext=function(){var e;try{var t={platform:"pc",uid:(0,U.getUid)(),environment:o.M.isDevEvn()?"development":"production",codeVer:null===(e=(0,c.Yi)().collab_client_vars.dver)||void 0===e?void 0:e.substr(0,3),currentEnv:o.M.getUrlParameter("currentEnv")||""};window.Raven&&window.Raven.setTagsContext(t)}catch(e){p.Logger.error(e)}},(0,r.__decorate)([(0,S.tB)(),(0,r.__metadata)("design:type","function"==typeof(t=void 0!==I.O&&I.O)?t:Object)],e.prototype,"contextService",void 0),e}(),ae=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),t.prototype.getDefaultDsn=function(){return N},t.prototype.getSentryConfigList=function(){return k},t}(ie);window.ReportHelper=d.ReportHelper;var se=n(1792);function ce(e){var t=window.App.UIConfigs,n=t.NORMAL_CONFIG,r=t.PREVIEW_CONFIG,o=(0,p.getUrlParameter)("inToastPreview")?r:n;if(o)try{var i=function(e){var t=new Map,n=function(e,r){Object.keys(e).forEach((function(o){var i=""===r?o:"".concat(r,".").concat(o);"[object Object]"===Object.prototype.toString.call(e[o])?n(e[o],i):t.set(i,e[o])}))};return n(e,""),t}(e);i.forEach((function(e,t){for(var n=t.split("."),r=o,i=0;i<n.length;i++){var a=n[i];r[a]||(r[a]={}),i===n.length-1?r[a]=e:r=r[a]}}))}catch(e){console.error("cacUpdate catch error:",e)}else console.error("weboffice cacUpdate error")}if(se.dQ)if("simple"===(0,p.getUrlParameter)("_o_mode"))ce({common:{titlebar:!1,toolbar:!1},custom:{feature:{bottom_bar:!1}}});else{var le=window.__WO_config__||{},ue=le.isShowTitleBar,de=le.isShowToolBar,pe=le.isShowOutline,fe=le.isShowStatusBar,he=le.isShowMobileBottomBar;ce({common:(0,r.__assign)((0,r.__assign)((0,r.__assign)({},!1===ue?{titlebar:!1}:{}),!1===de?{toolbar:!1}:{}),!1===fe?{statusbar:!1}:{}),custom:{feature:(0,r.__assign)((0,r.__assign)({},!0===pe?{outline:{autoShow:!0}}:{}),!1===he?{bottom_bar:!1}:{})}})}var me=n(768352),ge=n(986830),ve=n(718807),_e=n(289312),ye=n(57481),be=n(707605),Ee=function(){function e(){}var t,n;return e.prototype.use=function(e,t,n){return 0!==n.path.length&&!1!==e.respectPermission&&!be.qO.getInstance().isEditableCompute&&(t(),!0)},(0,r.__decorate)([(0,r.__param)(0,(0,ge.z)()),(0,r.__param)(1,(0,ve.o)()),(0,r.__param)(2,(0,_e.g)()),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",["function"==typeof(t=void 0!==me.ToolbarConfig&&me.ToolbarConfig)?t:Object,Object,"function"==typeof(n=void 0!==me.IActionPointInfo&&me.IActionPointInfo)?n:Object]),(0,r.__metadata)("design:returntype",void 0)],e.prototype,"use",null),e=(0,r.__decorate)([(0,ye.d)()],e)}(),Ce=n(153970),we=n(329961),Te=function(){function e(){}var t;return e.prototype.use=function(e,t){return!(!e||!(0,we.B)(e)||!e.state.dataEngine.getIsChunkLoadReadonly()||(t(),0))},(0,r.__decorate)([(0,r.__param)(0,(0,Ce.M)()),(0,r.__param)(1,(0,ve.o)()),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",["function"==typeof(t=void 0!==d.MeloEditor&&d.MeloEditor)?t:Object,Object]),(0,r.__metadata)("design:returntype",void 0)],e.prototype,"use",null),e=(0,r.__decorate)([(0,ye.d)()],e)}(),Ae=n(202532),Se=function(){function e(){}var t,n,o,i,a,s,c,l,u;return e.prototype.use=function(e,t,n,r){switch(n.trigger){case"shouldDisabled":return this.shouldDisabled(e,t,r);case"onClick":return this.onClick(e,t,r);case"tooltip":return this.tooltip(e,r)}},e.prototype.shouldDisabled=function(e,t,n){var r=e.respectPageView;return!((0,d.isPagedLayout)(n.layoutTypeManager.currentLayoutType)||!r||!(null==r?void 0:r.disabled)||(t(),0))},e.prototype.onClick=function(e,t,n){var r=e.respectPageView;if(!(0,d.isPagedLayout)(n.layoutTypeManager.currentLayoutType)&&r&&!r.disabled){var o=(0,j.$t)("layout-type:need-paged-layout");r.name&&(o="「".concat(r.name,"」").concat(o)),Ae.Modal.confirm({title:(0,j.$t)("提示"),content:o,cancelText:(0,j.$t)("取消"),okText:(0,j.$t)("立即切换"),onOk:function(){return n.layoutTypeManager.switchTo(d.LayoutType.Paged)}}),t()}},e.prototype.tooltip=function(e,t){var n=e.respectPageView,r=e.tooltip;return(0,d.isPagedLayout)(t.layoutTypeManager.currentLayoutType)||!n?r:n.disabled?(stop(),(0,j.$t)("仅分页视图可使用")):r},(0,r.__decorate)([(0,r.__param)(0,(0,ge.z)()),(0,r.__param)(1,(0,ve.o)()),(0,r.__param)(2,(0,_e.g)()),(0,r.__param)(3,(0,Ce.M)()),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",["function"==typeof(t=void 0!==me.WorkbenchUIConfig&&me.WorkbenchUIConfig)?t:Object,Object,"function"==typeof(n=void 0!==me.IActionPointInfo&&me.IActionPointInfo)?n:Object,"function"==typeof(o=void 0!==d.MeloEditor&&d.MeloEditor)?o:Object]),(0,r.__metadata)("design:returntype",void 0)],e.prototype,"use",null),(0,r.__decorate)([(0,r.__param)(0,(0,ge.z)()),(0,r.__param)(1,(0,ve.o)()),(0,r.__param)(2,(0,Ce.M)()),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",["function"==typeof(i=void 0!==me.WorkbenchUIConfig&&me.WorkbenchUIConfig)?i:Object,Object,"function"==typeof(a=void 0!==d.MeloEditor&&d.MeloEditor)?a:Object]),(0,r.__metadata)("design:returntype",void 0)],e.prototype,"shouldDisabled",null),(0,r.__decorate)([(0,r.__param)(0,(0,ge.z)()),(0,r.__param)(1,(0,ve.o)()),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",["function"==typeof(s=void 0!==me.WorkbenchUIConfig&&me.WorkbenchUIConfig)?s:Object,Object,"function"==typeof(c=void 0!==d.MeloEditor&&d.MeloEditor)?c:Object]),(0,r.__metadata)("design:returntype",void 0)],e.prototype,"onClick",null),(0,r.__decorate)([(0,r.__param)(0,(0,ge.z)()),(0,r.__param)(1,(0,Ce.M)()),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",["function"==typeof(l=void 0!==me.WorkbenchUIConfig&&me.WorkbenchUIConfig)?l:Object,"function"==typeof(u=void 0!==d.MeloEditor&&d.MeloEditor)?u:Object]),(0,r.__metadata)("design:returntype",void 0)],e.prototype,"tooltip",null),e=(0,r.__decorate)([(0,ye.d)()],e)}(),Ie=n(865213),Re=n(940062),Me=n(338104),Oe=n(890611),Ne=n(924878),ke=n(87360),Le=Symbol("service:start-up"),De=n(496985),Pe=n(71461),xe=n(731911),Fe=n(584985),Be=n(964587),Ue=n(859942),He=n(137600),We=n(437284),je=n(905365),Ge=n(826973),Ve=function(){function e(e){this.store=e,this.serviceSettingsChange=new We.t,this.store.register(je.e.Services,[]).subscribe(this.serviceSettingsChange)}return e.prototype.subscribeToSettingServicesChange=function(){this.serviceSettingsChange.subscribe((function(e){null==e||e.forEach((function(e){return S.Am.get(e)}))}))},e}();Ve=(0,Me.__decorate)([(0,Ge.t)(),(0,Me.__metadata)("design:paramtypes",[He.O])],Ve);var ze=function(){function e(){this.version="2.6.10";var e=ke.I.getMetadata(this);e&&this.settings.set(e)}return e.prototype.callHook=function(e){for(var t,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var o=(null!==(t=this.settings.mount)&&void 0!==t?t:{}).extensions;return(void 0===o?[]:o).forEach((function(t){var r=S.Am.get(t);r[e]&&r[e].apply(r,(0,Me.__spreadArray)([],(0,Me.__read)(n),!1))})),e in this?this[e].apply(this,(0,Me.__spreadArray)([],(0,Me.__read)(n),!1)):"not implemented"},e.prototype.start=function(){return(0,Me.__awaiter)(this,void 0,void 0,(function(){var e;return(0,Me.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,7,,8]),[4,this.callHook("$onInit")];case 1:return t.sent(),this.initServices(),this.initMiddlewares(),[4,this.callHook("$onMount")];case 2:return t.sent(),[4,this.mount()];case 3:return t.sent(),[4,this.callHook("$afterControllersInit")];case 4:return t.sent(),[4,this.attach()];case 5:return t.sent(),[4,this.callHook("$onReady")];case 6:return t.sent(),[3,8];case 7:if(e=t.sent(),"not implemented"===this.callHook("$onWorkbenchInitError",e))throw e;return[3,8];case 8:return[2]}}))}))},e.prototype.getComponent=function(){return this.startUpServive.getComponent()},e.prototype.initServices=function(){var e;S.Am.get(De.A),S.Am.get(xe.M),this.startUpServive.initServices(this.settings),S.Am.get(Oe.H),S.Am.get(Be.E),S.Am.get(Ue._),this.settings.useLogger&&this.settings.useLogger!==Pe.r&&(Pe.r.use=this.settings.useLogger),this.settings.useLogger?Pe.r.info("workbenchVersion:".concat(this.version)):console.info("workbenchVersion:".concat(this.version)),null===(e=this.settings.mount.services)||void 0===e||e.forEach((function(e){return S.Am.get(e)}))},e.prototype.initMiddlewares=function(){var e=S.Am.get(Ne.K);this.startUpServive.initMiddlewares(e,this.settings),e.$onInit()},e.prototype.attach=function(){return(0,Me.__awaiter)(this,void 0,void 0,(function(){return(0,Me.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.startUpServive.attach(this.settings.container)];case 1:return e.sent(),[2]}}))}))},e.prototype.mount=function(){return(0,Me.__awaiter)(this,void 0,void 0,(function(){var e=this;return(0,Me.__generator)(this,(function(t){return[2,new Promise((function(t){setTimeout((function(){S.Am.get(Oe.H).subscribeToControllerChange(),S.Am.get(Fe.U).subscribeToFeatureChange(),S.Am.get(Ve).subscribeToSettingServicesChange(),e.settings.addMountSettings(e.settings.mount),t()}),0)}))]}))}))},e}();(0,Me.__decorate)([(0,S.tB)(),(0,Me.__metadata)("design:type",ke.I)],ze.prototype,"settings",void 0),(0,Me.__decorate)([(0,S.tB)(Le),(0,Me.__metadata)("design:type",Object)],ze.prototype,"startUpServive",void 0);var Qe=n(87363),Ye=n.n(Qe),Ze=n(661533),Ke=n.n(Ze),Je=n(199235),qe=n(678464),Xe="editor-zone_editor-zone__1Mk-B",$e="editor-zone_grid___TyIk",et="editor-zone_float-widgets__1ZThR";(0,qe.Z)(".editor-zone_editor-zone__1Mk-B {\n  position: absolute;\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  transition: margin 0.3s ease;\n  z-index: 1200;\n}\n.editor-zone_grid___TyIk {\n  display: flex;\n  width: 100%;\n  height: 100%;\n}\n.editor-zone_grid___TyIk.editor-zone_editor-zone__1Mk-B {\n  width: auto;\n  height: auto;\n}\n.editor-zone_float-widgets__1ZThR {\n  position: absolute;\n  left: 0;\n  top: 0;\n  bottom: 0;\n  transition: margin 0.3s ease;\n  pointer-events: none;\n  z-index: 1500;\n}\n#workbench-float-widgets-lower.editor-zone_float-widgets__1ZThR {\n  z-index: 1250;\n}\n#workbench-float-widgets-middle.editor-zone_float-widgets__1ZThR {\n  z-index: 1325;\n}\n");var tt=n(725771),nt=n(996391),rt=n(797811),ot=n(699374),it="widget_widget__2xcrt";(0,qe.Z)(".widget_widget__2xcrt {\n  pointer-events: all;\n}\n");var at=n(386764),st=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,Me.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.children,n=e.style,r=void 0===n?{}:n,o=e.visibilityTransition,i=e.visible,a=Object.assign({},r);o||(a.display=void 0===i||i?"block":"none");var s=Ye().createElement("div",{className:it,style:a},Ye().createElement(ot.S,null,Ye().cloneElement(t,t.props)));return o?function(e,t){var n=t.visibilityTransition;return Ye().createElement(at.ZP,{in:!!t.visible,timeout:n.duration},(function(t){var r=e.props.style||{},o=Object.assign(Object.assign({},r),n[t]);return Ye().cloneElement(e,Object.assign(Object.assign({},e.props),{style:o}))}))}(s,this.props):s},t}(Ye().PureComponent),ct="surface_editor-wrapper__39Ndg",lt="surface_stack-view__3UVPj",ut="surface_hide__36RO-";(0,qe.Z)(".surface_editor-wrapper__39Ndg {\n  width: 100%;\n  height: 100%;\n  position: relative;\n}\n.surface_stack-view__3UVPj {\n  width: 100%;\n  height: 100%;\n  -webkit-user-select: text;\n     -moz-user-select: text;\n          user-select: text;\n  display: flex;\n}\n.surface_stack-view__3UVPj.surface_hide__36RO- {\n  display: none;\n}\n");var dt,pt=n(947229),ft=n(836072),ht=n(507342),mt=[],gt="ResizeObserver loop completed with undelivered notifications.";!function(e){e.BORDER_BOX="border-box",e.CONTENT_BOX="content-box",e.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"}(dt||(dt={}));var vt,_t=function(e){return Object.freeze(e)},yt=function(e,t){this.inlineSize=e,this.blockSize=t,_t(this)},bt=function(){function e(e,t,n,r){return this.x=e,this.y=t,this.width=n,this.height=r,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,_t(this)}return e.prototype.toJSON=function(){var e=this;return{x:e.x,y:e.y,top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height}},e.fromRect=function(t){return new e(t.x,t.y,t.width,t.height)},e}(),Et=function(e){return e instanceof SVGElement&&"getBBox"in e},Ct=function(e){if(Et(e)){var t=e.getBBox(),n=t.width,r=t.height;return!n&&!r}var o=e,i=o.offsetWidth,a=o.offsetHeight;return!(i||a||e.getClientRects().length)},wt=function(e){var t,n;if(e instanceof Element)return!0;var r=null===(n=null===(t=e)||void 0===t?void 0:t.ownerDocument)||void 0===n?void 0:n.defaultView;return!!(r&&e instanceof r.Element)},Tt="undefined"!=typeof window?window:{},At=new WeakMap,St=/auto|scroll/,It=/^tb|vertical/,Rt=/msie|trident/i.test(Tt.navigator&&Tt.navigator.userAgent),Mt=function(e){return parseFloat(e||"0")},Ot=function(e,t,n){return void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=!1),new yt((n?t:e)||0,(n?e:t)||0)},Nt=_t({devicePixelContentBoxSize:Ot(),borderBoxSize:Ot(),contentBoxSize:Ot(),contentRect:new bt(0,0,0,0)}),kt=function(e,t){if(void 0===t&&(t=!1),At.has(e)&&!t)return At.get(e);if(Ct(e))return At.set(e,Nt),Nt;var n=getComputedStyle(e),r=Et(e)&&e.ownerSVGElement&&e.getBBox(),o=!Rt&&"border-box"===n.boxSizing,i=It.test(n.writingMode||""),a=!r&&St.test(n.overflowY||""),s=!r&&St.test(n.overflowX||""),c=r?0:Mt(n.paddingTop),l=r?0:Mt(n.paddingRight),u=r?0:Mt(n.paddingBottom),d=r?0:Mt(n.paddingLeft),p=r?0:Mt(n.borderTopWidth),f=r?0:Mt(n.borderRightWidth),h=r?0:Mt(n.borderBottomWidth),m=d+l,g=c+u,v=(r?0:Mt(n.borderLeftWidth))+f,_=p+h,y=s?e.offsetHeight-_-e.clientHeight:0,b=a?e.offsetWidth-v-e.clientWidth:0,E=o?m+v:0,C=o?g+_:0,w=r?r.width:Mt(n.width)-E-b,T=r?r.height:Mt(n.height)-C-y,A=w+m+b+v,S=T+g+y+_,I=_t({devicePixelContentBoxSize:Ot(Math.round(w*devicePixelRatio),Math.round(T*devicePixelRatio),i),borderBoxSize:Ot(A,S,i),contentBoxSize:Ot(w,T,i),contentRect:new bt(d,c,w,T)});return At.set(e,I),I},Lt=function(e,t,n){var r=kt(e,n),o=r.borderBoxSize,i=r.contentBoxSize,a=r.devicePixelContentBoxSize;switch(t){case dt.DEVICE_PIXEL_CONTENT_BOX:return a;case dt.BORDER_BOX:return o;default:return i}},Dt=function(e){var t=kt(e);this.target=e,this.contentRect=t.contentRect,this.borderBoxSize=_t([t.borderBoxSize]),this.contentBoxSize=_t([t.contentBoxSize]),this.devicePixelContentBoxSize=_t([t.devicePixelContentBoxSize])},Pt=function(e){if(Ct(e))return 1/0;for(var t=0,n=e.parentNode;n;)t+=1,n=n.parentNode;return t},xt=function(){var e=1/0,t=[];mt.forEach((function(n){if(0!==n.activeTargets.length){var r=[];n.activeTargets.forEach((function(t){var n=new Dt(t.target),o=Pt(t.target);r.push(n),t.lastReportedSize=Lt(t.target,t.observedBox),o<e&&(e=o)})),t.push((function(){n.callback.call(n.observer,r,n.observer)})),n.activeTargets.splice(0,n.activeTargets.length)}}));for(var n=0,r=t;n<r.length;n++)(0,r[n])();return e},Ft=function(e){mt.forEach((function(t){t.activeTargets.splice(0,t.activeTargets.length),t.skippedTargets.splice(0,t.skippedTargets.length),t.observationTargets.forEach((function(n){n.isActive()&&(Pt(n.target)>e?t.activeTargets.push(n):t.skippedTargets.push(n))}))}))},Bt=function(){var e,t=0;for(Ft(t);mt.some((function(e){return e.activeTargets.length>0}));)t=xt(),Ft(t);return mt.some((function(e){return e.skippedTargets.length>0}))&&("function"==typeof ErrorEvent?e=new ErrorEvent("error",{message:gt}):((e=document.createEvent("Event")).initEvent("error",!1,!1),e.message=gt),window.dispatchEvent(e)),t>0},Ut=[],Ht=function(e){if(!vt){var t=0,n=document.createTextNode("");new MutationObserver((function(){return Ut.splice(0).forEach((function(e){return e()}))})).observe(n,{characterData:!0}),vt=function(){n.textContent=""+(t?t--:t++)}}Ut.push(e),vt()},Wt=0,jt={attributes:!0,characterData:!0,childList:!0,subtree:!0},Gt=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],Vt=function(e){return void 0===e&&(e=0),Date.now()+e},zt=!1,Qt=new(function(){function e(){var e=this;this.stopped=!0,this.listener=function(){return e.schedule()}}return e.prototype.run=function(e){var t=this;if(void 0===e&&(e=250),!zt){zt=!0;var n,r=Vt(e);n=function(){var n=!1;try{n=Bt()}finally{if(zt=!1,e=r-Vt(),!Wt)return;n?t.run(1e3):e>0?t.run(e):t.start()}},Ht((function(){requestAnimationFrame(n)}))}},e.prototype.schedule=function(){this.stop(),this.run()},e.prototype.observe=function(){var e=this,t=function(){return e.observer&&e.observer.observe(document.body,jt)};document.body?t():Tt.addEventListener("DOMContentLoaded",t)},e.prototype.start=function(){var e=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),Gt.forEach((function(t){return Tt.addEventListener(t,e.listener,!0)})))},e.prototype.stop=function(){var e=this;this.stopped||(this.observer&&this.observer.disconnect(),Gt.forEach((function(t){return Tt.removeEventListener(t,e.listener,!0)})),this.stopped=!0)},e}()),Yt=function(e){!Wt&&e>0&&Qt.start(),!(Wt+=e)&&Qt.stop()},Zt=function(){function e(e,t){this.target=e,this.observedBox=t||dt.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return e.prototype.isActive=function(){var e,t=Lt(this.target,this.observedBox,!0);return e=this.target,Et(e)||function(e){switch(e.tagName){case"INPUT":if("image"!==e.type)break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1}(e)||"inline"!==getComputedStyle(e).display||(this.lastReportedSize=t),this.lastReportedSize.inlineSize!==t.inlineSize||this.lastReportedSize.blockSize!==t.blockSize},e}(),Kt=function(e,t){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=e,this.callback=t},Jt=new WeakMap,qt=function(e,t){for(var n=0;n<e.length;n+=1)if(e[n].target===t)return n;return-1},Xt=function(){function e(){}return e.connect=function(e,t){var n=new Kt(e,t);Jt.set(e,n)},e.observe=function(e,t,n){var r=Jt.get(e),o=0===r.observationTargets.length;qt(r.observationTargets,t)<0&&(o&&mt.push(r),r.observationTargets.push(new Zt(t,n&&n.box)),Yt(1),Qt.schedule())},e.unobserve=function(e,t){var n=Jt.get(e),r=qt(n.observationTargets,t),o=1===n.observationTargets.length;r>=0&&(o&&mt.splice(mt.indexOf(n),1),n.observationTargets.splice(r,1),Yt(-1))},e.disconnect=function(e){var t=this,n=Jt.get(e);n.observationTargets.slice().forEach((function(n){return t.unobserve(e,n.target)})),n.activeTargets.splice(0,n.activeTargets.length)},e}(),$t=function(){function e(e){if(0===arguments.length)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if("function"!=typeof e)throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");Xt.connect(this,e)}return e.prototype.observe=function(e,t){if(0===arguments.length)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!wt(e))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");Xt.observe(this,e,t)},e.prototype.unobserve=function(e){if(0===arguments.length)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!wt(e))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");Xt.unobserve(this,e)},e.prototype.disconnect=function(){Xt.disconnect(this)},e.toString=function(){return"function ResizeObserver () { [polyfill code] }"},e}(),en=ht.U.ResizeObserver||$t,tn=n(745683),nn=n(996965),rn=n(166595),on=(0,tt.x)([je.R.DisableToolbar,je.R.ToolbarAlignment,je.R.SupportNativeDomScrolling,nt.j.EmbedWidget,nt.j.EmbedWidgetContainer],!0)((function(e){var t=e.children,n=e.embedWidget,r=e.id,o=e.forwardRef,i=e.embedWidgetContainer,a=e[je.R.SupportNativeDomScrolling],s=n.filter((function(e){return e.surface===r||null===e.surface})).map((function(e){return Ye().createElement(st,{key:"embed-".concat(e.name),style:e.styles,visible:!0},e.component)})),c=a?{overflow:"auto",scrollbarGutter:"stable"}:{};return Ye().createElement("div",{className:ct,ref:o,style:c},t,i[r]?(0,Ze.createPortal)(s,i[r]):s)})),an=function(e){function t(t){var n=e.call(this,t)||this;return n.node=Ye().createRef(),n.wrapperNode=Ye().createRef(),n}return(0,Me.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;this.sensor=new en((function(){e.bindResizeCallback()})),this.fireDomChangedNotification()},t.prototype.componentDidUpdate=function(){this.fireDomChangedNotification()},t.prototype.getSnapshotBeforeUpdate=function(){var e,t;return document.activeElement&&this.node.current&&(e=this.node.current,t=document.activeElement,e.contains(t)||e===t)?this.props.focusStream.next(!0):this.props.focusStream.next(!1),null},t.prototype.fireDomChangedNotification=function(){this.wrapperNode.current&&(this.sensor.disconnect(),this.sensor.observe(this.wrapperNode.current)),this.node.current?this.props.stream.next(this.node.current):this.props.stream.error(null)},t.prototype.componentWillUnmount=function(){this.props.stream.complete(),this.sensor.disconnect(),this.props.focusStream.complete()},t.prototype.bindResizeCallback=function(){var e,t=this,n=!1,r=function(){var o,i=null===(o=t.wrapperNode.current)||void 0===o?void 0:o.getBoundingClientRect();if(i){var a=i.width,s=i.height;n&&!t.isWrapperSizeChanged(a,s)?(t.eventEmitter.emit(ft.c.SurfaceSizeChanged),n=!1,e&&(window.cancelAnimationFrame(e),e=void 0)):t.isWrapperSizeChanged(a,s)&&(n=!0,e=window.requestAnimationFrame(r)),t.lastTimeRect=i}};window.requestAnimationFrame(r)},t.prototype.isWrapperSizeChanged=function(e,t){return!this.lastTimeRect||this.lastTimeRect.width!==e||this.lastTimeRect.height!==t},t.prototype.getWrapper=function(e){var t,n,r=(0,Me.__read)(e),o=r[0],i=r.slice(1);return o?(null!==(t=o.surface)&&void 0!==t?t:this.props.id)!==this.props.id?this.getWrapper(i):Ye().createElement(ot.S,null,Ye().cloneElement(o.component,Object.assign(Object.assign({},o.component.props),{key:"wrapper-".concat(o.name),children:null!==(n=this.getWrapper(i))&&void 0!==n?n:o.component.props.children}))):null},t.prototype.render=function(){var e=this,t={name:"surface-wrapper",priority:0,component:Ye().createElement(on,{id:this.props.id,forwardRef:this.wrapperNode})},n=ht.s&&this.props.ssrChildren?{__html:this.props.ssrChildren}:void 0,r={name:"surface-child",priority:-1/0,component:Ye().createElement("div",{id:this.props.id,ref:this.node,style:{minHeight:"100%",height:"100%",width:"100%"},onContextMenu:function(t){t.currentTarget.contains(t.target)&&e.eventEmitter.emit(ft.c.BeforeContextMenu,t)}})};n&&(r.component=Ye().cloneElement(r.component,{dangerouslySetInnerHTML:n}));var o=[lt];this.props.show||o.push(ut);var i=Ye().createElement("div",{className:o.join(" ")},Ye().createElement(tn.Kk.Provider,{value:{$grid:this.props.grid,$surface:this.props.id,evaluateWithContext:function(t,n){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];if(t instanceof rn.rM){var i=e.surfaceService.getEditor(e.props.id);t.setContext({editor:i})}return nn.k.apply(void 0,(0,Me.__spreadArray)([t,n],(0,Me.__read)(r),!1))}}},this.getWrapper(this.props.wrapWidget.concat(t,r))));return this.props.targetDom?Ke().createPortal(i,this.props.targetDom):i},t}(Ye().PureComponent);(0,Me.__decorate)([(0,S.tB)(),(0,Me.__metadata)("design:type",pt.v)],an.prototype,"eventEmitter",void 0),(0,Me.__decorate)([(0,S.tB)(),(0,Me.__metadata)("design:type",rt.W)],an.prototype,"surfaceService",void 0);var sn=(0,tt.x)([nt.j.WrapWidget],!0)(an),cn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,Me.__extends)(t,e),t.prototype.render=function(){var e,n,r,o,i,a=this,s=(null!==(n=null===(e=this.props.grids)||void 0===e?void 0:e.length)&&void 0!==n?n:0)>0,c={id:"grid-".concat(this.props.id),className:"".concat($e," ").concat(this.props.className," grid-").concat(this.props.type),style:this.props.style},l=s?null===(r=this.props.grids)||void 0===r?void 0:r.map((function(e,n,r){return Ye().createElement(t,Object.assign({mode:a.props.mode,key:e.id,style:{width:"".concat(100/r.length,"%")},isHidden:"stack"===a.props.type&&a.props.stackCurrent!==e.id},e))})):null===(o=this.props.surfaces)||void 0===o?void 0:o.map((function(e){return Ye().createElement(sn,Object.assign({mode:a.props.mode,show:e.visible,key:e.id},e))})),u=null!==(i=this.props.style)&&void 0!==i?i:{};return this.props.isHidden&&(u.display="none"),l?Ye().createElement("div",Object.assign({},c,{style:u}),l):null},t}(Qe.Component);cn.contextType=Je.FN,cn.defaultProps={className:""};var ln=n(378825),un=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,Me.__extends)(t,e),t.prototype.render=function(){var e,t,n,r,o=this,i=(0,ln.vM)(this.props.floatWidget,"layer","upper");return Ye().createElement(Ye().Fragment,null,Ye().createElement(cn,Object.assign({},this.props.surface,{mode:this.props.mode,className:Xe,style:{paddingLeft:this.props["editorZone.paddingLeft"],paddingRight:this.props["editorZone.paddingRight"],paddingTop:this.props["editorZone.paddingTop"],paddingBottom:this.props["editorZone.paddingBottom"],marginLeft:this.props.editorZoneMarginLeft,marginRight:this.props.editorZoneMarginRight}})),Ye().createElement(cn,Object.assign({},this.props.floatSurface,{mode:this.props.mode,style:Object.assign({display:(null!==(t=null===(e=this.props.floatSurface.surfaces)||void 0===e?void 0:e.length)&&void 0!==t?t:0)>0||(null!==(r=null===(n=this.props.floatSurface.grids)||void 0===n?void 0:n.length)&&void 0!==r?r:0)>0?"block":"none",zIndex:1300},this.props.floatSurfaceStyle)})),Object.keys(i).map((function(e){var t=i[e];return Ye().createElement("div",{key:e,id:"upper"!==e?"workbench-float-widgets-".concat(e):"workbench-float-widgets",className:et,style:{marginLeft:o.props.editorZoneMarginLeft,marginRight:o.props.editorZoneMarginRight}},t.map((function(e){return Ye().createElement(st,Object.assign({key:"float-".concat(e.name),style:e.styles,visibilityTransition:e.visibilityTransition},e.props,{visible:void 0===e.visible||e.visible}),e.component)})))})))},t}(Qe.Component),dn=(0,tt.x)([nt.j.Surface,nt.j.FloatSurface,nt.j.FloatSurfaceStyle,nt.j.FloatWidget,nt.j.EditorZoneMarginLeft,nt.j.EditorZoneMarginRight,je.R.PaddingLeft,je.R.PaddingRight,je.R.PaddingTop,je.R.PaddingBottom],!0)(un),pn="statusbar_statusbar-wrapper__3jAPj",fn="statusbar_statusbar-pusher__AmxFt",hn="statusbar_status-bar-component-wrapper__NwnZ7",mn="statusbar_static__2Ro1E",gn="statusbar_active__2HYrG";(0,qe.Z)('.statusbar_statusbar-wrapper__3jAPj {\n  padding: 0 16px;\n  display: flex;\n  height: 100%;\n  background-color: var(--workbench-theme-statusbar-background, #f0f0f0);\n  border-top: 1px solid var(--workbench-theme-statusbar-border, rgba(0, 0, 0, 0.04));\n  align-items: center;\n  transition: background-color 0.3s ease;\n  will-change: transform;\n}\n.statusbar_statusbar-wrapper__3jAPj > .statusbar_statusbar-pusher__AmxFt {\n  margin: 0 auto;\n}\n.statusbar_statusbar-wrapper__3jAPj > .statusbar_status-bar-component-wrapper__NwnZ7 {\n  margin: 0 6px;\n  color: var(--workbench-theme-statusbar-text-color, var(--workbench-theme-statusbar-foreground, #000000));\n  border-radius: 2px;\n  min-width: 24px;\n  min-height: 24px;\n  position: relative;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n}\n.statusbar_statusbar-wrapper__3jAPj > .statusbar_status-bar-component-wrapper__NwnZ7:first-child {\n  margin-left: 0;\n}\n.statusbar_statusbar-wrapper__3jAPj > .statusbar_status-bar-component-wrapper__NwnZ7:last-child {\n  margin-right: 0;\n}\n.statusbar_statusbar-wrapper__3jAPj > .statusbar_status-bar-component-wrapper__NwnZ7:not(.statusbar_static__2Ro1E):hover {\n  background-color: var(--workbench-theme-statusbar-hover-background, var(--workbench-theme-global-button-hover, rgba(0, 0, 0, 0.04)));\n}\n.statusbar_statusbar-wrapper__3jAPj > .statusbar_status-bar-component-wrapper__NwnZ7.statusbar_active__2HYrG,\n.statusbar_statusbar-wrapper__3jAPj > .statusbar_status-bar-component-wrapper__NwnZ7:not(.statusbar_static__2Ro1E):active {\n  background-color: var(--workbench-theme-statusbar-active-background, var(--workbench-theme-global-button-active, rgba(0, 0, 0, 0.08)));\n}\n.statusbar_statusbar-wrapper__3jAPj > .statusbar_status-bar-component-wrapper__NwnZ7 svg path.secondary {\n  fill: var(--workbench-theme-statusbar-icon-secondary-color, var(--workbench-theme-global-icon-secondary-color, currentColor)) !important;\n  opacity: var(--workbench-theme-statusbar-icon-secondary-color-opacity, var(--workbench-theme-global-icon-secondary-color-opacity, 0.4));\n}\n.statusbar_statusbar-wrapper__3jAPj > .statusbar_status-bar-component-wrapper__NwnZ7 svg path[fill]:not(g[fill="none"]),\n.statusbar_statusbar-wrapper__3jAPj > .statusbar_status-bar-component-wrapper__NwnZ7 svg g[fill]:not(g[fill="none"]),\n.statusbar_statusbar-wrapper__3jAPj > .statusbar_status-bar-component-wrapper__NwnZ7 path.primary {\n  fill: var(--workbench-theme-statusbar-icon-primary-color, var(--workbench-theme-global-icon-primary-color, currentColor)) !important;\n}\n.statusbar_statusbar-wrapper__3jAPj > .statusbar_status-bar-component-wrapper__NwnZ7 path.primary {\n  opacity: var(--workbench-theme-statusbar-icon-primary-color-opacity, var(--workbench-theme-global-icon-primary-color-opacity, 1));\n}\n.statusbar_statusbar-wrapper__3jAPj > .statusbar_status-bar-component-wrapper__NwnZ7 svg path[stroke]:not(g[stroke="none"]),\n.statusbar_statusbar-wrapper__3jAPj > .statusbar_status-bar-component-wrapper__NwnZ7 svg g[stroke]:not(g[stroke="none"]) {\n  stroke: var(--workbench-theme-statusbar-icon-primary-color, var(--workbench-theme-global-icon-primary-color, currentColor)) !important;\n}\n.statusbar_edge-right-tooltip__1JWl8.statusbar_dui-tooltip-content__2Ln9N {\n  transform: translate(-35%) !important;\n}\n');var vn=n(750720),_n=n(731168),yn=n(694469),bn=function(e){function t(){var t=e.apply(this,(0,Me.__spreadArray)([],(0,Me.__read)(arguments),!1))||this;return t.handleClick=function(e){var n,r;t.props.preventOriginalClick&&e.stopPropagation(),t.props.disabled||(t.props.badge&&t.badgeService.removeBadgeOn("statusbar",t.props.name),(0,rn.Mf)(t.props.onClick,e),null===(r=(n=t.props).onClick)||void 0===r||r.call(n))},t}return(0,Me.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.content,n=e.style,r=null!=n?n:{},o=this.props,i=o.disabled,a=o.tooltip,s=o.badge,c=o.ariaLabel,l=t;Ye().isValidElement(l)&&(l=Ye().cloneElement(l,{disabled:i}));var u=[hn];return this.props.active&&u.push(gn),this.props.preventHighlight&&u.push(mn),Ye().createElement("div",{onClickCapture:this.handleClick,className:u.join(" "),style:Object.assign(Object.assign({},r),{opacity:i?.3:1,pointerEvents:i?"none":"auto"}),role:"button","aria-checked":this.props.active,"aria-label":null!=c?c:a},Ye().createElement(vn.Tooltip,{placement:"top",title:a,disabled:!a},Ye().createElement(_n.ZP,{dot:s,style:{transform:"scale(0.6)",top:-1,right:-3,border:"none",transformOrigin:"top right"}},t)))},t}(Qe.PureComponent);(0,Me.__decorate)([(0,S.tB)(yn.c),(0,Me.__metadata)("design:type",Object)],bn.prototype,"badgeService",void 0);var En=n(733036),Cn=function(e){function t(){var t=e.apply(this,(0,Me.__spreadArray)([],(0,Me.__read)(arguments),!1))||this;return t.shouldHide=function(e){return(0,nn.k)(e.shouldHide,!1)},t.haveBadge=function(e){return t.props.badge.some((function(t){return t.key===e.name&&"statusbar"===t.position}))},t.getComponent=function(e,n){var r=e.content,o=e.name,i=t.shouldHide(e);return r&&!i?Ye().createElement(ot.S,{key:e.name},Ye().createElement(bn,Object.assign({},function(e){return Object.assign(Object.assign({},e),{tooltip:(0,nn.k)(e.tooltip,""),disabled:(0,nn.k)(e.shouldDisabled,!1),style:(0,nn.k)(e.style,void 0),active:(0,nn.k)(e.shouldCheck,!1),content:(0,nn.k)(e.content,void 0)})}(e),{badge:t.haveBadge(e)}))):"divider"===o?Ye().createElement(bn,{key:"".concat(e.name,"-").concat(n),name:"".concat(e.name,"-").concat(n),style:{margin:"0 8px",minWidth:1},preventHighlight:!0,content:Ye().createElement(En.ZP,{style:{borderRight:"1px solid var(--workbench-theme-statusbar-border)",margin:0},orientation:"vertical"})}):null},t}return(0,Me.__extends)(t,e),t.prototype.render=function(){return Ye().createElement("div",{className:pn,role:"toolbar","aria-label":"状态栏"},this.props.statusbar.left.map(this.getComponent),Ye().createElement("div",{className:fn}),this.props.statusbar.right.map(this.getComponent))},t}(Qe.PureComponent);Cn.contextType=Je.FN;var wn=(0,tt.x)([nt.j.Statusbar,nt.j.Badge])(Cn),Tn="pc_workbench-pc__2qtjl",An="pc_header__3i0cL",Sn="pc_container__3evvF",In="pc_float__3qJL6",Rn="pc_footer__33sHn";(0,qe.Z)(".pc_workbench-pc__2qtjl {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  box-sizing: border-box;\n}\n.pc_workbench-pc__2qtjl .pc_header__3i0cL {\n  flex-shrink: 0;\n  border-bottom: 1px solid var(--workbench-theme-toolbar-border-without-drawer, transparent);\n  background-color: var(--workbench-theme-toolbar-background, #f9fafb);\n  position: relative;\n  z-index: 1300;\n}\n.pc_workbench-pc__2qtjl .pc_header__3i0cL .pc_hidden__sN0uV {\n  position: absolute;\n  top: -1000px;\n  width: 100%;\n  display: flex;\n  flex-direction: row;\n  flex-wrap: nowrap;\n}\n.pc_workbench-pc__2qtjl .pc_container__3evvF {\n  position: relative;\n  height: 100%;\n  transition: all 0.3s ease;\n  transform-origin: 0 0;\n  -webkit-overflow-scrolling: touch;\n  display: flex;\n  justify-content: center;\n  background: var(--workbench-theme-editor-zone-background, #f9fafb);\n  -webkit-backdrop-filter: var(--workbench-theme-editor-zone-background-filter, none);\n          backdrop-filter: var(--workbench-theme-editor-zone-background-filter, none);\n}\n.pc_workbench-pc__2qtjl .pc_container__3evvF .pc_float__3qJL6 {\n  position: absolute;\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n}\n.pc_workbench-pc__2qtjl .pc_footer__33sHn {\n  height: auto;\n  width: 100%;\n  box-sizing: border-box;\n}\n");var Mn=n(751501),On={"drawer-container":"drawer_drawer-container__3f319","drawer-left":"drawer_drawer-left__1b2sS","drawer-right":"drawer_drawer-right__2gb6H",drawer:"drawer_drawer__2yRyg","animation-transform":"drawer_animation-transform__2KY05","animation-fade":"drawer_animation-fade__BhwlB",transparent:"drawer_transparent__13y6s","before-open":"drawer_before-open__3jmHf","after-close":"drawer_after-close__2KKbu",closing:"drawer_closing__14zYI",fade:"drawer_fade__2KWMg","after-open":"drawer_after-open__2rUxp","before-close":"drawer_before-close__1okJ8",opening:"drawer_opening__ir3ot","drawer-title":"drawer_drawer-title__29ZP4","drawer-close-button":"drawer_drawer-close-button__W_Uf6","drawer-back-button":"drawer_drawer-back-button__3FUCn","draggable-edge":"drawer_draggable-edge__2oMAa","custom-buttons-container":"drawer_custom-buttons-container__mEw_B","custom-button":"drawer_custom-button__eTiC6"};(0,qe.Z)('.drawer_drawer-container__3f319 {\n  position: absolute;\n  z-index: 1300;\n  top: 0;\n  bottom: 0;\n}\n.drawer_drawer-container__3f319.drawer_drawer-left__1b2sS {\n  left: 0;\n}\n.drawer_drawer-container__3f319.drawer_drawer-right__2gb6H {\n  right: 0;\n}\n.drawer_drawer__2yRyg {\n  position: absolute;\n  width: 280px;\n  height: 100%;\n  background: var(--workbench-theme-drawer-background, #f9fafb);\n  color: var(--workbench-theme-drawer-foreground, #000000);\n  box-sizing: border-box;\n  overflow: hidden;\n  display: none;\n}\n.drawer_drawer__2yRyg.drawer_animation-transform__2KY05 {\n  transition: transform 0.3s cubic-bezier(0.25, 0.1, 0.25, 1);\n}\n.drawer_drawer__2yRyg.drawer_animation-fade__BhwlB {\n  transition: transform 0.3s cubic-bezier(0.25, 0.1, 0.25, 1), opacity 0.3s cubic-bezier(0.25, 0.1, 0.25, 1);\n}\n.drawer_drawer__2yRyg.drawer_drawer-left__1b2sS {\n  left: 0;\n  transform: translateX(-100%);\n  border-right: 1px solid var(--workbench-theme-drawer-border, rgba(0, 0, 0, 0.06));\n}\n.drawer_drawer__2yRyg.drawer_drawer-right__2gb6H {\n  right: 0;\n  transform: translateX(100%);\n  border-left: 1px solid var(--workbench-theme-drawer-border, rgba(0, 0, 0, 0.06));\n}\n.drawer_drawer__2yRyg.drawer_transparent__13y6s {\n  background: transparent;\n  border-left: none;\n  border-right: none;\n}\n.drawer_drawer__2yRyg.drawer_before-open__3jmHf.drawer_drawer-left__1b2sS,\n.drawer_drawer__2yRyg.drawer_after-close__2KKbu.drawer_drawer-left__1b2sS,\n.drawer_drawer__2yRyg.drawer_closing__14zYI.drawer_drawer-left__1b2sS {\n  transform: translateX(-100%);\n}\n.drawer_drawer__2yRyg.drawer_before-open__3jmHf.drawer_drawer-right__2gb6H,\n.drawer_drawer__2yRyg.drawer_after-close__2KKbu.drawer_drawer-right__2gb6H,\n.drawer_drawer__2yRyg.drawer_closing__14zYI.drawer_drawer-right__2gb6H {\n  transform: translateX(100%);\n}\n.drawer_drawer__2yRyg.drawer_before-open__3jmHf,\n.drawer_drawer__2yRyg.drawer_closing__14zYI {\n  display: block;\n}\n.drawer_drawer__2yRyg.drawer_before-open__3jmHf.drawer_fade__2KWMg,\n.drawer_drawer__2yRyg.drawer_closing__14zYI.drawer_fade__2KWMg {\n  opacity: 0;\n}\n.drawer_drawer__2yRyg.drawer_before-open__3jmHf.drawer_fade__2KWMg.drawer_drawer-left__1b2sS,\n.drawer_drawer__2yRyg.drawer_closing__14zYI.drawer_fade__2KWMg.drawer_drawer-left__1b2sS {\n  transform: translateX(-40%);\n}\n.drawer_drawer__2yRyg.drawer_before-open__3jmHf.drawer_fade__2KWMg.drawer_drawer-right__2gb6H,\n.drawer_drawer__2yRyg.drawer_closing__14zYI.drawer_fade__2KWMg.drawer_drawer-right__2gb6H {\n  transform: translateX(40%);\n}\n.drawer_drawer__2yRyg.drawer_after-close__2KKbu {\n  display: none;\n}\n.drawer_drawer__2yRyg.drawer_after-close__2KKbu.drawer_fade__2KWMg {\n  opacity: 0;\n}\n.drawer_drawer__2yRyg.drawer_after-open__2rUxp,\n.drawer_drawer__2yRyg.drawer_before-close__1okJ8 {\n  display: block;\n  transform: none;\n}\n.drawer_drawer__2yRyg.drawer_after-open__2rUxp.drawer_fade__2KWMg,\n.drawer_drawer__2yRyg.drawer_before-close__1okJ8.drawer_fade__2KWMg {\n  opacity: 1;\n}\n.drawer_drawer__2yRyg.drawer_opening__ir3ot {\n  display: block;\n  transform: none !important;\n}\n.drawer_drawer__2yRyg.drawer_opening__ir3ot.drawer_fade__2KWMg {\n  opacity: 1;\n}\n.drawer_drawer__2yRyg.drawer_closing__14zYI.drawer_fade__2KWMg {\n  opacity: 0;\n}\n.drawer_drawer__2yRyg .drawer_drawer-title__29ZP4 {\n  padding: 17px 16px;\n  font-size: 16px;\n  font-weight: 600;\n  line-height: 22px;\n  display: flex;\n  color: var(--workbench-theme-drawer-foreground, rgba(0, 0, 0, 0.88));\n  font-weight: 500;\n}\n.drawer_drawer__2yRyg .drawer_drawer-close-button__W_Uf6 {\n  background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+RjNENTZBMjAtMzZDRC00RTM3LUI5OEYtMTAzQUNDRjlBQUQ4PC90aXRsZT4KICAgIDxnIGlkPSIyLjAiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSLnm67lvZUt5bGV5byAIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMjY0LjAwMDAwMCwgLTEyOC4wMDAwMDApIj4KICAgICAgICAgICAgPGcgaWQ9IkJhci/moIfpopjmoI8v5L6n6L655qCP5aSH5Lu9IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjAwMDAwMCwgMTEyLjAwMDAwMCkiPgogICAgICAgICAgICAgICAgPGcgaWQ9IklDT04v6L6F5Yqp5bCP5Zu+5qCHL+a4hemZpOi0puWPtyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjY0LjAwMDAwMCwgMTYuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICAgICAgPHJlY3QgaWQ9IuefqeW9oiIgc3Ryb2tlPSIjOTc5Nzk3IiBmaWxsPSIjRDhEOEQ4IiBvcGFjaXR5PSIwIiB4PSIwIiB5PSIwIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjwvcmVjdD4KICAgICAgICAgICAgICAgICAgICA8cG9seWdvbiBpZD0i6Lev5b6EIiBmaWxsPSIjODE4NjhGIiBwb2ludHM9IjguNjMxIDggMTMgMTIuMzY4MjI1MyAxMi4zNjgyMjUzIDEzIDcuOTk5IDguNjMxIDMuNjMxNzc0NzEgMTMgMyAxMi4zNjgyMjUzIDcuMzY4IDggMyAzLjYzMTc3NDcxIDMuNjMxNzc0NzEgMyA4IDcuMzY4IDEyLjM2ODIyNTMgMyAxMyAzLjYzMTc3NDcxIj48L3BvbHlnb24+CiAgICAgICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDwvZz4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==);\n  background-position: center;\n  background-size: 16px 16px;\n  background-repeat: no-repeat;\n  width: 24px;\n  height: 24px;\n  display: inline-block;\n  cursor: pointer;\n  position: absolute;\n  right: 16px;\n  top: 16px;\n  z-index: 999;\n}\n.drawer_drawer__2yRyg .drawer_drawer-close-button__W_Uf6:hover {\n  background-color: var(--workbench-theme-global-button-hover, rgba(0, 0, 0, 0.08));\n}\n.drawer_drawer__2yRyg .drawer_drawer-close-button__W_Uf6:active {\n  background-color: var(--workbench-theme-global-button-active, rgba(0, 0, 0, 0.08));\n}\n.drawer_drawer__2yRyg .drawer_drawer-back-button__3FUCn {\n  background-image: url("data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjQgMjQiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0ibTE0LjExNCA2IC44ODYuODdMOS43NzIgMTIgMTUgMTcuMTNsLS44ODYuODdMOCAxMmw2LjExNC02WiIgZmlsbD0iIzQ1NEQ1QSIvPjwvc3ZnPg==");\n  background-position: center;\n  background-size: 16px 16px;\n  background-repeat: no-repeat;\n  width: 22px;\n  height: 22px;\n  display: inline-block;\n  cursor: pointer;\n  margin-right: 17px;\n}\n.drawer_drawer__2yRyg .drawer_draggable-edge__2oMAa {\n  position: absolute;\n  top: 0;\n  width: 8px;\n  height: 100%;\n  cursor: col-resize;\n  background-color: transparent;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n          user-select: none;\n  z-index: 1;\n}\n.drawer_drawer__2yRyg .drawer_draggable-edge__2oMAa:hover {\n  transition: background-color 0.5s steps(1, end);\n  background-color: var(--workbench-theme-global-button-hover, rgba(0, 0, 0, 0.08));\n}\n.drawer_drawer__2yRyg .drawer_draggable-edge__2oMAa:active {\n  background-color: var(--workbench-theme-global-button-active, rgba(0, 0, 0, 0.16));\n}\n.drawer_drawer__2yRyg .drawer_custom-buttons-container__mEw_B {\n  position: absolute;\n  overflow-x: hidden;\n  right: 44px;\n  top: 16px;\n}\n.drawer_drawer__2yRyg .drawer_custom-buttons-container__mEw_B .drawer_custom-button__eTiC6 {\n  background-position: center;\n  background-size: 16px 16px;\n  background-repeat: no-repeat;\n  width: 24px;\n  height: 24px;\n  display: inline-block;\n  cursor: pointer;\n  z-index: 999;\n}\n.drawer_drawer__2yRyg .drawer_custom-buttons-container__mEw_B .drawer_custom-button__eTiC6:hover {\n  background-color: var(--workbench-theme-global-button-hover, rgba(0, 0, 0, 0.08));\n}\n.drawer_drawer__2yRyg .drawer_custom-buttons-container__mEw_B .drawer_custom-button__eTiC6:active {\n  background-color: var(--workbench-theme-global-button-active, rgba(0, 0, 0, 0.08));\n}\n.drawer_drawer__2yRyg .drawer_custom-buttons-container__mEw_B .drawer_custom-button__eTiC6:nth-child(n + 2) {\n  margin-left: 4px;\n}\n');var Nn=n(801031),kn={TRANSPARENT:(0,Nn.w)("transparent"),PANEL:(0,Nn.w)("panel")},Ln={SLIDE_IN:(0,Nn.w)("slideIn"),FADE_IN:(0,Nn.w)("fadeIn")};function Dn(e){return"object"==typeof e}var Pn=n(396144),xn=n(736575),Fn=function(e){var t,n=e.align,r=e.onDrag,o=e.onDragEnd,i=e.onDragStart,a="leftright".replace(n,""),s=(0,Me.__read)((0,Qe.useState)(""),2),c=s[0],l=s[1],u=(0,xn.c)({onDragStart:function(){null==i||i(),l("* { cursor: col-resize !important; } .".concat(Xe," { transition: none !important; }"))},onDragEnd:function(){null==o||o(),l("")},onDrag:function(e){var t=e.x;"left"===n?null==r||r(t):null==r||r(document.body.clientWidth-t)}}).refCallback;return Ye().createElement("div",{className:On["draggable-edge"],style:(t={},t[a]=-4,t),ref:u},Ye().createElement("style",{type:"text/css",media:"screen"},c))},Bn=function(e){function t(){var t=e.apply(this,(0,Me.__spreadArray)([],(0,Me.__read)(arguments),!1))||this;return t.transitionRef=Ye().createRef(),t.startWidth=0,t.setDrawerRef=function(e){t.drawerDom=e,t.props.forwardRef(e)},t.onDrawerEdgeDragStart=function(){var e,n;t.startWidth=null!==(n=null===(e=t.drawerDom)||void 0===e?void 0:e.clientWidth)&&void 0!==n?n:280},t.onDrawerEdgeDrag=function(e){var n,r,o,i=Dn(t.props.edgeDraggable)?t.props.edgeDraggable:{},a=i.minWidth,s=void 0===a?280:a,c=i.maxWidth,l=(n=e,void 0===(r=s)&&(r=0),void 0===(o=void 0===c?480:c)&&(o=100),Math.max(r,Math.min(n,o)));t.drawerService.updateCurrentDrawer(t.props.align,{style:Object.assign(Object.assign({},t.props.style),{width:l})},t.props.name),t.width=l},t.onDrawerEdgeDragEnd=function(){var e,n;t.width&&Dn(t.props.edgeDraggable)&&(null===(n=(e=t.props.edgeDraggable).onDragEnd)||void 0===n||n.call(e,t.width))},t}return(0,Me.__extends)(t,e),t.prototype.getWrapperClasses=function(){var e,t,n,r,o=[On.drawer,On["drawer-".concat(this.props.align)]];if(this.transitionRef.current){var i=this.transitionRef.current.appliedClasses;try{for(var a=(0,Me.__values)(Object.values(i)),s=a.next();!s.done;s=a.next()){var c=s.value;try{for(var l=(n=void 0,(0,Me.__values)(Object.values(c))),u=l.next();!u.done;u=l.next()){var d=u.value;o.push(d)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}}return this.props.animationDisabled||o.push(On["animation-transform"]),(this.props.type===kn.TRANSPARENT||!this.props.opened&&this.type===kn.TRANSPARENT)&&o.push(On.transparent),(this.props.animation===Ln.FADE_IN||!this.props.opened&&this.animation===Ln.FADE_IN)&&(o.push(On.fade),this.props.animationDisabled||o.push(On["animation-fade"])),o},t.prototype.getDrawerWidget=function(e,t,n){return t?Ye().createElement(st,{style:{maxHeight:"100%",overflow:"auto",height:"100%"},key:"drawer-".concat(this.props.align,"-").concat(n),visible:e},t):null},t.prototype.getContents=function(){var e,t,n=this,r=null===(t=(0,Me.__spreadArray)([],(0,Me.__read)((null===(e=this.props.hiddenContents)||void 0===e?void 0:e.values())||[]),!1))||void 0===t?void 0:t.map((function(e){return n.getDrawerWidget(!1,e.content,e.name)})),o=this.getDrawerWidget(!0,this.props.content,this.props.name);return(0,Me.__spreadArray)((0,Me.__spreadArray)([],(0,Me.__read)(r),!1),[o],!1)},t.prototype.render=function(){var e=this,t=this.props,n=t.align,r=t.type,o=t.animation,i=t.opened,a=t.edgeDraggable,s=t.style,c=t.animationDisabled,l=t.showCloseButton,u=t.title,d=t.titleStyle,p=t.closeButtonStyle,f=t.persistContents,h=t.usePersistContent,m=t.customHeaderButtonsConfig,g=t.onBack,v=t.onDrawerClose,_=t.onEnter,y=t.onEntered,b=t.onExit,E=t.onExited,C=this.getWrapperClasses();this.type=null!=r?r:kn.PANEL,this.animation=null!=o?o:Ln.SLIDE_IN;var w=null!=l?l:u;return Ye().createElement(Mn.Z,{in:i,timeout:c?0:300,appear:!0,classNames:{appear:On["before-open"],appearActive:On.opening,appearDone:On["after-open"],enter:On["before-open"],enterActive:On.opening,enterDone:On["after-open"],exit:On["before-close"],exitActive:On.closing,exitDone:On["after-close"]},onEnter:_,onEntered:y,onExit:b,onExited:E,ref:this.transitionRef},Ye().createElement("div",{ref:function(t){return e.setDrawerRef(t)},id:"workbench-drawer-".concat(n),className:C.join(" "),style:s,role:"complementary","aria-roledescription":"sidebar","aria-labelledby":"drawer-title-".concat(n)},a&&Ye().createElement(Fn,{align:n,onDrag:this.onDrawerEdgeDrag,onDragStart:this.onDrawerEdgeDragStart,onDragEnd:this.onDrawerEdgeDragEnd}),u&&Ye().createElement("div",{id:"drawer-title-".concat(n),className:On["drawer-title"],style:d},g?Ye().createElement("div",{className:On["drawer-back-button"],onClick:g}):null,(0,nn.k)(u,null)),Ye().createElement("div",{className:On["custom-buttons-container"]},null==m?void 0:m.map((function(e){var t=e.icon,n=e.name,r=e.ariaLabel,o=void 0===r?n:r,i=e.onClick,a=e.style;return Ye().createElement("div",{style:Object.assign(Object.assign({},a),{backgroundImage:"url(".concat(t,")")}),className:On["custom-button"],key:n,role:"button","aria-label":o,onClick:i})}))),w&&Ye().createElement("div",{className:On["drawer-close-button"],role:"button","aria-label":"Close sidebar",style:p,onClick:function(){v()}}),Ye().createElement("div",{id:"drawer-".concat(n,"-persist"),style:{height:"100%",display:h?"block":"none"}},(null!=f?f:[]).map((function(e){return Ye().createElement(st,{style:{maxHeight:"100%",overflow:"auto",height:"100%"},key:"drawer-".concat(n,"-persist-").concat(e.name),visible:e.name===h},e.content)}))),h?null:this.getContents()||null))},t}(Qe.Component);(0,Me.__decorate)([(0,S.tB)(),(0,Me.__metadata)("design:type",Pn.zv)],Bn.prototype,"drawerService",void 0);var Un=n(723180),Hn=n(515238),Wn=n(141519),jn=n(347839),Gn=n(623747),Vn=n(557112),zn=function(e){function t(t){var n=e.call(this,t)||this;return n.domSubject=new Hn.xQ,n.closingSubDrawers=[],n.setDrawerRef=function(e){n.drawerDom=e,n.domSubject.next(e)},n.closeDrawer=function(){n.drawerService.closeLeftDrawer()},n.closeSubDrawer=function(e){var t;n.drawerService.removeLeftSubDrawer(e.name),null===(t=e.onClose)||void 0===t||t.call(e);var r=n.closingSubDrawers.indexOf(e.name);r>=0&&n.closingSubDrawers.splice(r,1)},n.exitSubDrawer=function(e){n.closingSubDrawers.indexOf(e)<0&&n.closingSubDrawers.push(e),n.forceUpdate()},n.handleClick=function(e){var t,r,o=(null!==(t=n.props.leftDrawerInfo)&&void 0!==t?t:{}).onClickOutside;if(o&&n.drawerDom){var i=e.clientX,a=e.clientY,s=null===(r=n.drawerDom)||void 0===r?void 0:r.getBoundingClientRect(),c=s.top,l=s.left,u=s.right,d=s.bottom;(i<l||u<i||a<c||d<a)&&o()}},n.drawerService=S.Am.get(Pn.zv),n.handleVisibilityCallbackAfterRendered(),n}return(0,Me.__extends)(t,e),t.prototype.handleVisibilityCallbackAfterRendered=function(){var e=this,t=this.domSubject.pipe((0,Wn.x)()),n=new Hn.xQ;this.removeListenerWhenDrawerClose(n),t.pipe((0,jn.h)((function(e){return!!e})),(0,Gn.U)((function(){var t,n,r;return{visible:e.props.leftDrawerOpened,name:null===(t=e.props.leftDrawerInfo)||void 0===t?void 0:t.name,onOpen:null===(n=e.props.leftDrawerInfo)||void 0===n?void 0:n.onOpen,onClose:null===(r=e.props.leftDrawerInfo)||void 0===r?void 0:r.onClose}})),(0,Wn.x)((function(e,t){return e.name===t.name&&e.visible===t.visible})),(0,Vn.G)()).subscribe((function(t){var r,o,i,a=(0,Me.__read)(t,2),s=a[0],c=a[1];if(c.visible){if(s.name!==c.name)try{var l=e.context.store.getValue(nt.j.LeftDrawerStyle);e.drawerService.updateLeftDrawerStyle(null!=l?l:{}),null===(r=s.onClose)||void 0===r||r.call(s)}catch(e){Pe.r.error("Drawer ".concat(s.name," onClose has errors:\n").concat(e))}document.addEventListener("click",e.handleClick,!0);try{null===(o=c.onOpen)||void 0===o||o.call(c)}catch(e){Pe.r.error("Drawer ".concat(c.name," onOpen has errors:\n").concat(e))}}else{try{null===(i=c.onClose)||void 0===i||i.call(c)}catch(e){Pe.r.error("Drawer ".concat(c.name," onClose has errors:\n").concat(e))}n.next(!0)}}))},t.prototype.removeListenerWhenDrawerClose=function(e){var t=this;e.pipe((0,jn.h)((function(e){return e}))).subscribe((function(){document.removeEventListener("click",t.handleClick,!0),e.next(!1)}))},t.prototype.render=function(){var e,t,n=this,r=this.drawerService,o=r.onBeforeShowLeftDrawer,i=r.onBeforeCloseLeftDrawer,a=r.onAfterCloseLeftDrawer,s=r.onAfterShowLeftDrawer;return Ye().createElement("div",{className:[On["drawer-container"],On["drawer-left"]].join(" "),style:Object.assign(Object.assign({},this.props.leftDrawerStyle),{marginTop:this.props[nt.j.TitlebarDOMVisible]&&Un.w.isMobile()?44:"0"})},Ye().createElement(Bn,Object.assign({forwardRef:this.setDrawerRef,service:this.drawerService,align:"left",onDrawerClose:this.closeDrawer,onEnter:o,onEntered:s,onExit:i,onExited:a,opened:this.props.leftDrawerOpened,persistContents:this.props.leftDrawerPersistContent,hiddenContents:this.props.leftDrawerHiddenContent,animationDisabled:this.props.disableDrawerAnimation},this.props.leftDrawerInfo,{style:Object.assign(Object.assign({},null===(e=this.props.leftDrawerInfo)||void 0===e?void 0:e.style),{zIndex:0})})),(null!==(t=this.props.leftSubDrawerInfo)&&void 0!==t?t:[]).map((function(e,t){return Ye().createElement(Bn,Object.assign({forwardRef:function(){},key:e.name,service:n.drawerService,align:"right",onDrawerClose:function(){return n.exitSubDrawer(e.name)},onBack:function(){return n.exitSubDrawer(e.name)},opened:n.closingSubDrawers.indexOf(e.name)<0,animationDisabled:n.props.disableDrawerAnimation,onEntered:function(){var t;return null===(t=e.onOpen)||void 0===t?void 0:t.call(e)},onExited:function(){return n.closeSubDrawer(e)}},e,{style:Object.assign(Object.assign({},e.style),{zIndex:t+1})}))})))},t}(Qe.PureComponent);zn.contextType=Je.FN;var Qn=(0,tt.x)([nt.j.LeftDrawerInfo,nt.j.LeftDrawerOpened,nt.j.LeftDrawerStyle,nt.j.LeftDrawerPersistContent,nt.j.LeftDrawerHiddenContent,nt.j.TitlebarDOMVisible,nt.j.DisableDrawerAnimation,nt.j.LeftSubDrawerInfo],!0)(zn),Yn=function(e){function t(t){var n=e.call(this,t)||this;return n.domSubject=new Hn.xQ,n.closingSubDrawers=[],n.setDrawerRef=function(e){n.drawerDom=e,n.domSubject.next(e)},n.closeDrawer=function(){n.drawerService.closeRightDrawer()},n.closeSubDrawer=function(e){var t;n.drawerService.removeRightSubDrawer(e.name),null===(t=e.onClose)||void 0===t||t.call(e);var r=n.closingSubDrawers.indexOf(e.name);r>=0&&n.closingSubDrawers.splice(r,1)},n.exitSubDrawer=function(e){n.closingSubDrawers.indexOf(e)<0&&n.closingSubDrawers.push(e),n.forceUpdate()},n.handleClick=function(e){var t,r,o=(null!==(t=n.props.rightDrawerInfo)&&void 0!==t?t:{}).onClickOutside;if(o&&n.drawerDom){var i=e.clientX,a=e.clientY,s=null===(r=n.drawerDom)||void 0===r?void 0:r.getBoundingClientRect(),c=s.top,l=s.left,u=s.right,d=s.bottom;(i<l||u<i||a<c||d<a)&&o()}},n.drawerService=S.Am.get(Pn.zv),n.handleVisibilityCallbackAfterRendered(),n}return(0,Me.__extends)(t,e),t.prototype.handleVisibilityCallbackAfterRendered=function(){var e=this,t=this.domSubject.pipe((0,Wn.x)()),n=new Hn.xQ;this.removeListenerWhenDrawerClose(n),t.pipe((0,jn.h)((function(e){return!!e})),(0,Gn.U)((function(){var t,n,r;return{visible:e.props.rightDrawerOpened,name:null===(t=e.props.rightDrawerInfo)||void 0===t?void 0:t.name,onOpen:null===(n=e.props.rightDrawerInfo)||void 0===n?void 0:n.onOpen,onClose:null===(r=e.props.rightDrawerInfo)||void 0===r?void 0:r.onClose}})),(0,Wn.x)((function(e,t){return e.name===t.name&&e.visible===t.visible})),(0,Vn.G)()).subscribe((function(t){var r,o,i,a=(0,Me.__read)(t,2),s=a[0],c=a[1];if(c.visible){if(s.name!==c.name)try{var l=e.context.store.getValue(nt.j.RightDrawerStyle);e.drawerService.updateRightDrawerStyle(null!=l?l:{}),null===(r=s.onClose)||void 0===r||r.call(s)}catch(e){Pe.r.error("Drawer ".concat(s.name," onClose has errors:\n").concat(e))}document.addEventListener("click",e.handleClick,!0);try{null===(o=c.onOpen)||void 0===o||o.call(c)}catch(e){Pe.r.error("Drawer ".concat(c.name," onOpen has errors:\n").concat(e))}}else{try{null===(i=c.onClose)||void 0===i||i.call(c)}catch(e){Pe.r.error("Drawer ".concat(c.name," onClose has errors:\n").concat(e))}n.next(!0)}}))},t.prototype.removeListenerWhenDrawerClose=function(e){var t=this;e.pipe((0,jn.h)((function(e){return e}))).subscribe((function(){document.removeEventListener("click",t.handleClick,!0),e.next(!1)}))},t.prototype.render=function(){var e,t,n=this,r=this.drawerService,o=r.onBeforeShowRightDrawer,i=r.onBeforeCloseRightDrawer,a=r.onAfterCloseRightDrawer,s=r.onAfterShowRightDrawer;return Ye().createElement("div",{className:[On["drawer-container"],On["drawer-right"]].join(" "),style:Object.assign(Object.assign({},this.props.rightDrawerStyle),{marginTop:this.props[nt.j.TitlebarDOMVisible]&&Un.w.isMobile()?44:"0"})},Ye().createElement(Bn,Object.assign({forwardRef:this.setDrawerRef,service:this.drawerService,align:"right",onDrawerClose:this.closeDrawer,opened:this.props.rightDrawerOpened,onEnter:o,onEntered:s,onExit:i,onExited:a,persistContents:this.props.rightDrawerPersistContent,hiddenContents:this.props.rightDrawerHiddenContent,animationDisabled:this.props.disableDrawerAnimation},this.props.rightDrawerInfo,{style:Object.assign(Object.assign({},null===(e=this.props.rightDrawerInfo)||void 0===e?void 0:e.style),{zIndex:0})})),(null!==(t=this.props.rightSubDrawerInfo)&&void 0!==t?t:[]).map((function(e,t){return Ye().createElement(Bn,Object.assign({forwardRef:function(){},key:e.name,service:n.drawerService,align:"right",onDrawerClose:function(){return n.exitSubDrawer(e.name)},onBack:function(){return n.exitSubDrawer(e.name)},opened:n.closingSubDrawers.indexOf(e.name)<0,animationDisabled:n.props.disableDrawerAnimation,onEntered:function(){var t;return null===(t=e.onOpen)||void 0===t?void 0:t.call(e)},onExited:function(){return n.closeSubDrawer(e)}},e,{style:Object.assign(Object.assign({},e.style),{zIndex:t+1})}))})))},t}(Qe.PureComponent);Yn.contextType=Je.FN;var Zn=(0,tt.x)([nt.j.RightDrawerInfo,nt.j.RightDrawerOpened,nt.j.RightDrawerStyle,nt.j.RightDrawerPersistContent,nt.j.RightDrawerHiddenContent,nt.j.TitlebarDOMVisible,nt.j.DisableDrawerAnimation,nt.j.RightSubDrawerInfo],!1,30)(Yn),Kn=n(594482),Jn=n(366322),qn={contextmenu:"context-menu_contextmenu__2Aa6v","dui-divider-compact":"context-menu_dui-divider-compact__3Te8M","dui-divider-horizontal":"context-menu_dui-divider-horizontal__2PCv2","contextmenu-overlay":"context-menu_contextmenu-overlay__aBGJU","contextmenu-icon":"context-menu_contextmenu-icon__LViQv","workbench-menu-item":"context-menu_workbench-menu-item__2t1Up"};(0,qe.Z)(".context-menu_contextmenu__2Aa6v {\n  min-width: 180px;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n          user-select: none;\n  position: fixed;\n  z-index: 4001;\n  box-shadow: 0 2px 8px 2px rgba(68, 73, 77, 0.16);\n  border: 0 solid rgba(0, 0, 0, 0.12);\n  border-radius: 4px;\n  height: auto !important;\n}\n.context-menu_contextmenu__2Aa6v .context-menu_dui-divider-compact__3Te8M.context-menu_dui-divider-horizontal__2PCv2 {\n  margin: 6px 0 !important;\n}\n.context-menu_contextmenu-overlay__aBGJU {\n  position: fixed;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  z-index: 4000;\n}\n.context-menu_contextmenu-icon__LViQv {\n  position: absolute;\n  left: 10px;\n  height: 20px;\n  width: 20px;\n}\n.context-menu_workbench-menu-item__2t1Up.dui-menu-submenu::after {\n  filter: var(--workbench-theme-menu-arrow-filter);\n}\n");var Xn=function(e){var t,n=e.item,r=e.badge,o=n.content;return t="function"==typeof o?o():o,Ye().isValidElement(t)&&"string"==typeof t.type&&(t=Ye().cloneElement(t,{onMouseDown:function(e){e.preventDefault()}})),r?Ye().createElement(ot.S,null,Ye().createElement("div",null,null!=t?t:null,Ye().createElement(_n.ZP,{status:"error",style:{transform:"scale(0.6)",marginLeft:4}}))):Ye().createElement(ot.S,null,null!=t?t:null)},$n=n(163364),er=1/0,tr=function(e){function t(t){var n=e.call(this,t)||this;return n.edges={left:!1,right:!1,top:!1,bottom:!1},n.levelInfo={current:0},n.ref=(0,Qe.createRef)(),n.getBadgeTree=function(){return n.props.badge.filter((function(e){return"contextMenu"===e.position})).map((function(e){return e.key}))},n.handleClick=function(e){n.props.contextMenuInfo.show&&(e.ctrlKey||n.hoveringMenu||n.contextMenuService.hideContextMenu())},n.enter=function(){n.hoveringMenu=!0},n.leave=function(){n.hoveringMenu=!1},n.shouldShow=function(e){var t=!0;if(e.shouldHide&&(t=!(0,nn.k)(e.shouldHide,!1)),t&&!e.ignoreChildrenHideStatus&&e.children.length>0){var r=!1;return r=e.children.reduce((function(e,t){return e||n.shouldShow(t)}),r),t&&r}return t},n.getShortcut=function(e){if(void 0!==e)return Un.w.isMac()?e.mac:e.win},n.shouldDisabled=function(e){return!!e.shouldDisabled&&(0,nn.k)(e.shouldDisabled,!1)},n.removeUnnecessaryDivider=function(e,t,n){if("divider"===e.name){if(t<er)return!1;var r=n[t+1];if(!r)return!1;if("divider"===r.name)return!1}else er>t&&(er=t);return!0},n.generateMenuTree=function(e,t){if(0===t&&n.enterMenuTree(),"divider"===e.name)return Ye().createElement(En.ZP,{key:"divider-".concat(t)});er=1/0;var r=e.children.filter((function(e){return!(0,nn.k)(e.shouldHide,!1)})).filter(n.removeUnnecessaryDivider);if(0===e.children.length||0===r.length&&e.onClick){var o=n.checkBadge(e.name);return n.generateMenuItem({item:e,badge:o})}var i=r.map(n.generateMenuTree),a=Object.assign({},n.getCurrentLevelInfo());return n.leaveMenuTree(),e.children.length>0&&0===r.length&&!e.onClick?null:n.genarateSubMenu(e,t,i,a)},n.handleVisibleChange=function(e,t){e&&n.badgeTree.indexOf(t)>=0&&n.badgeService.removeBadgeOn("contextMenu",t)},n.handleMenuClick=function(e,t){n.contextMenuService.restoreFocus();var r=n.contextMenuService.get(e),o=r.onClick;if((0,rn.Mf)(o,t),o&&o(),n.props.badge.some((function(e){return e.key===(null==r?void 0:r.name)&&"contextMenu"===e.position}))&&n.badgeService.removeBadgeOn("contextMenu",r.name),r.preventDismiss)return n.selectionChangePrevent=!0,void setTimeout((function(){n.selectionChangePrevent=!1}),100);n.contextMenuService.hideContextMenu()},n.calculateEdges=function(e){n.edges={left:!1,right:!1,top:!1,bottom:!1};var t=e.filter((function(e){return"".concat(e.key).startsWith("divider")})).length,r=28*(e.length-t)+13*t+12,o=document.body.offsetHeight;return n.props.contextMenuInfo.left+180>document.body.offsetWidth&&(n.edges.right=!0),n.props.contextMenuInfo.top+r>document.body.offsetHeight&&(n.edges.bottom=!0,n.props.contextMenuInfo.top-r<0&&(n.edges.top=!0,o=document.body.offsetHeight-48)),n.props.contextMenuInfo.left<50&&(n.edges.left=!0),[180,r,o]},n.state={},n}return(0,Me.__extends)(t,e),t.prototype.componentDidMount=function(){document.addEventListener("click",this.handleClick,!0)},t.prototype.componentWillUnmount=function(){document.removeEventListener("click",this.handleClick,!0)},t.prototype.componentDidUpdate=function(e){this.props.contextMenuInfo.show?e.contextMenuInfo.show||this.eventEmitter.emit(ft.c.ContextMenuShowed):(this.contextMenuService.restoreFocus(),e.contextMenuInfo.show&&this.eventEmitter.emit(ft.c.AfterContextMenuDismissed)),this.updateContextmenuRealHeight()},t.prototype.updateContextmenuRealHeight=function(){var e=this;window.requestAnimationFrame((function(){var t,n,r,o=null===(r=null===(n=null===(t=e.ref.current)||void 0===t?void 0:t.listRef)||void 0===n?void 0:n.current)||void 0===r?void 0:r.getBoundingClientRect().height;o&&o!==e.state.contextMenuHeight&&e.setState({contextMenuHeight:o})}))},t.prototype.checkBadge=function(e){return this.badgeTree.includes(e)},t.prototype.render=function(){var e;if(this.props["contextMenu.disabled"]||!this.props.contextMenuInfo.show)return this.hoveringMenu&&this.leave(),null;this.badgeTree=this.getBadgeTree(),er=1/0;var t=this.props.contextMenu.children.filter(this.shouldShow).filter(this.removeUnnecessaryDivider).map((function(e){var t;return null===(t=e.onShow)||void 0===t||t.call(e),e})).map(this.generateMenuTree).filter((function(e){return null!==e})),n=this.getCurrentLevelInfo(),r=n.needCheckPadding,o=n.hasIcon;if(this.leaveMenuTree(),0===t.length)return null;var i=(0,Me.__read)(this.calculateEdges(t),3),a=i[0],s=i[1],c=i[2],l=null!==(e=this.state.contextMenuHeight)&&void 0!==e?e:s,u=Math.min(l,c),d=this.edges.top?24:this.props.contextMenuInfo.top-u,p=this.edges.bottom?d:this.props.contextMenuInfo.top+10,f=document.body.clientHeight-u-36;p>f&&(p=f);var h=(this.edges.right?this.props.contextMenuInfo.left-a:this.props.contextMenuInfo.left)+10;return Ye().createElement(Ye().Fragment,null,this.settings.contextMenu.hasOverlay&&Ye().createElement("div",{className:qn["contextmenu-overlay"],style:{display:this.props.contextMenuInfo.show?"block":"none"},onContextMenu:function(e){e.preventDefault()}}),Ye().createElement(Kn.ZP,{type:o?"with-icon":"normal",onClick:this.handleMenuClick,className:qn.contextmenu,selectable:r,onMouseEnter:this.enter,onMouseLeave:this.leave,ref:this.ref,style:Object.assign({display:this.props.contextMenuInfo.show?"block":"none",top:p,left:h},c<Number.MAX_SAFE_INTEGER?{overflowY:"auto",maxHeight:c}:{})},t))},t.prototype.getDescription=function(e){return"function"==typeof e.description?e.description():e.description},t.prototype.enterMenuTree=function(){this.levelInfo.current+=1},t.prototype.leaveMenuTree=function(){delete this.levelInfo[this.levelInfo.current],this.levelInfo.current-=1},t.prototype.recordLevelInfo=function(e,t,n){var r=this.levelInfo.current;this.levelInfo[r]?(this.levelInfo[r].needCheckPadding=this.levelInfo[r].needCheckPadding||e,this.levelInfo[r].hasIcon=this.levelInfo[r].hasIcon||t,this.levelInfo[r].childBeenChecked=this.levelInfo[r].childBeenChecked||n):this.levelInfo[r]={needCheckPadding:e,hasIcon:t,childBeenChecked:n}},t.prototype.getCurrentLevelInfo=function(){var e,t=this.levelInfo.current;return null!==(e=this.levelInfo[t])&&void 0!==e?e:{hasIcon:!1,hasCheck:!1}},t.prototype.shouldCheck=function(e){return!!e.shouldCheck&&(0,nn.k)(e.shouldCheck,!1)},t.prototype.generateMenuItem=function(e){var t=e.item,n=e.badge,r=void 0!==t.shouldCheck,o=void 0!==t.icon,i=this.shouldCheck(t);this.recordLevelInfo(r,o,i);var a=this.shouldDisabled(t),s=t.preventHighlight?{background:"transparent"}:{},c="function"==typeof t.style?t.style():t.style,l=Ye().createElement(Kn.ZP.Item,{id:t.name,disabled:a,style:Object.assign(Object.assign({},c),s),key:t.name,icon:o?Ye().createElement("div",{className:qn["workbench-menu-item-icon"]},t.icon):void 0,selected:this.shouldCheck(t),className:"contextmenu-item-".concat(t.name),description:this.getDescription(t)||this.getShortcut(t.shortcut),onMouseEnter:a?void 0:t.onMouseEnter,onMouseLeave:a?void 0:t.onMouseLeave},Ye().createElement(Xn,{item:t,badge:n}));return t.tooltip&&(l=Ye().createElement(Ye().Fragment,{key:t.name},(0,$n.t)(l,t.tooltip,{style:{display:"block"}}))),l},t.prototype.genarateSubMenu=function(e,t,n,r){var o=this,i="function"==typeof e.style?e.style():e.style,a="function"==typeof e.popUpStyle?e.popUpStyle():e.popUpStyle,s="function"==typeof e.popupClassName?e.popupClassName():e.popupClassName,c=this.checkBadge(e.name),l=void 0!==e.icon,u=this.shouldCheck(e),d=r.needCheckPadding||!!e.syncCheckStatus,p=r.childBeenChecked,f=u||p&&!!e.syncCheckStatus;return this.recordLevelInfo(!!e.syncCheckStatus,l,f),Ye().createElement(Kn.ZP.SubMenu,{id:e.name,className:qn["workbench-menu-item"],title:Ye().createElement(Xn,{item:e,badge:c}),key:"sub-".concat(e.name,"-").concat(t),style:i,icon:l?Ye().createElement("div",{className:qn["workbench-menu-item-icon"]},e.icon):void 0,selectable:d,selected:f,popupStyle:a,popupClassName:s,type:l?"with-icon":"normal",onVisibleChange:function(t){var n;null===(n=e.onVisibleChange)||void 0===n||n.call(e,t),o.handleVisibleChange(t,e.name),t&&e.children.forEach((function(e){var t;null===(t=e.onShow)||void 0===t||t.call(e)}))},disabled:this.shouldDisabled(e)},n)},t}(Qe.Component);tr.contextType=Je.FN,(0,Me.__decorate)([(0,S.tB)(),(0,Me.__metadata)("design:type",pt.v)],tr.prototype,"eventEmitter",void 0),(0,Me.__decorate)([(0,S.tB)(),(0,Me.__metadata)("design:type",Jn.L)],tr.prototype,"contextMenuService",void 0),(0,Me.__decorate)([(0,S.tB)(yn.c),(0,Me.__metadata)("design:type",Object)],tr.prototype,"badgeService",void 0),(0,Me.__decorate)([(0,S.tB)(),(0,Me.__metadata)("design:type",ke.I)],tr.prototype,"settings",void 0);var nr=(0,tt.x)([nt.j.ContextMenu,nt.j.ContextMenuInfo,je.R.DisableContextMenu,nt.j.Badge])(tr),rr=n(807650),or=n(12193),ir=n(768858),ar={titlebar:"titlebar_titlebar__2RoCq","titlebar-pusher":"titlebar_titlebar-pusher__2dcNp","titlebar-content":"titlebar_titlebar-content__1q_Y-",group:"titlebar_group__1FF5g",row:"titlebar_row__1f8v1","titlebar-hover-hot-zone":"titlebar_titlebar-hover-hot-zone__1isc5"};(0,qe.Z)(".titlebar_titlebar__2RoCq {\n  position: absolute;\n  width: 100%;\n  text-align: left;\n  z-index: 1350;\n  border-bottom-style: solid;\n  border-bottom-width: 1px;\n  border-bottom-color: var(--workbench-theme-titlebar-border, rgba(0, 0, 0, 0.04));\n  display: flex;\n  align-items: center;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n          user-select: none;\n  padding: 0;\n  box-sizing: border-box;\n  flex-shrink: 0;\n  background: var(--workbench-theme-titlebar-background, #f9fafb);\n  transition: background 0.3s ease;\n}\n.titlebar_titlebar__2RoCq .titlebar_titlebar-pusher__2dcNp {\n  margin: 0 auto;\n}\n.titlebar_titlebar__2RoCq .titlebar_titlebar-content__1q_Y- {\n  flex-shrink: 0;\n  margin: 0 8px;\n  color: var(--workbench-theme-titlebar-foreground, #000000);\n}\n.titlebar_titlebar__2RoCq > .titlebar_group__1FF5g {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  height: 100%;\n  white-space: nowrap;\n}\n.titlebar_titlebar__2RoCq > .titlebar_group__1FF5g .titlebar_row__1f8v1 {\n  display: flex;\n  align-items: center;\n}\n.titlebar_titlebar-hover-hot-zone__1isc5 {\n  width: 100%;\n  background: var(--workbench-theme-titlebar-background, #f9fafb);\n}\n");var sr=function(e){function t(){var t=e.apply(this,(0,Me.__spreadArray)([],(0,Me.__read)(arguments),!1))||this;return t.ref=Ye().createRef(),t.handleClick=function(e){if(t.props.preventOriginalClick&&e.stopPropagation(),!t.props.disabled){var n=t.props.onClick;(0,rn.Mf)(n,e),null==n||n(),t.titlebarService.setHoverActive(!1)}},t}return(0,Me.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;this.sensor=new en((function(){var t,n;if(!1!==e.props.visible){var r=getComputedStyle(e.ref.current),o=e.ref.current.clientWidth,i=parseInt(r.marginLeft,10)+parseInt(r.marginRight,10);e.titlebarService.updateWidth(e.props,o,i),null===(n=(t=e.props).onWidthChange)||void 0===n||n.call(t,o)}})),this.ref.current&&this.sensor.observe(this.ref.current)},t.prototype.componentDidUpdate=function(e){var t,n,r;e.visible!==this.props.visible&&(null===(n=(t=this.props).onVisibleChange)||void 0===n||n.call(t,null===(r=this.props.visible)||void 0===r||r))},t.prototype.componentWillUnmount=function(){this.titlebarService.updateWidth(this.props,0,0),this.sensor.disconnect()},t.prototype.getAriaAttributes=function(){var e={},t=this.props,n=t.ariaLabel,r=t.tooltip,o=t.content;t.onClick&&(e.role="button"),this.props.disabled&&(e["aria-disabled"]=this.props.disabled);var i=n||("string"==typeof o?o:void 0)||("string"==typeof r?r:void 0);return i&&(e["aria-label"]=i),e},t.prototype.render=function(){var e=this.props,t=e.content,n=e.style,r=null!=n?n:{},o=t;Ye().isValidElement(o)&&(o=Ye().cloneElement(o,{disabled:this.props.disabled}));var i=!1===this.props.visible?{maxWidth:0,minWidth:0,margin:0,overflow:"hidden"}:{};return Ye().createElement("div",Object.assign({onClickCapture:this.handleClick,ref:this.ref},this.getAriaAttributes(),{style:Object.assign(Object.assign(Object.assign(Object.assign({},this.props["titlebar.contentDefaultStyle"]),r),{flexBasis:"continuous"!==this.props.shrinkable?this.props.width:void 0,flexShrink:"continuous"===this.props.shrinkable?1:0,maxWidth:this.props.width}),i),className:ar["titlebar-content"]}),o)},t}(Qe.PureComponent);(0,Me.__decorate)([(0,S.tB)(),(0,Me.__metadata)("design:type",ir.M)],sr.prototype,"titlebarService",void 0);var cr=(0,tt.x)([je.R.TitlebarContentDefaultStyle])(sr),lr=n(648472),ur=n(802964),dr=function(e){function t(){var t=e.apply(this,(0,Me.__spreadArray)([],(0,Me.__read)(arguments),!1))||this;return t.ref=Ye().createRef(),t}return(0,Me.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;this.sensor=new en((function(){if(!1!==e.props.visible){var t=getComputedStyle(e.ref.current),n=e.ref.current.clientWidth,r=parseInt(t.marginLeft,10)+parseInt(t.marginRight,10);e.titlebarService.updateWidth(e.props,n,r)}})),this.ref.current&&this.sensor.observe(this.ref.current)},t.prototype.componentWillUnmount=function(){this.titlebarService.updateWidth(this.props,0,0),this.sensor.disconnect()},t.prototype.render=function(){var e=this.props,t=e.name,n=e.ariaLabel,r=e.items,o=e.getComponent,i=!1===this.props.visible?{maxWidth:0,minWidth:0,margin:0,overflow:"hidden"}:{},a=r.some((function(e){return e.some((function(e){return"pusher"===e.name}))}))?{flex:1}:{};return Ye().createElement("div",{ref:this.ref,style:Object.assign(Object.assign({},i),a),role:"group","aria-label":n,className:ar.group},r.map((function(e,n){return Ye().createElement("div",{className:ar.row,key:"".concat(t,"-").concat(n)},e.map((function(e,t){return o(e,"".concat(n,"-").concat(t))})))})))},t}(Qe.PureComponent);(0,Me.__decorate)([(0,S.tB)(),(0,Me.__metadata)("design:type",ir.M)],dr.prototype,"titlebarService",void 0);var pr=function(e){function t(){var t=e.apply(this,(0,Me.__spreadArray)([],(0,Me.__read)(arguments),!1))||this;return t.ref=Ye().createRef(),t.mousemove=null,t.click=null,t.hovering=!1,t.groupItemsMap=new Map,t.shouldHide=function(e){return(0,nn.k)(e.shouldHide,!1)},t.getComponent=function(e,n){if((0,ur.g)(e))return Ye().createElement(dr,Object.assign({key:"".concat(e.name,"-").concat(n),getComponent:t.getComponent,items:t.groupItemsMap.get(e.name)},e,t.props.titlebarCalculatedWidth[e.name]));var r=e.content,o=e.name;return r?Ye().createElement(ot.S,{key:o},Ye().createElement(cr,Object.assign({},function(e){return Object.assign(Object.assign({},e),{tooltip:(0,nn.k)(e.tooltip,""),disabled:(0,nn.k)(e.shouldDisabled,!1),style:(0,nn.k)(e.style,void 0),content:(0,nn.k)(e.content,void 0)})}(e),t.props.titlebarCalculatedWidth[o]))):"pusher"===o?Ye().createElement("div",{className:ar["titlebar-pusher"],key:"".concat(e.name,"-").concat(n)}):"divider"===o?Ye().createElement(cr,{key:"".concat(e.name,"-").concat(n),name:e.name,style:{margin:"0 4px"},content:Ye().createElement(En.ZP,{style:{display:"block",height:"".concat(Math.floor(t.props["titlebar.height"]/9*4),"px"),borderRight:"1px solid rgba(0,0,0)",opacity:.06,margin:0},orientation:"vertical"})}):null},t.clickOutsideTitlebar=function(e){var n;(null===(n=t.ref.current)||void 0===n?void 0:n.contains(e.target))||(t.titlebarService.setHoverActive(!0),t.store.update(nt.j.TitlebarShow,!1))},t.handleMouseMove=function(e){var n,r,o=e.clientY,i=e.clientX,a=null===(r=null===(n=t.ref)||void 0===n?void 0:n.current)||void 0===r?void 0:r.getBoundingClientRect(),s=a.top,c=a.left,l=a.right,u=t.getTakeUpSpaceHeight();t.props[nt.j.TitlebarListenMouseMove]&&i<=l&&i>=c&&o<=s+t.titlebarHeight+u&&o>=s+t.titlebarHeight?(t.hovering=!0,t.store.update(nt.j.TitlebarShow,!0)):t.props[nt.j.TitlebarListenMouseMove]&&o>s+t.props["titlebar.height"]&&t.props[nt.j.TitlebarShow]&&t.store.update(nt.j.TitlebarShow,!1)},t}return(0,Me.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;this.sensor=new en((function(){var t=getComputedStyle(e.ref.current),n=[t.paddingLeft,t.paddingRight].reduce((function(e,t){return e+parseInt(t,10)}),0);e.titlebarService.updateContainerWidth(e.ref.current.clientWidth-n)})),this.ref.current&&this.sensor.observe(this.ref.current),this.props[je.R.TitlebarHoverable]&&this.store.get(nt.j.TitlebarHover).subscribe((function(t){var n,r;t?(e.mousemove=(0,or.R)(document,"mousemove").pipe((0,rr.p)(30)).subscribe(e.handleMouseMove),e.click=(0,or.R)(document,"click").subscribe(e.clickOutsideTitlebar)):(null===(n=e.mousemove)||void 0===n||n.unsubscribe(),null===(r=e.click)||void 0===r||r.unsubscribe(),e.hovering=!1)})),this.eventEmitter.emit(ft.c.TitlebarMounted,this.ref.current)},t.prototype.componentWillUnmount=function(){this.sensor.disconnect()},t.prototype.filterGroupConfig=function(e){var t=this;e.rows=e.rows.map((function(e){return e.map((function(e){return e.filter((function(e){return!t.shouldHide(e)}))})).filter((function(e){return!!e.length}))})).filter((function(e){return!!e.length}))},t.prototype.convertTitlebar=function(e){var t=this;this.groupItemsMap.clear();var n=function(e){return e.reduce((function(e,t){var n,r;return 0===t.length?e:0===e.length||"pusher"===(null===(n=e[e.length-1])||void 0===n?void 0:n.name)||"pusher"===(null===(r=t[0])||void 0===r?void 0:r.name)?e.concat(t):e.concat({name:"divider"},t)}),[])},r=e.map((function(e){return e.filter((function(e){return(0,ur.g)(e)?(t.filterGroupConfig(e),!(t.shouldHide(e)||!e.rows.length||(t.groupItemsMap.set(e.name,e.rows.map((function(e){return n(e)}))),0))):!t.shouldHide(e)}))}));return n(r)},t.prototype.getTakeUpSpaceHeight=function(){var e=this.props[je.R.TitlebarHoverable];return"boolean"!=typeof e&&(null==e?void 0:e.takeUpSpaceHeight)?e.takeUpSpaceHeight:this.props["titlebar.height"]/3},Object.defineProperty(t.prototype,"titlebarHeight",{get:function(){var e;return null!==(e=this.props["titlebar.height"])&&void 0!==e?e:48},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e=this,t=this.convertTitlebar(this.props.titlebar),n=[ar.titlebar,this.props.titlebarFocus?ar.active:""];return Ye().createElement(Ye().Fragment,null,Ye().createElement(lr.K,{name:"titlebar",onExited:function(){e.hovering=!1},simulateSpaceChange:!this.hovering},Ye().createElement("div",{id:"workbench-titlebar",ref:this.ref,className:n.join(" "),style:{height:this.titlebarHeight},role:"toolbar","aria-label":"titlebar"},t.map(this.getComponent))))},t}(Qe.PureComponent);(0,Me.__decorate)([(0,S.tB)(),(0,Me.__metadata)("design:type",ir.M)],pr.prototype,"titlebarService",void 0),(0,Me.__decorate)([(0,S.tB)(),(0,Me.__metadata)("design:type",He.O)],pr.prototype,"store",void 0),(0,Me.__decorate)([(0,S.tB)(),(0,Me.__metadata)("design:type",pt.v)],pr.prototype,"eventEmitter",void 0);var fr=(0,tt.x)([nt.j.Titlebar,nt.j.TitlebarShow,nt.j.TitlebarFocus,je.R.TitlebarHeight,je.R.TitlebarHoverable,nt.j.TitlebarCalculatedWidth,nt.j.TitlebarHover,nt.j.TitlebarListenMouseMove])(pr),hr=n(967948),mr=n(783637),gr="ribbon-toolbar_ribbon-toolbar__3xV-1",vr="ribbon-toolbar_tablist__3z3Z3",_r="ribbon-toolbar_active__2cMHh",yr="ribbon-toolbar_pure__3ViYu",br="ribbon-toolbar_active-indicator__2MEFD",Er="ribbon-toolbar_tabpanel__3kgXq",Cr="ribbon-toolbar_header__2j5Oq",wr="ribbon-toolbar_pinned__3tWA6",Tr="ribbon-toolbar_disabled__2Kr8R";(0,qe.Z)('.ribbon-toolbar_ribbon-toolbar__3xV-1 {\n  color: var(--workbench-theme-toolbar-ribbon-active-color, #0d61f2);\n  background: var(--workbench-theme-toolbar-background, #f9fafb);\n  width: 100%;\n  height: 104px;\n}\nul.ribbon-toolbar_tablist__3z3Z3 {\n  display: flex;\n  height: 36px;\n  position: relative;\n  flex-shrink: 0;\n}\nul.ribbon-toolbar_tablist__3z3Z3 li {\n  list-style: none;\n  line-height: 16px;\n  font-size: 12px;\n  font-weight: 600;\n  padding: 10px 4px;\n  margin: 0 14px;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n          user-select: none;\n  cursor: default;\n  flex-shrink: 0;\n  color: var(--workbench-theme-toolbar-foreground-light, #000000A3);\n  position: relative;\n}\nul.ribbon-toolbar_tablist__3z3Z3 li:first-of-type {\n  margin-left: 4px;\n}\nul.ribbon-toolbar_tablist__3z3Z3 li:last-of-type {\n  margin-right: 4px;\n}\nul.ribbon-toolbar_tablist__3z3Z3 li::after {\n  content: "";\n  position: absolute;\n  bottom: 0;\n  left: calc(50% - 12px);\n  height: 3px;\n  width: 24px;\n  transition: width 0.15s ease, left 0.15s ease, background 0.01s 0.15s linear;\n  background: var(--workbench-theme-toolbar-button-hover-background, #00000014);\n  opacity: 0;\n}\nul.ribbon-toolbar_tablist__3z3Z3 li:hover::after {\n  opacity: 1;\n}\nul.ribbon-toolbar_tablist__3z3Z3 li.ribbon-toolbar_active__2cMHh {\n  color: currentColor;\n}\nul.ribbon-toolbar_tablist__3z3Z3 li.ribbon-toolbar_active__2cMHh::after {\n  opacity: 0;\n}\nul.ribbon-toolbar_tablist__3z3Z3 li.ribbon-toolbar_active__2cMHh.ribbon-toolbar_pure__3ViYu::after {\n  opacity: 1;\n  background-color: var(--workbench-theme-toolbar-ribbon-active-color, #0d61f2);\n}\n.ribbon-toolbar_active-indicator__2MEFD {\n  height: 3px;\n  width: 24px;\n  bottom: 0;\n  position: absolute;\n  transition: left 0.15s ease, width 0.15s ease;\n  opacity: 1;\n}\n.ribbon-toolbar_active-indicator__2MEFD::after {\n  content: "";\n  width: 24px;\n  height: 3px;\n  display: block;\n  background: currentColor;\n  margin-left: 50%;\n  transform: translateX(-50%);\n  transition: all 0.15s ease;\n}\nul:focus-visible .ribbon-toolbar_active-indicator__2MEFD::after,\nli.ribbon-toolbar_active__2cMHh:hover ~ .ribbon-toolbar_active-indicator__2MEFD::after {\n  width: 100%;\n}\n.ribbon-toolbar_tabpanel__3kgXq {\n  padding: 8px 16px;\n}\n.ribbon-toolbar_header__2j5Oq {\n  display: flex;\n  padding: 0 16px 0 12px;\n  align-items: center;\n}\n.ribbon-toolbar_pinned__3tWA6 {\n  margin-left: auto;\n}\n.ribbon-toolbar_disabled__2Kr8R {\n  opacity: 0.3;\n}\n');var Ar=n(249607),Sr=function(e){function t(t){var n,r=this;(r=e.call(this,t)||this).unsubscribe$=new Hn.xQ,r.ribbonData={},r.pinnedData=null,r.tabRef=Ye().createRef();var o=r.props.ribbons;return r.state={active:null!==(n=o[0])&&void 0!==n?n:""},r}return(0,Me.__extends)(t,e),t.prototype.componentDidMount=function(){var e,t,n=this,r=this.props,o=r.ribbons,i=r.pinned;o.forEach((function(e){var t;null===(t=n.context.store.get(e))||void 0===t||t.pipe((0,hr.R)(n.unsubscribe$)).subscribe((function(t){n.ribbonData[e]=t,e===n.state.active&&n.forceUpdate()}))})),i&&(null===(e=this.context.store.get(i))||void 0===e||e.pipe((0,hr.R)(this.unsubscribe$)).subscribe((function(e){n.pinnedData=e,n.forceUpdate()})),null===(t=this.context.store.get(nt.j.RibbonActiveTab))||void 0===t||t.pipe((0,hr.R)(this.unsubscribe$)).subscribe((function(e){e&&e!==n.state.active&&n.changeTab(e)})))},t.prototype.componentWillUnmount=function(){this.unsubscribe$.next(),this.unsubscribe$.complete()},t.prototype.shouldComponentUpdate=function(e,t){return JSON.stringify(t)!==JSON.stringify(this.state)||e[nt.j.SelectionState]!==this.props[nt.j.SelectionState]||e[nt.j.ModelState]!==this.props[nt.j.ModelState]||e.pinned!==this.props.pinned||JSON.stringify(e[nt.j.Badge])!==JSON.stringify(this.props[nt.j.Badge])||JSON.stringify(e.ribbons)!==JSON.stringify(this.props.ribbons)||JSON.stringify(this.props.style)!==JSON.stringify(e.style)},t.prototype.changeTab=function(e){this.setState({active:e})},t.prototype.getTabPosition=function(e){if(this.tabRef.current){var t=this.tabRef.current.children[e];if(t){var n=this.tabRef.current.getBoundingClientRect().left,r=t.getBoundingClientRect();return{left:r.left-n,width:r.width}}}},t.prototype.render=function(){var e,t,n,r,o=this,i=this.state.active,a=Object.entries(this.ribbonData).map((function(e){var t,n,r,o=(0,Me.__read)(e,2),i=o[0],a=o[1];return{key:i,label:a.label,hidden:(0,nn.k)(null===(t=a.keyItem)||void 0===t?void 0:t.shouldHide,!1),disabled:(0,nn.k)(null===(n=a.keyItem)||void 0===n?void 0:n.shouldDisabled,!1),onClick:null===(r=a.keyItem)||void 0===r?void 0:r.onClick}})).filter((function(e){return!e.hidden})),s=a.length,c=a.findIndex((function(e){return e.key===i}));-1===c&&(c=0,(i=null!==(t=null===(e=a[0])||void 0===e?void 0:e.key)&&void 0!==t?t:this.state.active)!==this.state.active&&this.setState({active:i}));var l=null!==(n=this.getTabPosition(c))&&void 0!==n?n:{left:0,width:0},u=l.left,d=l.width,p=this.context.store.getValue(i),f=Ar.O.getToolbarProps(this.pinnedData,this.props.badge),h=Ar.O.getToolbarProps(p,this.props.badge);return Ye().createElement("div",{role:"toolbar","aria-label":"Toolbar",className:gr,style:this.props.style},Ye().createElement("div",{className:Cr},Ye().createElement("ul",{role:"tablist",className:vr,ref:this.tabRef,tabIndex:0,onKeyUp:function(e){var t,n,r,c=a.findIndex((function(e){return e.key===i}));if(-1!==c){var l=c;do{"ArrowLeft"===e.key&&(l=0===l?s-1:l-1),"ArrowRight"===e.key&&(l=l===s-1?0:l+1)}while(a[l].disabled);o.changeTab(a[l].key),null===(t=o.tabRef.current)||void 0===t||t.focus(),null===(r=(n=a[l]).onClick)||void 0===r||r.call(n)}}},a.map((function(e,t){return Ye().createElement("li",{role:"tab",key:e.key,"aria-setsize":s,"aria-posinset":t,"aria-disabled":e.disabled?"true":"false",onClick:function(){var n,r;e.disabled||(o.changeTab(e.key),null===(r=(n=a[t]).onClick)||void 0===r||r.call(n))},className:[e.key===i?_r:"",e.disabled?Tr:"",ht.s?yr:""].join(" "),"aria-selected":e.key===i?"true":"false"},e.label)})),d>0&&Ye().createElement("div",{className:br,"aria-hidden":!0,style:{width:d,left:u}})),f?Ye().createElement("div",{className:wr},Ye().createElement(mr.o,{groups:f,pinned:!0,label:null===(r=this.pinnedData)||void 0===r?void 0:r.label})):null),Ye().createElement("div",{role:"tabpanel",className:Er},Ye().createElement(mr.o,{groups:h,multirows:!0,key:i,label:null==p?void 0:p.label,moreText:null==p?void 0:p.moreText,moreTooltip:null==p?void 0:p.moreTooltip})))},t}(Qe.Component);Sr.contextType=Je.FN;var Ir=(0,tt.x)([nt.j.SelectionState,nt.j.ModelState,nt.j.Badge])(Sr),Rr="classic-toolbar_container__oCgTs";(0,qe.Z)(".classic-toolbar_container__oCgTs {\n  padding: 10px 16px;\n  display: flex;\n  height: 44px;\n  width: 100%;\n  box-sizing: border-box;\n  background: var(--workbench-theme-toolbar-background, #f9fafb);\n}\n");var Mr=function(e){function t(){var t=e.apply(this,(0,Me.__spreadArray)([],(0,Me.__read)(arguments),!1))||this;return t.unsubscribe$=new Hn.xQ,t}return(0,Me.__extends)(t,e),t.prototype.componentDidMount=function(){var e,t,n=this,r=this.props,o=r.main,i=r.pinned;null===(e=this.context.store.get(o))||void 0===e||e.pipe((0,hr.R)(this.unsubscribe$)).subscribe((function(){n.forceUpdate()})),i&&(null===(t=this.context.store.get(i))||void 0===t||t.pipe((0,hr.R)(this.unsubscribe$)).subscribe((function(){n.forceUpdate()})))},t.prototype.componentWillUnmount=function(){this.unsubscribe$.next(),this.unsubscribe$.complete()},t.prototype.shouldComponentUpdate=function(e){return e[nt.j.SelectionState]!==this.props[nt.j.SelectionState]||e[nt.j.ModelState]!==this.props[nt.j.ModelState]||JSON.stringify(e[nt.j.Badge])!==JSON.stringify(this.props[nt.j.Badge])||e.pinned!==this.props.pinned||e.main!==this.props.main||JSON.stringify(this.props.style)!==JSON.stringify(e.style)},t.prototype.render=function(){var e,t=this.context.store.getValue(this.props.main),n=this.context.store.getValue(null!==(e=this.props.pinned)&&void 0!==e?e:""),r=Ar.O.getToolbarProps(t,this.props.badge),o=Ar.O.getToolbarProps(n,this.props.badge);return Ye().createElement("div",{className:Rr,style:Object.assign({marginBottom:24},this.props.style)},t&&Ye().createElement(mr.o,{groups:r,moreText:t.moreText,moreTooltip:t.moreTooltip,style:{flex:1,minWidth:60},label:null==t?void 0:t.label}),n&&Ye().createElement(mr.o,{groups:o,label:null==n?void 0:n.label,pinned:!0,style:{flexShrink:0,marginLeft:"auto",paddingLeft:16}}))},t}(Qe.Component);Mr.contextType=Je.FN;var Or=(0,tt.x)([nt.j.SelectionState,nt.j.ModelState,nt.j.Badge])(Mr),Nr={"fixed-toolbar-container":"fixed-toolbar-container_fixed-toolbar-container__3Gc26","fixed-toolbar-wrapper":"fixed-toolbar-container_fixed-toolbar-wrapper__3NxGh",ribbon:"fixed-toolbar-container_ribbon__2cdc8",classic:"fixed-toolbar-container_classic__20Mw9",fadeinRibbon:"fixed-toolbar-container_fadeinRibbon__25Hfa",fadeoutRibbon:"fixed-toolbar-container_fadeoutRibbon__34FZ5",fadeinClassic:"fixed-toolbar-container_fadeinClassic__radkD",fadeoutClassic:"fixed-toolbar-container_fadeoutClassic__xGC9n"};(0,qe.Z)(".fixed-toolbar-container_fixed-toolbar-container__3Gc26 {\n  transition: height 0.3s ease-in-out;\n  position: absolute;\n}\n.fixed-toolbar-container_fixed-toolbar-wrapper__3NxGh {\n  width: 100%;\n}\n.fixed-toolbar-container_ribbon__2cdc8 {\n  height: 104px;\n}\n.fixed-toolbar-container_classic__20Mw9 {\n  height: 44px;\n}\n@keyframes fixed-toolbar-container_fadeinRibbon__25Hfa {\n  from {\n    top: -50%;\n    opacity: 0;\n  }\n  to {\n    top: 0;\n    opacity: 1;\n  }\n}\n@keyframes fixed-toolbar-container_fadeoutRibbon__34FZ5 {\n  from {\n    top: 0;\n    opacity: 1;\n  }\n  50% {\n    top: -40%;\n    opacity: 0;\n  }\n  to {\n    top: -40%;\n    opacity: 0;\n    display: none;\n  }\n}\n@keyframes fixed-toolbar-container_fadeinClassic__radkD {\n  from {\n    top: -40%;\n    opacity: 0;\n  }\n  to {\n    top: 0;\n    opacity: 1;\n  }\n}\n@keyframes fixed-toolbar-container_fadeoutClassic__xGC9n {\n  from {\n    top: 0;\n    opacity: 1;\n  }\n  50% {\n    top: -20%;\n    opacity: 0;\n  }\n  to {\n    top: -40%;\n    opacity: 0;\n    display: none;\n  }\n}\nbody:has(.fixed-toolbar-container_ribbon__2cdc8) .dui-snackbar-top {\n  top: 165px;\n}\n");var kr=function(e){function t(){var t=e.apply(this,(0,Me.__spreadArray)([],(0,Me.__read)(arguments),!1))||this;return t.lastRibbonKeys=[],t.lastClassicKey="",t}return(0,Me.__extends)(t,e),t.prototype.getRibbonToolbar=function(e){var t=this.lastRibbonKeys,n=this.props["toolbar.pinnedKey"],r={position:"absolute"};return"exited"===e?null:("exiting"===e&&(r.animation="".concat(Nr.fadeoutRibbon," 0.3s linear"),r.opacity=0),"entering"===e&&(r.animation="".concat(Nr.fadeinRibbon," 0.3s linear"),t=this.props["toolbar.fixedKeys"],this.lastRibbonKeys=t),"entered"===e&&0===t.length&&(t=this.props["toolbar.fixedKeys"],this.lastRibbonKeys=t),Ye().createElement(Ir,{ribbons:t,pinned:n,style:r}))},t.prototype.getClassicToolbar=function(e){var t=this.lastClassicKey,n=this.props["toolbar.pinnedKey"],r={position:"absolute"};return"entered"===e?null:("entering"===e&&(r.animation="".concat(Nr.fadeoutClassic," 0.3s linear")),"exiting"===e&&(r.animation="".concat(Nr.fadeinClassic," 0.3s linear"),t=this.props["toolbar.fixedKeys"],this.lastClassicKey=t),"exited"===e&&(t=this.props["toolbar.fixedKeys"],this.lastClassicKey=t),Ye().createElement(Or,{main:t,pinned:n,style:r}))},t.prototype.render=function(){var e=this,t=this.props["toolbar.fixedKeys"];if(!t)return null;var n=Array.isArray(t);return Ye().createElement(lr.K,{name:"fixed-toolbar",simulateSpaceChange:!0,syncWithTarget:!1,className:[Nr["fixed-toolbar-container"],n?Nr.ribbon:Nr.classic].join(" ")},Ye().createElement("div",{className:[Nr["fixed-toolbar-wrapper"],n?Nr.ribbon:Nr.classic].join(" ")},Ye().createElement(at.ZP,{in:n,timeout:300},(function(t){return Ye().createElement(Ye().Fragment,null,e.getClassicToolbar(t),e.getRibbonToolbar(t))}))))},t}(Qe.Component),Lr=(0,tt.x)([je.R.ToolbarFixedKeys,je.R.ToolbarPinnedKey,nt.j.Badge,nt.j.ModelState,nt.j.SelectionState])(kr);S.Am.service(Lr,{overridable:!0});var Dr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,Me.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props[nt.j.InsertWidget].filter((function(t){return t.position===e.props.position}));return 0===t.length?null:Ye().createElement("div",{style:{width:"100%",flexShrink:0}},t.map((function(t){return Ye().createElement(st,{key:"insert-".concat(e.props.position,"-").concat(t.name),style:t.styles},t.component)})))},t}(Qe.Component),Pr=(0,tt.x)([nt.j.InsertWidget])(Dr),xr=function(e){function t(t){var n=e.call(this,t)||this;return n.statusBarRef=null,n.statusBarRef=Ye().createRef(),n}return(0,Me.__extends)(t,e),t.prototype.componentDidMount=function(){var e,t;null===(t=null===(e=this.statusBarRef)||void 0===e?void 0:e.current)||void 0===t||t.addEventListener("animationend",this.removeFixed)},t.prototype.componentWillUnmount=function(){var e,t;null===(t=null===(e=this.statusBarRef)||void 0===e?void 0:e.current)||void 0===t||t.removeEventListener("animationend",this.removeFixed)},t.prototype.removeFixed=function(e){e.currentTarget.style.position="static"},t.prototype.render=function(){var e=S.Am.getClass(Lr),t=!this.props["toolbar.disabled"];return Ye().createElement("div",{className:Tn,id:"workbench",style:this.props.style},!this.props["titlebar.disabled"]&&Ye().createElement(fr,null),t&&Ye().createElement("div",{className:An,id:"workbench-toolbar"},Ye().createElement(e,null)),Ye().createElement(Pr,{position:"inbetween-toolbar-editorzone"}),Ye().createElement("div",{className:Sn,id:"workbench-content-container"},Ye().createElement("div",{style:{height:50,width:"100%"}}),Ye().createElement("div",{className:In,id:"workbench-drawer"},Ye().createElement(Qn,null),Ye().createElement(Zn,null)),Ye().createElement(dn,{mode:"pc"}),Ye().createElement(nr,null)),Ye().createElement("div",{className:Rn,id:"workbench-statusbar",ref:this.statusBarRef},this.props["statusbar.disabled"]?null:Ye().createElement(wn,null)))},t}(Qe.Component),Fr=(0,tt.x)([je.R.DisableToolbar,je.R.ToolbarAlignment,je.R.DisableStatusbar,je.R.ToolbarSchemaAnimation,je.R.DisableTitlebar])(xr),Br=n(457524),Ur=n(874650),Hr=n(291508),Wr=n(588955),jr=n(103568),Gr=n(488302),Vr=n(277026),zr=n(808813),Qr=function(){function e(e,t){this.trackControllerService=e,this.adapterMatchService=t}return e.prototype.use=function(e,t,n){var r=this.trackControllerService.getConfigController(e.from+e.name),o=r?Gr.p.get(r):void 0;return!this.adapterMatchService.isAvailable(o,t)&&(n(),!0)},e}();(0,Me.__decorate)([(0,Me.__param)(0,(0,_e.g)()),(0,Me.__param)(1,(0,Ce.M)()),(0,Me.__param)(2,(0,ve.o)()),(0,Me.__metadata)("design:type",Function),(0,Me.__metadata)("design:paramtypes",[Object,Object,Function]),(0,Me.__metadata)("design:returntype",void 0)],Qr.prototype,"use",null),Qr=(0,Me.__decorate)([(0,ye.d)(),(0,Me.__metadata)("design:paramtypes",[Vr.r,zr.X])],Qr),n(469594);var Yr=n(216179),Zr=n(647150),Kr=function(){function e(e){var t=this;e.register(nt.j.IsOnline,this.isOnline()),Zr.u.getInstance().changeEnd((function(){e.update(nt.j.IsOnline,t.isOnline())}))}return e.prototype.use=function(e,t){return!(this.isOnline()||!t.respectOffline||(e(),0))},e.prototype.isOnline=function(){return Zr.u.getInstance().isOnline},e}();function Jr(e){return"disabled"===e.adapterMismatchBehavior?"shouldDisabled":"shouldHide"}(0,Me.__decorate)([(0,Me.__param)(0,(0,ve.o)()),(0,Me.__param)(1,(0,ge.z)()),(0,Me.__metadata)("design:type",Function),(0,Me.__metadata)("design:paramtypes",[Function,Object]),(0,Me.__metadata)("design:returntype",void 0)],Kr.prototype,"use",null),Kr=(0,Me.__decorate)([(0,ye.d)({overridable:!0}),(0,Me.__metadata)("design:paramtypes",[He.O])],Kr);var qr=function(){function e(){}return e.prototype.initServices=function(e){S.Am.alias(Yr.v.MENU,Br.h),S.Am.alias(Yr.v.TOOLBAR,Ur.O),S.Am.alias(Yr.v.CONTEXT_MENU,Jn.L),S.Am.alias(Yr.v.STATUSBAR,Hr.t),S.Am.alias(Yr.v.TITLEBAR,ir.M),S.Am.alias(Yr.v.KEYMAP,Wr.$),this.initServiceCollection(),this.initSchema(e)},e.prototype.updateServices=function(){this.collection.getControllerRelatedUIServices().forEach((function(e){e.updateState()}))},e.prototype.initMiddlewares=function(e,t){e.use(Qr,{on:Br.h,callbackNames:[Jr(t.menu)]}),e.use(Qr,{on:Jn.L,callbackNames:[Jr(t.contextMenu)]}),e.use(Qr,{on:Ur.O,callbackNames:[Jr(t.toolbar)]}),e.use(Qr,{on:Hr.t,callbackNames:[Jr(t.statusbar)]}),ht.s||(e.use(Kr,{on:Jn.L,callbackNames:["shouldDisabled"]}),e.use(Kr,{on:Br.h,callbackNames:["shouldDisabled"]}),e.use(Kr,{on:Ur.O,callbackNames:["shouldDisabled"]}),e.use(Kr,{on:Hr.t,callbackNames:["shouldDisabled"]}))},e.prototype.getComponent=function(){var e=new Je.x9;return S.Am.factory(Je.x9,e),Ye().createElement(Je.FN.Provider,{value:e},Ye().createElement(Fr,null))},e.prototype.attach=function(e){return(0,Me.__awaiter)(this,void 0,void 0,(function(){var t=this;return(0,Me.__generator)(this,(function(n){return[2,new Promise((function(n){t.collection.services.forEach((function(e){e.$forceUpdate()})),ht.s?n():Ke().hydrate(t.getComponent(),e,(function(){n()}))}))]}))}))},e.prototype.initServiceCollection=function(){var e=[Br.h,Jn.L,Ur.O,Hr.t,ir.M,Wr.$];this.collection=S.Am.invoke(jr.y,void 0,e),S.Am.factory(jr.y,this.collection)},e.prototype.initSchema=function(e){this.collection.has(Br.h)&&e.menu.schema&&S.Am.get(Br.h).setSchema(e.menu.schema),this.collection.has(Jn.L)&&e.contextMenu.schema&&S.Am.get(Jn.L).setSchema(e.contextMenu.schema),this.collection.has(Ur.O)&&e.toolbar.schema&&S.Am.get(Ur.O).setSchema(e.toolbar.schema),this.collection.has(Hr.t)&&e.statusbar.schema&&S.Am.get(Hr.t).setSchema(e.statusbar.schema),this.collection.has(ir.M)&&e.titlebar.schema&&S.Am.get(ir.M).setSchema(e.titlebar.schema)},e}();qr=(0,Me.__decorate)([(0,Ge.t)()],qr);var Xr=function(){function e(){}return e.load=function(e,t){return(0,Me.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,Me.__generator)(this,(function(o){switch(o.label){case 0:return n=S.Am.invoke(ke.I,new Map([["container",t],["platform","pc"]])),S.Am.factory(ke.I,n),S.Am.factory(Le,new qr),[4,(r=S.Am.invoke(e)).start()];case 1:return o.sent(),[2,r]}}))}))},e}(),$r=n(592698),eo=n(176654),to=n(935347),no=n(193506),ro=n(472863),oo=n(743447),io=n(581559),ao=n(372722),so=n(207788),co=n(399267),lo=n(429749),uo=n(826691),po=n(452088),fo=[uo.jz.CONTEXT_TOOLBAR,"spell-item0","spell-item1","spell-item2","spell-item3","spell-item4","divider","spell-replace-one","spell-replace-all","divider","cut","copy","paste","paste-text","paste-merge","paragraph-format","delete","image-cropper","image-reset",{key:"image-download",items:["image-download-current","image-download-current-attachment","image-download-batches"]},"image-compress","image-ocr",{key:"image-process-batches",items:[uo.Fv.QUICK_TOOLS_BATCH_DOWNLOAD_IMAGE,uo.Fv.QUICK_TOOLS_BATCH_RENAME_IMAGE,uo.Fv.QUICK_TOOLS_BATCH_ADD_WATERMARK_TO_IMAGE,uo.Fv.QUICK_TOOLS_BATCH_COMPRESS_IMAGE]},{key:"image-wrap-style",items:["image-convert-inline","image-convert-square","image-convert-ownline","image-convert-behind","image-convert-infront","image-convert-tight","image-convert-through","divider","image-not-fixed","image-fixed"]},{key:"textframe-wrap-style",items:["textframe-convert-inline","textframe-convert-square","textframe-convert-top-and-bottom","textframe-convert-behind","textframe-convert-infront","textframe-convert-tight","textframe-convert-through","divider","textframe-not-fixed","textframe-fixed"]},{key:"splitline-color",items:["splitline-color-component"]},{key:"splitline-style",items:["splitline-style-".concat(d.STBorder.none),"splitline-style-".concat(d.STBorder.thick),"splitline-style-".concat(d.STBorder.dotted),"splitline-style-".concat(d.STBorder.dashSmallGap),"splitline-style-".concat(d.STBorder.dashed),"splitline-style-".concat(d.STBorder.dotDash),"splitline-style-".concat(d.STBorder.dotDotDash),"splitline-style-".concat(d.STBorder.double),"splitline-style-".concat(d.STBorder.triple),"splitline-style-".concat(d.STBorder.thinThickSmallGap),"splitline-style-".concat(d.STBorder.thickThinSmallGap),"splitline-style-".concat(d.STBorder.thinThickThinSmallGap),"splitline-style-".concat(d.STBorder.wave),"splitline-style-".concat(d.STBorder.doubleWave),"splitline-style-".concat(d.STBorder.threeDEmboss),"splitline-style-".concat(d.STBorder.threeDEngrave)]},{key:"addon-list",items:[]},"divider","delete-content-control","divider",{key:"insertRowCol",items:["insertRowAbove","insertRowBelow","insertColLeft","insertColRight"]},{key:"removeRowCol",items:["removeRow","removeCol","deleteTable"]},"divider","mergeCells","cancelMergeCells","splitCells",{key:"averageCells",items:["averageRowHeight","averageColWidth"]},{key:"tableHorizonAlign",items:["tableHorizonLeftAlign","tableHorizonCenterAlign","tableHorizonRightAlign"]},{key:"table-wrap-text",items:["table-convert-inline","table-convert-square","divider","table-not-fixed","table-fixed"]},"divider","comment","insert-comment-ent","divider","insert_link","bookmark","divider",po.ym.EditUrl,po.ym.OpenOriginUrl,"divider","update-toc","update-toc-page-number","update-toc-setting","remove-toc","divider","clear-format","restartNumbering","continueNumbering","divider","insert-hint-placeholder","trans-to-hint","delete-hint","wxwork-quote"],ho=(uo.yW.PREVIEW_FILE,uo.yW.DOWNLOAD_FILE,uo.yW.SWITCH_MODE,uo.yW.DELETE_FILE,po.ym.OpenOriginUrl,po.ym.CopyUrl,po.ym.EditUrl,po.ym.Cancel,po.ym.SwitchMode,n(64815)),mo=n(286966),go=function(){return p.PlatformUtil.isWeWork(),!0},vo=function(){return!!window.PRIVATE},_o=n(541422),yo=["snippet-task-list","snippet-work-daily","snippet-work-report","snippet-conference-record","snippet-addon-work_plan","snippet-addon-project_management","snippet-addon-timeline","snippet-addon-project_milestone"],bo=(0,r.__spreadArray)((0,r.__spreadArray)(["insert-image",{key:"insert-table",items:[uo.Fv.PARAGRAPH_TABLE_PANEL]},"insert-link","bookmark",{key:"insert-snippet",items:yo},"insert-codeblock","addon-countdown",uo.Fv.PARAGRAPH_LATEX,{key:"insert-symbol",items:["symbol-panel"]},"doc-addon-mind_map","doc-addon-flow_chart",uo.Fv.PARAGRAPH_SIGNATURE,"divider",{key:"insert-splitline",items:["splitline-style-".concat(d.STBorder.none),"splitline-style-".concat(d.STBorder.thick),"splitline-style-".concat(d.STBorder.dotted),"splitline-style-".concat(d.STBorder.dashSmallGap),"splitline-style-".concat(d.STBorder.dashed),"splitline-style-".concat(d.STBorder.dotDash),"splitline-style-".concat(d.STBorder.dotDotDash),"splitline-style-".concat(d.STBorder.double),"splitline-style-".concat(d.STBorder.triple),"splitline-style-".concat(d.STBorder.thinThickSmallGap),"splitline-style-".concat(d.STBorder.thickThinSmallGap),"splitline-style-".concat(d.STBorder.thinThickThinSmallGap),"splitline-style-".concat(d.STBorder.wave),"splitline-style-".concat(d.STBorder.doubleWave),"splitline-style-".concat(d.STBorder.threeDEmboss),"splitline-style-".concat(d.STBorder.threeDEngrave),{key:"insert-splitline-color",items:["insert-splitline-color-component"]},{key:"insert-splitline-size",items:["linesize-quarter_width","linesize-half_width","linesize-half_and_quarter_width","linesize-one_width","linesize-one_and_half_width","linesize-two_and_quarter_width","linesize-three_width","linesize-four_and_half_width","linesize-six_width"]}]},"divider"],(0,r.__read)(vo()?[]:["add-member-contact-card","add-group-contact-card"]),!1),["divider","insert-doc-link",uo.Fv.INSERT_ATTACHMENT,"addon-insert_addons"],!1),Eo=["insert-image",{key:"insert-table",items:["table-panel"]},"insert-link","bookmark",{key:"insert-snippet",items:yo},{key:uo.Ak.SDT_WIDGET,items:[uo.Ak.RICH_TEXT_CONTENT_CONTROL]},"insert-codeblock","addon-countdown","addon-latex",{key:"insert-symbol",items:["symbol-panel"]},"doc-addon-mind_map","doc-addon-flow_chart","insert-comment","signature","divider",{key:"insert-splitline",items:["splitline-style-".concat(d.STBorder.none),"splitline-style-".concat(d.STBorder.thick),"splitline-style-".concat(d.STBorder.dotted),"splitline-style-".concat(d.STBorder.dashSmallGap),"splitline-style-".concat(d.STBorder.dashed),"splitline-style-".concat(d.STBorder.dotDash),"splitline-style-".concat(d.STBorder.dotDotDash),"splitline-style-".concat(d.STBorder.double),"splitline-style-".concat(d.STBorder.triple),"splitline-style-".concat(d.STBorder.thinThickSmallGap),"splitline-style-".concat(d.STBorder.thickThinSmallGap),"splitline-style-".concat(d.STBorder.thinThickThinSmallGap),"splitline-style-".concat(d.STBorder.wave),"splitline-style-".concat(d.STBorder.doubleWave),"splitline-style-".concat(d.STBorder.threeDEmboss),"splitline-style-".concat(d.STBorder.threeDEngrave),"divider",{key:"insert-splitline-color",items:["insert-splitline-color-component"]},{key:"insert-splitline-size",items:["linesize-quarter_width","linesize-half_width","linesize-half_and_quarter_width","linesize-one_width","linesize-one_and_half_width","linesize-two_and_quarter_width","linesize-three_width","linesize-four_and_half_width","linesize-six_width"]}]},{key:"insert-page-header-footer-number",items:["insert-page-header","insert-page-footer",{key:"insert-page-number",items:["insert-page-number-at-cursor","insert-page-number-at-header","insert-page-number-at-footer"]}]},{key:"insert-breaks",items:["insert-page-break","divider","insert-next-page-section-break","insert-continuous-section-break","insert-even-page-section-break","insert-odd-page-section-break"]},"insert-toc",{key:uo.Ak.FOOTNOTE_ENDNOTE,items:["insert-footnote","insert-endnote","divider",{key:uo.Ak.JUMP_TO_NEXT_NOTE,items:["prev-footnote","next-footnote","prev-endnote","next-endnote"]}]},"divider","addon-tencent_meeting_test","addon-tencent_meeting_release","insert-doc-link",uo.Fv.INSERT_ATTACHMENT,"insert-qq-card","addon-insert_addons",ho.U5.Insert],Co=["view-background","view-toc","view-ruler","view-comment","view-page","view-fullscreen","all-bookmark","divider","page-settings",{key:"page-background",items:["watermark","shading"]},"shading-standlone"],wo=["insert-toc","divider","insert-footnote","insert-endnote","divider",{key:uo.Ak.JUMP_TO_NEXT_NOTE,items:["prev-footnote","next-footnote","prev-endnote","next-endnote"]}],To=[uo.Fv.REVIEW_INSERT_COMMENT,"divider",uo.Fv.TOGGLE_TRACK_CHANGES,{key:uo.Fv.REVISION_MARKUP_OPTIONS,items:[uo.Fv.FINAL_MODE_WITH_MARKUP,uo.Fv.FINAL_MODE,uo.Fv.ORIGINAL_MODE_WITH_MARKUP,uo.Fv.ORIGINAL_MODE]},{key:uo.Fv.ACCEPT_REVISION,items:[uo.Fv.ACCEPT_CURRENT_REVISION,uo.Fv.ACCEPT_ALL_FORMAT_REVISIONS,uo.Fv.ACCEPT_ALL_REVISIONS]},{key:uo.Fv.REJECT_REVISION,items:[uo.Fv.REJECT_CURRENT_REVISION,uo.Fv.REJECT_ALL_FORMAT_REVISIONS,uo.Fv.REJECT_ALL_REVISIONS]},uo.Fv.MOVE_TO_PREVIOUS_REVISION,uo.Fv.MOVE_TO_NEXT_REVISION,"divider",uo.Fv.RESTRICT_EDIT],Ao=[{key:mo.z_.FILE,items:["file-info-panel-pc","divider","permissions","divider","copy-link","divider","local-file-save-as","local-file-save","local-file-show-item-in-folder","local-file-view-origin-file",{key:"export-as",items:["export-as-docx","export-as-pdf","snap-screen","shortcut"]},"clone","save-as-template","publish","divider","save-version","version-history","edit-history","view-history","divider",{key:"permission-submenu",items:["permission-simple","permission-pro","divider","change-owner"]},uo.Fv.PREFERENCE_SETTINGS,"divider","title-color","toggle-like","toggle-anonymous","divider","print","divider","exit-document","accessibility","switch_certification",{key:"help-center",items:["faq","feedback","report",{key:"privacy",items:["privacy-policy","third-information-checklist","third-authorization-management","personal-information-checklist"]},"infringement-guide","appeal","about","community-convention","doc-version"]},"report-publish","copy-sharelink","collect-pc",{key:"subscription-notification",items:["subscribe-all","subscribe-myself"]}]},{key:mo.z_.TOOLBAR_MODE,items:["single-line-toolbar","double-line-toolbar","divider","immersive-toolbar"]},{key:"page-settings-menu",items:["page-settings",{key:"page-background",items:["watermark","shading"]},"shading-standlone","view-background","view-toc","view-ruler","view-comment"]},{key:"delete-header-footer",items:["delete-header","delete-footer","delete-page-num"]},{key:"header-setting",items:["toggle_title_page","toggle_even_and_odd_headers","toggle_header_separator"]},{key:"footer-setting",items:["toggle_title_page","toggle_even_and_odd_headers"]},{key:mo.z_.EDIT,items:(0,r.__spreadArray)((0,r.__spreadArray)([{key:"format-common",items:[{key:"heading",items:["normal","divider","title","subtitle","divider","heading1","heading2","heading3","heading4","heading5","heading6","heading7","heading8","heading9"]},{key:"font-emphasis",items:["bold","italic","underline","strike-through","sup","sub",{key:"font-scaling",items:["font-scaling-component"]},{key:"letter-spacing",items:["letter-spacing-component"]},{key:"font-color",items:["font-color-component"]},{key:"font-background",items:["font-background-component"]}]},{key:"paragraph",items:[{key:"align",items:["align-left","align-center","align-right","align-justify","align-distribute"]},{key:"line-height",items:["line-height-1","line-height-1.15","line-height-1.3","line-height-1.5","line-height-2","line-height-3","divider","more-line-height-setting"]},{key:"indent",items:["increase-indent","decrease-indent"]},"more-paragraph-settings"]},"divider","clear-format"]},{key:"format-table",items:[{key:"table-border",items:["table-border-component","divider",{key:"table-border-color",items:["table-border-color-component"]}]},{key:"table-fill-color",items:["table-fill-color-component"]},"merge-cell",{key:"table-horizental-align",items:["table-horizental-align-left","table-horizental-align-center","table-horizental-align-right","table-horizental-align-justify","table-horizental-align-distribute"]},{key:"table-vertical-align",items:["table-vertical-align-top","table-vertical-align-center","table-vertical-align-bottom"]}]},{key:"format-splitline",items:["format-splitline-".concat(d.STBorder.none),"format-splitline-".concat(d.STBorder.thick),"format-splitline-".concat(d.STBorder.dotted),"format-splitline-".concat(d.STBorder.dashSmallGap),"format-splitline-".concat(d.STBorder.dashed),"format-splitline-".concat(d.STBorder.dotDash),"format-splitline-".concat(d.STBorder.dotDotDash),"format-splitline-".concat(d.STBorder.double),"format-splitline-".concat(d.STBorder.triple),"format-splitline-".concat(d.STBorder.thinThickSmallGap),"format-splitline-".concat(d.STBorder.thickThinSmallGap),"format-splitline-".concat(d.STBorder.thinThickThinSmallGap),"format-splitline-".concat(d.STBorder.wave),"format-splitline-".concat(d.STBorder.doubleWave),"format-splitline-".concat(d.STBorder.threeDEmboss),"format-splitline-".concat(d.STBorder.threeDEngrave),"divider",{key:"format-splitline-color",items:["format-splitline-color-component"]}]}],(0,r.__read)(Co),!1),["divider","find-replace"],!1)},{key:"unofficial-addons",items:["unofficial-addons-panel-title","system-addons-panel-title","spellcheck","translate","markdown","resume-assistant"]},{key:"toolbar-menu",items:[{key:"insert",items:Eo},{key:"page",items:Co},{key:"reference",items:wo},{key:uo.Fv.REVIEW,items:To},{key:"efficiency",items:["spellcheck","translate","markdown","resume-assistant","divider","snap-screen",{key:uo.Fv.PDF_TRANSFORM,items:[uo.Fv.PDF_TRANSFORM_DOC_TO_PDF,"divider",uo.Fv.PDF_TRANSFORM_PDF_TO_WORD,uo.Fv.PDF_TRANSFORM_PDF_TO_EXCEL,uo.Fv.PDF_TRANSFORM_PDF_TO_PPT]},"divider",{key:uo.Fv.QUICK_TOOLS,items:[uo.Fv.QUICK_TOOLS_BATCH_PROCESS_IMAGE,uo.Fv.QUICK_TOOLS_BATCH_DOWNLOAD_IMAGE,uo.Fv.QUICK_TOOLS_BATCH_RENAME_IMAGE,uo.Fv.QUICK_TOOLS_BATCH_ADD_WATERMARK_TO_IMAGE,uo.Fv.QUICK_TOOLS_BATCH_COMPRESS_IMAGE]},"unofficial-addons"]},{key:"government",items:[{key:uo.Fv.GOVERNMENT_TEMPLATE,items:[uo.Fv.GOVERNMENT_TEMPLATE_CONTENT]},"divider",{key:uo.Fv.GOVERNMENT_HEADER,items:[uo.Fv.GOVERNMENT_HEADER_CONTENT]},{key:uo.Fv.GOVERNMENT_SEPERATOR,items:["gov-seperator-style-normal","gov-seperator-style-lower","gov-seperator-style-upper","gov-seperator-style-start"]},"divider",{key:uo.Fv.GOVERNMENT_SINGLE_AUTHORITY,items:[uo.Fv.GOVERNMENT_SINGLE_AUTHORITY_CONTENT]},{key:uo.Fv.GOVERNMENT_JOINT_AUTHORITY,items:[uo.Fv.GOVERNMENT_JOINT_AUTHORITY_CONTENT]},"divider",{key:uo.Fv.GOVERNMENT_SINGLE_LINE_EDITION,items:[uo.Fv.GOVERNMENT_SINGLE_LINE_EDITION_CONTENT]},{key:uo.Fv.GOVERNMENT_MUTIL_LINE_EDITION,items:[uo.Fv.GOVERNMENT_MUTIL_LINE_EDITION_CONTENT]}]}]},{key:uo.Ak.PARAGRAPH_SHORTCUT_MENU,items:[uo.Fv.PARAGRAPH_STYLE_GREY,uo.Fv.PARAGRAPH_MENU_TOOLBAR,"divider",uo.Fv.AI_PARAGRAPH_FLOATING_BAR,"divider",{key:uo.Fv.PARAGRAPH_INERT,items:(0,r.__spreadArray)([],(0,r.__read)(bo),!1)},uo.Fv.PARAGRAPH_COPY,uo.Fv.PARAGRAPH_CUT,uo.Fv.PARAGRAPH_DELETE]},{key:uo.Ak.PARAGRAPH_SHORTCUT_MENU_NULL,items:(0,r.__spreadArray)([uo.Fv.PARAGRAPH_STYLE_GREY,uo.Fv.PARAGRAPH_MENU_TOOLBAR,"divider",uo.Fv.AI_PARAGRAPH_FLOATING_BAR,"divider",uo.Fv.PARAGRAPH_INERT_GREY],(0,r.__read)(bo),!1)},{key:uo.Ak.WORD_COUNT_MENU,items:[uo.Fv.COUNT_INFO,uo.Fv.COUNT,uo.Fv.COUNT_NO_PUNCTUATION,uo.Fv.COUNT_CHARACTERS,uo.Fv.COUNT_CHARACTERS_NO_SPACES,uo.Fv.COUNT_LOADING]},{key:uo.Ak.TABLE_SHORTCUT_MENU,items:[{key:uo.Fv.TABLE_ADJUST,items:[uo.Fv.TABLE_ADJUST_AUTO,uo.Fv.TABLE_ADJUST_ROW,uo.Fv.TABLE_ADJUST_COL]},{key:uo.Fv.TABLE_HORIZON_ALIGN,items:[uo.Fv.TABLE_HORIZON_ALIGN_LEFT,uo.Fv.TABLE_HORIZON_ALIGN_CENTER,uo.Fv.TABLE_HORIZON_ALIGN_RIGHT]},{key:uo.Fv.TABLE_STYLE_THEME,items:[uo.Fv.TABLE_STYLE_THEME_PREVIEW]},"divider",uo.Fv.AI_TABLE_FLOATING_BAR,"divider",{key:uo.Fv.TABLE_INSERT,items:(0,r.__spreadArray)([],(0,r.__read)(bo),!1)},uo.Fv.TABLE_COPY,uo.Fv.TABLE_CUT,uo.Fv.TABLE_DELETE]},{key:uo.Ak.TOC_SHORTCUT_MENU,items:[uo.Fv.TOC_STYLE_GREY,uo.Fv.TOC_MENU_TOOLBAR,"divider",{key:uo.Fv.TOC_INSERT,items:(0,r.__spreadArray)([],(0,r.__read)(bo),!1)},uo.Fv.TOC_COPY,uo.Fv.TOC_CUT,uo.Fv.TOC_DELETE]},{key:po.ym.SwitchMode,items:[d.FieldDisplayLayoutTypeChar.Text,d.FieldDisplayLayoutTypeChar.Inline,d.FieldDisplayLayoutTypeChar.Card,d.FieldDisplayLayoutTypeChar.Preview]},{key:"page-layout-settings",items:[{key:"page-orientation",items:["page-orientation-portrait","page-orientation-landscape"]},{key:"page-size",items:["page-size-a3","page-size-a4","page-size-a5","page-size-b4","page-size-b5","divider","page-size-custom"]}]},{key:uo.Ak.SDT_WIDGET,items:[uo.Ak.RICH_TEXT_CONTENT_CONTROL]},{key:uo.Ak.SNIPPETS,items:yo},{key:"insert-row-col",items:["insert-row-above","insert-row-below","insert-col-left","insert-col-right"]},{key:"underline-menu",items:[_o.n.SINGLE,_o.n.DOUBLE,_o.n.THICK,_o.n.DOTTED,_o.n.DASH,_o.n.DOT_DASH,_o.n.DOT_DOT_DASH,_o.n.WAVE]},{key:eo.o4.SELECT_FONT_ALIGN,items:["table-horizental-align-left","table-horizental-align-center","table-horizental-align-right","divider","table-vertical-align-top","table-vertical-align-center","table-vertical-align-bottom"]}],So=new Set,Io={key:"insert-splitline",items:["splitline-clear","splitline-style-".concat(d.STBorder.thick),"splitline-style-".concat(d.STBorder.dotted),"splitline-style-".concat(d.STBorder.dashSmallGap),"splitline-style-".concat(d.STBorder.dashed),"splitline-style-".concat(d.STBorder.dotDash),"splitline-style-".concat(d.STBorder.dotDotDash),"splitline-style-".concat(d.STBorder.double),"splitline-style-".concat(d.STBorder.triple),"splitline-style-".concat(d.STBorder.thinThickSmallGap),"splitline-style-".concat(d.STBorder.thickThinSmallGap),"splitline-style-".concat(d.STBorder.thinThickThinSmallGap),"splitline-style-".concat(d.STBorder.wave),"splitline-style-".concat(d.STBorder.doubleWave),"splitline-style-".concat(d.STBorder.threeDEmboss),"splitline-style-".concat(d.STBorder.threeDEngrave),{key:"insert-splitline-color",items:["insert-splitline-color-component"]},{key:"insert-splitline-size",items:["linesize-quarter_width","linesize-half_width","linesize-half_and_quarter_width","linesize-one_width","linesize-one_and_half_width","linesize-two_and_quarter_width","linesize-three_width","linesize-four_and_half_width","linesize-six_width"]}]},Ro=(0,r.__spreadArray)((0,r.__spreadArray)(["insert-image",{key:"insert-table",items:["table-panel"]},"insert-link","insert-sheet-iframe",{key:"insert-snippet",items:vo()?["snippet-work-daily","snippet-work-report","snippet-conference-record"]:["snippet-task-list","snippet-work-daily","snippet-work-report","snippet-conference-record"]},{key:uo.Ak.SDT_WIDGET,items:[uo.Ak.RICH_TEXT_CONTENT_CONTROL]},"insert-codeblock","addon-latex","doc-addon-mind_map","doc-addon-flow_chart","signature","divider","insert-comment-ent","divider",Io,{key:"insert-page-header-footer-number",items:["insert-page-header","insert-page-footer",{key:"insert-page-number",items:["insert-page-number-at-cursor","insert-page-number-at-header","insert-page-number-at-footer"]}]},"insert-page-break","divider"],(0,r.__read)(vo()?[]:["add-member-contact-card","add-group-contact-card"]),!1),["add-cold-start-button","divider","insert-doc-link-ent",{key:"insert-file",items:vo()?["insert-file-wedrive"]:["insert-file-wedrive","insert-file-local"]},"insert-app",!vo()&&{key:"wxwork-calender",items:["create-wxwork-calender","insert-wxwork-calender"]},!vo()&&{key:"wxwork-meeting",items:["create-wxwork-meeting","insert-wxwork-meeting"]},!vo()&&"task-list","insert-date-reminder","addon-insert_addons"],!1),Mo=((0,r.__spreadArray)([{key:"file",items:["file-info-panel-ent-pc","divider","add-cooperator","share-pc",!vo()&&"share-to-wechat","copy-sharelink","permission-pro","divider","publish","divider","collect-pc","add-fast-access","add-wedrive-shortcut","move-to-wedrive",{key:"watch-in-wedrive",items:["open-in-wedrive"]},"divider","edit-history","view-history",{key:"help-edit-function",items:[{key:"format-common",items:[{key:"heading",items:["normal","divider","title","subtitle","divider","heading1","heading2","heading3","heading4","heading5","heading6","heading7","heading8","heading9"]},{key:"font-emphasis",items:["bold","italic","underline","strike","sup","sub",{key:"letter-spacing",items:["letter-spacing-component"]},{key:"font-color",items:["font-color-component"]},{key:"font-background",items:["font-background-component"]}]},{key:"paragraph",items:[{key:"align",items:["align-left","align-center","align-right","align-justify","align-distribute"]},{key:"line-height",items:["line-height-1","line-height-1.15","line-height-1.3","line-height-1.5","line-height-2","line-height-3","divider","more-line-height-setting"]},{key:"indent",items:["increase-indent","decrease-indent"]},"more-paragraph-settings"]},"divider","clear-format"]},{key:"format-table",items:[{key:"table-border",items:["table-border-component","divider",{key:"table-border-color",items:["table-border-color-component"]}]},{key:"table-fill-color",items:["table-fill-color-component"]},"merge-cell",{key:"table-horizental-align",items:["table-horizental-align-left","table-horizental-align-center","table-horizental-align-right","table-horizental-align-justify","table-horizental-align-distribute"]},{key:"table-vertical-align",items:["table-vertical-align-top","table-vertical-align-center","table-vertical-align-bottom"]}]},Io,{key:"insert-page-header-footer-number-without-icon",items:["insert-page-header","insert-page-footer",{key:"insert-page-number",items:["insert-page-number-at-cursor","insert-page-number-at-header","insert-page-number-at-footer"]}]},"divider","view-toc","view-ruler","view-comment","view-page","view-fullscreen","divider","page-settings",{key:"page-background",items:["watermark","shading"]},"divider","find-replace"]},"divider","save-as-template","clone",{key:"export-as",items:vo()?["export-as-docx","snap-screen","shortcut"]:["export-as-docx","export-as-pdf","snap-screen","shortcut"]},"add-to-mail","print","divider",{key:"show-more",items:["open-in-browser","accessibility",{key:"tob-help-and-feedback",items:vo()?["tob-help-quickly-key"]:["tob-help-feedback","tob-help-quickly-key","divider","tob_recent_input_text","divider","complaint","wxwork-help-and-feedback-log-report"]}]},"divider",{key:"sync-to-tencent-document-list",items:["synchronize-tencent-file-list","asynchronize-tencent-single-file","asynchronize-tencent-all-file"]},"divider","collab-exit","delete-doc"]},{key:"insert",items:(0,r.__spreadArray)((0,r.__spreadArray)(["insert-image",{key:"insert-table",items:["table-panel"]},"insert-link","insert-sheet-iframe",{key:"insert-snippet",items:vo()?["snippet-work-daily","snippet-work-report","snippet-conference-record"]:["snippet-task-list","snippet-work-daily","snippet-work-report","snippet-conference-record"]},{key:uo.Ak.SDT_WIDGET,items:[uo.Ak.RICH_TEXT_CONTENT_CONTROL]},"insert-codeblock","addon-latex","doc-addon-mind_map","doc-addon-flow_chart","signature","divider","insert-comment-ent","divider",Io,{key:"insert-page-header-footer-number",items:["insert-page-header","insert-page-footer",{key:"insert-page-number",items:["insert-page-number-at-cursor","insert-page-number-at-header","insert-page-number-at-footer"]}]},{key:"insert-breaks",items:["insert-page-break","divider","insert-next-page-section-break","insert-continuous-section-break","insert-even-page-section-break","insert-odd-page-section-break"]},"divider"],(0,r.__read)(vo()?[]:["add-member-contact-card","add-group-contact-card"]),!1),["divider","insert-doc-link-ent",{key:"insert-file",items:vo()?["insert-file-wedrive"]:["insert-file-wedrive","insert-file-local"]},"insert-app",!vo()&&{key:"wxwork-calender",items:["create-wxwork-calender","insert-wxwork-calender"]},!vo()&&"task-list","insert-date-reminder","addon-insert_addons"],!1),items:Ro},{key:"more",items:[{key:"format-common",items:[{key:"heading",items:["normal","divider","title","subtitle","divider","heading1","heading2","heading3","heading4","heading5","heading6","heading7","heading8","heading9"]},{key:"font-emphasis",items:["bold","italic","underline","strike","sup","sub",{key:"letter-spacing",items:["letter-spacing-component"]},{key:"font-color",items:["font-color-component"]},{key:"font-background",items:["font-background-component"]}]},{key:"paragraph",items:[{key:"align",items:["align-left","align-center","align-right","align-justify","align-distribute"]},{key:"line-height",items:["line-height-1","line-height-1.15","line-height-1.3","line-height-1.5","line-height-2","line-height-3","divider","more-line-height-setting"]},{key:"indent",items:["increase-indent","decrease-indent"]},"more-paragraph-settings"]},"divider","clear-format"]},{key:"format-table",items:[{key:"table-border",items:["table-border-component","divider",{key:"table-border-color",items:["table-border-color-component"]}]},{key:"table-fill-color",items:["table-fill-color-component"]},"merge-cell",{key:"table-horizental-align",items:["table-horizental-align-left","table-horizental-align-center","table-horizental-align-right","table-horizental-align-justify","table-horizental-align-distribute"]},{key:"table-vertical-align",items:["table-vertical-align-top","table-vertical-align-center","table-vertical-align-bottom"]}]},Io,{key:"insert-page-header-footer-number-without-icon",items:["insert-page-header","insert-page-footer",{key:"insert-page-number",items:["insert-page-number-at-cursor","insert-page-number-at-header","insert-page-number-at-footer"]}]},"divider","view-toc","view-ruler","view-comment","view-page","view-fullscreen","divider","page-settings",{key:"page-background",items:["watermark","shading"]},"divider","find-replace"]},{key:"unofficial-addons",items:["unofficial-addons-panel-title","spellcheck","translate","markdown"]},{key:uo.Ak.PARAGRAPH_SHORTCUT_MENU,items:[uo.Fv.PARAGRAPH_MENU_TOOLBAR,"divider",uo.Fv.AI_PARAGRAPH_FLOATING_BAR,"divider",uo.Fv.WXWORK_QUOTE,uo.Fv.PARAGRAPH_COPY,uo.Fv.PARAGRAPH_CUT,uo.Fv.PARAGRAPH_DELETE,"divider",{key:uo.Fv.PARAGRAPH_INERT,items:(0,r.__spreadArray)([],(0,r.__read)(Ro),!1)}]},{key:uo.Ak.PARAGRAPH_SHORTCUT_MENU_NULL,items:(0,r.__spreadArray)([uo.Fv.PARAGRAPH_MENU_TOOLBAR,"divider"],(0,r.__read)(Ro),!1)}],(0,r.__read)(Ao),!1).filter((function(e){var t="string"==typeof e?e:e.key;return!So.has(t)&&(So.add(t),!0)})),n(996600)),Oo={left:["toc",Mo.JT,"page-status","word-count"],right:["dark-mode","play","tencent-meeting-play","divider","full-screen","zoom"]},No=(Mo.Kq,n(783504)),ko=(vo()?(No.ZP.t("插入"),No.ZP.t("内容块")):(No.ZP.t("插入"),uo.tV.INSERT_ATTACHMENT,No.ZP.t("内容块"),No.ZP.t("addon:addons")),No.ZP.t("ui:toolbar.style"),No.ZP.t("段落"),No.ZP.t("行间距"),go(),go(),n(870372));ko.C.SwitchCertificationMobile,(0,j.$t)("file-mobile:file"),(0,j.$t)("查看");var Lo=n(631141),Do={"toolbar-start":{data:[{items:[[[eo.o4.UNDO,eo.o4.REDO],[eo.o4.FORMAT_PAINT,eo.o4.CLEAR_FORMAT]]]},[eo.o4.INSERT],{shelter:eo.o4.FONT_SHELTER,items:[[[eo.o4.FONT,eo.o4.FONT_SIZE,eo.o4.FONT_SIZE_INCREASE,eo.o4.FONT_SIZE_DECREASE],[eo.o4.BOLD,eo.o4.ITALIC,eo.o4.UNDERLINE,eo.o4.STRIKE,eo.o4.SUB,eo.o4.SUP,eo.o4.LETTER_SPACING,eo.o4.FONT_SCALING,eo.o4.FONT_BACKGROUND_COLOR,eo.o4.FONT_COLOR]]]},{shelter:eo.o4.PARAGRAPH_SHELTER,items:[[[eo.o4.BULLET_LIST,eo.o4.NUMBERED_LIST,eo.o4.TASK_LIST,eo.o4.DESC_INDENT,eo.o4.INC_INDENT,eo.o4.LINE_HEIGHT],[eo.o4.ALIGNMENT_LEFT,eo.o4.ALIGNMENT_CENTER,eo.o4.ALIGNMENT_RIGHT,eo.o4.ALIGNMENT_JUSTIFY,eo.o4.ALIGNMENT_DISTRIBUTE,eo.o4.MENU_QUOTE,eo.o4.PARAGRAPH_LIGHTBLOCK]]]},{shelter:eo.o4.IMAGE_SHELTER,items:[[[eo.o4.IMAGE_CROPPER],[eo.o4.ROTATE_IMAGE]],[[eo.o4.IMAGE_RESET]]]},{shelter:eo.o4.TABLE_SHELTER,items:[[[eo.o4.CELL_BORDER],[eo.o4.CELL_COLOR]],[[eo.o4.ALIGN_VERTICAL,eo.o4.CELL_MERGE]]]},[eo.o4.HEADING_COMPONENT],[uo.aE.QUICK_TOOLS,eo.o4.UNOFFICIAL_ADDONS],{shelter:uo.aE.FORMAT_CONVERSION_SHELTER,items:[[[uo.aE.GENERATE_IMAGE,uo.aE.PDF_TRANSFORM]]]},[eo.o4.INSERT_MENTION_ENT],["print"]],moreText:No.ZP.t("ui:more-text"),moreTooltip:No.ZP.t("ui:more-tooltip"),label:No.ZP.t("ui:toolbar-start")},"toolbar-insert":{data:[["insert-image","insert-link","insert-table","insert-codeblock","insert-bookmark","addon-latex","insert-symbol","insert-toc","signature"],["insert-splitline",[["insert-page-break"],["insert-header-footer"]]],["doc-addon-mind_map","doc-addon-flow_chart"],["insert-doc-link","insert-attachment"],["insert-qq-card"],["embed-webpage"],["insert-snippet","insert-addons",uo.aE.SDT_WIDGET],["insert-comment"]],moreText:No.ZP.t("ui:more-text"),moreTooltip:No.ZP.t("ui:more-tooltip"),label:No.ZP.t("ui:toolbar-insert")},"toolbar-page":{data:[["outline","bookmark","view-ruler"],["page-margin",[["page-size"],["page-orientation"]]],["watermark","page-shade"]],moreText:No.ZP.t("ui:more-text"),moreTooltip:No.ZP.t("ui:more-tooltip"),label:No.ZP.t("ui:toolbar-page")},"toolbar-reference":{data:[["insert-toc"],[eo.o4.INSERT_FOOTNOTE],[[[eo.o4.PREV_FOOTNOTE],[eo.o4.NEXT_FOOTNOTE]]],[eo.o4.INSERT_ENDNOTE],[[[eo.o4.PREV_ENDNOTE],[eo.o4.NEXT_ENDNOTE]]]],moreText:No.ZP.t("ui:more-text"),moreTooltip:No.ZP.t("ui:more-tooltip"),label:No.ZP.t("ui:toolbar-reference")},"toolbar-review":{data:[[uo.aE.REVIEW_INSERT_COMMENT],[uo.aE.TOGGLE_TRACK_CHANGES,uo.aE.REVISION_MARKUP_OPTIONS,uo.aE.ACCEPT_REVISION,uo.aE.REJECT_REVISION,uo.aE.MOVE_TO_PREVIOUS_REVISION,uo.aE.MOVE_TO_NEXT_REVISION],[uo.aE.RESTRICT_EDIT]],moreText:No.ZP.t("ui:more-text"),moreTooltip:No.ZP.t("ui:more-tooltip"),label:No.ZP.t("ui:toolbar-review")},"toolbar-efficiency":{data:[["spellcheck","translate","markdown"],[uo.aE.GENERATE_IMAGE,uo.aE.PDF_TRANSFORM],["resume-assistant"],[uo.aE.QUICK_TOOLS,eo.o4.UNOFFICIAL_ADDONS]],moreText:No.ZP.t("ui:more-text"),moreTooltip:No.ZP.t("ui:more-tooltip"),label:No.ZP.t("ui:toolbar-efficiency")},"toolbar-government":{data:[[uo.aE.GOVERNMENT_TEMPLATE],[uo.aE.GOVERNMENT_HEADER],[uo.aE.GOVERNMENT_SEPERATOR],[[[uo.aE.GOVERNMENT_SINGLE_AUTHORITY],[uo.aE.GOVERNMENT_JOINT_AUTHORITY]]],[[[uo.aE.GOVERNMENT_SINGLE_LINE_EDITION],[uo.aE.GOVERNMENT_MUTIL_LINE_EDITION]]]],label:No.ZP.t("ui:toolbar-government")},"toolbar-image":{data:[{shelter:eo.o4.IMAGE_SHELTER,items:[[[eo.o4.IMAGE_CROPPER],[eo.o4.ROTATE_IMAGE]],[[eo.o4.IMAGE_RESET]]]}],label:No.ZP.t("ui:toolbar-image")},"toolbar-table":{data:[{shelter:eo.o4.TABLE_SHELTER,items:[[[eo.o4.CELL_BORDER],[eo.o4.CELL_COLOR]],[[eo.o4.ALIGN_VERTICAL,eo.o4.CELL_MERGE]]]}],label:No.ZP.t("ui:toolbar-table")},"toolbar-pinned":{data:[[eo.o4.FIND_REPLACE,eo.o4.TOGGLE]],label:No.ZP.t("ui:toolbar-pinned")},"toolbar-simple":{data:[["toolbar-menu"],[eo.o4.UNDO,eo.o4.REDO,eo.o4.FORMAT_PAINT,eo.o4.CLEAR_FORMAT],[eo.o4.INSERT],[eo.o4.HEADING,eo.o4.FONT,eo.o4.FONT_SIZE,eo.o4.FONT_SIZE_INCREASE,eo.o4.FONT_SIZE_DECREASE,eo.o4.BOLD,eo.o4.ITALIC,eo.o4.UNDERLINE,{shrinkType:Lo.f.GROUP_TAIL,buttons:[[eo.o4.STRIKE]],priority:4},{shrinkType:Lo.f.GROUP_TAIL,buttons:[[eo.o4.SUB]],priority:3},{shrinkType:Lo.f.GROUP_TAIL,buttons:[[eo.o4.SUP]],priority:2},{shrinkType:Lo.f.GROUP_TAIL,buttons:[[eo.o4.LETTER_SPACING,eo.o4.FONT_SCALING]],priority:1},eo.o4.FONT_BACKGROUND_COLOR,eo.o4.FONT_COLOR],[eo.o4.BULLET_LIST,eo.o4.NUMBERED_LIST,eo.o4.TASK_LIST,eo.o4.DESC_INDENT,eo.o4.INC_INDENT,eo.o4.ALIGNMENT,eo.o4.LINE_HEIGHT,eo.o4.MENU_QUOTE,eo.o4.PARAGRAPH_LIGHTBLOCK],[eo.o4.IMAGE_CROPPER,eo.o4.ROTATE_IMAGE,eo.o4.IMAGE_RESET],[eo.o4.CELL_COLOR,eo.o4.CELL_BORDER,eo.o4.ALIGN_VERTICAL,eo.o4.CELL_MERGE],[uo.aE.QUICK_TOOLS,uo.aE.PDF_TRANSFORM,uo.aE.GENERATE_IMAGE],["print",eo.o4.INSERT_MENTION_ENT]],label:No.ZP.t("ui:toolbar-simple"),moreText:No.ZP.t("ui:more-text"),moreTooltip:No.ZP.t("ui:more-tooltip")},"toolbar-paragraph-menu":{data:[[[[uo.aE.PARAGRAPH_TEXT,uo.aE.PARAGRAPH_HEADING1,uo.aE.PARAGRAPH_HEADING2,uo.aE.PARAGRAPH_HEADING3,uo.aE.PARAGRAPH_HEADING4],[uo.aE.PARAGRAPH_HEADING5,uo.aE.PARAGRAPH_HEADING6,uo.aE.PARAGRAPH_BULLET_LIST,uo.aE.PARAGRAPH_NUMBERED_LIST,uo.aE.PARAGRAPH_TASK_LIST],[uo.aE.PARAGRAPH_ALIGN_LEFT,uo.aE.PARAGRAPH_ALIGN_CENTER,uo.aE.PARAGRAPH_ALIGN_RIGHT,uo.aE.PARAGRAPH_ALIGN_JUSTIFY,uo.aE.PARAGRAPH_ALIGN_DISTRIBUTE],[uo.aE.PARAGRAPH_QUOTE,uo.aE.PARAGRAPH_LIGHTBLOCK]]]]},"toc-toolbar-menu":{data:[[[[uo.aE.PARAGRAPH_TEXT,uo.aE.PARAGRAPH_HEADING1,uo.aE.PARAGRAPH_HEADING2,uo.aE.PARAGRAPH_HEADING3,uo.aE.PARAGRAPH_HEADING4],[uo.aE.PARAGRAPH_BULLET_LIST,uo.aE.PARAGRAPH_NUMBERED_LIST,uo.aE.PARAGRAPH_TASK_LIST,uo.aE.PARAGRAPH_QUOTE]]]]},"toolbar-selection":{data:[[eo.o4.MATH_ALIGN],[eo.o4.FONT_SIZE_INCREASE,eo.o4.FONT_SIZE_DECREASE,eo.o4.BOLD,eo.o4.ITALIC,eo.o4.UNDERLINE,eo.o4.STRIKE,uo.aE.FONT_BACKGROUND_COLOR,uo.aE.FLOAT_FONT_COLOR,{shelter:eo.o4.SELECT_FONT_FORMAT,shrinkType:Lo.f.ON_THE_SPOT,forceShrink:!0,buttons:[[eo.o4.TABLE_ITALIC,eo.o4.TABLE_UNDERLINE,eo.o4.TABLE_STRIKE]]}],[eo.o4.CELL_COLOR,eo.o4.CELL_BORDER,eo.o4.SELECT_FONT_ALIGN,eo.o4.CELL_MERGE,eo.o4.CANCEL_CELL_MERGE,eo.o4.INSERT_ROW_COL,eo.o4.DELETE_ROW,eo.o4.DELETE_COL,eo.o4.DELETE_TABLE],[uo.aE.AI_FLOATING_BAR]],label:No.ZP.t("ui:toolbar-selection")},"header-footer-float-toolbar":{data:[[uo.aE.INSERT_PAGE_NUM,uo.aE.PAGE_NUM_SETTING],[uo.aE.HEADER_SETTING,uo.aE.FOOTER_SETTING],[uo.aE.LINK_TO_PREV_SECTION],[uo.aE.DELETE_HEADER_FOOTER]]}},Po=(window.isPublishedURL,["bold","italic","underline","strike-through","font-background-color"]),xo=["normal","heading1","heading2","heading3","heading4"],Fo=["font-size-18","font-size-16","font-size-14","font-size-12","font-size-11","font-size-10"],Bo=["font-color-white","font-color-black","font-color-red","font-color-yellow","font-color-green","font-color-blue","font-color-purple"],Uo=["align-left","align-center","align-right","align-justify"],Ho=["line-height-1","line-height-1.3","line-height-1.5","line-height-2","line-height-3"],Wo={key:"insertion-union",panel:[{groupKey:"insert",groupType:"grid",title:No.ZP.t("插入"),items:["insert-from-album","insert-from-shooting","insert-ocr","shooting","insert-audiorecord","insert-location","emotion","insert-table","insert-splitline","insert-comment","insert-doclink",uo.tV.INSERT_ATTACHMENT,"signature"]},{groupKey:"template",title:No.ZP.t("snippet:menu-insert-snippet"),items:["snippet-task-list","snippet-work-daily","snippet-work-report","snippet-conference-record"]},{groupKey:"mobile-plugin",title:No.ZP.t("addon:addons"),items:[]}],closeFloatPanel:!0},jo=(No.ZP.t("文本"),{key:"paragraphstyle",panel:[{groupKey:"paragraph",groupType:"list",title:No.ZP.t("段落"),items:[Uo,[["bullet-list","numbered-list","task-list"],["desc-indent","inc-indent"]],["auto-number"]]},{groupKey:"line-height",groupType:"list",title:No.ZP.t("行间距"),items:[Ho]}],closeFloatPanel:!0}),Go={key:"quick-shooting",panel:[{groupKey:"quick-shooting",groupType:"list",items:["insert-from-shooting-pop","insert-from-album-pop"]}],forcePopup:!0,forcePopupToggle:!1},Vo=((0,r.__spreadArray)((0,r.__spreadArray)([Wo,"separator",{key:"heading",panel:[{groupKey:"heading",groupType:"list",title:No.ZP.t("标题"),items:[xo]}],closeFloatPanel:!0},{key:"font-size",panel:[{groupKey:"font-size",groupType:"list",title:No.ZP.t("字号"),items:[Fo]}],closeFloatPanel:!0}],(0,r.__read)(Po),!1),[{key:"font-color",panel:[{groupKey:"font-color",groupType:"list",title:No.ZP.t("文本颜色"),items:[Bo]}],closeFloatPanel:!0},"separator","bullet-list","numbered-list","inc-indent","desc-indent",{key:"align",panel:[{groupKey:"align",groupType:"list",title:No.ZP.t("对齐"),items:[Uo]}],closeFloatPanel:!0},{key:"line-height",panel:[{groupKey:"line-height",groupType:"list",title:No.ZP.t("行间距"),items:[Ho]}],closeFloatPanel:!0},{key:"auto-number-entry",panel:[{groupKey:"auto-number",groupType:"list",title:No.ZP.t("自动编号列表"),items:["auto-number"]}],closeFloatPanel:!0},"separator",Go,"voice-input","task-list","insert-mention","separator","ai-floatingbar"],!1),(0,r.__spreadArray)((0,r.__spreadArray)([Wo,"separator",{key:"heading",panel:[{groupKey:"heading",groupType:"list",title:No.ZP.t("标题"),items:[xo]}],closeFloatPanel:!0},{key:"font-size",panel:[{groupKey:"font-size",groupType:"list",title:No.ZP.t("字号"),items:[Fo]}],closeFloatPanel:!0}],(0,r.__read)(Po),!1),[{key:"font-color",panel:[{groupKey:"font-color",groupType:"list",title:No.ZP.t("字体颜色"),items:[Bo]}],closeFloatPanel:!0},"separator",jo,"separator",Go,"voice-input","task-list","insert-mention","separator","ai-floatingbar"],!1),n(344695)),zo=n(921277),Qo=n(148084),Yo={app:"doc",version:"v_20200902173919_release",common:{titlebar:!1,toolbar:!1,statusbar:!1,menu:{},blankpage:{applyEditPermission:!1,applyViewPermission:!1,back:!1,comment:!1,errImg:!1,footer:!1,login:!1,refresh:!1,switchAccount:!1,watchOfficeAccount:!1}},custom:{widget:{"help-center":!1},contextmenu:!1,feature:{ad_mobile:!1,app_guide:!1,app_guide_pc:!1,audio:!0,bottom_bar:!1,codeblock:!1,collab_caret:!1,collab_status:!1,collab_status_mobile:!1,comment:!1,comment_mobile:!1,comment_pc:!1,contextmenu_mobile:!1,core_edit:!1,doc_preview:!1,doc_view_mobile:!0,docx_database_proxy:!1,docx_deferred_render:!1,docx_docx_render:!1,docx_pages:!1,docx_right_bar:!1,docx_tools:!1,fake_toolbar:!1,field_processor:!0,fieldcode:!0,fieldcode_date:!0,fieldcode_doc_link:!0,fieldcode_doclink_render:!0,fieldcode_mention:!1,fieldcode_mention_render:!0,file_base:!0,file_export:!0,file_mobile:!0,file_pc:!0,font:!1,fullscreen:!0,help_center:!0,help_center_mobile:!0,home_mobile:!0,image:!1,image_mobile:!1,image_pc:!1,image_readonly:!0,hyperlink:!0,list:!0,list_readonly:!0,location:!1,login:!0,manual_offline:!0,markdown:!1,mobile_header:!0,mobile_tips:!0,mobile_view:!0,move_to:!0,move_to_mobile:!0,collect_mobile:!0,newpad_input_tips:!0,ocr:!1,ocr_preview:!1,offline_edit:!0,outline:!1,outline_mobile:!0,page:!0,page_shade:!0,paragraph:!1,performance_report:!0,presentation:!1,presentation_player:!0,print:!0,publish:!0,read_record:!1,readonly_mobile_toolbar:!0,readonly_tips:!0,readonly_toolbar:!0,recover_doc:!0,revision_record:!1,scroll_position:!0,search:!0,section:!0,selective_paste:!1,share:!0,share_mobile:!0,snap_screen_mobile:!1,snap_screen_pc:!1,spellcheck:!1,splitline:!1,splitline_readonly:!0,star_mobile:!0,table:!0,tdocs_deferred_render:!0,tdocs_render:!0,template_info:!1,text_flow:!0,title:!0,title_default_add:!0,title_mobile:!0,titlebar:!0,titlebar_mobile:!0,translate:!0,unread_notify:!0,update_notice:!0,user_avatar:!0,vip:!1,voice_input:!0,watermark:!0,word_count:!0,zoom_base:!0,zoom_melo:!0,zoom_mobile:!1,zoom_pc:{wheel:!0}}}},Zo={app:"doc",version:"v_20210812182727_release",common:{titlebar:{account:!1,auth:!1,back:!1,collaborators:!1,collect:!1,fileMenu:!1,login:!1,logo:!0,moreMenu:!1,move:!1,new_logo:!1,presentation:!1,readonly:!1,saveState:!1,share:!1,title:!0},titlebar_mobile:{account:!0,ai:!0,auth:!0,collaborators:!0,collect:!0,home:!0,login:!0,logo:!0,moreMenu:!0,share:!0,title:!0},toolbar:!1,statusbar:!1,menu:{"more-type":!0,"new-folder":!1},blankpage:{applyEditPermission:!0,applyViewPermission:!0,back:!0,comment:!0,errImg:!0,feedbackQuestion:!0,footer:!0,login:!0,refresh:!0,switchAccount:!0,watchOfficeAccount:!0}},custom:{widget:{"help-center":!0},contextmenu:{},feature:{ad_mobile:!0,"addon.support_new_sdk":!0,app_guide:!0,app_guide_pc:!0,attachment:!0,audio:!0,codeblock:!0,collab_caret:!0,collab_status:!0,collab_status_mobile:!0,comment:!0,comment_mobile:!0,comment_pc:!0,contextmenu_mobile:!0,core_edit:!0,doc_preview:!0,doc_view_mobile:!0,docx_database_proxy:!0,docx_deferred_render:!0,docx_docx_render:!0,docx_pages:!0,docx_right_bar:!0,docx_tools:!0,fake_toolbar:!0,field_processor:!0,fieldcode:!0,fieldcode_date:!0,fieldcode_doc_link:!0,fieldcode_doclink_render:!0,fieldcode_mention:!0,fieldcode_mention_render:!0,file_base:!0,file_export:!0,file_mobile:!0,file_pc:!0,font:!0,fullscreen:!0,help_center:!0,help_center_mobile:!0,home_mobile:!0,image:!0,image_mobile:!0,image_pc:!0,image_readonly:!0,link:!0,list:!0,list_readonly:!0,location:!0,login:!0,manual_offline:!0,markdown:!0,mobile_header:!0,mobile_precise_preview:!1,mobile_tips:!0,mobile_view:!0,move_to:!0,move_to_mobile:!0,newpad_input_tips:!0,ocr:!0,ocr_preview:!0,offline_edit:!0,outline:!0,outline_mobile:!0,page:!0,page_shade:!0,paragraph:!0,performance_report:!0,presentation:!0,presentation_player:!1,print:!0,publish:!0,read_record:!0,readonly_mobile_toolbar:!0,readonly_tips:!0,readonly_toolbar:!0,recover_doc:!0,revision_record:!0,scroll_position:!0,search:!0,section:!0,selective_paste:!0,share:!0,share_mobile:!0,snap_screen_mobile:!0,snap_screen_pc:!0,spellcheck:!0,splitline:!0,splitline_readonly:!0,star_mobile:!0,table:!0,tdocs_deferred_render:!0,tdocs_render:!0,template_info:!0,text_flow:!0,title:!0,title_default_add:!0,title_mobile:!0,titlebar:!0,titlebar_mobile:!0,translate:!0,unread_notify:!0,update_notice:!0,user_avatar:!0,vip:!0,voice_input:!0,watermark:!0,word_count:!0,zoom_base:!0,zoom_melo:!0,zoom_mobile:!0,zoom_pc:{wheel:!0}}}},Ko={app:"doc",version:"v_20210824230003_release",common:{titlebar:!1,titlebar_mobile:{account:!0,ai:!0,auth:!0,collaborators:!0,collect:!0,home:!0,login:!0,logo:!1,moreMenu:!0,share:!0,share_web:!1,title:!0},toolbar:!1,statusbar:!1,menu:{},blankpage:{applyEditPermission:!0,applyViewPermission:!0,back:!0,comment:!0,errImg:!0,feedbackQuestion:!0,footer:!0,login:!0,refresh:!0,switchAccount:!0,watchOfficeAccount:!0}},custom:{widget:{"help-center":!1},contextmenu:!1,feature:{ad_mobile:!0,"addon.support_new_sdk":!0,app_guide:!1,app_guide_pc:!1,attachment:!0,audio:!0,codeblock:!0,collab_caret:!1,collab_status:!0,collab_status_mobile:!0,comment:!0,comment_mobile:!1,comment_pc:!1,contextmenu_mobile:!0,core_edit:!0,doc_preview:!0,doc_view_mobile:!0,docx_database_proxy:!0,docx_deferred_render:!0,docx_docx_render:!0,docx_pages:!0,docx_right_bar:!0,docx_tools:!0,fake_toolbar:!0,field_processor:!0,fieldcode:!0,fieldcode_date:!0,fieldcode_doc_link:!0,fieldcode_doclink_render:!0,fieldcode_mention:!0,fieldcode_mention_render:!0,file_base:!0,file_export:!0,file_mobile:!0,file_pc:!0,font:!0,fullscreen:!0,help_center:!0,help_center_mobile:!0,home_mobile:!0,image:!0,image_mobile:!0,image_pc:!0,image_readonly:!0,link:!0,list:!0,list_readonly:!0,location:!0,login:!0,manual_offline:!0,markdown:!0,mobile_header:!0,mobile_precise_preview:!1,mobile_tips:!0,mobile_view:!0,move_to:!0,move_to_mobile:!0,newpad_input_tips:!0,ocr:!0,ocr_preview:!0,offline_edit:!0,outline:!0,outline_mobile:!0,page:!0,page_shade:!0,paragraph:!0,performance_report:!0,presentation:!0,presentation_player:!1,print:!0,publish:!0,read_record:!0,readonly_mobile_toolbar:!0,readonly_tips:!0,readonly_toolbar:!0,recover_doc:!0,revision_record:!0,scroll_position:!0,search:!0,section:!0,selective_paste:!0,share:!0,share_mobile:!0,snap_screen_mobile:!0,snap_screen_pc:!0,spellcheck:!1,splitline:!0,splitline_readonly:!0,star_mobile:!0,table:!0,tdocs_deferred_render:!0,tdocs_render:!0,template_info:!1,text_flow:!0,title:!0,title_default_add:!0,title_mobile:!0,titlebar:!0,titlebar_mobile:!0,translate:!0,unread_notify:!0,update_notice:!0,user_avatar:!0,vip:!1,voice_input:!0,watermark:!0,word_count:!0,zoom_base:!0,zoom_melo:!0,zoom_mobile:!0,zoom_pc:{wheel:!0}}}},Jo={app:"doc",version:"v_20210926150923_release",common:{titlebar:{account:!0,auth:!0,back:!0,collaborators:!0,collect:!0,fileMenu:!0,login:!0,logo:!0,moreMenu:!0,move:!0,new_logo:!1,presentation:!0,readonly:!0,saveState:!0,share:!0,title:!0},titlebar_mobile:{account:!0,ai:!0,auth:!0,collaborators:!0,collect:!0,home:!0,login:!0,logo:!1,moreMenu:!0,share:!0,share_web:!1,title:!0},toolbar:{"titlebar-toggle":!0},statusbar:{},menu:{"file-info-panel-mobile":!0,"more-type":!0,"new-folder":!1},blankpage:{applyEditPermission:!0,applyViewPermission:!0,back:!0,comment:!0,errImg:!0,feedbackQuestion:!0,footer:!0,login:!0,refresh:!0,switchAccount:!0,watchOfficeAccount:!0}},custom:{widget:{"help-center":!0},contextmenu:{},feature:{accessibility:!0,ad_mobile:!0,"addon.support_new_sdk":!0,app_guide:!0,app_guide_pc:!0,attachment:!0,audio:!0,closeWemeetBtn:!1,codeblock:!0,collab_caret:!0,collab_status:!0,collab_status_mobile:!0,comment:!0,comment_mobile:!0,comment_pc:!0,contextmenu_mobile:!0,core_edit:!0,doc_preview:!0,doc_view_mobile:!0,docx_database_proxy:!0,docx_deferred_render:!0,docx_docx_render:!0,docx_pages:!0,docx_right_bar:!0,docx_tools:!0,fake_toolbar:!0,field_processor:!0,fieldcode:!0,fieldcode_date:!0,fieldcode_doc_link:!0,fieldcode_doclink_render:!0,fieldcode_mention:!0,fieldcode_mention_render:!0,file_base:!0,"file_base.support_processon":!0,file_export:!0,file_mobile:!0,file_pc:!0,font:!0,fullscreen:!0,help_center:!0,help_center_mobile:!0,home_mobile:!0,image:!0,image_mobile:!0,image_pc:!0,image_readonly:!0,keymap_list:!0,link:!0,list:!0,list_readonly:!0,location:!0,login:!0,manual_offline:!0,markdown:!0,mobile_header:!0,mobile_precise_preview:!1,mobile_tips:!0,mobile_view:!0,move_to:!0,move_to_mobile:!0,newpad_input_tips:!0,ocr:!0,ocr_preview:!0,offline_edit:!0,outline:!0,outline_mobile:!0,page:!0,page_shade:!0,paragraph:!0,performance_report:!0,presentation:!0,presentation_player:!1,print:!0,publish:!0,read_record:!0,readonly_mobile_toolbar:!0,readonly_tips:!0,readonly_toolbar:!0,recover_doc:!0,revision_record:!0,scroll_position:!0,search:!0,section:!0,selective_paste:!0,share:!0,share_mobile:!0,snap_screen_mobile:!0,snap_screen_pc:!0,spellcheck:!0,splitline:!0,splitline_readonly:!0,star_mobile:!0,table:!0,tdocs_deferred_render:!0,tdocs_render:!0,template_info:!0,text_flow:!0,title:!0,title_default_add:!0,title_mobile:!0,titlebar:!0,titlebar_mobile:!0,translate:!0,unread_notify:!0,update_notice:!0,user_avatar:!0,vip:!0,voice_input:!0,watermark:!0,word_count:!0,zoom_base:!0,zoom_melo:!0,zoom_mobile:!0,zoom_pc:{wheel:!0}}}},qo={app:"doc",version:"v_20201207192816_release",common:{titlebar:!1,titlebar_mobile:{account:!0,ai:!0,auth:!0,collaborators:!0,collect:!0,home:!0,login:!0,logo:!0,moreMenu:!0,share:!0,title:!0},toolbar:!1,statusbar:{},menu:{},blankpage:{applyEditPermission:!0,applyViewPermission:!0,back:!0,comment:!0,errImg:!0,feedbackQuestion:!0,footer:!0,login:!0,refresh:!0,switchAccount:!0,watchOfficeAccount:!0}},custom:{widget:{"help-center":!0},contextmenu:{},feature:{ad_mobile:!0,app_guide:!0,app_guide_pc:!0,audio:!0,codeblock:!0,collab_caret:!0,collab_status:!0,collab_status_mobile:!0,comment:!1,comment_mobile:!1,comment_pc:!1,contextmenu_mobile:!0,core_edit:!0,doc_preview:!0,doc_view_mobile:!0,docx_database_proxy:!0,docx_deferred_render:!0,docx_docx_render:!0,docx_pages:!0,docx_right_bar:!0,docx_tools:!0,fake_toolbar:!0,field_processor:!0,fieldcode:!0,fieldcode_date:!0,fieldcode_doc_link:!0,fieldcode_doclink_render:!0,fieldcode_mention:!0,fieldcode_mention_render:!0,file_base:!0,file_export:!0,file_mobile:!0,file_pc:!0,font:!0,fullscreen:!0,help_center:!0,help_center_mobile:!0,home_mobile:!0,image:!0,image_mobile:!0,image_pc:!0,image_readonly:!0,link:!0,list:!0,list_readonly:!0,location:!0,login:!0,manual_offline:!0,markdown:!0,mobile_header:!0,mobile_tips:!0,mobile_view:!0,move_to:!0,move_to_mobile:!0,newpad_input_tips:!0,ocr:!0,ocr_preview:!0,offline_edit:!0,outline:!0,outline_mobile:!0,page:!0,page_shade:!0,paragraph:!0,performance_report:!0,presentation:!0,print:!0,publish:!0,read_record:!0,readonly_mobile_toolbar:!0,readonly_tips:!0,readonly_toast:!0,readonly_toolbar:!0,recover_doc:!0,revision_record:!0,scroll_position:!0,search:!0,section:!0,selective_paste:!0,share:!0,share_mobile:!0,snap_screen_mobile:!0,snap_screen_pc:!0,spellcheck:!0,splitline:!0,splitline_readonly:!0,star_mobile:!0,table:!0,tdocs_deferred_render:!0,tdocs_render:!0,template_info:!0,text_flow:!0,title:!0,title_default_add:!0,title_mobile:!0,titlebar:!0,titlebar_mobile:!0,translate:!0,unread_notify:!0,update_notice:!0,user_avatar:!0,vip:!0,voice_input:!0,watermark:!0,word_count:!0,zoom_base:!0,zoom_melo:!0,zoom_mobile:!0,zoom_pc:{wheel:!0}}}},Xo=function(){function e(e,t,n,r,o){var i=this;this.configService=e,this.eventEmitter=t,this.titlebarService=n,this.settings=r,this.contextService=o,this.setConfig=function(){var e,t=S.Am.get(Vo.i),n=window.basicClientVars||{},r=n.authInfo,o=n.docInfo,a=be.qO.createInstance({privilegeAttribute:(null==r?void 0:r.attribute)||{},isCreator:null==o?void 0:o.isCreator}),s=O.X.getInstance().getConfig("tenantConfig");!i.configService.isTrustedDomain()&&s&&(window.productName=s.tenantDocName,document.documentElement.style.setProperty("--tenant-custom-icon",'url("'.concat(s.tenantLogo.SVGBlack,'")')),document.documentElement.style.setProperty("--tenant-custom-icon-solid",'url("'.concat(s.tenantLogo.SVGSolidBlack,'")'))),i.contextService.inject("permission",a),i.configService.setConfig(zo.J.NORMAL,window.App.UIConfigs.NORMAL_CONFIG||Jo),i.configService.setConfig(zo.J.PUBLISH,window.App.UIConfigs.PUBLISH_CONFIG||Zo),i.configService.setConfig(zo.J.PREVIEW,window.App.UIConfigs.PREVIEW_CONFIG||qo),i.configService.setConfig(zo.J.MINIMAL,window.App.UIConfigs.MINIMAL_CONFIG||Ko),i.configService.setConfig(zo.J.PLAYER,window.App.UIConfigs.PLAYER_CONFIG||Yo),i.syncConfig(),Qo.ud.get(Qo.wA.DocsConfigLib).then((function(e){var t=e.default;t.getInstance().bind(i.configService.get("common")),t.getInstance().saveToSessionStorage()}));var c=null!==(e=i.configService.get("custom.widget"))&&void 0!==e?e:{};t.exclude(Object.keys(c).filter((function(e){return!c[e]})),"float"),i.eventEmitter.emit("TDOCS_CONFIG_SETED")}}return e.prototype.initConfig=function(){this.configService.setMode(zo.J.PUBLISH,(function(){return window.isPublishedURL})),this.configService.setMode(zo.J.PREVIEW,(function(){return!!(0,p.getUrlParameter)("inToastPreview")||!!(0,p.getUrlParameter)("ocr")})),this.configService.setMode(zo.J.MINIMAL,(function(){return!!(0,p.getUrlParameter)("minimal")||"reading"===(0,p.getUrlParameter)("mode")})),this.configService.setMode(zo.J.PLAYER,(function(){return"player"===(0,p.getUrlParameter)("show")})),this.configService.setMode(zo.J.DIFFVIEW,(function(){return!(!(0,p.getUrlParameter)("begin_rev")||!(0,p.getUrlParameter)("end_rev"))})),this.setConfig()},e.prototype.syncConfig=function(){var e=!this.configService.get("common.toolbar"),t=!this.configService.get("common.titlebar")||this.configService.get("common.toolbar")&&!this.configService.get("common.toolbar.titlebar-toggle-show");this.settings.set("toolbar.disabled",e),this.settings.set("titlebar.disabled",t),this.settings.set("statusbar.disabled",!this.configService.get("common.statusbar")),this.settings.set("contextMenu.disabled",!this.configService.get("custom.contextmenu")),this.titlebarService.$forceUpdate(),t&&e?to.p.hide(to.j.ALL):(t&&to.p.hide(to.j.Titlebar),e&&to.p.hide(to.j.Toolbar))},e.prototype.filterSchema=function(e,t){return function(e,t){var n=Object.entries(e).reduce((function(e,t){var n=(0,r.__read)(t,2),o=n[0];return n[1]||e.push(o),e}),[]);return JSON.parse(n.reduce((function(e,t){return e.replace(new RegExp('"'.concat(t,'"'),"g"),'"'.concat(t,'__removed"'))}),JSON.stringify(t)))}(e,t)},e.prototype.serviceSetSchema=function(e,t){var n=this.filterSchema(e,this[t].getSchema());this[t].setSchema(n)},e}(),$o=function(e){function t(t,n,r,o,i,a,s,c){var l=e.call(this,t,i,a,s,c)||this;return l.menuService=n,l.toolbarService=r,l.contextMenuService=o,l}var n,o,i,a,s,c,l,u;return(0,r.__extends)(t,e),t=(0,r.__decorate)([(0,Ge.t)(),(0,r.__metadata)("design:paramtypes",["function"==typeof(n=void 0!==lo.ax&&lo.ax)?n:Object,"function"==typeof(o=void 0!==Br.h&&Br.h)?o:Object,"function"==typeof(i=void 0!==Ur.O&&Ur.O)?i:Object,"function"==typeof(a=void 0!==Jn.L&&Jn.L)?a:Object,"function"==typeof(s=void 0!==pt.v&&pt.v)?s:Object,"function"==typeof(c=void 0!==ir.M&&ir.M)?c:Object,"function"==typeof(l=void 0!==ke.I&&ke.I)?l:Object,"function"==typeof(u=void 0!==I.O&&I.O)?u:Object])],t)}(Xo),ei=n(18316),ti=n(531181),ni=n(885279),ri=n(217907),oi=n(788765),ii=n(376639),ai=n(836840),si=n(791854),ci=n(972736),li=n(639746),ui="JankDetector",di=1e4,pi=function(){function e(){}return e.createRAFJank=function(t,n){return void 0===n&&(n=e.config),be.qO.getInstance().isEditable&&e.supportJankDetect?(e.rAFJank||e.init(n),e.context=t,e.rAFJank):null},e.init=function(t){e.detectFocus(),e.detectClick(),e.rAFJank=p.RAFJankUtil.createInstance(t),e.rAFJank.addEventListener("jank",e.handleJank),e.rAFJank.addEventListener("heart",e.handleHeart)},e.handleHeart=function(){window.JankGlobalKeyCode="",e.clickEventPath=""},e.handleJank=function(t){var n=t.jankTime,r=t.stack,o=t.position;e.reportJank(n,r,o||0),e.context.perfManager.resetEditTimes()},e.reportJank=function(t,n,r){var i=t>di;p.Logger.warn(ui,"reportJank isSlowerRender: ".concat(i," ").concat(t)),o.M.isDevEvn()||(e.reportOnes(t,n,r),e.reportMulti(t,n,r))},e.reportOnes=function(t,n,r){var o=t>di;e.hasReportJank||(e.hasReportJank=!0,e.stack||(e.stack=[]),e.stack.push({jankTime:t,stack:n,position:r,hidden:document.hidden,isFocus:e.isFocus,kc:window.JankGlobalKeyCode,path:e.clickEventPath}),e.reportToTdw(t,"edit_slow"),e.reportToSentry(),d.ReportHelper.monitor(o?d.MonitorName.FRAME_DROP_SERIOUS:d.MonitorName.FRAME_DROP_NORMAL),e.stack=[])},e.reportMulti=function(t,n,r){var o;if(Date.now()-e.lastReportTime<1e4)e.stack.push({jankTime:t,stack:n,position:r,hidden:document.hidden,isFocus:e.isFocus,kc:window.JankGlobalKeyCode,path:e.clickEventPath});else{e.reportToTdw(t,"edit_jank");var i=e.getEditStatisticInfo();if(d.ReportHelper.zzsHandler.zzsStatus({attributeId:d.MonitorName.FRAME_DROP_OCCUR,status:d.Status007.FAIL,otherDimensions:[i.mutLenLevel,String(i.pasteInRecent),String(i.editAfterOpen),String(i.editInFiveMin),String(i.lastEditFromCollab),e.isFocus,document.hidden]}),d.ReportHelper.zzsHandler.zzsValue(d.MonitorName.FRAME_DROP_OCCUR,t),!e.hasReportWeblog&&t>=3e3){var a=3;t>=5e3&&(a=5),t>=di&&(a=10),null===(o=window.log)||void 0===o||o.report(d.MonitorName.FRAME_DROP_REPORT+"_".concat(a,"s")),e.hasReportWeblog=!0}e.lastReportTime=Date.now(),e.stack=[]}},e.detectFocus=function(){window.addEventListener("focus",(function(){e.isFocus=!0})),window.addEventListener("blur",(function(){e.isFocus=!1}))},e.detectClick=function(){window.addEventListener("click",(function(t){e.clickEventPath=(0,ci.tD)(t.target,5)}))},e.reportToSentry=function(){var e=d.GlobalContext.run(B.Rh.getActionType),t=new Error("JankError_".concat(e));t.name="JankError_".concat(e),t.message+="\n,changesetLog: ".concat(JSON.stringify(d.GlobalContext.run(B.Rh.get))),d.ReportHelper.captureException(d.MonitorName.FRAME_DROP_REPORT,{logger:d.RavenLogger.ACTIVE_REPORT},t)},e.reportToTdw=function(t,n){var r=e.getJankReportData(t,n);li.u.getInstance((0,ei.pb)()).containerEnv;return window.__isOfflinePkg,li.u.replaceCount,d.ReportHelper.tdwReport(r),void e.reportToAegis(n)},e.getEditStatisticInfo=function(){var t,n=e.context.perfManager.getPerfInfo().recentEditInfoList,r=n[n.length-1];return{pasteInRecent:!!n.find((function(e){return e.commandType===d.Type.DocPaste})),editInFiveMin:!!r&&p.PerfUtil.now()-r.editTime>3e5,editAfterOpen:!!n.length,lastEditFromCollab:!!r&&r.fromServer,mutLenLevel:null===(t=d.ReportHelper.monitorHandler)||void 0===t?void 0:t.getMutLenDimensionsStr(),recentEditInfoList:n}},e.getJankReportData=function(t,n){var o=e.context,i=o.perfManager,a=o.statisticInfo,s=i.getPerfInfo(),c=(s.recentEditInfoList,(0,r.__rest)(s,["recentEditInfoList"])),l=e.getEditStatisticInfo(),u={module:"page_detail",opername:"tech_doc_performance_melo",action:n,source2:t>di?2:1,ver5:JSON.stringify(l),ver6:JSON.stringify(c),ver7:JSON.stringify(a),ver8:JSON.stringify(e.stack)};return p.Logger.warn(ui,"getJankReportData:",u),u},e.reportToAegis=function(e){window.aegis&&window.aegis.reportEvent(e)},e.config={HeartbeatConfig:{jankLimit:1e3,TriggerLimit:1e6,StopOnPageHidden:!0},PageActiveConfig:{Limit:18e4}},e.isFocus=!0,e.supportJankDetect=!!window.requestAnimationFrame&&!!window.cancelAnimationFrame,e.hasReportJank=!1,e.hasReportWeblog=!1,e.lastReportTime=(new Date).getTime(),e.clickEventPath="",e}(),fi=function(){function e(){var e=this;this._visiable=!1,this._left=30,this._top=30,this._width=50,this._height=50,this._dragCacheOffset={x:0,y:0},this._down=function(t){var n=mi(t),r=n.clientX,o=n.clientY;e._dragCacheOffset.x=r-e._canvas.offsetLeft,e._dragCacheOffset.y=o-e._canvas.offsetTop,document.body.addEventListener("mousemove",e._move),document.body.addEventListener("touchmove",e._move),document.body.addEventListener("mouseup",e._up),document.body.addEventListener("touchend",e._up)},this._move=function(t){var n=mi(t),r=n.clientX,o=n.clientY;e._left=r-e._dragCacheOffset.x,e._top=o-e._dragCacheOffset.y,e._canvas.style.left=e._left+"px",e._canvas.style.top=e._top+"px"},this._up=function(){e._dragCacheOffset.x=0,e._dragCacheOffset.y=0,document.body.removeEventListener("mousemove",e._move),document.body.removeEventListener("touchmove",e._move),document.body.removeEventListener("mouseup",e._up),document.body.removeEventListener("touchend",e._up)}}return Object.defineProperty(e.prototype,"visiable",{get:function(){return this._visiable},enumerable:!1,configurable:!0}),e.prototype.show=function(){this._visiable||(this._init(),this._visiable=!0)},e.prototype.hide=function(){this._visiable&&(this._visiable=!1,this._dispose())},e.prototype.draw=function(e){var t=1e3/e;this._draw(t)},e.prototype._draw=function(e){this._ctx.clearRect(0,0,this._width,this._height),this._ctx.drawImage(this._backCanvas,0,0,this._width*devicePixelRatio,this._height*devicePixelRatio,1,0,this._width,this._height),this._ctx.clearRect(0,0,1,this._height),this._ctx.save(),this._ctx.strokeStyle="#2ec3f7",this._ctx.translate(.5,0),this._ctx.beginPath(),this._ctx.moveTo(0,this._height),this._ctx.lineTo(0,(1-Math.min(120,e)/120)*this._height),this._ctx.closePath(),this._ctx.stroke(),this._ctx.restore(),this._backCtx.clearRect(0,0,this._width,this._height),this._backCtx.drawImage(this._canvas,0,0,this._width*devicePixelRatio,this._height*devicePixelRatio,0,0,this._width,this._height),this._ctx.save(),this._ctx.strokeStyle="#ff0000",this._ctx.beginPath(),this._ctx.moveTo(0,this._height/2),this._ctx.lineTo(this._width,this._height/2),this._ctx.closePath(),this._ctx.stroke(),this._ctx.restore()},e.prototype._init=function(){var e,t,n;this._canvas=document.createElement("canvas"),this._ctx=this._canvas.getContext("2d"),this._backCanvas=document.createElement("canvas"),this._backCtx=this._backCanvas.getContext("2d"),e=this._canvas,t=this._left,n=this._top,Object.assign(e.style,{position:"absolute",backgroundColor:"#d8f5ff",left:t+"px",top:n+"px",zIndex:1e6}),hi(this._canvas,this._ctx,this._width,this._height),hi(this._backCanvas,this._backCtx,this._width,this._height),this._canvas.addEventListener("mousedown",this._down),this._canvas.addEventListener("touchstart",this._down),document.body.appendChild(this._canvas)},e.prototype._dispose=function(){this._canvas=null,this._ctx=null,this._canvas.removeEventListener("mousedown",this._down),this._canvas.removeEventListener("touchstart",this._down),document.body.removeChild(this._canvas)},e}();function hi(e,t,n,r){var o=window.devicePixelRatio||1,i=Math.round(n*o),a=Math.round(r*o);e.setAttribute("width",String(i)),e.setAttribute("height",String(a)),e.style.width=i/o+"px",e.style.height=a/o+"px",t.scale(o,o)}function mi(e){return e.clientX?{clientX:e.clientX,clientY:e.clientY}:{clientX:e.touches[0].clientX,clientY:e.touches[0].clientY}}var gi,vi=fi,_i=function(){function e(e){var t=this;void 0===e&&(e={}),this._running=!1,this._last=0,this._timer=0,this._record=[],this._threshold=Number.MAX_SAFE_INTEGER,this._maxInterval=0,this._box=new vi,this._listeners=[],this._run=function(){var e=Date.now()-t._last;t._record.push(e),t._shouldDispatch(),t._box.visiable&&t._box.draw(e),t._last=Date.now(),t._timer=requestAnimationFrame(t._run)},void 0!==e.cycle&&(this._threshold=e.cycle/16|0),void 0!==e.maxInterval&&(this._maxInterval=e.maxInterval)}return e.prototype.start=function(){this._running?console.warn("已经启动 fps 监听"):(this._running=!0,this._lastDispatch=Date.now(),this._last=Date.now(),this._timer=requestAnimationFrame(this._run))},e.prototype.end=function(){window.cancelAnimationFrame(this._timer),this._running=!1,this._record.length>0&&(this._dispatch(),this._record.length=0)},e.prototype.visiable=function(){this._box.show()},e.prototype.invisible=function(){this._box.hide()},e.prototype.addListener=function(e){this._hasListener(e)||this._listeners.push(e)},e.prototype.removeListener=function(e){this._hasListener(e)&&(this._listeners=this._listeners.filter((function(t){return t!==e})))},e.prototype._shouldDispatch=function(){(0!==this._maxInterval&&Date.now()-this._lastDispatch>this._maxInterval||this._record.length>=this._threshold)&&this._dispatch()},e.prototype._hasListener=function(e){return!this._listeners.every((function(t){return t!==e}))},e.prototype._dispatch=function(){var e=this;this._listeners.forEach((function(t){t(e._record)})),this._record.length=0,this._lastDispatch=Date.now()},e}(),yi=function(){function e(e){var t=this;this.fps=new _i,this.isScrolling=!1,this.SAMPLE_RATE=1,this.PARTITION=[[0,30,"0-30"],[30,40,"30-40"],[40,50,"40-50"],[50,56,"50-55"],[56,57,"56"],[57,58,"57"],[58,59,"58"],[59,60,"59"],[60,Number.POSITIVE_INFINITY,"60+"]],this.onScroll=(0,p.throttle)((function(){clearTimeout(t.scrollTimer),t.scrollTimer=setTimeout((function(){t.isScrolling=!1,t.end()}),300),t.isScrolling||(t.isScrolling=!0,t.start((function(e){var n;switch(t.editor.docEnv.renderType){case d.RenderType.Canvas:n=1;break;case d.RenderType.Lite:n=2}for(var r=0,o=e.length-1;o>=0&&!((r+=e[o])>=300);o--);var i=t.calFPS(e.slice(0,o));p.Logger.log("perf|fps_scroll:".concat(JSON.stringify(i))),void 0!==i&&d.ReportHelper.tdwReport({opername:"quality_doc",module:"detail",action:"fps_scroll",ver7:i.average,ver8:i.partition,ver9:n,ver10:i.variance})})))}),100),this.editor=e}return e.prototype.shouldMonitor=function(){return 100*Math.random()<this.SAMPLE_RATE},e.prototype.start=function(e){var t=this;this.shouldMonitor()&&(this.currentListener=e,this.fps.addListener(this.currentListener),this.fps.start(),this.timeoutTimer=setTimeout((function(){t.end()}),1e4))},e.prototype.end=function(){this.fps.end(),this.fps.removeListener(this.currentListener),clearTimeout(this.timeoutTimer)},e.prototype.visible=function(){this.fps.visiable()},e.prototype.invisible=function(){this.fps.invisible()},e.prototype.reset=function(){this.editor.scrollHandler.removeScrollListener(this.onScroll),this.fps.removeListener(this.currentListener),this.fps.end()},e.prototype.calFPS=function(e){var t=this;if(e.length>4){var n=e.slice(2,e.length-2),r=1e3/(n.reduce((function(e,t){return e+t}),0)/n.length),o=0,i={};return n.forEach((function(e){var n=1e3/e;t.PARTITION.some((function(e){return n>=e[0]&&n<e[1]&&(i[e[2]]=(i[e[2]]||0)+1,!0)})),o+=Math.pow(n-r,2)})),{average:r,variance:Math.sqrt(o/n.length),partition:JSON.stringify(i)}}},e.prototype.startInitMonitor=function(){var e=this;this.start((function(t){var n,r=e.calFPS(t);switch(e.editor.docEnv.renderType){case d.RenderType.Canvas:n=1;break;case d.RenderType.Lite:n=2}p.Logger.log("perf|fps_init:".concat(JSON.stringify(r))),void 0!==r&&d.ReportHelper.tdwReport({opername:"quality_doc",module:"detail",action:"fps_init",ver7:r.average,ver8:r.partition,ver9:n,ver10:r.variance})}))},e.prototype.startScrollMonitor=function(){this.editor.scrollHandler.addScrollListener(this.onScroll)},e}(),bi=n(963210),Ei=function(){function e(e){this.editor=e}return e.prototype.monitorLayoutError=function(){var e=this;this.editor.on(d.LayoutNotification.LayoutFinished,(function(){e.checkAndReportFatalError()}),this)},e.prototype.reportFatalLayout=function(){Q.j.report("doc-fatal-layout-caused-by-dirty-data"),d.ReportHelper.tdwReport({opername:"doc_fatal_layout",module:"layout_finished",action:"dirty_data_check"})},e.prototype.checkAndReportFatalError=function(){var e=this.editor.getLayoutError();if(!e)return!1;var t=e.context.gcpPairs;return t&&(Q.j.error("[脏数据]排版错误，当前数据版本为：",window.App.collabCenterAdapter.getVersion()),Q.j.error("[脏数据]排版错误，bp 换 cp 的错误结果为：",t),this.reportFatalLayout()),!0},e.prototype.dispose=function(){this.editor.removeListener(d.LayoutNotification.LayoutFinished,this)},(0,r.__decorate)([(0,bi.u)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",void 0)],e.prototype,"reportFatalLayout",null),e}(),Ci=n(446296),wi=n(387540),Ti=n(243607),Ai=n(481734),Si={logo:[mo.j9.HOME],divider:[mo.j9.DIVIDER],title:[mo.j9.TITLE],"drive-file-badge":[mo.j9.DRIVE_FILE_BADGE],"title-badge":[mo.j9.TITLE_BADGE],certification:[mo.j9.CERTIFICATION],readonly:[mo.j9.READONLY_TIPS],badge:[mo.j9.BADGE],saveState:[mo.j9.SUBSCRIBE,mo.j9.SAVE_TIPS],collaborators:[mo.j9.COLLABORATION],"qq-group":[mo.j9.QQ_GROUP_AIO],fileMenu:[mo.j9.FILE_MENU],moreMenu:[mo.j9.EDIT_MENU],presentation:[mo.j9.PRESENTATION],auth:[mo.j9.AUTH],share:[mo.j9.SHARE],account:[mo.j9.ACCOUNT_AVATAR],login:[mo.j9.LOGIN],collect:[mo.j9.COLLECT],toggle:[mo.j9.TOOLBAR_MODE],move:[mo.j9.MOVE],"drive-file-convert":[mo.j9.DRIVE_FILE_CONVERT],"share-private":[mo.j9.SHARE_PRIVATE]},Ii=n(669144),Ri={name:mo.j9.BRAND,content:Ye().createElement(Ai.pp,null),preventHide:!0},Mi=function(){function e(){}var t,n,o,i,a;return e.init=function(){var e,t,n;return(0,r.__awaiter)(this,void 0,Promise,(function(){var o,i,a,s,c,l,u,d,p,f,h,m,g,v,_,y=this;return(0,r.__generator)(this,(function(b){return o=S.Am.get(Ti.$),null===(e=null===mo.rX||void 0===mo.rX?void 0:mo.rX.updateExtensionService)||void 0===e||e.call(mo.rX,o.extensionService),i=o.dependentServiceCombinder,a=i.docMetaDomain,s=i.userInfoDomain,c=i.authDomain,l=i.accountDomain,u=i.fileInfoDomain,d=i.accountApplication,p=i.collaborateDomain,null===(t=null===mo.rX||void 0===mo.rX?void 0:mo.rX.updateDomainService)||void 0===t||t.call(mo.rX,{docMetaDomain:a,accountDomain:l,authDomain:c,userInfoDomain:s,fileInfoDomain:u,collaborateDomain:p}),Ii.v.isDriveFile&&(f=(0,wi.getPathname)(),h=f.slice(f.lastIndexOf("/")+1),m=(0,wi.getU)(),g={docId:h,u:m},u.init(g)),null===(n=null===mo.rX||void 0===mo.rX?void 0:mo.rX.updateApplicationService)||void 0===n||n.call(mo.rX,{accountApplication:d}),this.initTitleBarProperty(),v=Object.entries(this.configService.get("common.titlebar")).reduce((function(e,t){var n,o=(0,r.__read)(t,2),i=o[0];return o[1]||e.push.apply(e,(0,r.__spreadArray)([],(0,r.__read)(null!==(n=Si[i])&&void 0!==n?n:[]),!1)),e}),[]),_=JSON.parse(v.reduce((function(e,t){return e.replace(new RegExp('"'.concat(t,'"'),"g"),'"'.concat(t,'__removed"'))}),JSON.stringify(mo.QW.TITLEBAR_SCHEMA))),this.titlebarService.setSchema(_),this.titlebarService.register(Ri),this.controllerService.buildController(mo.QW.TitlebarController),[].push(this.store.get("docTitle").subscribe((function(e){window.isPublishedURL&&y.eventEmitter.emit(mo.zW.TITLE_CHANGE,e)}))),[2]}))}))},e.initTitleBarProperty=function(){var e=(0,c.Yi)().official_auth_info;this.store.register("isTitlebarShowed",!!this.configService.get("common.toolbar.titlebar-toggle-show")&&!0),this.store.register("docTitle",(0,j.$t)(window.productName)),this.store.register("isLogin",!0),this.store.register("isEditable",!0),this.store.register("canEditTitle",!1),this.store.register("canShowCertification",!!e),this.store.register("menuActive",!1),this.store.register("menuHover","none"),this.store.register("menuLastHover","none"),this.store.register("menuHoverTooltip","none")},(0,r.__decorate)([(0,S.tB)(),(0,r.__metadata)("design:type","function"==typeof(t=void 0!==pt.v&&pt.v)?t:Object)],e,"eventEmitter",void 0),(0,r.__decorate)([(0,S.tB)(),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==Oe.H&&Oe.H)?n:Object)],e,"controllerService",void 0),(0,r.__decorate)([(0,S.tB)(),(0,r.__metadata)("design:type","function"==typeof(o=void 0!==He.O&&He.O)?o:Object)],e,"store",void 0),(0,r.__decorate)([(0,S.tB)(),(0,r.__metadata)("design:type","function"==typeof(i=void 0!==ir.M&&ir.M)?i:Object)],e,"titlebarService",void 0),(0,r.__decorate)([(0,S.tB)(),(0,r.__metadata)("design:type","function"==typeof(a=void 0!==lo.ax&&lo.ax)?a:Object)],e,"configService",void 0),e}(),Oi=n(396285),Ni=[Oi.DOCUMENT_DATA_TYPE.committing,Oi.DOCUMENT_DATA_TYPE.queue,Oi.DOCUMENT_DATA_TYPE.waiting];!function(e){e.spreadStructure="1.0",e.protoBufStructure="2.0"}(gi||(gi={}));var ki,Li=function(e,t){return{modelVersion:gi.protoBufStructure,subId:e.subId,offlineMsg:e.offlineMsg,type:t,taskId:e.taskId,version:e.baseRev,createTimestamp:e.time,changesetString:e.base64Commands,changeset:[],dataVersion:window.App.GlobalConfig.globalCodeVersion}},Di=function(e){try{var t=JSON.parse(e.data);return{modelVersion:gi.spreadStructure,dver:e.dataVersion,subId:e.subId,head:t.data.head,keydata:t.data.keyData,offlineMsg:t.isOfflineMessage,type:e.type,taskId:e.taskId,version:e.version,createTimestamp:e.createTimestamp,changeset:t.data.changeset,changesetString:t.data.changeset,apool:t.data.apool}}catch(e){null===Q.j||void 0===Q.j||Q.j.error("twoDotZeroToThreeDotZeroDocChangeTransform error: ".concat(null==e?void 0:e.message))}},Pi=n(165168),xi=n(253879),Fi=n(200122),Bi=function(){function e(e){this.collab=e,this.tag="ChangesetManager",this.hasEdited=!1,this.hasReportEdit=!1,this.composeCommands=[],this.composeTimer=null,window.App.changesetManager=this}return e.prototype.addMergedBaseDocChanges=function(){this.addDocChanges(Fi.Wo.getMergedBaseDocChange())},e.prototype.applyLocalChangesToBase=function(e){var t,n,o,i;try{var a=this.getChanges().map((function(e){return(0,r.__assign)((0,r.__assign)({},e),{changeset:K._.getMutationCommands(e.changesetString)})}));p.Logger.info("".concat(this.tag," | applyLocalChangesToBase localChanges.length:").concat(e.length,", memoryChanges.length: ").concat(a.length));var s=e.filter((function(e){return e.subId&&!Fi.Wo.isMergedToBase(e.taskId)})),c=+new Date;try{for(var l=(0,r.__values)(s),u=l.next();!u.done;u=l.next()){var f=u.value,h=function(e){var t=(0,Z.By)([e]);a.forEach((function(e){t=(0,Z.ny)(t,e)})),f.offlineMsg=!0,e.mutations=t,m.collab.applyChangesToBase(t)},m=this;try{for(var g=(o=void 0,(0,r.__values)(f.changeset)),v=g.next();!v.done;v=g.next())h(v.value)}catch(e){o={error:e}}finally{try{v&&!v.done&&(i=g.return)&&i.call(g)}finally{if(o)throw o.error}}a.length&&(f.createTimestamp=c,c+=1)}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=l.return)&&n.call(l)}finally{if(t)throw t.error}}this.addDocChanges(s)}catch(e){d.ReportHelper.monitor007Status(d.MonitorName.APPLY_DATA_FAIL,d.Status007.FAIL,JSON.stringify(null==e?void 0:e.message),{isOffline:!0});var _=new CustomEvent(xi.HJ,{detail:{code:72010}});document.dispatchEvent(_);var y=new Error;y.name=d.MonitorName.CHANGESET_ERROR_APPLY_OFFLINE;var b=" browser info : ".concat(p.PlatformUtil.getBrowser(),",ex: ").concat(JSON.stringify(e));y.message="{\n".concat(b,"\n}"),p.Logger.error(this.tag,"applyLocalChangesToBase error: ".concat(b)),d.ReportHelper.captureChangesetException(d.MonitorName.CHANGESET_ERROR_APPLY_OFFLINE,{option:{changesetDataType:d.ChangesetDataType.INIT_DATA}},y)}},e.prototype.applyNewChangesToBase=function(e,t){try{var n=e;this.composeCommands.length&&this.composeCommands.forEach((function(e,t,o){var i;i=(0,r.__read)(d.MutationUtil.followDouble(e.mutations,n),2),o[t].mutations=i[0],n=i[1]})),this.collab.applyChangesToBase(n,t)}catch(e){p.Logger.error("".concat(this.tag," | applyNewChangesToBase error: ").concat(e)),d.ReportHelper.monitor007Status(d.MonitorName.SERVER_MUTATION_APPLY_ERROR,d.Status007.FAIL),d.ReportHelper.monitor007Status(d.MonitorName.APPLY_DATA_FAIL,d.Status007.FAIL,JSON.stringify(null==e?void 0:e.message)),d.ReportHelper.tdwReport({opername:"doc_word_melo",module:"data_lost",action:"exp_tip",ver5:"1",ver6:d.EditorDocumentType.DOCUMENT,ver7:d.ChangesetDataType.APPLY_SERVER_DATA}),d.ReportHelper.captureChangesetException(d.MonitorName.CHANGESET_ERROR_APPLY_ONLINE,{option:{changesetDataType:d.ChangesetDataType.APPLY_SERVER_DATA}},e)}},e.prototype.hasUncommittedChanges=function(){return this.getChanges().length>0},e.prototype.getUncommitedInfo=function(){var e=0,t=0;try{this.getChanges().forEach((function(n){n.changeset&&(e+=(0,Z.Re)(n.changeset),t+=n.changeSetCount||1)}))}catch(e){p.Logger.error("".concat(this.tag," | getUncommitedInfo error"),e)}return{charCount:e,csCount:t}},e.prototype.beforeApplyCursorMsg=function(e){var t=this.getChanges();p.Logger.debug("[collab-caret]本地队列",t.map((function(e){return e.changeset[0]}))),p.Logger.debug("[collab-caret]本地队列处理前",e[0]);var n=(0,Pi.Nc)(t),o=(0,Pi.Mu)(n),i=e.map((function(e){var t=(0,r.__assign)({},e);return t.gcp=(0,Pi.ZN)(e.gcp,o),t}));return p.Logger.debug("[collab-caret]本地队列处理后",i[0]),i},e.prototype.getChanges=function(){var e,t,n;return null!==(n=null===(t=(e=window.App.collabCenterAdapter).getLocalUserChanges)||void 0===t?void 0:t.call(e).map((function(e){return Li(e,Oi.DOCUMENT_DATA_TYPE.waiting)})))&&void 0!==n?n:[]},e.prototype.addCommand=function(e){var t=this;this.hasEdited=!0,this.reportEdit(),0!==e.mutations.length&&(this.composeCommands.push(e),null===this.composeTimer&&(this.composeTimer=window.setTimeout((function(){var n=JSON.stringify(t.composeCommands),r=window.App.collabCenterAdapter.getVersion();p.Logger.info(t.tag,"addCommand:".concat(n)),d.GlobalContext.run(B.Rh.push,{composeCs:n,rev:r,actionType:e.type||"unknownActionType"}),d.GlobalContext.run(Z.KM.SetData2Store,Z.fb.UserChangeset,{changeset:[e]});var o={taskId:(0,H.generateMessageTaskId)(),subId:"BB08J2",base64Commands:(0,Z.eT)(t.composeCommands),baseRev:r,changeSetCount:1,offlineMsg:!1,wordCount:(0,Z.Re)(t.composeCommands),changeset:""};window.App.collabCenterAdapter.sendUserChange([o]),t.composeCommands=[],t.composeTimer=null}),500)))},e.prototype.addDocChanges=function(e){if(0!==(null==e?void 0:e.length)){var t=e.map((function(e){return(0,r.__assign)((0,r.__assign)({},e),{time:e.createTimestamp,base64Commands:(0,Z.eT)(e.changeset),baseRev:e.version,changeset:""})}));window.App.collabCenterAdapter.sendUserChange(t)}},e.prototype.reportEdit=function(){this.hasReportEdit||(d.GlobalContext.run(B.Rh.reportEdit),this.hasReportEdit=!0)},e}(),Ui=n(148387),Hi=n(188585),Wi=n(814808),ji=(0,p.throttle)((function(){Wi.default.show({message:(0,j.$t)("文档较大正在加载中，请完成后再试。"),duration:3e3,autoClose:!0,id:"largeDocumentScrollToBottomSnackBarId"})}),5e3),Gi=function(){function e(e){var t,n,o=this;this.gapMutations=[],this.retryFetchChunkCount=2,this.firstCount=2,this.defaultCount=10,this.maxRequestCount=2,this.chunkTotalLength=0,this.gcpChunkEnd=0,this.revisionVersion=0,this.waitRequestQueue=[],this.requestingQueue=[],this.currentChunk=0,this.slowStart=0,this.slowStartMax=20,this.retrySliceCount={},this.layoutRunning=!1,this.userChangeQuene=[],this.docLength=0,this.isLoadEdit=!1,this.isPause=!1,this.isFinished=!1,this.offlineMutationsFollow=[],this.setFinishCb=function(e){o.collabCenterAdapter=e},this.debounce=function(e,t,n){var r;return void 0===n&&(n=!0),function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];n&&(o.isPause=!0,o.slowStartClear()),r&&clearTimeout(r),r=setTimeout((function(){return e.apply(i)}),t)}},this.finishInput=this.debounce((function(){o.isPause=!1,o.layoutRunning=!1,o.moveFoward()}),2e3),this.forceLayout=this.debounce((function(){o.isFinished||(p.Logger.info("[分页]强行兜底推动排版 index: ".concat(o.currentChunk,", 分片总数: ").concat(o.chunkTotalLength)),p.Logger.info("[分片]Unused[".concat(o.currentChunk,"]: ").concat(o.hasContentUnused(o.currentChunk),", Run: ").concat(o.layoutRunning)),o.isPause=!1,o.layoutRunning=!1,o.moveFoward())}),5e3,!1),this.applyChunk=function(e){if(Array.isArray(e)&&0!==e.length){o.layoutRunning=!0;var t=o.getMinMaxGCPByMutations(e),n=t.minGCP,r=t.maxGCP-n;o.editor.state.deltaApplyController.forceUpdateDirtyRange(new d.GCPRange(Math.max(n-1,0),r));var i=e.concat(o.offlineMutationsFollow),a=B.QD.mutations2Delta(i);a.globalOpts.isInputDoc=!0,a.globalOpts.fromChunk=!0,o.editor.state.applyDelta(a),o.editor.state.dataEngine.setMutNum(o.editor.state.dataEngine.getMutNum()+i.length)}else o.moveFoward()},this.retryRequestingQueue=function(e){var t,n;try{for(var i=(0,r.__values)(o.requestingQueue),a=i.next();!a.done;a=i.next()){var s=a.value;(!e||e&&s.index<=e&&e<s.index+s.count)&&(p.Logger.info("[分片] retryRequestingQueue, requestItem: ".concat(JSON.stringify(s))),o.processFetchChunk(s.index,s.count))}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},this.onlineChange=function(){p.Logger.info("[分片] online, requestingQueue: ".concat(JSON.stringify(o.requestingQueue))),o.retryRequestingQueue()},this.loggerFisrtEnd=function(e){var t=1500;p.Logger.info(e),e.length>4500?(p.Logger.info(e.slice(-3e3,-1500)),p.Logger.info(e.slice(-1500))):e.length>t&&p.Logger.info(e.slice(-1500))},this.onLoadingDBClick=function(e){"dblclick"===e.event.type&&ji()},this.onScrollToBottom=function(){var e,t,n,r=null===(e=o.editor.scrollHandler)||void 0===e?void 0:e.getClientHeight();(null===(t=o.editor.scrollHandler)||void 0===t?void 0:t.getScrollTop())+r>=(null===(n=o.editor.scrollHandler)||void 0===n?void 0:n.getScrollHeight())-10&&ji()},this.editor=e.editor,this.clientVars=e.clientVars,this.csManager=e.csManager,this.isLoadEdit=!!(0,p.getUrlParameter)("isLoadEdit");var i=null===(n=null===(t=this.clientVars)||void 0===t?void 0:t.initialAttributedText)||void 0===n?void 0:n.text;if(!i||Array.isArray(i)&&0===i.length){var a="chunkCenter constructor error, firstData null";return p.Logger.error(a),void d.ReportHelper.captureException(d.MonitorName.FITST_CHUNK_LOAD_ERROR,{},a)}this.currentChunkData=i[0],this.currentChunkData.gap_chunk&&(this.gapMutations=this.getMutationsByChunkItemData(this.currentChunkData.gap_chunk)),this.chunkTotalLength=this.currentChunkData.total,this.revisionVersion=this.currentChunkData.revision_version||0,this.chunkVersion=this.currentChunkData.chunk_version,this.editorInitPromise(),globalThis.layoutTotalTime=0}return e.prototype.editorInitPromise=function(){var e=this;this.initEvents((function(){if(window.App.GlobalConfig.IsSupportStore){var t=e.editor.generateDocumentKeyFrame();(0,Hi.G)(window.clientVars,(0,Z.eT)(t.commands))}}))},e.prototype.loadDocumentData=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return(0,r.__generator)(this,(function(r){try{return this.chunkStartTime=Date.now(),this.handleSlicedChunks(this.currentChunkData),e=this.currentChunkData.chunks.length,t=this.getGroupMutationsByFollow(this.currentChunk,e,!0),this.docLength=t[0].mutation.text.length,this.initWaitRequestQueue(),this.loadDocData(),this.layoutRunning=!0,(n=new B.QD({mutations:t})).dataEngine.setGCPChunkEnd(this.gcpChunkEnd),[2,n]}catch(e){d.ReportHelper.captureException(d.MonitorName.FITST_CHUNK_LOAD_ERROR,{},e)}return[2]}))}))},e.prototype.getCacheSlicedChunks=function(){return e.cacheSlicedChunks},e.prototype.getIndexSlicedChunks=function(t){return e.cacheSlicedChunks[t]},e.prototype.selectIndexSlicedChunks=function(e){var t=this.getIndexSlicedChunks(e);this.editor.service.getSelection().setRange(Number(t.gcpStart),Number(t.gcpEnd))},e.prototype.handleSlicedChunks=function(e){var t=this;e.chunks.forEach((function(e){t.setCacheSlicedChunk(e)}))},e.prototype.setCacheSlicedChunk=function(t){if(!e.cacheSlicedChunks[t.index]){var n=this.getMutationsByChunkItemData(t);e.cacheSlicedChunks[t.index]={mutations:n,gcpStart:t.gcp_start,gcpEnd:t.gcp_end,used:!1}}},e.prototype.getMutationWrapper=function(e){return K._.getMutationCommand(e).mutations},e.prototype.getMutationsByChunkItemData=function(e){return this.getMutationWrapper(e.command||e.command_json_str)},e.prototype.getGroupMutations=function(t,n){for(var r,o=[],i=t;i<n;i++)(r=e.cacheSlicedChunks[i])?(o=o.concat(r.mutations),r.used=!0):p.Logger.error("[分片]error: getGroupMutations undefined, index: ".concat(i));return o},e.prototype.setDataEngineChunkEnd=function(e){this.editor.state.dataEngine.setGCPChunkEnd(e)},e.prototype.setIsChunkLoadReadonly=function(e){this.editor.state.dataEngine.setIsChunkLoadReadonly(e)},e.prototype.hasContentUnused=function(t){return e.cacheSlicedChunks[t]&&!e.cacheSlicedChunks[t].used},e.prototype.getOfflineMutations=function(){var e,t=[];return null===(e=this.userChangeQuene)||void 0===e||e.forEach((function(e){var n=e.changeset;null==n||n.forEach((function(e){t.push.apply(t,(0,r.__spreadArray)([],(0,r.__read)(e.mutations),!1))}))})),t},e.prototype.slowStartAdd=function(){this.slowStart<this.slowStartMax&&(this.slowStart+=1)},e.prototype.slowStartClear=function(){this.slowStart=0},e.prototype.getUnusedCount=function(e,t){for(var n=0,r=e;r<e+t&&this.hasContentUnused(r);r++)n+=1;return n},e.prototype.getShouldMoveCount=function(e){return Math.floor(e/4)+1},e.prototype.getMinMaxGCPByMutations=function(e,t){var n,o,i,a,s,c=0,l=1/0;try{for(var u=(0,r.__values)(e),p=u.next();!p.done;p=u.next()){var f=p.value;a=null==(s=null==f?void 0:f.mutation)?void 0:s.beginIndex,i=null==s?void 0:s.endIndex,t&&!f.options.inChunkRange||f.type===d.MutationType.mp&&("number"==typeof i&&i>c&&i>=0&&(c=i),"number"==typeof a&&a<l&&a>=0&&(l=a))}}catch(e){n={error:e}}finally{try{p&&!p.done&&(o=u.return)&&o.call(u)}finally{if(n)throw n.error}}return{minGCP:l,maxGCP:c}},e.prototype.getChunkEndByMutation=function(t,n,r){var o=0,i=r.length>0;return i||(o=Number(e.cacheSlicedChunks[n-1].gcpEnd||0)),(i||0===o)&&(o=this.getChunkEndByFollow(t,r)),n===this.chunkTotalLength&&(o=-1),o},e.prototype.getChunkEndByFollow=function(e,t){return t.forEach((function(t){var n=null==t?void 0:t.mutation,r=null==n?void 0:n.beginIndex,o=null==n?void 0:n.endIndex;if(t.type===d.MutationType.is&&void 0!==r){var i=((null==n?void 0:n.text)||"").length;r<=e&&(e+=i)}t.type===d.MutationType.ds&&void 0!==r&&void 0!==o&&(i=o-r,e>=o?e-=i:r<=e&&e<o&&(e=r))})),e},e.prototype.getGroupMutationsByFollow=function(t,n,o){var i,a,s,c=this;void 0===o&&(o=!0);var l,u=this.getGroupMutations(t,n);0===t&&this.gapMutations.length&&(u[0].options.baseLen=(null===(s=null===(a=u[0].mutation)||void 0===a?void 0:a.text)||void 0===s?void 0:s.length)||0,l=u.shift()),this.currentChunk=n,this.userChangeQuene=this.csManager.getChanges();var p=this.getOfflineMutations();this.gapMutations.length&&this.isLoadEdit&&(p=this.gapMutations.concat(p));var f=p.length>0,h=Number(e.cacheSlicedChunks[n-1].gcpEnd||0);return this.offlineMutationsFollow=[],o&&f&&(i=(0,r.__read)(d.MutationUtil.followDouble(p,u),2),p=i[0],u=i[1],p.forEach((function(e,t){var n,o;if(e.type===d.MutationType.mp){var i=p.slice(t).filter((function(e){return e.type===d.MutationType.is||e.type===d.MutationType.ds})),a=d.MutationUtil.followSingle([e],i,!1);try{for(var s=(0,r.__values)(a),l=s.next();!l.done;l=s.next()){var u=l.value;c.offlineMutationsFollow.push(u)}}catch(e){n={error:e}}finally{try{l&&!l.done&&(o=s.return)&&o.call(s)}finally{if(n)throw n.error}}}}))),u=this.editor.state.meetsServerMutation(u,!1),this.gcpChunkEnd=this.getChunkEndByMutation(h,n,p),this.setIsChunkLoadReadonly(!this.isLoadEdit&&this.gcpChunkEnd>0),this.editor.state.dataEngine.getIsChunkLoadReadonly()&&!1!==this.editor.isEditable()&&this.editor.setEditable(!1),0===t&&this.gapMutations.length&&(this.isLoadEdit&&(u=this.gapMutations.concat(u)),u.unshift(l)),n!==this.chunkTotalLength||this.isLoadEdit||(u=u.concat(this.gapMutations)),u},e.prototype.moveFoward=function(){if(!this.isFinished&&!this.layoutRunning){this.slowStartAdd();var e=this.getShouldMoveCount(this.slowStart),t=this.getUnusedCount(this.currentChunk,e);if(p.Logger.info("[分片]加载下一页，Run: ".concat(this.layoutRunning,", unusedCount: ").concat(t,", shouldMoveCount: ").concat(e,", ")+"Unused[".concat(this.currentChunk,"]: ").concat(this.hasContentUnused(this.currentChunk),", 总数: ").concat(this.chunkTotalLength)),t){var n=this.currentChunk+t,r=this.getGroupMutationsByFollow(this.currentChunk,n);this.setDataEngineChunkEnd(this.gcpChunkEnd),this.applyChunk(r)}else this.slowStartClear(),this.retryRequestingQueue(this.currentChunk),p.Logger.info("[分片]moveFoward fail, shouldMoveCount: ".concat(e,", unusedCount: ").concat(t)),p.Logger.info("[分片]Unused[".concat(this.currentChunk,"]: ").concat(this.hasContentUnused(this.currentChunk),", Run: ").concat(this.layoutRunning))}},e.prototype.requestingQueueSplice=function(e,t){var n=-1;this.requestingQueue.forEach((function(r,o){r.index===e&&r.count===t&&(n=o)})),n>=0&&this.requestingQueue.splice(n,1)},e.prototype.fetchOpenDoc=function(e,t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var n=this;return(0,r.__generator)(this,(function(r){return[2,new Promise((function(r,o){var i=new URL(window.location.href).searchParams;i.delete("uid"),i.delete("uid_key");var a=i.toString(),s="/dop-api/get/doc?".concat(a,"&padId=").concat(n.clientVars.globalPadId)+"&commandsFormat=1&start_index=".concat(e,"&count=").concat(t,"&revision_version=").concat(n.revisionVersion);$.get(s,{},(function(n,i){if("success"===i&&0===n.retcode){var a=n.data;r({retcode:0,data:a})}else p.Logger.error("[分片] 拉取".concat(e,"片,count:").concat(t,",数据返回错误, fail data: ").concat(JSON.stringify(n))),o({retcode:n&&n.retcode||-1,data:n})})).catch((function(t){o({retcode:-1,data:void 0}),p.Logger.error("[分片] 拉取".concat(e,"片数据返回错误catch, error: ").concat(JSON.stringify(t)))}))}))]}))}))},e.prototype.processFetchChunk=function(e,t){var n=this;this.fetchOpenDoc(e,t).then((function(r){d.ReportHelper.monitor007Status(d.MonitorName.CHUNK_REQUEST_SUCESS_RATE,d.Status007.SUCCESS),d.ReportHelper.aegisReportEvent({name:d.ReportName.CHUNK_REQUEST_SUCESS}),n.requestingQueueSplice(e,t),n.loadDocData(),p.Logger.info("[分片]".concat(e,"片,  数量为").concat(t,"拉取回来")),r.data.chunk_version!==n.chunkVersion&&(p.Logger.error("[分片]分片加载中分片机制版本更新 new chunkVer:".concat(r.data.chunk_version,", old chunkVer: ").concat(n.chunkVersion)),window.location.reload()),n.handleSlicedChunks(r.data),e===n.currentChunk&&n.moveFoward()})).catch((function(r){if(200706===r.retcode)throw n.destroy(),new Error("doc is completed deleted");d.ReportHelper.monitor007Status(d.MonitorName.CHUNK_REQUEST_SUCESS_RATE,d.Status007.FAIL,JSON.stringify(r)),d.ReportHelper.aegisReportEvent({name:d.ReportName.CHUNK_REQUEST_FAIL,custom_errorInfo:JSON.stringify(r)}),p.Logger.error("[分片] processFetchChunk catch, 拉取".concat(e,"片,count:").concat(t,",数据返回错误, error: ").concat(JSON.stringify(r))),void 0===n.retrySliceCount[e]&&(n.retrySliceCount[e]=n.retryFetchChunkCount),n.retrySliceCount[e]=n.retrySliceCount[e]-1,n.retrySliceCount[e]>=0?(p.Logger.error("[分片] processFetchChunk retryCount: ".concat(n.retrySliceCount[e])),setTimeout((function(e,t){n.processFetchChunk(e,t)}),2e3,e,t)):(Wi.default.show({message:(0,j.$t)("网络异常，请刷新重试。"),duration:5e3,type:"error"}),d.ReportHelper.captureException(d.MonitorName.OTHER_CHUNK_LOAD_ERROR,{extra:{detail:n.currentChunk}},r),d.ReportHelper.monitor007Status(d.MonitorName.OTHER_CHUNK_LOAD_ERROR,d.Status007.FAIL,void 0,{errorCode:Y.p.CollabRoomGetChunkFail}))}))},e.prototype.loadDocData=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(t){for(;this.waitRequestQueue.length>0&&this.requestingQueue.length<this.maxRequestCount;){if(!(e=this.waitRequestQueue.shift()))return[2];this.requestingQueue.push(e),this.processFetchChunk(e.index,e.count)}return[2]}))}))},e.prototype.initWaitRequestQueue=function(){for(var e=this.firstCount;e<this.chunkTotalLength;)this.waitRequestQueue.push({index:e,count:this.defaultCount}),e+=this.defaultCount},e.prototype.logCacheSlicedChunks=function(){var t={};Object.keys(e.cacheSlicedChunks).forEach((function(n){var r=e.cacheSlicedChunks[n];t[n]={gcpStart:r.gcpStart,gcpEnd:r.gcpEnd,used:r.used}})),this.loggerFisrtEnd("[chunk]cacheSlicedChunks Logger: ".concat(JSON.stringify(t)))},e.prototype.initEvents=function(e){var t,n=this;this.editor&&(this.editor.on(d.LayoutNotification.LayoutEachChunkFinished,(function(){n.isFinished||(n.layoutRunning=!1,n.currentChunk===n.chunkTotalLength&&(n.chunkEndTime=Date.now(),d.ReportHelper.monitor007Status(d.MonitorName.CHUNK_ALL_LOAD_SUCESS,d.Status007.SUCCESS),d.ReportHelper.monitor007Value(d.MonitorName.CHUNK_USE_TIME,n.chunkEndTime-n.chunkStartTime),p.Logger.info("[分片]已经加载完成!"),n.logCacheSlicedChunks(),n.isFinished=!0,n.editor.fire(new Ui.m,!1),n.collabCenterAdapter.resume(H.PauseOrResumeType.ALL),null==e||e(),be.qO.getInstance().canEdit&&n.editor.setEditable(!0),n.destroy()),n.isPause||n.moveFoward())}),this),this.editor.on(d.HiddenEditorNotificationType.ON_INPUT,this.finishInput,this),this.editor.on(d.LayoutNotification.LayoutChanged,this.forceLayout,this),null===(t=this.editor.scrollHandler)||void 0===t||t.addScrollListener(this.onScrollToBottom),this.isLoadEdit||this.editor.on(d.RenderNotificationTypes.PAGE_MOUSE_EVENT,this.onLoadingDBClick,this),window.addEventListener("online",this.onlineChange))},e.prototype.removeEvents=function(){var e;this.editor&&(this.editor.removeListener(d.LayoutNotification.LayoutEachChunkFinished,this),this.editor.removeListener(d.HiddenEditorNotificationType.ON_INPUT,this),this.editor.removeListener(d.LayoutNotification.LayoutChanged,this),null===(e=this.editor.scrollHandler)||void 0===e||e.removeScrollListener(this.onScrollToBottom),this.editor.removeListener(d.RenderNotificationTypes.PAGE_MOUSE_EVENT,this),window.removeEventListener("online",this.onlineChange))},e.prototype.destroy=function(){this.waitRequestQueue=[],this.requestingQueue=[],this.currentChunk=0,this.retrySliceCount={},e.cacheSlicedChunks={},this.removeEvents()},e.cacheSlicedChunks={},e}(),Vi=n(507270),zi=n(80224),Qi=function(e,t){this.context=e,this.id=t},Yi=n(346682),Zi="".concat((0,c.Yi)().globalPadId,"_").concat((0,U.getUid)(),"_Dirty_Data"),Ki=function(e){if(e){var t={hasDirtyData:e};p.LocalStorageUtil.setItem(Zi,Yi.JsonUtil.jsonStringify(t))}else p.LocalStorageUtil.removeItem(Zi)};!function(e){e.DISCONNECTED="DISCONNECTED"}(ki||(ki={}));var Ji,qi=function(e){function t(){return e.call(this,ki.DISCONNECTED)||this}return(0,r.__extends)(t,e),t}(p.Notification),Xi=Wi.Snackbar,$i="REPAIR_SNACKBAR_ID",ea=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.context=t,o.hasFeatureLoaded=!1,o.hasRenderFinished=!1,o.fixFail=!1,o.handleBeforeApplyDeltaValidatorResult=function(e){return(0,r.__awaiter)(o,void 0,void 0,(function(){var t,n,o;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return t=e.result,(null===(o=null===(n=null==t?void 0:t.errors)||void 0===n?void 0:n.some)||void 0===o?void 0:o.call(n,(function(e){return e.needFix})))&&this.context.canEdit()&&!this.snackbar?(Ki(!0),(null==t?void 0:t.isBreak)?[3,2]:[4,this.repair()]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},o.context.notificationCenter.on(d.StateNotification.BeforeApplyDeltaValidatorResult,(function(e){e instanceof d.BeforeApplyDeltaValidatorResultNotification&&o.handleBeforeApplyDeltaValidatorResult(e)})),o}return(0,r.__extends)(t,e),t.prototype.run=function(){var e=this;this.context.canEdit()&&function(){var e=p.LocalStorageUtil.getItem(Zi);if(e)try{if(!0===JSON.parse(e).hasDirtyData)return!0}catch(e){return!1}return"1"===(0,p.getUrlParameter)("forcecheck")}()&&(p.Logger.info(t.tag,"canRepair"),this.context.editor.once(d.RenderNotificationTypes.RENDER_FINISH,(function(){e.hasFeatureLoaded&&e.repair(),e.hasRenderFinished=!0})),d.GlobalContext.once(d.FeatureNotificationType.FEATURE_LOADED,(function(){e.hasRenderFinished&&e.repair(),e.hasFeatureLoaded=!0}))),d.GlobalContext.on(ki.DISCONNECTED,(function(){e.destroy()}))},t.prototype.destroy=function(){var e,t,n,r;null===(t=null===(e=this.fixingTips)||void 0===e?void 0:e.close)||void 0===t||t.call(e),null===(r=null===(n=this.snackbar)||void 0===n?void 0:n.close)||void 0===r||r.call(n)},t.prototype.repair=function(){return(0,r.__awaiter)(this,void 0,Promise,(function(){var e,n,o=this;return(0,r.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),this.context.canEdit()?(p.Logger.info(t.tag,"repair"),[4,this.checkDirtyData()]):[2];case 1:return(e=i.sent())?(p.Logger.info(t.tag,"hasDirtyData:".concat(e)),this.snackbar=Xi.show({message:(0,j.$t)("auto-repair:current-document-contains-abnormal-data-want-repair"),type:"error",closable:!1,autoClose:!1,id:$i,action:[{text:(0,j.$t)("auto-repair:fix"),onClick:function(){return(0,r.__awaiter)(o,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return p.Logger.info(t.tag,"开始修复"),this.showFixingTips(),[4,this.fix()];case 1:return e.sent(),this.finish(),[2]}}))}))}}],style:{background:"rgb(255, 125, 111)",color:"white",zIndex:9997}}),be.qO.getInstance().setPrivilege({isBlocked:!0}),[3,3]):(Ki(!1),[2]);case 2:return n=i.sent(),p.Logger.warn(t.tag,"ready error:".concat(null==n?void 0:n.message)),[3,3];case 3:return[2]}}))}))},t.prototype.checkDirtyData=function(){var e=this;return new Promise((function(t){var n,r=setTimeout((function(){t(!1)}),3e4),o=window.pad.editor.state._deltaApplyController.validateFullDoc();e.errors=o,clearTimeout(r);var i=!!(null===(n=null==o?void 0:o.some)||void 0===n?void 0:n.call(o,(function(e){return e.needFix})));t(i)}))},t.prototype.fix=function(){var e;return(0,r.__awaiter)(this,void 0,Promise,(function(){var n,o;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:try{(n=Array.from(new Set(null===(e=this.errors)||void 0===e?void 0:e.map((function(e){return e.reportModule}))))).includes(d.ReportModule.TABLE)&&(n=[d.ReportModule.TABLE]),window.pad.editor.state._deltaApplyController.tryToFix(n)}catch(e){p.Logger.error(t.tag,"fix error:".concat(null==e?void 0:e.message))}o=15,r.label=1;case 1:return[4,new Promise((function(e){setTimeout((function(){return e(!0)}),3e3)}))];case 2:if(r.sent(),0===window.App.changesetManager.getChanges().length)return[3,4];o-=1,r.label=3;case 3:if(o>=0)return[3,1];r.label=4;case 4:return[2]}}))}))},t.prototype.finish=function(){var e,t,n;return(0,r.__awaiter)(this,void 0,Promise,(function(){var o,i,a;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.checkDirtyData()];case 1:return o=r.sent(),Ki(o),null===(e=this.fixingTips)||void 0===e||e.close(),this.snackbar=Xi.show({message:(0,j.$t)("auto-repair:repair-complete-continue-use"),type:"success",closable:!1,autoClose:!1,id:$i,action:[{text:(0,j.$t)("auto-repair:refresh"),onClick:function(){location.reload()}}]}),d.ReportHelper.monitor007Status(d.MonitorName.DIRTY_DATA_AUTO_FIX,o?d.Status007.FAIL:d.Status007.SUCCESS),o&&(this.fixFail=o,i=Date.now(),a=i-18e5,null===(n=null===(t=window.log)||void 0===t?void 0:t.report)||void 0===n||n.call(t,"WORD_DIRTY_DATA_AUTO_FIX_FAIL",{query:{startTs:a,endTs:i}})),[2]}}))}))},t.prototype.showFixingTips=function(){this.fixingTips=Xi.show({message:(0,j.$t)("auto-repair:saving-please-wait"),type:"loading",autoClose:!1,id:$i})},t.tag="AutoRepairController",t}(Qi),ta=function(){function e(e){this.plugins=[],this.registerPlugin(new ea(e,ea.tag))}return e.prototype.registerPlugin=function(e){this.plugins.find((function(t){return t.id===e.id}))||this.plugins.push(e)},e.prototype.run=function(){var e,t;try{for(var n=(0,r.__values)(this.plugins),o=n.next();!o.done;o=n.next())o.value.run()}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},e}(),na=n(734268);function ra(){return p.PlatformUtil.isWindowStore()?Ji.windows:p.PlatformUtil.isMac()?Ji.mac:Ji.other}function oa(){var e;return null!==(e=window.__globalReleaseVersion)&&void 0!==e?e:""}function ia(e){return{platform:ra(),rel_rev:oa(),right_tag:e?1:0}}!function(e){e[e.windows=1]="windows",e[e.android=2]="android",e[e.iOS=3]="iOS",e[e.other=4]="other",e[e.mac=5]="mac"}(Ji||(Ji={}));var aa,sa=n(684069),ca=n(341524),la=n(582918),ua=(n(30521),"connected"),da=function(){function e(e,t){var n=this;this.notificationCenter=e,this.clientVars=t,this.userInfoInRoomMap=new Map,this.userJoinQueue=[],this.userJoinFetchingQueue=[],this.initUserNewInfoNotices=[],this.isGuest=function(e){return!1},this.updateMemberCount=function(e,t){var r;void 0===t&&(t=0),n.memberCount=t||(null===(r=e[0])||void 0===r?void 0:r.mem_count)},this.onUserJoin=(0,p.throttle)((function(){return(0,r.__awaiter)(n,void 0,void 0,(function(){var e,t,n,o,i,a,s,c,l,u;return(0,r.__generator)(this,(function(d){switch(d.label){case 0:return this.userJoinFetchingQueue=(0,r.__spreadArray)([],(0,r.__read)(this.userJoinQueue),!1),this.userJoinQueue=[],e=this.filterFetchedUserInfos(this.userJoinFetchingQueue),t=e.newUidListWithNoGuest,n=e.guestUidList,t.length>0?[4,ca.z.getRemark(this.clientVars,t,!1)]:[3,2];case 1:return i=d.sent(),[3,3];case 2:i={},d.label=3;case 3:return o=i,a=this.parseGetUserMarkNameResult(o),s=this.generateGuestInfoMap(n),Object.assign(a,s),c=this.findUpdateUserInfos(a,this.userJoinFetchingQueue),l=this.filterFetchedUserInfos(this.userJoinFetchingQueue).newUserInfoMap,u=this.findJoinUserInfos(a,l),this.collabUserInfoService.getJoinUserInfos().next(u),c.length>0&&(this.updateUserInfoInRoom(c,sa.ZK.ON_USER_INFO_UPDATE),this.notificationCenter.fire(new sa.Bu(c))),u.length>0&&(this.updateUserInfoInRoom(u,sa.ZK.ON_USER_JOIN),this.notificationCenter.fire(new sa.c(u))),c.length||u.length||this.notificationCenter.fire(new sa.c([])),this.userJoinFetchingQueue=[],[2]}}))}))}),5e3)}var t,n;return e.prototype.getInitMemberCount=function(){return this.memberCount},e.prototype.getInitUserNewInfoNotices=function(){return this.initUserNewInfoNotices},e.prototype.getUserInfo=function(e){return this.userInfoInRoomMap.get(e)},e.prototype.getUserInfos=function(){return Array.from(this.userInfoInRoomMap.values())},e.prototype.handleTobVidToUid=function(e){return(0,r.__awaiter)(this,void 0,Promise,(function(){var t;return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return[2,e];case 1:return t=n.sent(),[2,e.map((function(e){var n,o,i=null===(o=null===(n=e.userId)||void 0===n?void 0:n.split("."))||void 0===o?void 0:o[1];if(i){var a=t.get(i);if(a){var s=function(e){return"0"!==e},c=s(a.uid)?a.uid:s(a.vid)?a.vid:"";if(c){var l="p.".concat(c);return(0,r.__assign)((0,r.__assign)({},e),{userId:l})}}}return e}))]}}))}))},e.prototype.handleUserNewInfo=function(e,t){return(0,r.__awaiter)(this,void 0,Promise,(function(){var n,o=this;return(0,r.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.handleTobVidToUid(e)];case 1:return e=(e=i.sent()).filter((function(e){return!o.isGuest(e.userId)})),this.initUserNewInfoNotices=e,(n=this.userJoinQueue).push.apply(n,(0,r.__spreadArray)([],(0,r.__read)(e),!1)),this.updateMemberCount(e,t),this.onUserJoin(),[2]}}))}))},e.prototype.handlerUserAnonymousStatusChange=function(e){var t,n;return(0,r.__awaiter)(this,void 0,Promise,(function(){var o,i,a,s;return(0,r.__generator)(this,(function(c){switch(c.label){case 0:return(o=this.getUserInfo("p.".concat(e)))?[4,ca.z.getRemark(this.clientVars,[e],!1)]:[3,2];case 1:if(i=c.sent(),!(a=this.parseGetUserMarkNameResult(i)[e]))return[2];s=(0,r.__assign)((0,r.__assign)({},o),{corpName:null!==(t=a.corpName)&&void 0!==t?t:"",name:null!==(n=a.markName)&&void 0!==n?n:""}),this.collabUserInfoService.getJoinUserInfos().next([s]),this.updateUserInfoInRoom([s],sa.ZK.ON_USER_INFO_UPDATE),this.notificationCenter.fire(new sa.Bu([s])),c.label=2;case 2:return[2]}}))}))},e.prototype.handleUserLeave=function(e){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t,n,o;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.handleTobVidToUid([e])];case 1:return e=r.sent()[0],t=e.userId,n=this.clientVars.userId,this.clientVars.collab_client_vars.websocket&&t===n||(this.collabUserInfoService.getLeaveUserInfos().next(e),this.updateUserInfoInRoom([e],sa.ZK.ON_USER_LEAVE),this.notificationCenter.fire(new sa.UD(e)),o=function(e){return e.userId!==t},this.userJoinQueue=this.userJoinQueue.filter(o),this.userJoinFetchingQueue=this.userJoinFetchingQueue.filter(o)),[2]}}))}))},e.prototype.handleUserLeaves=function(e){var t=this;void 0===e&&(e=[]),e.forEach((function(e){t.handleUserLeave(e)}))},e.prototype.generateGuestInfoMap=function(e){void 0===e&&(e=[]);var t={};return e.forEach((function(e){t[e]={uid:e,reqUid:e,userPic:"",markName:"",corpName:"",englishName:"",wedriveUin:"",xid:"",uidSource:0}})),t},e.prototype.filterFetchedUserInfos=function(e){var t=this,n={},o=[],i=[],a=[];return e.forEach((function(e){var s=e.userId;if(!t.userInfoInRoomMap.has(s)){var c=(0,r.__read)(s.split("."),2)[1];n[c]||(n[c]=e,o.push(c),0===s.indexOf("g.")?a.push(c):i.push(c))}})),{newUserInfoMap:n,newUidList:o,newUidListWithNoGuest:i,guestUidList:a}},e.prototype.parseGetUserMarkNameResult=function(e){var t=e.rsp,n={};return(void 0===t?[]:t).forEach((function(e){var t=e.reqUid,r=e.uid;n[null!=t?t:r]=e})),n},e.prototype.findUpdateUserInfos=function(e,t){var n=this,o=[],i=this.clientVars.userId,a=!!this.clientVars.collab_client_vars.websocket;return t.filter((function(e){var t=(0,r.__read)(e.userId.split("."),2)[1];return a||e.userId!==i&&t})).forEach((function(t){var i,a,s,c=t.userId,l=(0,r.__read)(t.userId.split("."),2)[1],u=e[c];if(n.isUserInfoExist(c)&&u){var d=n.userInfoInRoomMap.get(c),p={uin:l,corpName:null!==(i=u.corpName)&&void 0!==i?i:"",name:null!==(a=u.markName)&&void 0!==a?a:"",xid:t.xid,uuId:t.uuId,userId:t.userId,colorId:t.colorId,session_type:t.session_type,englishName:t.englishName,userPic:null!==(s=null==d?void 0:d.userPic)&&void 0!==s?s:"",status:ua,userLink:"",vipInfo:t.vip_info};o.push(p)}})),o},e.prototype.findJoinUserInfos=function(e,t){var n=[];return Object.keys(e).forEach((function(r){var o=e[r],i=o.corpName,a=o.markName,s=o.userPic,c=o.englishName,l=o.xid,u=t[r];u&&n.push({uin:r,corpName:i,name:a,xid:l,userPic:s,englishName:c,uuId:u.uuId,userId:u.userId,colorId:u.colorId,session_type:u.session_type,status:ua,userLink:"",vipInfo:u.vip_info})})),n},e.prototype.updateUserInfoInRoom=function(e,t){var n=this;e&&e.forEach((function(e){switch(t){case sa.ZK.ON_USER_JOIN:n.userInfoInRoomMap.has(e.userId)||e.status!==ua||n.userInfoInRoomMap.set(e.userId,e);break;case sa.ZK.ON_USER_INFO_UPDATE:e.status===ua&&n.userInfoInRoomMap.set(e.userId,e);break;case sa.ZK.ON_USER_LEAVE:n.userInfoInRoomMap.has(e.userId)&&n.userInfoInRoomMap.delete(e.userId)}}))},e.prototype.isUserInfoExist=function(e){var t=this.userInfoInRoomMap.get(e);return!!(null==t?void 0:t.name)&&!!(null==t?void 0:t.userPic)},(0,r.__decorate)([(0,S.tB)(),(0,r.__metadata)("design:type","function"==typeof(t=void 0!==la.E&&la.E)?t:Object)],e.prototype,"collabUserInfoService",void 0),(0,r.__decorate)([(0,S.tB)(),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==pt.v&&pt.v)?n:Object)],e.prototype,"eventEmitter",void 0),e}(),pa=n(641415),fa=n(462086),ha=n.n(fa),ma=n(301958),ga=n(723557),va=function(){function e(e){this.clientVars=e,this.userInfoMap=new Map}return e.prototype.getUserInfoByUid=function(e){return this.userInfoMap.get(e)},e.prototype.getUserIds=function(){return Array.from(this.userInfoMap.keys())},e.prototype.fetchCollaboratorInfosWithChunck=function(e){var t=this,n=this.clientVars.globalPadId,o={headers:{"Content-Type":"application/x-www-form-urlencoded"},paramsSerializer:function(e){return ha().stringify(e,{arrayFormat:"repeat"})},timeout:1e4},i=pa.Z.get("/api/collaboratormember/member_list",(0,r.__assign)({params:{file_id:n,uids:e,xsrf:(0,d.getXsrf)()}},o)),a=pa.Z.get("/api/vipcenter/info/get",(0,r.__assign)({params:{file_id:n,uids:e,only_vip:!0}},o));return Promise.all([i,a]).then((function(e){return t.setCollaboratorInfos(e[0]),t.setVipInfos(e[1]),t.userInfoMap})).catch((function(e){return p.Logger.warn("get collaboratormember",e),t.userInfoMap}))},e.prototype.chunkUids=function(e,t){for(var n=[],r=0;r<e.length;r+=t)n.push(e.slice(r,r+t));return n},e.prototype.fetchCollaboratorInfos=function(e){var t=this;if(e.length<=50)return this.fetchCollaboratorInfosWithChunck(e);var n=this.chunkUids(e,50);return Promise.all(n.map((function(e){return t.fetchCollaboratorInfosWithChunck(e)}))).then((function(e){return t.userInfoMap})).catch((function(e){return t.userInfoMap}))},e.prototype.setCollaboratorInfos=function(e){var t=e.data;if(0!==t.retcode)throw new Error(t.msg);this.appendMembers(t.result.members)},e.prototype.setVipInfos=function(e){var t=e.data;if(0!==t.retcode)throw new Error(t.msg);this.injectVipInfo(t.result.vip_info)},e.prototype.appendMembers=function(e){var t=this;e.forEach((function(e){t.userInfoMap.set(e.uid,e)}))},e.prototype.injectVipInfo=function(e){var t=this;Object.keys(e).forEach((function(n){var o=t.userInfoMap.get(n);if(o)try{t.userInfoMap.set(n,(0,r.__assign)((0,r.__assign)({},o),{vipInfo:ma.Z(JSON.parse(e[n]),(function(e,t){return ga.Z(t)}))}))}catch(e){}}))},e}(),_a=n(225525),ya=n(666410),ba=n(662654),Ea=n(221352),Ca=n(421628),wa=function(){function e(e){var t=this;this.options=e,this.tag="ConnectionRecoverHelper",this.visibleObservable=new ba.y((function(e){var n=function(){return"visible"===document.visibilityState};t.nextVisible=function(){return e.next(n())},window.addEventListener("visibilitychange",(function(){e.next(n())})),document.addEventListener("click",(function(){e.next(!0)})),window.addEventListener("pagehide",(function(){e.next(!1)})),window.addEventListener("pageshow",(function(){e.next(!0)}))}))}return e.prototype.tryRecover=function(e,t){var n,o,i=this,a=function(n){var o;if(n.codes.indexOf(e)>=0)return s.observable?(p.Logger.info(s.tag,"retry conflict code: ".concat(e)),s.clean(),t(),{value:void 0}):(s.observable=s.visibleObservable.pipe((0,Wn.x)()).subscribe((function(a){var s,c,l=void 0===o;if(o=a,a){var u=!l||n.retryImmeOnFirstVisible;p.Logger.info(i.tag,"document visible, startRetry"),null===(s=i.cleanupRetry)||void 0===s||s.call(i),i.cleanupRetry=i.startRetry(e,(0,r.__assign)((0,r.__assign)({},n),{retryImme:u}),t)}else p.Logger.info(i.tag,"document invisible, cleanupRetry"),null===(c=i.cleanupRetry)||void 0===c||c.call(i)})),s.nextVisible(),{value:void 0})},s=this;try{for(var c=(0,r.__values)(this.options),l=c.next();!l.done;l=c.next()){var u=a(l.value);if("object"==typeof u)return u.value}}catch(e){n={error:e}}finally{try{l&&!l.done&&(o=c.return)&&o.call(c)}finally{if(n)throw n.error}}t()},e.prototype.startRetry=function(e,t,n){var r=this,o=t.retry,i=t.retryLimit,a=t.retryInterval,s=t.retryImme,c=(0,Ea.H)(s?0:a,a).pipe((0,Ca.q)(i)).subscribe((function(t){p.Logger.info(r.tag,"startRetry, count".concat(t,", retryLimit: ").concat(i)),o(e).then((function(){p.Logger.info(r.tag,"retry success, count: ".concat(t)),r.clean()})).catch((function(){p.Logger.info(r.tag,"retry failed, count: ".concat(t)),t===i-1&&(p.Logger.info(r.tag,"retry failed and fallback"),r.clean(),n())}))}));return function(){c.unsubscribe()}},e.prototype.clean=function(){var e,t;p.Logger.info(this.tag,"clean recovery"),null===(e=this.observable)||void 0===e||e.unsubscribe(),this.observable=void 0,null===(t=this.cleanupRetry)||void 0===t||t.call(this)},e}(),Ta=[ya.RoomWebsocketErrorCode.SOCKET_USER_AUTH_FAILED,ya.RoomWebsocketErrorCode.SOCKET_AUTH_TIMEOUT],Aa=[ya.RoomWebsocketErrorCode.SOCKET_SERVER_ERROR,ya.RoomWebsocketErrorCode.SOCKET_LAYER_ERROR,ya.RoomWebsocketErrorCode.SOCKET_COLLAB_SERVER_TIMEOUT,ya.RoomWebsocketErrorCode.SOCKET_DOC_PRIVILEGE_FAILED,ya.RoomWebsocketErrorCode.SOCKET_SERVER_STORAGE_TIMEOUT,ya.RoomWebsocketErrorCode.SOCKET_SERVER_CGI_TIMEOUT,ya.RoomWebsocketErrorCode.SOCKET_FREQUENCY_LIMIT],Sa=function(){function e(e){var t,n=this;this.context=e,this.isConnectOnce=!1;var o=e.notificationCenter;this.showTipsManager=new ne(o),this.recoverHelper=new wa((0,r.__spreadArray)((0,r.__spreadArray)([],(0,r.__read)((null===(t=window.tdocs)||void 0===t?void 0:t.docLogin)?[{codes:Ta,retry:function(e){return n.weworkRenewTicket(e)},retryLimit:1,retryInterval:H.DEFAULT_SEND_MESSAGE_TIMEOUT,retryImmeOnFirstVisible:!0}]:[]),!1),[{codes:[ya.RoomWebsocketErrorCode.SOCKET_SERVER_ERROR,ya.RoomWebsocketErrorCode.SOCKET_COLLAB_ROOM_TIMEOUT,ya.RoomWebsocketErrorCode.SOCKET_CLIENT_NOT_READY_ERROR,ya.RoomWebsocketErrorCode.SOCKET_DOC_PRIVILEGE_FAILED,ya.RoomErrorCode.ROOM_CLOSE],retry:function(){return(0,r.__awaiter)(n,void 0,void 0,(function(){var e=this;return(0,r.__generator)(this,(function(t){return[2,new Promise((function(t,n){e.reconnect(),e.context.collabCenterAdapter.isConnected?t(!0):setTimeout((function(){e.context.collabCenterAdapter.isConnected?t(!0):n()}),5e3)}))]}))}))},retryLimit:1,retryInterval:H.DEFAULT_SEND_MESSAGE_TIMEOUT,retryImmeOnFirstVisible:!1}],!1))}return e.prototype.handleConnect=function(){Q.j.info(Q.w.Collab,"network connect success."),this.isConnectOnce||(this.isConnectOnce=!0,d.ReportHelper.monitor007Status(d.MonitorName.SOCKET_FAILED_IN_90S,d.Status007.SUCCESS),d.ReportHelper.aegisReportEvent(d.ReportName.SOCKET_SUCCESS_IN_90S)),this.isTicketRenewed&&(_a.VF.renewSuccess(location.href),this.isTicketRenewed=!1);var e=window.App.changesetManager.hasUncommittedChanges();window.App.offlineEditAdapter.enterOnline(e)},e.prototype.handleClose=function(e){var t=e.reason,n=t.reason,r=void 0===n?"":n,o=t.errCode,i=void 0===o?0:o;Q.j.info(Q.w.Collab,"connection closed, errorCode = ".concat(i,", reason = ").concat(r)),Aa.includes(i)&&this.showTipsManager.showErrorTips(i,r);var a=window.App.changesetManager.hasUncommittedChanges();window.App.offlineEditAdapter.enterOffline(a,r)},e.prototype.handleShutdown=function(e){var t=this,n=e.reason,r=n.errCode,o=void 0===r?0:r,i=n.reason;Q.j.info(Q.w.Collab,"connection shutdown, errorCode = ".concat(o,", reason = ").concat(i)),d.ReportHelper.monitor007Status(d.MonitorName.SOCKET_SHUTDOWN,d.Status007.FAIL,i,{errorCode:o}),d.GlobalContext.fire(new qi),[Y.p.CollabRoomShutDownNotOpen,ya.RoomWebsocketErrorCode.SOCKET_COLLAB_ROOM_MEMBER_FULL,ya.RoomWebsocketErrorCode.SOCKET_COLLABROOM_NOT_VIP_FULL,ya.RoomWebsocketErrorCode.COMMIT_CHANGES_CONTAIN_REVERT,ya.RoomWebsocketErrorCode.INACTIVE].includes(o)||this.recoverHelper.tryRecover(o,(function(){t.context.canEdit()&&t.showTipsManager.showTips(o,i,t.context.canEdit()),t.notifyClearOfflineData(o),t.reportWebsocketError(o)}))},e.prototype.handleReconnectFail=function(){Q.j.info(Q.w.Collab,"connection reconnect fail!")},e.prototype.handleStateChange=function(e){var t=e.status,n=e.moreInfo;Q.j.info(Q.w.Collab,"connection state change:".concat(t," description:").concat(JSON.stringify(n)))},e.prototype.weworkRenewTicket=function(e){return(0,r.__awaiter)(this,void 0,Promise,(function(){var t;return(0,r.__generator)(this,(function(n){switch(n.label){case 0:if(!_a.VF.renewTicket(location.href))return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,_a.VF.awaitLoginTicket(location.href)];case 2:return n.sent(),this.reconnect(),this.isTicketRenewed=!0,[3,4];case 3:throw t=n.sent(),Q.j.error(Q.w.Collab,"renew ticket error, detail: ".concat(t)),t;case 4:return[3,6];case 5:throw Q.j.error(Q.w.Collab,"renew ticket error reach max try"),new Error("".concat(e));case 6:return[2]}}))}))},e.prototype.reconnect=function(){Q.j.error(Q.w.Collab,"reconnect after renew ticker."),this.context.collabCenterAdapter.reconnect()},e.prototype.notifyClearOfflineData=function(e){if(ya.RoomWebsocketErrorCode.SOCKET_DATA_DOC_NOT_EXIST===e){var t=new CustomEvent("CustomEvent");t.initCustomEvent("Melo_ClearOfflineData",!0,!0,{code:e}),document.dispatchEvent(t)}},e.prototype.reportWebsocketError=function(e){if(ya.RoomWebsocketErrorCode.SOCKET_USER_AUTH_FAILED===e){var t=new Error("login error! cookie:".concat(document.cookie));d.ReportHelper.captureException(d.MonitorName.ACTIVE_REPORT_ERROR,{},t)}d.ReportHelper.idkeyReport(d.IdkeyName.WEBSOCKET_ERROR)},e}(),Ia=n(673469),Ra=n(493788),Ma=n(926939);!function(e){e.ON_DELTA_GCP_CHANGE="onDeltaGcpChange"}(aa||(aa={}));var Oa,Na,ka=function(e){function t(t){var n=e.call(this,aa.ON_DELTA_GCP_CHANGE)||this;return n.rev=t,n}return(0,r.__extends)(t,e),t}(p.Notification),La=1e3,Da=function(){function e(){this.revStart=0,this.revEnd=0,this.store=new Map}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.save=function(e,t){if(!this.store.has(e))if(this.getRevs().length){if(e!==this.revStart-1&&e!==this.revEnd+1)return void console.error("Δgcp区间跳跃,不允许存入",e,t,this.store);e>this.revEnd?this.revEnd=e:this.revStart=e,this.store.set(e,[])}else this.revStart=e,this.revEnd=e,this.store.set(e,[]);var n=this.store.get(e),r=(0,Pi.Mu)(t);p.Logger.debug("[collab-caret]Δgcp save",e,r),r.forEach((function(e){return n.push(e)})),this.store.set(e,n),d.GlobalContext.fire(new ka(e)),this.slide()},e.prototype.deleteBeforeSave=function(e){this.store.has(e)&&this.store.set(e,[])},e.prototype.getDeltaGcpStore=function(){return this.store},e.prototype.hasRev=function(e){var t;return!!(null===(t=this.store.get(e))||void 0===t?void 0:t.length)},e.prototype.getRevs=function(){return(0,r.__spreadArray)([],(0,r.__read)(this.store.keys()),!1)},e.prototype.slide=function(){var e=this;if(this.revEnd-this.revStart>La){var t=this.revEnd-La,n=this.getRevs().filter((function(e){return e<t}));n.length&&(n.forEach((function(t){e.store.delete(t)})),this.revStart=t)}},e}(),Pa=function(){function e(){this.cache=new Map}return e.prototype.clear=function(){this.cache.clear()},e.prototype.save=function(e){var t=e.baseRev,n=e.userId,r=e.gcp;this.cache.has(t)||this.cache.set(t,{});var o=this.cache.get(t);o[n]?o[n].gcp=r:o[n]={gcp:r}},e.prototype.deleteRev=function(e){this.cache.has(e)&&this.cache.delete(e)},e.prototype.createCursorMsgsInRev=function(e){var t,n;if(!this.cache.has(e))return[];var o=[],i=this.cache.get(e);try{for(var a=(0,r.__values)(Object.entries(i)),s=a.next();!s.done;s=a.next()){var c=(0,r.__read)(s.value,2),l=c[0],u=c[1].gcp;o.push({baseRev:e,userId:l,gcp:u})}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return o},e}(),xa=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.consume=function(e,t,n){var o=e-1;if(this.cache.has(o)){var i=this.createCursorMsgsInRev(o),a=t.get(e);if(!a)return;i.forEach((function(e){var t=(0,r.__assign)({},e),o=(0,Pi.ZN)(e.gcp,a);t.gcp=o,t.baseRev+=1,n(t)})),this.deleteRev(o)}},t}(Pa),Fa=n(164354),Ba=n.n(Fa),Ua=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.getRevs=function(){return(0,r.__spreadArray)([],(0,r.__read)(this.cache.keys()),!1).map(Number)},t.prototype.consume=function(e,t,n){var o=this;if(this.getRevs().sort((function(e,t){return e-t})).forEach((function(i){var a=i+1,s=t.get(a);(null==s?void 0:s.length)&&(o.createCursorMsgsInRev(i).forEach((function(t){p.Logger.debug("[collab-caret]deltaGcp冲突前",t);var i=(0,r.__assign)({},t),a=(0,Pi.ZN)(t.gcp,s);i.gcp=a,i.baseRev+=1,p.Logger.debug("[collab-caret]deltaGcp冲突后",i),o.canDeliverNow(i.baseRev,e)?n(i):o.combine(i)})),o.deleteRev(i))})),this.cache.size){if(Ba()(this.preCache,this.cache))return;p.Logger.debug("[collab-caret]连续合并",this.cache),this.preCache=new Map(this.cache),this.consume(e,t,n)}},t.prototype.combine=function(e){var t,n=e.baseRev,r=e.userId;this.cache.has(n)&&(null===(t=this.cache.get(n))||void 0===t?void 0:t[r])||this.save(e)},t.prototype.canDeliverNow=function(e,t){return e===t},t}(Pa),Ha=function(){function e(){var e=this;this.lowVersionCache=Ua.getInstance(),this.highVersionCache=xa.getInstance(),this.deltaGCP=Da.getInstance(),d.GlobalContext.on(aa.ON_DELTA_GCP_CHANGE,(function(t){var n=t.rev;e.consume({curRev:window.App.collabCenterAdapter.getVersion(),rev:n})}))}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.addConsumeCursorMsgCallBack=function(e){this.consumeCallback=e},e.prototype.onVersionChange=function(e){p.Logger.debug("[collab-caret]onVersionChange",e,this.deltaGCP.getDeltaGcpStore());var t=this.deltaGCP.getDeltaGcpStore();this.highVersionCache.consume(e,t,this.consumeCallback)},e.prototype.pullLowerVersionMissChangeAndSave=function(e,t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var n,o,i,a=this;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return t>e?[2]:(n=Math.max(0,e-50),o=e,p.Logger.debug("[collab-caret]低版本触发补拉",n,o),d.ReportHelper.tdwReport({opername:"doc_word_editor",module:"collab-caret",action:"pull_low_version_misschanges",ver5:"[".concat(n,"-").concat(o,"]")}),[4,window.App.collabCenterAdapter.getMissChanges(n,o).catch((function(e){return console.error("pullLowerVersionMissChangeAndSave error, error=",e),Promise.reject(e)}))]);case 1:return i=r.sent(),p.Logger.debug("[collab-caret]changeList",i),i.map((function(e){return e.data})).sort((function(e,t){return t.newRev-e.newRev})).forEach((function(e){var t=e.newRev,n=e.changeset||e.commands;a.deltaGCP.deleteBeforeSave(t);var r=(0,Z.D6)(n);r&&a.deltaGCP.save(t,r)})),this.isNeedPull(t)&&this.pullLowerVersionMissChangeAndSave(n,t),[2]}}))}))},e.prototype.isNeedPull=function(e){return!this.deltaGCP.getRevs().length||e<this.deltaGCP.revStart},e.prototype.consume=function(e){var t=this.deltaGCP.getDeltaGcpStore(),n=e.curRev,r=e.rev;this.lowVersionCache.consume(n,t,this.consumeCallback),this.highVersionCache.consume(r,t,this.consumeCallback)},e}();!function(e){e.NOT_NEED_TO_CREATE="NOT_NEED_TO_CREATE",e.CREATE_NEW_DOC_ERROR="CREATE_NEW_DOC_ERROR",e.COMMIT_CHANGE_ERROR="COMMIT_CHANGE_ERROR",e.DATABASE_ERROR="DATABASE_ERROR"}(Oa||(Oa={})),function(e){e.RECEIVE_REVRET_MESSAGE="RECEIVE_REVRET_MESSAGE",e.SERVER_CHANGES_CONTAIN_REVERT="SERVER_CHANGES_CONTAIN_REVERT",e.COMMIT_CHANGES_CONTAIN_REVERT_WS="COMMIT_CHANGES_CONTAIN_REVERT_WS",e.COMMIT_CHANGES_CONTAIN_REVERT_CGI="COMMIT_CHANGES_CONTAIN_REVERT_CGI"}(Na||(Na={}));var Wa,ja=function(){function e(e){this.context=e,this.collabCursorDeltaGcpManager=Ha.getInstance(),this.showTipsManager=new ne(e.notificationCenter)}return e.prototype.handleCommitFail=function(e){var t,n=Number(e.errorCode);if([ya.RoomWebsocketErrorCode.SOCKET_DOC_PRIVILEGE_FAILED,ya.RoomWebsocketErrorCode.SOCKET_USER_DOC_NOPRIVILEGE].includes(n)&&this.showTipsManager.showTips(n),n===ya.RoomWebsocketErrorCode.COMMIT_CHANGES_CONTAIN_REVERT){var r=new CustomEvent(xi.R0,{detail:{version:this.context.collabCenterAdapter.getVersion()}});document.dispatchEvent(r),V.zzsReport(Na.COMMIT_CHANGES_CONTAIN_REVERT_WS)}this.reportCommitError(e),p.Logger.info(Q.w.Collab,"handle commit fail, cmd: ".concat(e.cmd,", errorCode: ").concat(n,", taskId: ").concat(null===(t=e.result)||void 0===t?void 0:t.taskId))},e.prototype.handleCommitSuccess=function(e){var t,n=e.newVersion,o=e.data,i=e.data.base64Commands,a=(0,Z.D6)(i);if(a&&this.collabCursorDeltaGcpManager.deltaGCP.save(e.newVersion,a),d.GlobalContext.run(B.Rh.push,{acceptCs:i,rev:n}),(0,Ma.m)()){o.base64Commands="";var s={newVersion:n,revert:!1,head:o.head,subId:o.subId,commitId:o.taskId,data:(0,r.__assign)((0,r.__assign)({},o),{commands:i,commandsType:ya.NewChangeCommandsType.BASE64,author:this.context.clientVars.userId})},c=new Ra.TU({data:s,uid:(0,U.getUid)()||"",version:n,secretId:(0,ei.pb)(),docType:Ra.Gk.WORD,taskId:o.taskId,subSheetId:o.subId,type:Ra.Nt.ACCEPTED,globalPadId:this.context.clientVars.globalPadId,createTime:null!==(t=o.time)&&void 0!==t?t:Date.now(),dver:window.App.GlobalConfig.globalCodeVersion});Fi.Wo.handleDataFromIndexDB({data:c,type:Fi.nN.update,tableName:Ra.me.DOCUMENT_DATA})}},e.prototype.reportCommitError=function(e){for(var t=Number(e.errorCode),n=e.commitingQueue.length,r=0;r<n;r++)d.ReportHelper.monitor(d.MonitorName.DATA_PRODUCE_ERROR_BACK),d.ReportHelper.monitor007Status(d.MonitorName.DATA_PRODUCE_ERROR_BACK_3_0);d.ReportHelper.tdwReport({opername:"doc_word_melo",module:"data_lost",action:"exp_tip",ver5:"1",ver6:"1",ver7:0,obj3:n}),d.ReportHelper.captureChangesetException(n<10?d.MonitorName.CHANGESET_ERROR_COMMIT:d.MonitorName.CHANGESET_ERROR_COMMIT_SPIKE,{option:{errorCode:e.errorCode}},new Error("code:".concat(t,",count:").concat(n)))},e}(),Ga=n(884008),Va=n(619736),za=n(760445),Qa=n(701128);!function(e){e.DELETE_OFFLINE_DATA="deleteOfflineData"}(Wa||(Wa={}));var Ya,Za=function(e){function t(){return e.call(this,Wa.DELETE_OFFLINE_DATA)||this}return(0,r.__extends)(t,e),t}(p.Notification),Ka=n(91190),Ja=n(830640),qa=n(948280);!function(e){e[e.privilegeAttribute=1]="privilegeAttribute",e[e.title=2]="title"}(Ya||(Ya={}));var Xa,$a="//".concat(window.location.hostname,"/cgi-go/padinfo/getpadinfo");!function(e){e.wx="wx",e.qq="qq"}(Xa||(Xa={}));var es,ts=function(){function e(e){this.context=e,this.showTipsManager=new ne(e.notificationCenter),this.cursorNoticeBeforeLoadCache=new Map,this.isEditFeatureLoaded=!1,this.addCollabCursorLoadedListener(),this.initCollabCursorConflictHandler()}var t,n;return e.prototype.addCollabCursorLoadedListener=function(){var e,t=this,n=null===(e=window.pad)||void 0===e?void 0:e.editor;n&&(this.gcpManager=n.state.dataEngine.createGCPClass(!0,!1,d.PosPolicy.Inner),n.once(sa.JI.FEATURE_LOAD_FINISH,(function(){t.isEditFeatureLoaded=!0,t.cursorNoticeBeforeLoadCache.size&&((0,r.__spreadArray)([],(0,r.__read)(t.cursorNoticeBeforeLoadCache.values()),!1).forEach((function(e){var n=e.userId,r=e.baseRev;t.context.notificationCenter.fire(new sa.pm([{userId:n,gcp:t.gcpManager.getGCP(n),baseRev:r}]))})),t.cursorNoticeBeforeLoadCache.clear())})))},e.prototype.initCollabCursorConflictHandler=function(){var e=this;this.collabCursorDeltaGcpManager=Ha.getInstance(),this.consumeCursorMsgCallback=function(t){var n=window.App.changesetManager.beforeApplyCursorMsg([t]);p.Logger.debug("[collab-caret]应用光标消息",n[0]),e.context.notificationCenter.fire(new sa.pm(n))},this.collabCursorDeltaGcpManager.addConsumeCursorMsgCallBack(this.consumeCursorMsgCallback)},e.prototype.handleReceiveMessage=function(e){var t,n=this,o=e.type,i=e.data,a=this.context.collabCenterAdapter.userInfoManager,s=(0,r.__read)(i,1)[0],c=be.qO.getInstance().isDrivePreview?{MARK_MESSAGE:function(e){return n.handleMarkMessage(o,e)}}:{USER_LEAVE:function(e){return a.handleUserLeave(e.body.notice)},USER_LEAVES:function(e){return a.handleUserLeaves(e.body.notices)},USER_NEWINFO:function(e){return a.handleUserNewInfo([e.body.notice],e.body.mem_count)},USER_NEWINFOS:function(e){return a.handleUserNewInfo(e.body.notices,e.body.mem_count)},RIGHT_MESSAGE:function(){return n.handleRightChange()},REVERT_MESSAGE:function(){return n.handleRevertMessage()},CURSOR_MESSAGE:function(e){var t;return n.handleCursorMessage([null===(t=e.body)||void 0===t?void 0:t.notice])},CURSOR_MESSAGES:function(e){var t;return n.handleCursorMessage(null===(t=e.body)||void 0===t?void 0:t.notices)},COMM_NOTICE:function(e){return n.handleCommonMessage(e)},CODEREV_NEW:function(e){return n.handleCodeVersionChange(e)},HANDLE_DELETE:function(e){return n.handleDeleteDocument(e)},LIVE_MESSAGE:function(e){return n.handleLiveMessage(e)},MARK_MESSAGE:function(e){return n.handleMarkMessage(o,e)},PRESENT_INFO:function(e){return n.handlePresentationInfo(e)},TITLE_MESSAGE:function(e){return n.handleTitleMessage(e)},COMMERCIALIZE_MESSAGE:function(e){return n.handleCommercializeMessage(e)}};null===(t=c[o])||void 0===t||t.call(c,s)},e.prototype.handleConnect=function(){this.handleRightChange(!1)},e.prototype.handleRightChange=function(e){void 0===e&&(e=!0);var t=!!(4&this.context.clientVars.rightFlag);p.Logger.info(Q.w.Collab,"通道接到权限变更的推送。isOwner:".concat(t,", isRightMessage:").concat(e)),t||this.updatePrivilege()},e.prototype.getDiffPrivilege=function(e){var t=this.context.clientVars.privilegeAttribute,n=e,r=function(e,t){return p.Logger.info("computeDiffPrivilege, old: ".concat(JSON.stringify(e),", new: ").concat(JSON.stringify(t))),Object.keys(t).reduce((function(n,r){return void 0!==e[r]&&void 0!==t[r]&&("object"==typeof e[r]||"object"==typeof t[r]?(0,d.deepEqual)(e[r],t[r])||n.push(r):e[r]!==t[r]&&n.push(r)),n}),[])}(t,n);return p.Logger.info("权限比对结果: oldPrivilege = ",t,"newPrivilege = ",n,"diffPrivilege = ",r),r},e.prototype.handleHasPrivilegeChange=function(e){var t={},n=e.docx_attribute;Object.keys(n).forEach((function(e){t["".concat(e)]=Number(n["".concat(e)])}));var o=(0,r.__assign)((0,r.__assign)({},e),t),i=this.getDiffPrivilege(o);i.length&&(this.context.clientVars.privilegeAttribute=o,window.clientVars&&(window.clientVars.privilegeAttribute=(0,r.__assign)((0,r.__assign)({},window.clientVars.privilegeAttribute),o)),d.GlobalContext.fire(new Va.Tf(o,i)),this.context.notificationCenter.fire(new za.w9),this.context.notificationCenter.fire(new Za))},e.prototype.updatePrivilege=function(){var e=this;this.context.collabCenterAdapter.sendMessage(H.Command.GET_PRIVILEGE).then((function(t){var n,r,o,i=t.result;0===i.errCode&&0===(null===(r=null===(n=i.response)||void 0===n?void 0:n.onpost)||void 0===r?void 0:r.result)&&(null===(o=i.response.onpost)||void 0===o?void 0:o.privilege_attribute)&&e.handleHasPrivilegeChange(i.response.onpost.privilege_attribute)})).catch((function(t){var n;(n=(0,ei.pb)(),(0,r.__awaiter)(void 0,void 0,Promise,(function(){return(0,r.__generator)(this,(function(e){return[2,new Promise((function(e,t){n!==si.yx&&n||t(new Error("PrivilegeAttributeService secretId:".concat(n," is invalid.")));var r="&infoKeys=[".concat([Ya.privilegeAttribute,Ya.title],"]"),o="".concat($a,"?encodePadId=").concat(n).concat(r,"&xsrf=").concat((0,d.getXsrf)());p.Logger.info("请求 /cgi-go/padinfo/getpadinfo 接口"),$.get(o).done((function(n){p.Logger.info("/cgi-go/padinfo/getpadinfo 接口返回：",n);try{if(0===n.retcode){var r=n.data.privilegeAttribute;return void e(r)}t(new Error("PrivilegeAttributeService response.retcode:".concat(null==n?void 0:n.retcode," is invalid.")))}catch(e){t(e)}})).fail((function(e){return t(e)}))}))]}))}))).then((function(t){e.handleHasPrivilegeChange(t)})).catch((function(e){var n;Q.j.warn(Q.w.Collab,"".concat(H.Command.GET_PRIVILEGE,", errCode:").concat(null===(n=t.result)||void 0===n?void 0:n.errCode," error:").concat(null==e?void 0:e.message))}))}))},e.prototype.handleRevertMessage=function(){return(0,r.__awaiter)(this,void 0,Promise,(function(){var e;return(0,r.__generator)(this,(function(t){return this.stateManager.get(qa.SN)||(e=new CustomEvent(xi.R0,{detail:{version:this.context.collabCenterAdapter.getVersion()}}),document.dispatchEvent(e),this.context.collabCenterAdapter.disconnect("revert message",H.RoomWebsocketErrorCode.COMMIT_CHANGES_CONTAIN_REVERT),V.zzsReport(Na.RECEIVE_REVRET_MESSAGE)),[2]}))}))},e.prototype.handleCursorMessage=function(e){var t=this;e.length&&(this.isEditFeatureLoaded?this.handleCursorMsgWithVersion(e):e.forEach((function(e){var n=e.userId,r=e.gcp;t.cursorNoticeBeforeLoadCache.set(n,e),t.gcpManager&&(t.gcpManager.containGCP(n)&&t.gcpManager.deleteGCP(n),t.gcpManager.insertGCP(n,r))})))},e.prototype.handleCursorMsgWithVersion=function(e){var t=this;p.Logger.debug("[collab-caret]收到光标消息",e[0]);var n=this.context.collabCenterAdapter.getVersion();e.forEach((function(e){var r=e.baseRev,o=r+1;if(r)if(r<n&&n-r<=950){if(t.collabCursorDeltaGcpManager.lowVersionCache.save(e),t.collabCursorDeltaGcpManager.deltaGCP.hasRev(o))return void t.collabCursorDeltaGcpManager.lowVersionCache.consume(n,t.collabCursorDeltaGcpManager.deltaGCP.getDeltaGcpStore(),t.consumeCursorMsgCallback);t.collabCursorDeltaGcpManager.isNeedPull(o)&&t.collabCursorDeltaGcpManager.pullLowerVersionMissChangeAndSave(n,o)}else r>n?t.collabCursorDeltaGcpManager.highVersionCache.save(e):t.consumeCursorMsgCallback(e);else t.context.notificationCenter.fire(new sa.pm([e]))}))},e.prototype.handleCodeVersionChange=function(e){var t,n=null!==(t=window.App.GlobalConfig.globalCodeVersion)&&void 0!==t?t:"";Q.j.error(Q.w.Collab,"handle code version change event, current dver: ".concat(n));var r=!1,o=e.body.notice,i=o.dver,a=o.gray,s=o.code_ver;i&&i!==n?(this.notifyOfflineCodeVersion(i),r=!0):a===window._grayVersion&&s===this.context.clientVars.collab_client_vars.pver&&a===this.context.clientVars.collab_client_vars.gray||(r=!0),r&&(this.context.collabCenterAdapter.disconnect("CodeVerChange"),this.context.notificationCenter.fire(new z.w0({errMsg:(0,j.$t)("文档状态有更新，请刷新重试。"),errCode:"",action:this.showTipsAction?[z.S9.REFRESH,z.S9.CONTACT]:[]})))},e.prototype.notifyOfflineCodeVersion=function(e){var t,n,r;if((0,Ma.m)()){var o=(0,ei.pb)();null===(r=null===(n=window.mqq)||void 0===n?void 0:n.invoke)||void 0===r||r.call(n,"docx","notifyOfflineCodeVersion",{ver_map:(t={},t[o]=e,t)})}},e.prototype.handleTitleMessage=function(e){this.context.notificationCenter.fire(new sa.V_(e.body.notice.title,e.body.notice.client_cookie))},e.prototype.handleDeleteDocument=function(e){var t=this.context.collabCenterAdapter,n=t.isRecovering,r=t.isDeleting;Q.j.warn(Q.w.Collab,"handle delete document, data:".concat(JSON.stringify(e)," isRecovering:").concat(n," isDeleting: ").concat(r)),n||r||window.multiAccountUtil.reload()},e.prototype.handleCommonMessage=function(e){var t,n,r=e.body.notice;if("push_message"===r.type){try{var o=JSON.parse(r.message);if(!o)return;if("unbind"!==o.type)return;var i=(0,Ga.getLoginType)();i||Q.j.warn(Q.w.Collab,"handleMessageFromServer unbind utype is null!");var a=o.unbind;if(a===Xa.wx){if(Q.j.warn(Q.w.Collab,"handleMessageFromServer unbind wx"),i===Xa.wx)return void this.context.collabCenterAdapter.disconnect("TX-LOGIN-PSKEY-EXPIRED");Q.j.warn(Q.w.Collab,"handleMessageFromServer unbind wx push not for wx")}else if(a===Xa.qq){if(Q.j.warn(Q.w.Collab,"handleMessageFromServer unbind qq"),i===Xa.qq)return;Q.j.warn(Q.w.Collab,"handleMessageFromServer unbind qq push not for qq")}}catch(e){Q.j.error(Q.w.Collab,"error: ".concat(null==e?void 0:e.message," notice:").concat(r.message)),Q.j.report("Word_Melo_COMM_NOTICE_Error")}this.context.notificationCenter.fire(new Va.ac(null===(n=e.body)||void 0===n?void 0:n.notice))}else this.context.notificationCenter.fire(new Va.ac(null===(t=e.body)||void 0===t?void 0:t.notice))},e.prototype.handleMarkMessage=function(e,t){this.context.notificationCenter.fire(new sa.T9({type:e,watermark:t.body.notice.watermark}))},e.prototype.handleLiveMessage=function(e){this.context.notificationCenter.fire(new sa.tR(e))},e.prototype.handlePresentationInfo=function(e){var t=this,n=e.body.notice,o=n.syncDataList,i=n.bizid,a=n.hostInfo;o&&a&&o.forEach((function(e){(0,Ka.ym)(e)?t.context.notificationCenter.fire(new sa.ir((0,r.__assign)((0,r.__assign)({},e),{bizid:i,hostInfo:a}))):(0,Ka.lF)(e)?t.context.notificationCenter.fire(new sa.z$((0,r.__assign)((0,r.__assign)({},e),{bizid:i,hostInfo:a}))):(0,Ka.F4)(e)?t.context.notificationCenter.fire(new sa.JL((0,r.__assign)((0,r.__assign)({},e),{bizid:i,hostInfo:a}))):(0,Ka.p_)(e)&&t.context.notificationCenter.fire(new sa.OP((0,r.__assign)((0,r.__assign)({},e),{bizid:i,hostInfo:a})))}))},e.prototype.handleCommercializeMessage=function(e){var t=e.body.notice,n=t.type,r=t.payload;switch(n){case"docBackground":this.context.notificationCenter.fire(new Ja.v(r.background_id,r.transparency));break;case"anonymous_status":this.context.notificationCenter.fire(new Qa.L(r.operator,r.anonymous_status)),this.context.collabCenterAdapter.userInfoManager.handlerUserAnonymousStatusChange(r.operator)}},(0,r.__decorate)([(0,S.tB)(),(0,r.__metadata)("design:type","function"==typeof(t=void 0!==la.E&&la.E)?t:Object)],e.prototype,"collabUserInfoService",void 0),(0,r.__decorate)([(0,S.tB)(),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==He.O&&He.O)?n:Object)],e.prototype,"stateManager",void 0),(0,r.__decorate)([(0,X.D)("feature.collab_center_adapter.showTipsAction",!0),(0,r.__metadata)("design:type",Boolean)],e.prototype,"showTipsAction",void 0),e}();!function(e){e.LocalChangeContent="localChangeContent",e.ServerChangeContent="serverChangeContent"}(es||(es={})),function(e){function t(t){var n=e.call(this,es.LocalChangeContent)||this;return n.msg=t,n}(0,r.__extends)(t,e)}(p.Notification);var ns,rs,os=function(e){function t(){return e.call(this,es.ServerChangeContent)||this}return(0,r.__extends)(t,e),t}(p.Notification),is=n(164418),as=n(698054),ss=[H.RoomWebsocketErrorCode.SOCKET_COLLAB_ROOM_MEMBER_FULL,H.RoomWebsocketErrorCode.SOCKET_COLLABROOM_NOT_VIP_FULL,H.RoomWebsocketErrorCode.SOCKET_COLLABROOM_DOC_DELETED,H.RoomWebsocketErrorCode.SOCKET_DOC_PRIVILEGE_FAILED,H.RoomWebsocketErrorCode.SOCKET_USER_AUTH_FAILED,Y.p.CollabRoomDataBaseChange],cs=function(){function e(e){this.context=e,this.disconnectErrorCode=0;var t=e.clientVars,n=e.notificationCenter,o=(0,r.__assign)((0,r.__assign)({},this.context),{collabCenterAdapter:this});this.userInfoManager=new da(n,t),this.collaboratorInfoManager=new va(t),this.sendMessageAdapter=new ja(o),this.receiveMessageAdapter=new ts(o),this.connectionAdapter=new Sa(o),this.initCollabCenter(),this.initCollabEvent(),this.initConnectionControllerService(),this.connectionController=this.collabCenter.connectionController,window.App.collabCenterAdapter=this,!t.isPublish&&as.x.getIsNeedInitCollabCenter()&&(this.connectAfterCreateDocument(),this.collabCursorDeltaGcpManager=Ha.getInstance())}var t,n;return Object.defineProperty(e.prototype,"isConnected",{get:function(){return this.collabCenter.isConnected},enumerable:!1,configurable:!0}),e.prototype.getVersion=function(){return this.collabCenter.version},e.prototype.connect=function(e){this.collabCenter.connect(e)},e.prototype.disconnect=function(e,t){this.collabCenter.disconnect(e,t)},e.prototype.reconnect=function(){this.collabCenter.reconnect(),this.collabCenter.forceResume(H.PauseOrResumeType.ALL)},e.prototype.pause=function(e){this.collabCenter.pause(e)},e.prototype.forceResume=function(e){this.collabCenter.forceResume(e)},e.prototype.resume=function(e){this.collabCenter.resume(e)},e.prototype.sendUserChange=function(e){this.collabCenter.sendUserChange(e)},e.prototype.getConnectionController=function(){return this.collabCenter.connectionController},e.prototype.getLocalUserChanges=function(){return this.collabCenter.getLocalUserChanges()},e.prototype.sendMessage=function(e,t,n){return void 0===t&&(t=null),(0,r.__awaiter)(this,void 0,Promise,(function(){var o=this;return(0,r.__generator)(this,(function(r){return[2,new Promise((function(r,i){try{var a=JSON.stringify(t),s={cmd:e,data:a,onError:function(e,t,n,r){Q.j.error(Q.w.Collab,"send message exception taskId: ".concat(e," command:").concat(t," result:").concat(null==r?void 0:r.errCode)),i({taskId:e,command:t,type:n,result:r})},onsend:function(e,t,n,o){r({taskId:e,command:t,type:n,result:o})},taskId:null!=n?n:(0,H.generateMessageTaskId)(),customParam:{timeout:H.DEFAULT_SEND_MESSAGE_TIMEOUT,maxRetryCount:3}};o.collabCenter.sendMessage([s])}catch(r){var c={errorCode:-1,errorMsg:r.message};i({taskId:n,command:e,type:t,result:c})}}))]}))}))},e.prototype.startGetMissChanges=function(e,t){this.collabCenter.startGetMissChanges(e,t)},e.prototype.getMissChanges=function(e,t){return(0,r.__awaiter)(this,void 0,Promise,(function(){return(0,r.__generator)(this,(function(n){return[2,this.collabCenter.getMissChanges(e,t)]}))}))},e.prototype.handleServerUserChanges=function(e){return(0,r.__awaiter)(this,void 0,Promise,(function(){return(0,r.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.collabCenter.handleServerUserChanges(e)];case 1:return t.sent(),[2]}}))}))},e.prototype.connectAfterCreateDocument=function(){var e=this;d.GlobalContext.once(is.G7,(function(t){Q.j.info(Q.w.Collab,"LONG_CONNECTION_NOTIFICATION_TYPE, status:".concat(t.status)),(0,zi.t)().getCreateDocPromise().then((function(t){e.handleAfterCreateDocument(t)})).catch((function(e){Q.j.error(Q.w.Collab,"connectAfterCreateDocument can't connect, reason: ".concat(null==e?void 0:e.message))}))}),this),this.context.clientVars.isOverConNum||(this.connectionTimeoutId=setTimeout((function(){!1===window.hiddenOnDocumentOpening&&"hidden"!==document.visibilityState&&(Q.j.info(Q.w.Collab,"socket connect timeout in 90s !!!"),ss.includes(e.disconnectErrorCode)||V.reportToWebLog("".concat(9e4)),d.ReportHelper.monitor007Status(d.MonitorName.SOCKET_FAILED_IN_90S,d.Status007.FAIL,void 0,{errorCode:e.disconnectErrorCode,isOffline:!1}),d.ReportHelper.aegisReportEvent({name:d.ReportName.SOCKET_FAILED_IN_90S,custom_errorInfo:String(e.disconnectErrorCode)})),clearTimeout(e.connectionTimeoutId)}),9e4))},e.prototype.handleAfterCreateDocument=function(e){if(Q.j.info(Q.w.Collab,"handle after create document, result = ",e),!0===e){if(se.dQ&&!be.qO.getInstance().canEdit)return;this.connect()}else{var t=e.collab_client_vars,n=this.context.clientVars.userId,r=this.context.canEdit();t.gray=Math.max(t.gray,0);var o={serverVars:t,uid:(0,U.getUid)()||"",uuId:n,userid:n,module:"doc",config:{headerGeneralPacket:ia(r),messagePriority:new Map([[H.Command.CURSOR_MESSAGE,H.MessagePriority.LOW]])}};this.collabCenter.reconnect(o)}},e.prototype.getConnectionOptions=function(e){var t=e.collab_client_vars,n=e.userId,o=(0,r.__assign)((0,r.__assign)({},t),{dver:window.App.GlobalConfig.globalCodeVersion}),i=t.client,a=this.context.canEdit();return{serverVars:o,uid:n.startsWith("g.")?"":(0,U.getUid)()||"",uuId:(0,ci.Gb)(n,null==i?void 0:i.sid),userid:n,module:"doc",config:{headerGeneralPacket:ia(a),messagePriority:new Map([[H.Command.CURSOR_MESSAGE,H.MessagePriority.LOW]])}}},e.prototype.getCollabCenterConfig=function(e){return{documentInfo:{isEditable:!!(2&e.rightFlag),isCreator:e.isCreator},fullMemberInfo:{enable:!0,isFullMember:!!e.isOverConNum},hotDocsInfo:{enable:!0,isHotDocs:!!e.hotDocs,isQueryData:!!e.querydata}}},e.prototype.initCollabCenter=function(){var e=this.context.clientVars.collab_client_vars.rev,t=this.getConnectionOptions(this.context.clientVars);this.collabCenter=new H.CollabCenter({baseVersion:e,connectionOptions:t,collabCenterDelegate:{multiTypeFollow:this.multiTypeFollow.bind(this),shouldFollowUserChange:this.shouldFollowUserChange.bind(this),onEditableChange:this.onEditableChange.bind(this),getMissChangesUrl:this.getMissChangesUrl.bind(this),getQueryDataUrl:this.getQueryDataUrl.bind(this),onReceiveQueryData:this.onReceiveQueryData.bind(this),applyServerUserChanges:this.applyServerUserChanges.bind(this)},config:this.getCollabCenterConfig(this.context.clientVars)})},e.prototype.initCollabEvent=function(){var e=this,t=this.collabCenter.connectionController;t&&(na.ZP.getInstance().sendMessage=t.sendMessage.bind(t),t.onConnectionEvent((function(e){var t,n,r,o,i;na.ZP.getInstance().receiveMessage((null===(n=null===(t=e.data)||void 0===t?void 0:t.serverMsg)||void 0===n?void 0:n.type)||"",null!==(i=null===(o=null===(r=e.data)||void 0===r?void 0:r.serverMsg)||void 0===o?void 0:o.data)&&void 0!==i?i:[])}))),this.collabCenter.on(H.SEND_MESSAGE_EVENT.ON_COMMIT_SUCCESS,(function(t){return e.sendMessageAdapter.handleCommitSuccess(t)})),this.collabCenter.on(H.SEND_MESSAGE_EVENT.ON_COMMIT_FAIL,(function(t){return e.sendMessageAdapter.handleCommitFail(t)})),this.collabCenter.on(H.RECEIVE_MESSAGE_EVENT.ON_RECEIVE_MESSAGE,(function(t){return e.receiveMessageAdapter.handleReceiveMessage(t)})),this.collabCenter.on(H.CONNECTION_STATE_EVENT.ON_ROOM_OPEN,(function(){clearTimeout(e.connectionTimeoutId),e.connectionAdapter.handleConnect(),e.receiveMessageAdapter.handleConnect()})),this.collabCenter.on(H.CONNECTION_STATE_EVENT.ON_ROOM_CLOSE,(function(t){return e.connectionAdapter.handleClose(t)})),this.collabCenter.on(H.CONNECTION_STATE_EVENT.ON_ROOM_SHUTDOWN,(function(t){e.connectionAdapter.handleShutdown(t),e.clearConnectionTimeoutId(t)})),this.collabCenter.on(H.CONNECTION_STATE_EVENT.ON_RECONNECT_FAIL,(function(){return e.connectionAdapter.handleReconnectFail()})),this.collabCenter.on(H.CONNECTION_STATE_EVENT.ON_ROOM_STATE_CHANGE,(function(t){return e.connectionAdapter.handleStateChange(t)})),this.collabCenter.on(H.VERSION_EVENT.ON_VERSION_CHANGE,(function(t){var n=new CustomEvent("Melo_setPadRev",{detail:{padRev:t.newVersion}});document.dispatchEvent(n),e.collabCursorDeltaGcpManager.onVersionChange(t.newVersion)})),this.collabCenter.on(H.REPORT_EVENT.ON_LOG,(function(e){var t=e.type,n=e.data;t===H.LOG_TYPE.INFO?Q.j.info.apply(Q.j,(0,r.__spreadArray)([Q.w.Collab],(0,r.__read)(n),!1)):t===H.LOG_TYPE.WARN?Q.j.warn.apply(Q.j,(0,r.__spreadArray)([Q.w.Collab],(0,r.__read)(n),!1)):t===H.LOG_TYPE.ERROR?Q.j.error.apply(Q.j,(0,r.__spreadArray)([Q.w.Collab],(0,r.__read)(n),!1)):H.LOG_TYPE.DEBUG})),this.collabCenter.on(H.REPORT_EVENT.ON_REPORT,(function(e){var t=e.type,n=e.data;t===H.REPORT_MONITOR_TYPE.COMMIT_REQUEST_SUCCESS?(d.ReportHelper.monitor007Status(d.MonitorName.KEY_COMMIT_REQUEST_FAIL,d.Status007.SUCCESS),d.ReportHelper.aegisReportEvent(d.ReportName.KEY_COMMIT_REQUEST_SUCCESS)):t===H.REPORT_MONITOR_TYPE.COMMIT_REQUEST_FAIL&&(d.ReportHelper.monitor007Status(d.MonitorName.KEY_COMMIT_REQUEST_FAIL,d.Status007.FAIL,n.errorMessage,{errorCode:n.errorCode}),d.ReportHelper.aegisReportEvent({name:d.ReportName.KEY_COMMIT_REQUEST_FAIL,custom_errorInfo:n.errorCode}))})),this.collabCenter.on(H.LOCAL_USER_CHANGE_EVENT.ON_QUEUE_CHANGE,(function(e){var t=(0,r.__spreadArray)((0,r.__spreadArray)([],(0,r.__read)(e.commitingQueue.map((function(e){return Li(e,Oi.DOCUMENT_DATA_TYPE.committing)}))),!1),(0,r.__read)(e.waitingQueue.map((function(e){return Li(e,Oi.DOCUMENT_DATA_TYPE.waiting)}))),!1);window.App.offlineEditAdapter.deleteAndUpsertChanges(t)}))},e.prototype.initConnectionControllerService=function(){this.collabCenter.connectionController&&this.extensionService.dependentServiceCombinder.connectionControllerService.setConnectionController(this.collabCenter.connectionController)},e.prototype.applyServerUserChanges=function(e){var t,n;if(!be.qO.getInstance().isDrivePreview&&!(null===(t=this.contextService)||void 0===t?void 0:t.context.store.getValue("isReceivedRevertCommands"))){if(e.revert){var r=new CustomEvent(xi.R0,{detail:{version:this.getVersion()}});return document.dispatchEvent(r),V.zzsReport(Na.SERVER_CHANGES_CONTAIN_REVERT),void(null===(n=this.contextService)||void 0===n||n.context.store.upsert("isReceivedRevertCommands",!0))}var o=e.base64Commands,i=e.changeset,a=e.newRev,s=e.taskId,c=o||i;this.saveDeltaGcp(a,c),d.GlobalContext.run(B.Rh.push,{newCs:c,rev:a});var l=K._.getAllMutationWrappers(c),u=this.getVersion();Q.j.info(Q.w.Collab,"collabcenter adapter receive server user change.",u,a,s),window.App.changesetManager.applyNewChangesToBase(l,e.author),this.context.notificationCenter.fire(new os),this.context.notificationCenter.fire(new Ia.N(e))}},e.prototype.saveDeltaGcp=function(e,t){var n=(0,Z.D6)(t);n&&this.collabCursorDeltaGcpManager.deltaGCP.save(e,n)},e.prototype.shouldFollowUserChange=function(e){return!e.revert},e.prototype.multiTypeFollow=function(e,t,n){var r=K._.getMutationCommands(e.base64Commands||e.changeset),o=(0,Z.By)(r),i=K._.getMutationCommands(t.base64Commands||t.changeset),a=(0,Z.By)(i),s=d.MutationUtil.followSingle(a,o,!n),c={type:i[0].type,mutations:s};return{changesetType:t.changesetType,changeset:"",base64Commands:(0,Z.eT)([c])}},e.prototype.getMissChangesUrl=function(e){return(0,r.__awaiter)(this,void 0,Promise,(function(){var t;return(0,r.__generator)(this,(function(n){return t=void 0!==e.to?"&to=".concat(e.to):"",[2,"/dop-api/get/changes?padId=".concat(e.globalPadId,"&from=").concat(e.from).concat(t,"&commandsFormat=1")]}))}))},e.prototype.getQueryDataUrl=function(){return"/dop-api/querydata?padid=".concat(this.context.clientVars.globalPadId,"&noEscape=1&type=doc&room=1")},e.prototype.onEditableChange=function(e){var t="collab_center_lock";e?be.qO.getInstance().enableEditForKey(t):be.qO.getInstance().disableEditForKey(t),Q.j.info(Q.w.Collab,"full member status change, editable: ".concat(e,", editKey: ").concat(t))},e.prototype.onReceiveQueryData=function(e){try{return this.getVersion()!==e.rev?(Q.j.info(Q.w.Collab,"on receive query data， rev:",e.rev),this.collabCenter.startGetMissChanges(this.getVersion()+1,e.rev)):Q.j.info(Q.w.Collab,"on receive query data, newRev === curVersion, need not refresh"),!0}catch(e){return Q.j.info(Q.w.Collab,"on receive query data， apply data error:",e.message),!1}},e.prototype.clearConnectionTimeoutId=function(e){var t=e.reason.errCode,n=void 0===t?0:t;this.disconnectErrorCode=n},(0,r.__decorate)([(0,S.tB)(),(0,r.__metadata)("design:type","function"==typeof(t=void 0!==Ti.$&&Ti.$)?t:Object)],e.prototype,"extensionService",void 0),(0,r.__decorate)([(0,S.tB)(),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==I.O&&I.O)?n:Object)],e.prototype,"contextService",void 0),e}(),ls=n(798732),us=n(972925),ds=n(305775);!function(e){e.POST="POST",e.GET="GET"}(ns||(ns={})),function(e){e.None="None",e.Network="Network",e.ServerVerity="ServerVerity"}(rs||(rs={}));var ps=function(){function e(e){this.rev=e}return e.prototype.composeOfflineData=function(e,t){if(!t||0===t.length)return{};var n=(0,U.getUid)(),r=t[0];return{common:{commandsFormat:r.modelVersion===gi.protoBufStructure?1:0,type:"USER_CHANGES",offlineMsg:!0,curRev:this.rev,docid:e,uid:n,dver:window.App.GlobalConfig.globalCodeVersion,base_rev:r.version,code_ver:0,session_type:0,gray:window._grayVersion?window._grayVersion:0,generalpacket:{rel_rev:window.__globalReleaseVersion},pver:2,uuId:n},respective:t.map((function(e){return{task_id:e.taskId,subId:e.subId,changeSetCount:e.changeSetCount||1,commands:(0,Z.eT)(e.changeset,e.modelVersion===gi.protoBufStructure)}}))}},e.prototype.commitOfflineData=function(e,t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var n,o;return(0,r.__generator)(this,(function(r){return n="/dop-api/commitchanges?padId=".concat(e,"&xsrf=").concat((0,d.getXsrf)()),o=JSON.stringify(t),o=encodeURIComponent(o),[2,Ra.hS.sendCommonRequest(n,ns.POST,"data=".concat(o))]}))}))},e.prototype.batchCommitOfflineData=function(e,t){return(0,r.__awaiter)(this,void 0,Promise,(function(){var n,o,i,a,s=this;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return n={success:!1,type:rs.None,data:[]},o=this.composeOfflineData(e,t),[4,this.commitOfflineData(e,o)];case 1:return(i=r.sent()).error?[4,this.commitOfflineData(e,o)]:[3,3];case 2:i=r.sent(),r.label=3;case 3:return i.error?(n.type=rs.Network,p.Logger.error(i.error),n.errorCode=i.error.statusCode,[2,n]):((a=i.data)&&0===a.retcode?(a.Data.respective.forEach((function(e){p.Logger.info("commitOfflineData:".concat(s.rev,", ").concat(e.newRev,", ").concat(e.commands,", ").concat(e.commitId)),e.newRev>s.rev&&n.data.push(e)})),n.success=!0):(n.type=rs.ServerVerity,n.errorCode=a.retcode,p.Logger.error("batchCommitOfflineData retcode:".concat(a&&a.retcode))),[2,n])}}))}))},e}(),fs=function(){function e(){}return e.prototype.createDoc=function(e,t){return(0,r.__awaiter)(this,void 0,Promise,(function(){var n,o,i,a,s,c,l,u;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return n={success:!1},[4,this.createNewDoc(e)];case 1:return 0!==(o=r.sent()).retcode?(n.reason=Oa.CREATE_NEW_DOC_ERROR,p.Logger.info("createNewDoc Error, retcode:".concat(o.retcode,",  message: ").concat(o.msg)),[2,n]):(i=o.doc_url,a=o.doc_id,s=a.domain_id,c=a.pad_id,p.Logger.info("createNewDoc version: ".concat(e.version,",  Result: ").concat(JSON.stringify(o))),l="".concat(s,"$").concat(c),[4,this.commitChanges(l,e.version,t)]);case 2:return(u=r.sent()).success?[4,window.App.offlineEditAdapter.clearOfflineData("commitchanges success.")]:(n.reason=Oa.COMMIT_CHANGE_ERROR,p.Logger.info("commitChanges error, error type: ".concat(u.type)),[2,n]);case 3:return r.sent(),n.success=!0,n.newUrl=i,[2,n]}}))}))},e.prototype.createNewDoc=function(e){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t,n,o;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return t=e.version,n=this.generateCreateFileBody(t),[4,us.networkRequest.post("/cgi-bin/online_docs/createdoc_new?create_source=8001",n)];case 1:if(200!==(o=r.sent()).status)throw Error((0,j.$t)("创建副本请求失败"));return[2,o.data]}}))}))},e.prototype.generateCreateFileBody=function(e){var t=Math.floor(+new Date/1e3),n="".concat((0,j.$t)("副本"),"-").concat((0,c.Yi)().title,"-").concat((new Date).toLocaleDateString()),r=(0,c.Yi)().domainId,o=(0,c.Yi)().padId;return"create_type=".concat(4,"&commandsFormat=1&create_source=").concat(8001,"&pad_id=").concat(o,"&domain_id=").concat(r,"&doc_type=").concat(0,"&templateId=").concat(0,"&xsrf=").concat((0,ds.f)(),"&version=").concat("3.0.0","&folder_id=").concat("/","&title=").concat(n,"&last_browse_ts=").concat(t,"&data_rev=").concat(e)},e.prototype.commitChanges=function(e,t,n){return(0,r.__awaiter)(this,void 0,Promise,(function(){return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return[4,new ps(t).batchCommitOfflineData(e,n)];case 1:return[2,r.sent()]}}))}))},e}(),hs=function(e){var t=this;this.context=e,this.newDocUrl="",this.handleRevert=function(){return(0,r.__awaiter)(t,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){return p.Logger.info("RevertChangesetHandler handleRevert"),this.tipsManager.showErrorTips(ya.RoomWebsocketErrorCode.COMMIT_CHANGES_CONTAIN_REVERT,void 0,!0),[2]}))}))},this.confirmToCreateDocCopy=function(){return(0,r.__awaiter)(t,void 0,void 0,(function(){var e,t,n,o,i;return(0,r.__generator)(this,(function(a){switch(a.label){case 0:return[4,J()];case 1:return e=a.sent(),p.Logger.info("RevertChangesetHandler confirmToCreateDocCopy localChanges.length:".concat(e.length)),e.length?(t=new fs,n=(0,r.__read)(e,1),o=n[0],[4,t.createDoc({globalPadId:(0,c.Yi)().globalPadId,version:o.version},e)]):[2];case 2:return(i=a.sent()).success?(this.newDocUrl="https:".concat(i.newUrl),this.createDocSucessModal(),[2]):(p.Logger.warn("RevertChangesetHandler handleRevert fail. reason:".concat(i.reason)),this.handleCommitError(),[2])}}))}))},this.showModal=function(e){Wi.Snackbar.show({type:e.type,message:e.message,action:e.action,autoClose:e.autoClose,onClickAction:e.onClickAction})},this.createDocSucessModal=function(){var e={type:"success",message:(0,j.$t)("文档已被还原无法进行数据同步，已为你保存副本。"),action:(0,j.$t)("去查看"),autoClose:!1,onClickAction:function(){return t.openNewDoc()}};t.showModal(e)},this.reload=function(){window.location&&window.multiAccountUtil.reload()},this.openNewDoc=function(){p.Logger.info("打开新文档： 文档URL：".concat(t.newDocUrl)),window.open(t.newDocUrl),t.reload()},this.handleCommitError=function(){t.tipsManager.showErrorTips(W.OFFLINE_EDIT_CODE.RESUBMIT_FAIL)},this.tipsManager=new ne(this.context.notificationCenter),this.context.notificationCenter.on(ls.N.CONFIRM_CREATE_DOC_COPY,this.confirmToCreateDocCopy)},ms=n(411812),gs=n(969577),vs=n(537666),_s=n(336338),ys=function(e,t){if(p.Logger.info("follow newRev:".concat(t.newRev,", taskId:").concat(t.commitId," revert:").concat(t.revert)),t.revert){var n=new Error("revert changes, command is undefined.");throw n.name="".concat(H.RoomWebsocketErrorCode.COMMIT_CHANGES_CONTAIN_REVERT),n}var o=K._.getMutationCommands(t.commands),i=[];return e.forEach((function(e){var n,a;e.changesetString&&(e.changeset=K._.getMutationCommands(e.changesetString));var s=(0,r.__assign)({},e);null===(a=(n=e.changeset).forEach)||void 0===a||a.call(n,(function(t){var n;if("BB08J2"!==e.subId)return e;null===(n=o.forEach)||void 0===n||n.call(o,(function(e){var n;n=(0,r.__read)(d.MutationUtil.followDouble(t.mutations,e.mutations),2),t.mutations=n[0],e.mutations=n[1]}))})),s.version=t.newRev,s.changesetString=(0,Z.eT)(e.changeset),i.push(s)})),i},bs=function(){function e(e,t){var n={version:e,documentInfo:{dataVersion:t,docType:Oi.DOCUMENT_TYPE.doc,secretId:(0,ei.pb)(),globalPadId:(0,c.Yi)().globalPadId,uid:(0,U.getUid)()||""}};this.offlineEditBackUp=new W.OfflineEditBackUp(n)}return e.prototype.init=function(){return(0,r.__awaiter)(this,void 0,Promise,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.offlineEditBackUp.init()];case 1:return[2,e.sent()]}}))}))},e}(),Es=function(){function e(e){var t=this;this.adapterOption=e,this.isEnterOffline=!1,this.tag="OfflineEditAdapter",this.handleClearOfflineData=function(e){return(0,r.__awaiter)(t,void 0,void 0,(function(){var t,n,o,i,a;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return t=Number(null!==(o=null===(n=null==e?void 0:e.detail)||void 0===n?void 0:n.code)&&void 0!==o?o:0),(null===(i=null==e?void 0:e.detail)||void 0===i?void 0:i.isBackup)?[4,this.backupChanges()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.clearOfflineData("handleClearOfflineData reason:".concat(t),null===(a=null==e?void 0:e.detail)||void 0===a?void 0:a.callback),[2]}}))}))};var n=(0,c.Yi)().padStatus===Oi.DOCUMENT_STATUS.local||(0,c.Yi)().padStatus===Oi.DOCUMENT_STATUS.new,o={version:(0,c.Yi)().collab_client_vars.rev,documentInfo:{secretId:(0,ei.pb)(),globalPadId:(0,c.Yi)().globalPadId,dataVersion:window.App.GlobalConfig.globalCodeVersion,documentType:Oi.DOCUMENT_TYPE_DESC.doc,docType:Oi.DOCUMENT_TYPE.doc,uid:(0,U.getUid)()||""},config:{isUseResubmit:!0,isUseBatchCommit:!n,isDisableAutoReleaseLock:n}},i={eventEmitter:this.adapterOption.eventEmitter,canEdit:this.adapterOption.canEdit,resubmit:{connectionController:window.App.collabCenterAdapter.connectionController,getNewChanges:this.getNewChanges.bind(this),applyNewChanges:this.applyNewChanges.bind(this),applyLocalChanges:this.applyLocalChanges.bind(this),follow:ys,setEditAble:function(){return be.qO.getInstance().setPrivilege({isBlocked:!1})},setDisableEdit:function(){return be.qO.getInstance().setPrivilege({isBlocked:!0})},offlineDataSyncing:gs.l1},networkStatusSwitch:{config:{available:gs.YX,unusable:gs.Xx,otherTab:gs.Ps,offlineDataSyncing:gs.l1},setEditAble:function(){return be.qO.getInstance().setPrivilege({isBlocked:!1})},setDisableEdit:function(){return be.qO.getInstance().setPrivilege({isBlocked:!0})}},oldChangesTransForm:Di};this.offlineEdit=new W.OfflineEdit(o,i),this.offlineEditWritable=!0}return e.prototype.init=function(){var e,t,n,o,i;return(0,r.__awaiter)(this,void 0,Promise,(function(){var a,s,c;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return this.initEvent(),a=as.x.getIsNeedInitOffline(),[4,this.offlineEdit.init(!a)];case 1:return(s=r.sent()).error&&p.Logger.warn(this.tag,"init error:".concat(null===(e=s.error)||void 0===e?void 0:e.message," name:").concat(null===(t=s.error)||void 0===t?void 0:t.name)),s.retCode!==ya.RoomWebsocketErrorCode.COMMIT_CHANGES_CONTAIN_REVERT&&(null===(n=s.error)||void 0===n?void 0:n.name)!=="".concat(ya.RoomWebsocketErrorCode.COMMIT_CHANGES_CONTAIN_REVERT)||void 0===s.baseVersion?(this.offlineEdit.mutexLockHelper.isLocked()||"list"!==(null===(i=null===(o=this.offlineEdit.mutexLockHelper.lastLockItem)||void 0===o?void 0:o.optional)||void 0===i?void 0:i.source)||this.detectLock(),s.isSuccess?(as.x.getIsNeedInitOffline()&&ms.network.changeEnd(this.handleNetWorkChangeCallback.bind(this)),d.GlobalContext.fire(new is.Js(s.status)),[2]):(new ne(this.adapterOption.notificationCenter).showTips(W.OFFLINE_EDIT_CODE.RESUBMIT_FAIL),[2])):(c=new CustomEvent(xi.R0,{detail:{version:s.baseVersion}}),document.dispatchEvent(c),V.zzsReport(Na.COMMIT_CHANGES_CONTAIN_REVERT_CGI),[2])}}))}))},e.prototype.setOfflineEditWritable=function(e){p.Logger.info(this.tag,"set offlineEditWritable :".concat(e)),this.offlineEditWritable=e},e.prototype.enterOnline=function(e){_s.cm?p.Logger.info(this.tag,"local edit mode, enterOnline, hasChanges: ".concat(e)):(p.Logger.info(this.tag,"enterOnline, hasChanges: ".concat(e)),this.isEnterOffline=!1,this.offlineEdit.enterOnline(e))},e.prototype.enterOffline=function(e,t){_s.cm?p.Logger.info(this.tag,"local edit mode, enterOffline, hasChanges: ".concat(e)):(p.Logger.info(this.tag,"enterOffline, hasChanges: ".concat(e)),this.isEnterOffline=!0,this.offlineEdit.enterOffline(e,t))},e.prototype.canRead=function(){return this.offlineEdit.canRead()},e.prototype.canWrite=function(){return(0,r.__awaiter)(this,void 0,Promise,(function(){var e;return(0,r.__generator)(this,(function(t){switch(t.label){case 0:return(e=this.offlineEditWritable)?[4,this.offlineEdit.canWrite()]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return[2,e]}}))}))},e.prototype.isLocked=function(){var e,t;return!0===(null===(t=null===(e=this.offlineEdit.mutexLockHelper)||void 0===e?void 0:e.isLocked)||void 0===t?void 0:t.call(e))},e.prototype.isLockedByOtherDocPage=function(){var e,t,n;return!this.isLocked()&&"edit"===(null===(n=null===(t=null===(e=this.offlineEdit.mutexLockHelper)||void 0===e?void 0:e.lastLockItem)||void 0===t?void 0:t.optional)||void 0===n?void 0:n.source)},e.prototype.isLockedByDataSyncPage=function(){var e,t,n;return"list"===(null===(n=null===(t=null===(e=this.offlineEdit.mutexLockHelper)||void 0===e?void 0:e.lastLockItem)||void 0===t?void 0:t.optional)||void 0===n?void 0:n.source)},e.prototype.release=function(){return(0,r.__awaiter)(this,void 0,Promise,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.offlineEdit.release()];case 1:return e.sent(),[2]}}))}))},e.prototype.destroy=function(){this.destroyEvent()},e.prototype.getChanges=function(){var e,t,n;return(0,r.__awaiter)(this,void 0,Promise,(function(){var o;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.offlineEdit.getChanges({types:Ni})];case 1:return(o=r.sent()).error?(p.Logger.warn(this.tag,"getChanges error:".concat(null===(e=o.error)||void 0===e?void 0:e.message," stack:").concat(null===(t=o.error)||void 0===t?void 0:t.stack)),[2,[]]):[2,null!==(n=o.data)&&void 0!==n?n:[]]}}))}))},e.prototype.deleteAndUpsertChanges=function(e){return(0,r.__awaiter)(this,void 0,Promise,(function(){return(0,r.__generator)(this,(function(t){switch(t.label){case 0:return this.offlineEditWritable?(this.checkCommit(e),[4,this.offlineEdit.deleteAndUpsertChanges({types:Ni},e)]):(p.Logger.info(this.tag,"deleteAndUpsertChanges offlineEditWritable:".concat(this.offlineEditWritable)),[2,{data:!1}]);case 1:return[2,t.sent()]}}))}))},e.prototype.checkCommit=function(e){var t,n,o,i;return(0,r.__awaiter)(this,void 0,void 0,(function(){var a,s,c,l;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return e.length>=5&&!this.isEnterOffline?(a=null===(t=e[0])||void 0===t?void 0:t.createTimestamp,s=null===(n=e[e.length-1])||void 0===n?void 0:n.createTimestamp,(null===(i=null===(o=e[e.length-1])||void 0===o?void 0:o.offlineMsg)||void 0===i||!i)&&a&&s&&Math.abs(a-s)>=6e4?(p.Logger.info(this.tag,"checkCommit timeout, changes.length: ".concat(e.length)),c=window.App.changesetManager.hasUncommittedChanges(),this.enterOffline(c),[4,this.canWrite()]):[3,2]):[3,2];case 1:l=r.sent(),d.ReportHelper.weiMonitorCube({module:d.ICubeModule.Feature,name:"CollabCenter",action:"sendUserChangeTimeout",ver1:"".concat(JSON.stringify({canWrite:l,isEnterOffline:!1}))}),r.label=2;case 2:return[2]}}))}))},e.prototype.clearOfflineData=function(e,t){var n,o;return(0,r.__awaiter)(this,void 0,Promise,(function(){var i;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return p.Logger.info(this.tag,"clearOfflineData reason: ".concat(e)),[4,this.offlineEdit.deleteChanges({types:Ni})];case 1:return(i=r.sent()).error&&p.Logger.error(this.tag,"clearOfflineData error:".concat(null===(n=i.error)||void 0===n?void 0:n.message," stack:").concat(null===(o=i.error)||void 0===o?void 0:o.stack)),null==t||t(),[2]}}))}))},e.prototype.initEvent=function(){document.addEventListener("Melo_ClearOfflineData",this.handleClearOfflineData)},e.prototype.destroyEvent=function(){document.removeEventListener("Melo_ClearOfflineData",this.handleClearOfflineData),ms.network.remove(this.handleNetWorkChangeCallback.bind(this))},e.prototype.backupChanges=function(){return(0,r.__awaiter)(this,void 0,Promise,(function(){var e,t,n=this;return(0,r.__generator)(this,(function(r){return e=new Promise((function(e){try{n.getChanges().then((function(t){(null==t?void 0:t.length)?n.getOfflineEditBackupAdapter().init().then((function(){n.getOfflineEditBackupAdapter().offlineEditBackUp.deleteAndUpsertChanges({types:Ni},t).then((function(t){t||p.Logger.warn(n.tag,"getOfflineEditBackupAdapter deleteAndUpsertChanges fail."),e()})).catch((function(){e()}))})):e()}))}catch(t){p.Logger.warn(n.tag,"handleClearOfflineData error:".concat(null==t?void 0:t.message," stack:").concat(null==t?void 0:t.stack)),e()}})),t=new Promise((function(e){return setTimeout((function(){e()}),2e4)})),[2,Promise.race([t,e])]}))}))},e.prototype.detectLock=function(){var e=this;this.offlineEdit.mutexLockHelper.detect((function(){var t,n;p.Logger.info(e.tag,"detectLock reload"),null===(n=null===(t=window.multiAccountUtil)||void 0===t?void 0:t.reload)||void 0===n||n.call(t)}),500)},e.prototype.applyLocalChanges=function(e){return(0,r.__awaiter)(this,void 0,Promise,(function(){return(0,r.__generator)(this,(function(t){switch(t.label){case 0:return e.length?[4,this.shouldApplyContinue()]:[2];case 1:return t.sent(),e.forEach((function(e){(0,vs.U)(e.dver)||(e.changeset=K._.getMutationCommands(e.changesetString))})),window.App.changesetManager.applyLocalChangesToBase(e),[2]}}))}))},e.prototype.getNewChanges=function(e,t){var n;return(0,r.__awaiter)(this,void 0,Promise,(function(){var o,i,a;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,window.App.collabCenterAdapter.getMissChanges(e,t)];case 1:return o=r.sent(),i=[],o.forEach((function(e){e.data&&i.push(e.data)})),[2,i];case 2:throw a=r.sent(),p.Logger.warn("getNewChanges error"),null!==(n=null==a?void 0:a.error)&&void 0!==n?n:new Error("getNewChanges error");case 3:return[2]}}))}))},e.prototype.applyNewChanges=function(e){return(0,r.__awaiter)(this,void 0,Promise,(function(){var t,n=this;return(0,r.__generator)(this,(function(o){switch(o.label){case 0:return e.length?[4,this.shouldApplyContinue()]:[2];case 1:return o.sent(),t=[],e.forEach((function(e){p.Logger.info(n.tag,"applyNewChanges: ".concat(e.newRev,", ").concat(e.commitId)),t.push(new H.ServerUserChange((0,r.__assign)((0,r.__assign)({},e),{changeset:e.changeset})))})),[4,window.App.collabCenterAdapter.handleServerUserChanges(t)];case 2:return o.sent(),[2]}}))}))},e.prototype.getOfflineEditBackupAdapter=function(){return this.offlineEditBackUpAdapter||(this.offlineEditBackUpAdapter=new bs((0,c.Yi)().collab_client_vars.rev,window.App.GlobalConfig.globalCodeVersion)),this.offlineEditBackUpAdapter},e.prototype.shouldApplyContinue=function(){return(0,r.__awaiter)(this,void 0,Promise,(function(){var e=this;return(0,r.__generator)(this,(function(t){return[2,new Promise((function(t){if(!(0,c.Yi)().collab_client_vars.isChunked||!e.adapterOption.editor.state.dataEngine.getIsChunkLoading())return t(!0);e.adapterOption.notificationCenter.on(Ui.J.CHUNK_CENTER_FINISH,(function(){p.Logger.info(e.tag,"shouldApplyContinue: true"),t(!0)}))}))]}))}))},e.prototype.handleNetWorkChangeCallback=function(e){var t=window.App.changesetManager.hasUncommittedChanges();"online"===e?window.App.offlineEditAdapter.enterOnline(t):window.App.offlineEditAdapter.enterOffline(t)},e}(),Cs=n(973843),ws=function(){function e(t){var n=this;this.context=t,this.handleCommitMissChangesContainRevert=function(){if(be.qO.getInstance().setPrivilege({isBlocked:!0}),new hs(n.context).handleRevert(),!window.App.GlobalConfig.IsSupportStore)return!1;new Cs.f((0,ei.pb)()).getClientVarsFromServer((0,ei.pb)()).then((function(e){var t;"doc"===e.padType&&!1===(null===(t=null==e?void 0:e.collab_client_vars)||void 0===t?void 0:t.isChunked)&&(0,Hi.G)(e)}))},this.handleApplyChangesetError=function(e){var t;p.Logger.warn("handleApplyChangesetError: ".concat(null==e?void 0:e.detail),null===(t=null==e?void 0:e.detail)||void 0===t?void 0:t.code),new ne(n.context.notificationCenter).showTips(Y.p.CollabRoomCHANGESETERRORAPPLYOFFLINE)},this.onBeforeUnload=function(){if(p.Logger.info(e.tag,"onBeforeUnload"),window.App.changesetManager.hasUncommittedChanges())return(0,j.$t)("文档存在未保存修改，如果关闭，修改将不会被保存。您是否确定关闭？")};var r=t.clientVars,o=new Es({canEdit:t.canEdit,eventEmitter:t.eventEmitter,editor:t.editor,notificationCenter:t.notificationCenter});window.App.offlineEditAdapter=o,o.init(),r.isPublish||this.init(),window.App.offline=this}return e.prototype.initEvent=function(){window.onbeforeunload=this.onBeforeUnload,document.addEventListener(xi.HJ,this.handleApplyChangesetError),document.addEventListener(xi.Ep,this.context.copyAllDataToMemory),document.addEventListener(xi.R0,this.handleCommitMissChangesContainRevert,{once:!0}),this.context.notificationCenter.on(Wa.DELETE_OFFLINE_DATA,(function(){window.App.offlineEditAdapter.clearOfflineData(Wa.DELETE_OFFLINE_DATA)}),this)},e.prototype.destroyEvent=function(){document.removeEventListener(xi.HJ,this.handleApplyChangesetError),document.removeEventListener(xi.Ep,this.context.copyAllDataToMemory),document.removeEventListener(xi.R0,this.handleCommitMissChangesContainRevert),this.context.notificationCenter.removeListener(Wa.DELETE_OFFLINE_DATA,this)},e.prototype.init=function(){this.initEvent()},e.prototype.destroy=function(){this.destroyEvent()},e.tag="Offline",e}(),Ts=n(890220),As=n(696644),Ss=n(228859),Is=n(6297),Rs="DocumentManager",Ms=function(){function e(){this.isContainerReady=!1}return e.getInstance=function(){return this.instance||(this.instance=new e,window.documentManager=this.instance),this.instance},e.prototype.onReady=function(e){p.Logger.info(Rs,"onReady dver:".concat(e)),this.isContainerReady=!0,d.GlobalContext.fire(new $r.Gr)},e.prototype.showhideEditorMask=function(e){p.Logger.info(Rs,"showhideEditorMask: ".concat(window.location.href!==e),(new Date).toString()),(window.requestAnimationFrame||window.webkitRequestAnimationFrame)((function(){var e,t;null===(t=null===(e=window.tdocs)||void 0===e?void 0:e.firstLoadFinished)||void 0===t||t.call(e)}))},e.prototype.onPrerenderFinish=function(e,t){p.Logger.info(Rs,"onPrerenderFinish return",e,t),window.mqq&&window.mqq.invoke("docx","sendToParent",{func:"window&&window.preloadManager&&window.preloadManager.onPrerenderFinish",args:[e,"0.0.0",t]})},e.prototype.reportOpenSameUrl=function(e,t,n){n&&window.mqq&&window.mqq.invoke("docx","getMetric",{csid:n},(function(o){if(o&&o.data){var i=o.data,a=i.doc_item_click_timestamp,s=i.doc_loadurl_timestamp,c=(0,r.__rest)(i,["doc_item_click_timestamp","doc_loadurl_timestamp"]),l=Math.round(s-a),u=Math.round(e-s),f=Math.round(t-a),h=f,m=JSON.stringify({clickToEditCost:h,clickToShowCost:f,clickToLoadCost:l,loadToStartCost:u}),g=JSON.stringify(c);p.Logger.debug("report container_open_same_doc"),d.ReportHelper.tdwReport({opername:"doc_core",module:"open",action:"container_open_same_doc",file_type:"1",obj3:m,ver9:g})}else p.Logger.error("getMetric for ".concat(n," failed ").concat(o))}))},e}(),Os=function(){function e(e){this.editor=e}return e.prototype.insertParagraph=function(e){this.editor.service.getDocument().getRange(e,e,{fixRange:!1}).insertParagraph()},e.prototype.deleteTextFromGcp=function(e,t){var n=new d.GCPRange(e,t);this.editor.service.getSelection().deleteWithMultiRanges([n],{fixRange:!1})},e.prototype.insertTableStart=function(e){var t=this.editor.selection.gcpRange.clone();t.gcpBegin=e,t.len=1;var n=this.editor.state.delta();d.Commands.insertTableStart(e,n),this.editor.state.applyDelta(n)},e.prototype.transformHistoryToVersionFile=function(e){var t="";return t+="0, ".concat(e.initialAttributedText.text,"\n"),e.actionlist.forEach((function(e,n){t+="".concat(n+1,", ").concat(e.action,"\n")})),t},e}(),Ns=Os,ks=function(e){this.dirtyDataTools=new Ns(e)},Ls=ks;n(520273);var Ds=function(){function e(e){this._hideFirstScreen=!1,this.notificationTimes=0,this.secretId=e.secretId,this.container=e.container,this.contextService=e.contextService,this.eventEmitter=e.eventEmitter,this.init()}var t,o,i;return e.createInstance=function(t){return this.instance?this.instance.onReset(t):this.instance=new e(t),this.instance},e.getInstance=function(){return this.instance},e.prototype.handleEditorFirstRender=function(){var e,t;p.Logger.info("padeditor handleEditorFirstRender");var n=document.createEvent("CustomEvent");if(n.initCustomEvent("first_render_clearwhitescreen",!0,!0,{}),document.dispatchEvent(n),null===(e=window.App)||void 0===e||e.reportDrive(!0),(null===(t=window.editableWhenCreateState)||void 0===t?void 0:t.editableWhenCreate)&&ii.Q.instance.disabled||this.hideFirstScreen(),this.showNoSupportBrowserTips(),ai.t.isMiniProgram()){var r=document.getElementById("header");r instanceof HTMLElement&&(r.style.display="block")}Ms.getInstance().onReady(this.clientVars.collab_client_vars.dver),this.fpsMonitor.startInitMonitor()},e.prototype.reportPV=function(){var e,t;if(!(0,si.g6)()){if(!this.contextService.context.isPublish){d.ReportHelper.zzsStatus({attributeId:d.MonitorName.PV,status:d.Status007.SUCCESS,otherDimensions:["injectDomain: ".concat(null!==(e=n.g.injectDomain)&&void 0!==e&&e)]});var r=p.LocalStorageUtil.getItem("tdsourcetag");return d.ReportHelper.tdwReport({opername:"doc_core",module:"visit",action:"detail_page",source3:r||"",obj3:p.PlatformUtil.getBrowser(),ver5:1===this.clientVars.collab_client_vars.dirty?"limited":"normal",ver7:null===(t=this.clientVars.collab_client_vars.dver)||void 0===t?void 0:t.substr(0,3),ver10:this.permissionCtrl.isPreview?"qqpreview":""},{immediate:!0}),d.ReportHelper.tdwReport({opername:"doc_core",module:"abtest",action:"report"}),d.ReportHelper.oss({itemname:"wwdoc_view_doc"}),d.ReportHelper.idkeyReport(d.IdkeyName.PV),void d.ReportHelper.idkeyReport(d.IdkeyName.PV_PC)}d.ReportHelper.monitor(d.MonitorName.PV_PUBLISH),d.ReportHelper.tdwReport({opername:"doc_word_file",module:"to_web",action:"web_visit"})}},e.prototype.reportToB=function(){this.contextService.context.appid&&(d.ReportHelper.monitor(d.MonitorName.PV_TOB),d.ReportHelper.tdwReport({opername:"doc_core",module:"visit",action:"detail_page_tob",obj3:p.PlatformUtil.getBrowser(),ver5:1===this.clientVars.collab_client_vars.dirty?"limited":"normal",ver8:this.contextService.context.appid}),d.ReportHelper.tdwReport({opername:"doc_core",module:"abtest",action:"report"}))},e.prototype.startRAFMonitor=function(){if(p.Logger.info("padeditor startRAFMonitor"),1===this.notificationTimes){var e=pi.createRAFJank(this.editor);if(!e)return;e.startMonitor()}this.notificationTimes+=1},e.prototype.handleEditorRenderFinished=function(){var e,t,n=this.clientVars.collab_client_vars;p.Logger.info("padeditor render finish"),this.startRAFMonitor(),this.reportPV(),(null===(e=n.dver)||void 0===e?void 0:e.startsWith("3.0"))&&d.ReportHelper.monitor007Status(d.MonitorName.PV_3_0),this.reportToB(),(null===(t=window.editableWhenCreateState)||void 0===t?void 0:t.editableWhenCreate)||this.hideFirstScreen(),window.loadLazyScriptStartHandler&&window.loadLazyScriptStartHandler(),this.fpsMonitor.end(),this.fpsMonitor.startScrollMonitor()},e.prototype.init=function(){var e,t,n=this;null===(t=null===(e=window.log)||void 0===e?void 0:e.showConsole)||void 0===t||t.call(e),this.editor=new d.MeloEditor,this.eventEmitter.emit("$beforeMeloAttach",{editor:this.editor,element:this.container}),this.fpsMonitor=new yi(this.editor),this.layoutMonitor=new Ei(this.editor),this.layoutMonitor.monitorLayoutError(),p.Logger.info("padeditor init for first screen editor"),this.editor.once(d.RenderNotificationTypes.FIRST_RENDER,this.handleEditorFirstRender.bind(this)),this.editor.once(d.RenderNotificationTypes.RENDER_FINISH,this.handleEditorRenderFinished.bind(this)),this.editor.once(d.RenderNotificationTypes.HIDE_SNAPSHOT,this.hideFirstScreen.bind(this)),d.GlobalContext.once(d.FeatureNotificationType.FEATURE_LOADED,this.startRAFMonitor.bind(this)),this.editor.attachEditor(this.container),this.eventEmitter.listen("$editableChanged",(function(e){n.editor.setEditable(e)})),this.eventEmitter.listen("$copyableChanged",(function(e){n.editor.setCopyable(e)})),this.handleVisibilityChange(),this.devTools=new Ls(this.editor)},e.prototype.initClientData=function(){var e,t,n=this;return null===(t=null===(e=window.performance)||void 0===e?void 0:e.mark)||void 0===t||t.call(e,"MK_DATAINIT_START"),p.PerfUtil.mark("clientDataInitBegin"),window.ClientVarsPromise&&window.ClientVarsPromise.then((function(){return(0,r.__awaiter)(n,void 0,void 0,(function(){var e,t,n,o,i,a,s,l,u,f,h,m,g,v,_,y=this;return(0,r.__generator)(this,(function(b){switch(b.label){case 0:return p.PerfUtil.mark("clientDataPromiseResolved"),null===(h=null===(f=window.performance)||void 0===f?void 0:f.mark)||void 0===h||h.call(f,"MK_DATAINIT_RESOLVE"),this.needWaitVipInfo?(this.initOwnerVipStatus(),[4,Ci.f.initAccountApplication()]):[3,2];case 1:return b.sent(),[3,3];case 2:Ci.f.initAccountApplication(),b.label=3;case 3:return this.loginService.init(),[4,Mi.init()];case 4:return b.sent(),this.clientVars=li.u.getInstance(this.secretId).getClientVars(),this.handleReport(this.clientVars),e=p.PerfUtil.now(),t=this.clientVars.collab_client_vars,o=void 0,this.collab=new B.Xm(this.editor,t.ignoreLineRev),i=new Bi(this.collab),this.collab.setChangesetManager(i),p.PerfUtil.mark("dataParseBegin"),this.isChunkDataEnabled()?[4,(o=new Gi({editor:this.editor,clientVars:t,csManager:i})).loadDocumentData()]:[3,6];case 5:return n=b.sent(),[3,7];case 6:n=null!==(m=window.dataInput)&&void 0!==m?m:K._.createDataInput(t),b.label=7;case 7:return p.PerfUtil.mark("dataParseEnd"),d.ReportHelper.monitor007Status(d.MonitorName.IS_CHUNK_RATE,t.isChunked?d.Status007.SUCCESS:d.Status007.FAIL),window.dataInput=void 0,this.permissionCtrl=be.qO.createInstance(this.clientVars),this.permissionCtrl.notifyUpdateTitleBarUI(),!this.contextService.context.permission&&this.contextService.inject("permission",this.permissionCtrl),this.updateDocInitTitle(),a=function(e,t){var n=(0,c.Yi)();return{layoutType:(0,Vi.D)(t),renderType:d.RenderType.Canvas,editable:e.isEditable,copyable:e.isCopyable,uniqueId:n.globalPadId}}(this.permissionCtrl,n),p.Logger.info("RenderType",a.renderType),this.editor.updateDocEnv(a),this.store.register("baseZoomLevel",1),this.store.update("zoomLevel",1),this.editor.zoom=1,this.collab.applyInitialData(n),window.__editor=this.editor,s=p.PerfUtil.now()-e,p.Logger.info("perf|initialDataTotalTime=".concat(s,"ms")),this.eventEmitter.emit("$modelInited",this.editor),(0,zi.t)().init({secretId:(0,ei.pb)(),editor:this.editor}),l=function(){return y.permissionCtrl.canEdit},u={notificationCenter:this.editor,changesetManager:i,clientVars:this.clientVars,canEdit:l,editor:this.editor,eventEmitter:this.eventEmitter},this.controllerCenter=new ta(u),this.controllerCenter.run(),this.collabCenterAdapter=new cs(u),this.contextService.inject("collabCenterAdapter",this.collabCenterAdapter),t.isChunked&&o&&(this.collabCenterAdapter.pause(H.PauseOrResumeType.ALL),o.setFinishCb(this.collabCenterAdapter)),this.offline=new ws((0,r.__assign)((0,r.__assign)({},u),{copyAllDataToMemory:function(){p.Logger.warn("copyAllDataToMemory."),y.editor.service.getSelection().wholeStory(),y.editor.clipboardManager.copy()},clearUndoRedoStack:function(){y.editor.run("clearUndoRedoStack")}})),i.addMergedBaseDocChanges(),new B.Ce((function(){return y.clientVars.collab_client_vars.dirty})).registerPlugin(d.GlobalContext),null===(g=this.initDataCallback)||void 0===g||g.call(this),null===(_=null===(v=window.performance)||void 0===v?void 0:v.mark)||void 0===_||_.call(v,"MK_DATAINIT_END"),p.PerfUtil.mark("clientDataInitEnd"),[2]}}))}))}))},e.prototype.onReset=function(e){return this.secretId=e.secretId,this.container=e.container,this.contextService=e.contextService,this.eventEmitter=e.eventEmitter,this._hideFirstScreen=!1,this.notificationTimes=0,this.fpsMonitor.reset(),this.init(),!0},e.prototype.load=function(){this.contextService.inject("permission",this.permissionCtrl),this.contextService.inject("collabCenterAdapter",this.collabCenterAdapter)},e.prototype.showNoSupportBrowserTips=function(){(p.PlatformUtil.isIE11()||p.PlatformUtil.isChrome()&&p.PlatformUtil.getChromeVersion()<53)&&Wi.default.show({message:No.ZP.t("为了有更好的体验，推荐使用最新版Chrome浏览器。"),duration:5e3,autoClose:!0})},Object.defineProperty(e.prototype,"needWaitVipInfo",{get:function(){return this.supportVip&&!0},enumerable:!1,configurable:!0}),e.prototype.initOwnerVipStatus=function(){var e;return(0,r.__awaiter)(this,void 0,Promise,(function(){var t,n,o,i,a,s;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:t=null===(e=window.clientVars)||void 0===e?void 0:e.globalPadId,n="300000000$",o=t,"string"==typeof t&&t.startsWith(n)&&(o=t.substring(10)),i={file_id:o},r.label=1;case 1:return r.trys.push([1,4,,5]),[4,fetch("/api/personalize/owner/viplevel",{method:"POST",body:JSON.stringify(i),headers:{"Content-Type":"application/json"}})];case 2:return[4,r.sent().json()];case 3:return 0===(a=r.sent()).retcode&&(window.clientVars.ownerVipInfo={vip_level:a.result.vip_level}),[3,5];case 4:return s=r.sent(),p.Logger.error(s),[3,5];case 5:return[2]}}))}))},e.prototype.hideFirstScreen=function(){var e;li.u.getInstance(this.secretId).docRendered=!0,this._hideFirstScreen||(this._hideFirstScreen=!0,Ts.K.hideFirsScreenLoading(),p.Logger.info("PadEditor","hideFirstScreen"),p.PerfUtil.mark("hideFirstScreen"),As.L.getInstance().hide(),(e=document.createEvent("CustomEvent")).initCustomEvent("first_render_hided_quick_look",!0,!0,{}),document.dispatchEvent(e))},Object.defineProperty(e.prototype,"meloEditor",{get:function(){return this.editor},enumerable:!1,configurable:!0}),e.prototype.handleReport=function(e){var t;"2.1.0"===(null===(t=null==e?void 0:e.collab_client_vars)||void 0===t?void 0:t.dver)&&d.ReportHelper.monitor(d.MonitorName.OPENDOC30_WITH_21DATA)},e.prototype.updateDocInitTitle=function(){var e;Ss.q.getInstance().updateDocInitTitle(),(null===(e=this.contextService.context.permission)||void 0===e?void 0:e.canEditTitle)&&this.store.update("canEditTitle",!0)},e.prototype.isChunkDataEnabled=function(){return this.clientVars.sourceOfClientVars!==c.dw.FROM_LOCAL&&this.clientVars.collab_client_vars.isChunked},e.prototype.handleVisibilityChange=function(){},(0,r.__decorate)([(0,S.tB)(),(0,r.__metadata)("design:type","function"==typeof(t=void 0!==Is.r&&Is.r)?t:Object)],e.prototype,"loginService",void 0),(0,r.__decorate)([(0,S.tB)(),(0,r.__metadata)("design:type","function"==typeof(o=void 0!==He.O&&He.O)?o:Object)],e.prototype,"store",void 0),(0,r.__decorate)([(0,S.tB)(),(0,r.__metadata)("design:type","function"==typeof(i=void 0!==ni.r&&ni.r)?i:Object)],e.prototype,"zoomMeloService",void 0),(0,r.__decorate)([(0,X.D)("feature.vip",!0),(0,r.__metadata)("design:type",Boolean)],e.prototype,"supportVip",void 0),e}(),Ps=n(293325),xs=n(951778),Fs=function(){function e(e){this.platform=e}return e.loadMeloExt=function(e){xs.A8.load(e)},e.prototype.loadLifecycleFeature=function(e){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t=this;return(0,r.__generator)(this,(function(n){return[2,new Promise((function(n){Ps.iz.loadLifecycleFeature(e,t.platform,n)}))]}))}))},e.prototype.mountLifecycleFeature=function(e){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){switch(t.label){case 0:return[4,Ps.iz.mountLifecycleFeature(e)];case 1:return t.sent(),[2]}}))}))},e}(),Bs=n(12127),Us=n(134850),Hs=function(){function e(e,t,n){this.contextService=e,this.featureService=t,this.eventEmitter=n,this.isMeloExtLoaded=!1,this.isPublishLoaded=!1,this.isLevel1Loaded=!1,this.isLevel2Loaded=!1,this.isLevel3Loaded=!1,this.isLevel4Loaded=!1,this.isAllLoaded=!1,this.platform=Ps.Ev.Pc}var t,n,o;return e.prototype.$onReset=function(){},e.prototype.loadService=function(e){e&&!(0,we.B)(e)&&(Fs.loadMeloExt(e),this.isMeloExtLoaded=!0)},e.prototype.init=function(e,t,n){var o;return(0,r.__awaiter)(this,void 0,void 0,(function(){var i,a=this;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return i=new Fs(e),this.platform=e,null===(o=n.beforeInit)||void 0===o||o.call(n),[4,this.initFirstScreen(i,t,n)];case 1:return r.sent(),[4,(0,d.createIdleAsyncTask)((function(){return a.initAfterFirstScreen(i,t,n)}),{priority:Us.Priority.hight})];case 2:return r.sent(),[2]}}))}))},e.prototype.initFirstScreen=function(e,t,n){var o;return(0,r.__awaiter)(this,void 0,void 0,(function(){var i=this;return(0,r.__generator)(this,(function(a){switch(a.label){case 0:return p.Logger.info("初始化clientVars数据：".concat(d.PerfUtilLogger.now()-this.startTime)),[4,Ds.getInstance().initClientData()];case 1:return a.sent(),null===(o=n.initClientDataCallback)||void 0===o||o.call(n),p.Logger.info("初始化clientVars数据完成：".concat(d.PerfUtilLogger.now()-performance.timing.navigationStart)),this.loadService(t),p.Logger.info("melo-ext加载完成：".concat(d.PerfUtilLogger.now()-performance.timing.navigationStart)),d.PerfUtilLogger.mark("featuresInitBegin"),p.Logger.info("level1加载开始：".concat(d.PerfUtilLogger.now()-performance.timing.navigationStart)),d.PerfUtilLogger.mark("featuresLevel1InitBegin"),e.loadLifecycleFeature(Ps.YV.Level1).then((function(){return(0,r.__awaiter)(i,void 0,void 0,(function(){var t;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return[4,e.mountLifecycleFeature(Ps.YV.Level1)];case 1:return r.sent(),null===(t=n.level1LoadedCallback)||void 0===t||t.call(n),d.PerfUtilLogger.mark("featuresLevel1InitEnd"),p.Logger.info("level1加载完成：".concat(d.PerfUtilLogger.now()-performance.timing.navigationStart)),[2]}}))}))})),[2]}}))}))},e.prototype.initAfterFirstScreen=function(e,t,n){var o,i;return(0,r.__awaiter)(this,void 0,void 0,(function(){var a,s,l,u=this;return(0,r.__generator)(this,(function(f){switch(f.label){case 0:return a=(0,c.Yi)(),s=null===(o=a.privilegeAttribute)||void 0===o?void 0:o.can_edit,l=this.contextService.context.isPublish,p.Logger.info("level2加载开始：".concat(d.PerfUtilLogger.now()-this.startTime)),l?(d.PerfUtilLogger.mark("featuresPublishInitBegin"),[4,e.loadLifecycleFeature(Ps.YV.Publish)]):[3,2];case 1:return f.sent(),[3,4];case 2:return d.PerfUtilLogger.mark("featuresReadonlyInitBegin"),[4,e.loadLifecycleFeature(Ps.YV.Level2)];case 3:f.sent(),f.label=4;case 4:return[4,e.mountLifecycleFeature(l?Ps.YV.Publish:Ps.YV.Level2)];case 5:return f.sent(),l?(this.isPublishLoaded=!0,d.PerfUtilLogger.mark("featuresPublishInitEnd")):(this.isLevel2Loaded=!0,d.PerfUtilLogger.mark("featuresReadonlyInitEnd")),p.Logger.info("level2加载完成：".concat(d.PerfUtilLogger.now()-performance.timing.navigationStart)),null===(i=n.level2LoadedCallback)||void 0===i||i.call(n),s?(p.Logger.info("level3加载开始：".concat(d.PerfUtilLogger.now()-this.startTime)),d.PerfUtilLogger.mark("featuresEditInitBegin"),[4,e.loadLifecycleFeature(Ps.YV.Level3)]):[3,8];case 6:return f.sent(),[4,e.mountLifecycleFeature(Ps.YV.Level3)];case 7:return f.sent(),p.Logger.info("level3加载完成：".concat(d.PerfUtilLogger.now()-this.startTime)),this.isLevel3Loaded=!0,this.eventEmitter.emit("$featureEditLoaded"),d.PerfUtilLogger.mark("featuresEditInitEnd"),[3,9];case 8:d.GlobalContext.on(be.ap.ON_PERMISSION_CHANGE,(function(t){return(0,r.__awaiter)(u,void 0,void 0,(function(){return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return t.permissionCtrl.canEdit?(p.Logger.info("level3加载开始(权限变更)：".concat(d.PerfUtilLogger.now()-this.startTime)),[4,e.loadLifecycleFeature(Ps.YV.Level3)]):[3,3];case 1:return n.sent(),[4,e.mountLifecycleFeature(Ps.YV.Level3)];case 2:n.sent(),p.Logger.info("level3加载完成(权限变更)：".concat(d.PerfUtilLogger.now()-this.startTime)),this.isLevel3Loaded=!0,this.eventEmitter.emit("$featureEditLoaded"),n.label=3;case 3:return[2]}}))}))}),this),Promise.resolve(),f.label=9;case 9:return t.view.forceRerender(),t.isRenderLiteType()||d.TaskScheduler.getInstance().enableAggressiveMode(),d.GlobalContext.fire(new d.FeatureLoadFinishedNotification),this.contextService.inject("isFeatureLoaded",!0),this.eventEmitter.emit("$featureLoaded"),ii.Q.instance.onFeatureLoaded(),d.PerfUtilLogger.mark("featuresInitEnd"),Us.scheduler.scheduleTask((function(){p.Logger.info("level4加载开始：".concat(d.PerfUtilLogger.now()-u.startTime)),e.loadLifecycleFeature(Ps.YV.Level4).then((function(){return(0,r.__awaiter)(u,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){switch(t.label){case 0:return[4,e.mountLifecycleFeature(Ps.YV.Level4)];case 1:return t.sent(),p.Logger.info("level4加载完成：".concat(d.PerfUtilLogger.now()-this.startTime)),[2]}}))}))})),u.isLevel4Loaded=!0,u.isAllLoaded=!0})),[2]}}))}))},e.prototype.destory=function(){d.GlobalContext.removeListener(be.ap.ON_PERMISSION_CHANGE,this),this.isMeloExtLoaded=!1,this.isPublishLoaded=!1,this.isLevel1Loaded=!1,this.isLevel2Loaded=!1,this.isLevel3Loaded=!1,this.isLevel4Loaded=!1,this.isAllLoaded=!1},Object.defineProperty(e.prototype,"startTime",{get:function(){var e=Bs._.getInstance().clickStart;return e?Number(e):performance.timing.navigationStart},enumerable:!1,configurable:!0}),e=(0,r.__decorate)([(0,Ge.t)(),(0,r.__metadata)("design:paramtypes",["function"==typeof(t=void 0!==I.O&&I.O)?t:Object,"function"==typeof(n=void 0!==Fe.U&&Fe.U)?n:Object,"function"==typeof(o=void 0!==pt.v&&pt.v)?o:Object])],e)}(),Ws=function(){function e(){}return e.prototype.destroy=function(){var e,t,n,r,o;p.Logger.info("WordOnlineDocument","destroy document, time: ".concat((new Date).toString())),null===(e=window.__softKeyboardDisposeAllInstances)||void 0===e||e.call(window),null===(n=(t=window).onbeforeclosetab)||void 0===n||n.call(t),null===(o=null===(r=window.App.offlineEditAdapter)||void 0===r?void 0:r.release)||void 0===o||o.call(r),document.dispatchEvent(new CustomEvent("DestroyDocumentNotification"))},e}(),js=function(){var e=this;this.ssrFlowLayerWithDocument=function(){$.get(window.location.href,{},(function(t){e.generateSSRLayer(t,"ssr-layer-html")}),"html")},this.ssrFlowLayerWithDevServer=function(){var t=window.clientVars.collab_client_vars,n=t.initialAttributedText,r=t.apool,o={text:n.text,attribs:n.attribs},i={atext:JSON.stringify(o),apool:JSON.stringify(r)};$.post("http://127.0.0.1:8090/doc-ssr/generate",i,(function(t){e.generateSSRLayer(t,"ssr-layer-dev")}))},this.generateSSRLayer=function(t,n){void 0===n&&(n="ssr-layer");var r=e.createSSRLayer(n);document.body.appendChild(r);var o=r.contentWindow;e.renderSSRLayerWithString(o,t),e.executeSSRInlineJS(o,t)},this.createSSRLayer=function(e){var t=document.getElementById(e);return t&&t.remove(),(t=document.createElement("iframe")).setAttribute("id","ssr-layer"),t.setAttribute("style",""),Object.assign(t.style,{position:"absolute",zIndex:"99999",opacity:"0.7",top:"0px",left:"0px",border:"none",width:"100%",height:"100%"}),t},this.renderSSRLayerWithString=function(e,t){e.document.body.parentElement.innerHTML=t},this.executeSSRInlineJS=function(e,t){var n="/*dev-server-start*/",r=t.indexOf(n)+20,o=t.indexOf("/*dev-server-end*/");o>-1&&e.eval(t.slice(r,o))},window.ssrUtils={ssrFlowLayerWithDevServer:this.ssrFlowLayerWithDevServer,ssrFlowLayerWithDocument:this.ssrFlowLayerWithDocument}},Gs=function(){function e(e,t,n){this.contextService=e,this.eventEmitter=t,this.layoutExtensionService=n}var t,n,o,i,a;return e.prototype.attachEditor=function(e,t){return(0,r.__awaiter)(this,void 0,void 0,(function(){var n;return(0,r.__generator)(this,(function(r){return n=Ds.createInstance({secretId:(0,ei.pb)(),container:e,contextService:this.contextService,eventEmitter:this.eventEmitter}),this.startupService.isMeloExtLoaded&&Fs.loadMeloExt(n.editor),n.editor.modelWrapperMgr.add(d.LayoutInputNodeType.Section,(0,ti.G)(n.editor)),n.editor.on(d.RenderNotificationTypes.SELECTION_END,(function(){return t.onSelectionChange()}),this),n.editor.on(d.StateNotification.CusorPropChange,t.onDataChange,this),n.editor.on(d.FocusBlurNotificationType.ON_FOCUS,t.onFocus,this),n.editor.on(d.FocusBlurNotificationType.ON_BLUR,t.onBlur,this),window.pad=n,window.onlineDocument=new Ws,new js,this.layoutExtensionService.applyExtension(n.editor),[2,n.editor]}))}))},e.prototype.requestBlur=function(e){e.fire(new d.FocusBlurNotification(d.FocusBlurNotificationType.ON_BLUR)),e.fire(new d.FocusBlurNotification(d.FocusBlurNotificationType.ON_REQUEST_BLUR))},e.prototype.requestFocus=function(e){e.fire(new d.FocusBlurNotification(d.FocusBlurNotificationType.ON_FOCUS)),e.fire(new d.FocusBlurNotification(d.FocusBlurNotificationType.ON_REQUEST_FOCUS))},e.prototype.setValue=function(){},e.prototype.isCaret=function(e){return e.isCaret()},e.prototype.destroy=function(e){e.detach()},(0,r.__decorate)([(0,S.tB)(),(0,r.__metadata)("design:type","function"==typeof(i=void 0!==Hs&&Hs)?i:Object)],e.prototype,"startupService",void 0),(0,r.__decorate)([(0,S.tB)(),(0,r.__metadata)("design:type","function"==typeof(a=void 0!==ni.r&&ni.r)?a:Object)],e.prototype,"zoomMeloService",void 0),e=(0,r.__decorate)([(0,ri.L)("melo"),(0,r.__metadata)("design:paramtypes",["function"==typeof(t=void 0!==I.O&&I.O)?t:Object,"function"==typeof(n=void 0!==pt.v&&pt.v)?n:Object,"function"==typeof(o=void 0!==oi.Q&&oi.Q)?o:Object])],e)}(),Vs=n(522142),zs=n(364157),Qs=function(e){return function(t,n){var r=t.clone();return function(t){return 0===e.getRangeFromIndex(t.getBPFirstIndex(),t.getBPLastIndex()).begin()}(n)&&(r.spacing.after=r.spacing.after+(0,p.pxToTwips)(zs.ds+zs.rY)),{data:r}}},Ys=(function(){function e(){}e.prototype.$onEditorOpen=function(e){e.modelWrapperMgr.add(d.LayoutInputNodeType.Paragraph,(function(e,t){var n,r=e.clone();if(e instanceof d.ListInfo&&e.isTask){var o=t.parent,i=(0,p.pxToTwips)(135);if(o instanceof d.SectionNode){var a=null===(n=o.getProperty())||void 0===n?void 0:n.pgMar.right;i="number"==typeof a?a:i}var s=(0,p.pxToTwips)(135)-i;r.ind.right=r.ind.right+s}return{data:r}})),Ii.W.isApiDoc&&e.modelWrapperMgr.add(d.LayoutInputNodeType.Paragraph,Qs(e))},e=(0,r.__decorate)([(0,Vs.L)({name:ko.C.ListQwxtodoRender,adapters:["melo"]})],e)}(),n(278062)),Zs=n(34715),Ks=n(339106),Js=n(252783),qs=n(967844),Xs=n(187846),$s=n(320023),ec=Ye().lazy((function(){return n.e(5807).then(n.bind(n,175807)).then((function(e){return{default:e.RenderAddonLink}}))})),tc=Ye().lazy((function(){return n.e(5807).then(n.bind(n,175807)).then((function(e){return{default:e.RenderAddonLinkCard}}))})),nc=(0,$s.Z)(ec),rc=((0,$s.Z)(tc),n(276106)),oc=Ye().lazy((function(){return n.e(5305).then(n.bind(n,375305)).then((function(e){return{default:e.RenderDocLinkCard}}))})),ic=(0,$s.Z)(oc),ac=Ye().lazy((function(){return n.e(9517).then(n.bind(n,889517)).then((function(e){return{default:e.RenderDocLinkPlaceholder}}))})),sc=(0,$s.Z)(ac),cc=Ye().lazy((function(){return n.e(3595).then(n.bind(n,263595)).then((function(e){return{default:e.RenderDocLinkProgress}}))})),lc=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),t.prototype.render=function(){return Ye().createElement(Ye().Suspense,{fallback:null},Ye().createElement(cc,(0,r.__assign)({},this.props)))},t}(Ye().Component),uc=Ye().lazy((function(){return n.e(5494).then(n.bind(n,585494)).then((function(e){return{default:e.RenderLinkCard}}))})),dc=(0,$s.Z)(uc),pc=Ye().lazy((function(){return n.e(5380).then(n.bind(n,815380)).then((function(e){return{default:e.RenderNormalLink}}))})),fc=(0,$s.Z)(pc),hc=n(181355),mc=n(740587),gc=n(68883),vc=n(513516),_c=function(e){return function(e){var t,n=e.fieldResultProp.clone();switch(null===(t=e.fieldCode.switches)||void 0===t?void 0:t[d.FieldCommonSwitchesName.displayLayoutType]){case d.FieldDisplayLayoutTypeChar.Card:return{};case d.FieldDisplayLayoutTypeChar.Inline:var r=(0,p.pxToTwips)(vc.ox+vc.uO),o=(0,p.pxToTwips)(vc.ox+vc.uO)+((null==n?void 0:n.renderFontSize)||0)*vc.Di;return n.setDefault(n.tKeys.w),{metric:{padding:{before:0,start:o,after:0,end:r}},fieldResultProp:n};default:return{fieldResultProp:n}}}},yc=n(76989),bc=n(801134),Ec=n.n(bc),Cc=n(84475),wc=n(129602),Tc={"link-inline":"link-inline--VZc3T",linkInline:"link-inline--VZc3T","link-inline-active":"link-inline-active--8EmC6",linkInlineActive:"link-inline-active--8EmC6","doc-link-card-wrapper":"doc-link-card-wrapper--DDTuc",docLinkCardWrapper:"doc-link-card-wrapper--DDTuc","link-inline-none":"link-inline-none--MIyfc",linkInlineNone:"link-inline-none--MIyfc","link-inline-lite":"link-inline-lite--YVdIu",linkInlineLite:"link-inline-lite--YVdIu","link-inline-canvas":"link-inline-canvas--PE64Y",linkInlineCanvas:"link-inline-canvas--PE64Y","text-wrapper":"text-wrapper--+sm8p",textWrapper:"text-wrapper--+sm8p","link-icon-wrapper":"link-icon-wrapper--6CVi-",linkIconWrapper:"link-icon-wrapper--6CVi-","link-button-wrapper":"link-button-wrapper--Fc60A",linkButtonWrapper:"link-button-wrapper--Fc60A","link-card-wrapper":"link-card-wrapper--xK1lB",linkCardWrapper:"link-card-wrapper--xK1lB","link-card-wrapper-mobile":"link-card-wrapper-mobile--7WJan",linkCardWrapperMobile:"link-card-wrapper-mobile--7WJan","link-card-link-wrapper":"link-card-link-wrapper--wBBxL",linkCardLinkWrapper:"link-card-link-wrapper--wBBxL","link-card-link-wrapper-desc":"link-card-link-wrapper-desc--xTpBo",linkCardLinkWrapperDesc:"link-card-link-wrapper-desc--xTpBo",left:"left--1uXHn",placeholder:"placeholder--NN6LQ",center:"center--GdYoF",title:"title--khJt-",desc:"desc--k2vMg",url:"url--WEZSP",right:"right---Qzh9",action:"action--lPeoK","link-card-overbtn":"link-card-overbtn--y0JSk",linkCardOverbtn:"link-card-overbtn--y0JSk","link-card-wedoc-wrapper":"link-card-wedoc-wrapper--RF3XB",linkCardWedocWrapper:"link-card-wedoc-wrapper--RF3XB","link-card-wedoc-wrapper-preview":"link-card-wedoc-wrapper-preview--HTbcu",linkCardWedocWrapperPreview:"link-card-wedoc-wrapper-preview--HTbcu","link-card-wedoc-wrapper-mobile":"link-card-wedoc-wrapper-mobile--TJxuV",linkCardWedocWrapperMobile:"link-card-wedoc-wrapper-mobile--TJxuV","melo-wedrive-file-card-wedoc-wrapper-preview":"melo-wedrive-file-card-wedoc-wrapper-preview--LVVWK",meloWedriveFileCardWedocWrapperPreview:"melo-wedrive-file-card-wedoc-wrapper-preview--LVVWK",success:"success--OU-CP",loading:"loading--u0Daj",error:"error--NKvGJ",deleted:"deleted--ObLpY",auth:"auth--gjkEi",icon:"icon--jPQH3","preview-text":"preview-text--vcQH5",previewText:"preview-text--vcQH5","inner-wrapper":"inner-wrapper--7AkrG",innerWrapper:"inner-wrapper--7AkrG",text:"text--hOJCQ",actions:"actions--DL3C+"},Ac=n(883397),Sc=n(199253),Ic=n(88111),Rc=n(140663),Mc=n(23212),Oc=n(224370),Nc=n(704918),kc=n(384819),Lc=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),Object.defineProperty(t.prototype,"subtype",{get:function(){return this.props.fieldInfo.fieldCode.switches[d.FieldCommonSwitchesName.subtype]},enumerable:!1,configurable:!0}),t.prototype.fontSizePx=function(e){var t,n,r;return(0,d.isLeafContainer)(e)||(0,d.isContainerBoxLite)(e)?0:(0,d.isFieldBox)(e)?(0,p.twipsToPx)((null===(t=e.content)||void 0===t?void 0:t.textStyle.renderFontSize)||0):(0,p.twipsToPx)((null===(r=null===(n=e.content)||void 0===n?void 0:n.property)||void 0===r?void 0:r.renderFontSize)||0)},Object.defineProperty(t.prototype,"defaultIcon",{get:function(){return function(e){var t,n=e.fieldCode.switches,o=n[qs.h_.fileFavicon];if(o)return o;var i=(0,yc.lm)(e);if(!Object.prototype.hasOwnProperty.call(hc.x7,i))return Ac.Z;if(i===Js.Au.DRIVE){var a={doc:function(){return Rc.Z},xlsx:function(){return Mc.Z},txt:function(){return Sc.Z},ppt:function(){return Ic.Z}},s=(null===(t=e.fieldResult)||void 0===t?void 0:t.result)||n[qs.h_.fileName];if(!s)return Ac.Z;var c,l=s.split("."),u=l[l.length-1];return u?(Object.entries(hc.Fs).forEach((function(e){var t=(0,r.__read)(e,2),n=t[0];-1!==t[1].indexOf(u)&&(c=n)})),c&&Object.prototype.hasOwnProperty.call(a,c)?a[c]():Ac.Z):Ac.Z}return hc.x7[i]||Ac.Z}(this.props.fieldInfo)},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){this.updateAddonLinkIcon()},t.prototype.renderIcon=function(e,t){return""===e?Ye().createElement("img",{src:kc.Z}):"string"==typeof e?Ye().createElement("img",{src:e,style:t}):Ye().cloneElement(e,{style:t})},t.prototype.updateAddonLinkIcon=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,t,n,o,i,a;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:if(this.subtype!==Js.m7.AddonLink)return[2];Oc.DocAddonBridge.updateMetaInfo(function(){var e=(0,c.Yi)(),t=e.creatorId,n=e.userInfo,r=e.globalPadId,o=(null==n?void 0:n.tinyId)||(null==n?void 0:n.userId)||"";return{fileId:r,fileType:Oc.FileType.DOC,creatorId:t,uid:o}}()),e=this.props.fieldInfo.fieldCode.switches,r.label=1;case 1:return r.trys.push([1,3,,4]),t=e[Nc.fC.originUrl],n=e[Nc.fC.iframeId],[4,Oc.DocAddonBridge.getIconOfAddonLink(t,n)];case 2:return o=r.sent(),i=this.renderIcon(o,this.state.iconStyle),[2,this.setState({icon:i})];case 3:return a=r.sent(),p.Logger.error("[HYPERLINK ".concat(e[d.FieldCommonSwitchesName.displayLayoutType],"]获取icon失败：").concat(a)),[3,4];case 4:return[2]}}))}))},t}(Qe.PureComponent),Dc=function(e){function t(t){var n=e.call(this,t)||this,r=n.fontSizePx(t.layoutBox),o="".concat(r,"px"),i=r?{minWidth:o,maxWidth:o,width:o,height:o}:{};return n.state={icon:n.renderIcon(n.defaultIcon,i),iconStyle:i,disableBorder:!1},n}return(0,r.__extends)(t,e),t.prototype.renderLeftComponent=function(){return Ye().createElement("div",{className:"".concat(Tc.left)},this.state.icon)},t.prototype.renderCenterComponent=function(){var e,t=this.props.fieldInfo,n=(0,Xs.P5)(t.fieldCode),r=t.fieldCode.switches,o=(null===(e=t.fieldResult)||void 0===e?void 0:e.result)||r[qs.h_.fileName]||"";if(this.subtype===Js.m7.DocLink){var i=(0,yc.lm)(t),a=[Js.Au.WEDRIVE_IMAGE,Js.Au.WEDRIVE_VIDEO].includes(i),s=r[qs.h_.fileCreatorNick];return Ye().createElement("div",{className:Tc.center},Ye().createElement("span",{className:Tc.title},o),a&&Ye().createElement("span",{className:Tc.wedrive},"$",(0,j.$t)("来自微盘")),s&&Ye().createElement("span",{className:Tc.creator},"".concat(s," ").concat((0,j.$t)("创建"))))}var c=r[qs.h_.fileDesc];return Ye().createElement("div",{className:"".concat(Tc.center)},Ye().createElement("div",{className:"".concat(Tc.title)},(0,d.getPrintableText)(null!=o?o:n)),c&&Ye().createElement("div",{className:"".concat(Tc.desc)},c),Ye().createElement("div",{className:"".concat(Tc.url)},n))},t.prototype.renderRightComponent=function(){var e=this;if(this.subtype!==Js.m7.DocLink)return Ye().createElement(Ye().Fragment,null);var t=this.props.fieldInfo.fieldCode,n=t.name,o=t.switches[d.FieldCommonSwitchesName.subtype],i=S.Am.get(Ks.D),a=Ye().createElement(wc.u,{title:(0,j.$t)("doc-link:open-in-new-window"),placement:"top"},Ye().createElement("span",{style:{display:"flex"}},Ye().createElement(Cc.Z,null)));return Ye().createElement("div",{className:Tc.right},Ye().createElement("div",{className:Tc.action,onClick:function(t){var a,s;return t.stopPropagation(),t.preventDefault(),null===(s=(a=i.getFieldHookConfig(n,o)).onClick)||void 0===s?void 0:s.call(a,(0,r.__assign)((0,r.__assign)({},e.props),{event:t,customObject:{isForceOpen:!0}}))}},!this.props.editor.docEnv.isSSR&&a))},t.prototype.render=function(){var e,t=Ec()(((e={})["field-code-draggable"]=!0,e["".concat(Tc["link-card-wrapper"])]=!0,e["".concat(Tc["link-card-wrapper-mobile"])]=!1,e["".concat(Tc["link-card-link-wrapper"])]=!0,e["".concat(Tc["link-card-link-wrapper-desc"])]=!!this.props.fieldInfo.fieldCode.switches[qs.h_.fileDesc],e["".concat(Tc["link-card-link-wrapper-mobile"])]=!1,e)),n={borderColor:this.state.disableBorder?"transparent":void 0};return Ye().createElement("div",{className:t,style:n},this.renderLeftComponent(),this.renderCenterComponent(),this.renderRightComponent())},t}(Lc),Pc=n(577050),xc=function(e){function t(t){var n=e.call(this,t)||this;n.defaultStyle={padding:vc.uO,margin:vc.ox},n.respondEventTimer=null,n.docLinkRef=Ye().createRef(),n.onWheel=function(e){if(!(Math.abs(e.deltaY)>Math.abs(e.deltaX))||e.shiftKey){if(!n.respondEventTimer){if(n.docLinkRef.current){var t=(0,Pc.s)(n.docLinkRef.current,2);t&&(t.style.pointerEvents="none")}n.respondEventTimer=(0,p.debounce)((function(){if(n.docLinkRef.current){var e=(0,Pc.s)(n.docLinkRef.current,2);e&&(e.style.pointerEvents="all")}n.respondEventTimer=null}),300)}n.respondEventTimer()}};var r=n.fontSizePx(t.layoutBox),o="".concat(r,"px"),i=r?{minWidth:o,maxWidth:o,width:o,height:o}:{};return n.state={icon:n.renderIcon(n.defaultIcon,i),iconStyle:i},n}return(0,r.__extends)(t,e),Object.defineProperty(t.prototype,"edgeWidth",{get:function(){return this.defaultStyle.padding+this.defaultStyle.margin+this.fontSizePx(this.props.layoutBox)*vc.Di},enumerable:!1,configurable:!0}),t.prototype.getContainerStyleFromOtherRenderType=function(e){var t={};return e.renderType===d.RenderType.Canvas&&(0,d.isFieldBox)(this.props.layoutBox)?t=this.getCanvasStyle(this.props.layoutBox):e.renderType===d.RenderType.Lite&&(0,d.isFieldBoxLite)(this.props.layoutBox)&&(t=this.getLiteStyle(this.props.layoutBox)),t},t.prototype.getLiteStyle=function(e){var t,n=null===(t=e.content)||void 0===t?void 0:t.property;return n?(0,r.__assign)((0,r.__assign)({},{maxWidth:"100%"}),n?{color:n.color.val}:{}):{}},t.prototype.getCanvasStyle=function(e){return{maxWidth:(0,p.twipsToPx)(e.totalWidth)-this.defaultStyle.margin}},t.prototype.render=function(){var e,t=this.props,n=t.children,o=t.editor,i=t.overrideStyle,a=o.docEnv,s=this.defaultStyle,c=this.getContainerStyleFromOtherRenderType(a),l=Ec()(((e={})["field-code-draggable"]=!0,e["".concat(Tc["link-inline"])]=!0,e["".concat(Tc["link-inline-none"])]=!0,e["".concat(Tc["link-inline-lite"])]=a.renderType===d.RenderType.Lite,e["".concat(Tc["link-inline-canvas"])]=a.renderType===d.RenderType.Canvas,e)),u=this.defaultStyle.padding;return Ye().createElement("span",{className:l,style:(0,r.__assign)((0,r.__assign)((0,r.__assign)((0,r.__assign)({padding:"0px ".concat(s.padding,"px"),margin:"0px ".concat(s.margin,"px"),fontSize:"".concat(this.fontSizePx,"px")},c),{height:"100%"}),d.CssUtil.cssPropsToStyle(i)),{display:"flex",alignItems:"center"}),onWheel:this.onWheel,ref:this.docLinkRef},Ye().createElement("span",{className:"".concat(Tc["link-icon-wrapper"]),style:{left:u}},this.state.icon),Ye().createElement("span",{className:"".concat(Tc["text-wrapper"]),style:{paddingLeft:"".concat(this.edgeWidth-u,"px")}},n))},t}(Lc),Fc=function(){function e(){}return e.prototype.createAddonLinkComponent=function(e){var t=e.children,n=e.fieldInfo,o=(0,yc.w0)(n);if(!o)return null;var i=(0,r.__assign)((0,r.__assign)({},e),{iframeInfo:o});return o.mode===d.FieldDisplayLayoutTypeChar.Text?Ye().createElement(fc,(0,r.__assign)({subType:Js.m7.AddonLink},i),t):Ye().createElement(nc,(0,r.__assign)({},i),t)},e.prototype.createDocLinkComponent=function(e){var t,n=e.children,o=e.fieldInfo,i=(0,yc.sQ)(o);if(!i)return null;var a=(0,r.__assign)((0,r.__assign)({},e),{docLink:i});switch(i.fileType){case qs.m_.ProgressLoading:return Ye().createElement(lc,(0,r.__assign)({},a),n);case qs.m_.Placeholder:return Ye().createElement(sc,(0,r.__assign)({},a),n);default:return i.displayLayoutType===d.FieldDisplayLayoutTypeChar.Text?Ye().createElement(fc,(0,r.__assign)({subType:Js.m7.DocLink},a),n):[d.FieldDisplayLayoutTypeChar.Card,d.FieldDisplayLayoutTypeChar.Preview].includes(null!==(t=i.displayLayoutType)&&void 0!==t?t:"")?(0,hc.KC)(i)?Ye().createElement(dc,(0,r.__assign)({},a),n):Ye().createElement(ic,(0,r.__assign)({},a),n):Ye().createElement(rc.m,(0,r.__assign)({},a),n)}},e.prototype.createNormalLinkComponent=function(e){return this.createDocLinkComponent(e)},e.prototype.getSubtype=function(e){var t,n=e.fieldCode,r=n.switches,o=n.instructions;return null!==(t=r[d.FieldCommonSwitchesName.subtype])&&void 0!==t?t:null==o?void 0:o[0]},e.prototype.getOverrideWidthStyle=function(e){var t,n,r,o=null!==(t=this.getSubtype(e))&&void 0!==t?t:"";if([Js.m7.DocLink,Js.m7.NormalLink].includes(o)){var i=null!==(r=null===(n=e.fieldCode.switches)||void 0===n?void 0:n[d.FieldCommonSwitchesName.displayLayoutType])&&void 0!==r?r:"";return[d.FieldDisplayLayoutTypeChar.Card,d.FieldDisplayLayoutTypeChar.Preview].includes(i)?"100%":"auto"}},e}(),Bc=function(e){return function(t){var n=t.children,o=t.box,i=t.fieldInfo,a="field-trigger-".concat(o.uuid),s=new Fc,c=i&&s.getSubtype(i);if(i&&c){var l=S.Am.get(Ks.D),u=i.nestingLevel,p=function(t,n){var r,i=o.getRange(),a=l.getFieldByPoint(e,i.begin(),u);if(a){var s={event:n,layoutBox:o,fieldInfo:a,editor:e},d=l.getFieldHookConfig(a.fieldCode.name,c);null===(r=d[t])||void 0===r||r.call(d,s)}},f={editor:e,layoutBox:o,fieldInfo:i,children:n},h=i.displayLayoutType===d.FieldDisplayLayoutTypeChar.Text;return{component:Ye().createElement("div",{key:a,style:{whiteSpace:"nowrap"},onTouchStart:function(e){return p("onTouchStart",e)},onTouchMove:function(e){return p("onTouchMove",e)},onTouchEnd:function(e){return p("onTouchEnd",e)},onMouseEnter:function(e){return p("onMouseEnter",e)}},h?n:Ye().createElement(xc,(0,r.__assign)({},f))),overrideStyle:{maxWidth:"calc(100% - 5px)",width:s.getOverrideWidthStyle(i)}}}return{component:Ye().createElement(mc.x,{editor:e,layoutBox:o,fieldInfo:i,key:a},n),overrideStyle:{}}}},Uc=function(e){return(0,d.isTextBox)(e)?e.textString():""};function Hc(e){return e.children.map((function(e){return e.hidden?null:Ye().createElement("span",{className:"melo-leaf",style:(0,r.__assign)((0,r.__assign)({},d.CssUtil.cssPropsToStyle(d.CssUtil.computeStyles(e).cssProperties)),{verticalAlign:"baseline"}),key:e.uuid},Uc(e))}))}var Wc=[Js.m7.AddonLink,Js.m7.TDSheetIFrame];function jc(e){var t,n,o=e.editor,i=e.ctx,a=e.box,s=e.fieldInfo,c=e.cssStyle,l=e.bridge,u=null===(t=s.fieldCode.instructions)||void 0===t?void 0:t[0],f=s.fieldCode.switches,h=null==f?void 0:f[d.FieldCommonSwitchesName.subtype];if((u||!f||f[qs.a.internalJump])&&h){var m=(0,d.makeFrame)(0,0,a.totalWidth,a.totalHeight),g=(0,Xs.Vo)(i,a),v=null===(n=a.fieldInfo)||void 0===n?void 0:n.layoutType,_=null,y={editor:o,layoutBox:a,fieldInfo:s,overrideStyle:c,bridge:l,renderCanvas:!0};if(d.FieldLayoutType.Text===v)_=function(e,t){var n=e.editor,o=e.layoutBox,i=e.fieldInfo,a=e.overrideStyle,s=e.bridge,c=e.renderCanvas,l=o.children.map((function(e){return e.hidden?null:Ye().createElement("span",{className:"melo-leaf",style:(0,r.__assign)((0,r.__assign)({paddingBottom:"".concat(Math.round((0,p.twipsToPx)(e.totalHeight)/8),"px")},d.CssUtil.cssPropsToStyle(d.CssUtil.computeStyles(e).cssProperties)),{verticalAlign:"baseline"}),key:Math.random()},Uc(e))})).filter((function(e){return!e}));return Ye().createElement(fc,{editor:n,layoutBox:o,fieldInfo:i,subType:t,key:"field-trigger-".concat(o.uuid),renderCanvas:c,overrideStyle:a,bridge:s},l)}(y,h);else{var b=(new Fc)[Wc.includes(h)?"createAddonLinkComponent":"createDocLinkComponent"];_=s&&b((0,r.__assign)((0,r.__assign)({},y),{key:"field-trigger-".concat(a.uuid),fieldInfo:s,children:Hc(a)}))}if(_){var E=d.PoolNodeFactory.obtain(d.IComponentView,a.uuid,m,_,g);i.addView(E)}}}var Gc={textRenderConfig:{decorator:{decoratorCallback:Bc,bridgeKey:gc.zE.DocLink},modelWrapper:_c,draw:jc},containerRenderConfig:{children:function(e){return Ye().createElement(Dc,(0,r.__assign)({},e))}}},Vc={textRenderConfig:{decorator:{decoratorCallback:Bc,bridgeKey:gc.zE.NormalLink},modelWrapper:_c,draw:jc},containerRenderConfig:{children:function(e){return Ye().createElement(Dc,(0,r.__assign)({},e))}}},zc={textRenderConfig:{decorator:{decoratorCallback:Bc,bridgeKey:gc.zE.AddonLink},modelWrapper:_c,draw:jc},containerRenderConfig:{children:function(e){return Ye().createElement(Dc,(0,r.__assign)({},e))}}},Qc=[d.FieldDisplayLayoutTypeChar.Text,d.FieldDisplayLayoutTypeChar.Inline,d.FieldDisplayLayoutTypeChar.Card,d.FieldDisplayLayoutTypeChar.Preview],Yc={oneLineContent:56,twoLinesContent:66,threeLinesContent:110},Zc=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isAutoUpdate=!1,t.isShowDropdowns=!1,t.isShowHover=!1,t}return(0,r.__extends)(t,e),t.prototype.canFocusInField=function(e){var t=e.switches;return(null==t?void 0:t[d.FieldCommonSwitchesName.displayLayoutType])===d.FieldDisplayLayoutTypeChar.Text},t.prototype.getFieldLayoutType=function(e){var t=e.switches,n=void 0===t?{}:t;if(0===Object.keys(n).length)return d.FieldDisplayLayoutTypeChar.Inline;var r=n[d.FieldCommonSwitchesName.displayLayoutType];return Qc.includes(r)?r:d.FieldDisplayLayoutTypeChar.Text},t.prototype.getFieldWidth=function(e){var t,n=null===(t=e.instructions)||void 0===t?void 0:t[0],r=e.switches;return n&&(null==r?void 0:r[d.FieldCommonSwitchesName.displayLayoutType])===d.FieldDisplayLayoutTypeChar.Card?(0,p.pxToTwips)(420):0},t.prototype.getPluginContainerFitRule=function(t){var n=e.prototype.getPluginContainerFitRule.call(this,t);if(!t||!t.instructions)return n;var r=(0,hc.re)(t);return r&&hc.zj.isWeDrivePreview(r)?{fitToParentWidth:!1,fitToParentHeight:!1}:n},t.prototype.getFieldHeight=function(e){var t,n=e.switches,r=null==n?void 0:n[d.FieldCommonSwitchesName.subtype];if(r){var o=null==n?void 0:n[d.FieldCommonSwitchesName.displayLayoutType],i=null==n?void 0:n[qs.hq.fileDesc||""];return o===d.FieldDisplayLayoutTypeChar.Card?this.getCardHeight(r,!!i):o===d.FieldDisplayLayoutTypeChar.Preview?this.getPreviewHeight():r&&(null===(t=this["handle".concat(o,"Height")])||void 0===t?void 0:t.call(this,r))}},t.prototype.getCardHeight=function(e,t){return e===Js.m7.DocLink?(0,p.pxToTwips)(Yc.oneLineContent):t?(0,p.pxToTwips)(Yc.threeLinesContent):(0,p.pxToTwips)(Yc.twoLinesContent)},t.prototype.getPreviewHeight=function(){return(0,p.pxToTwips)(360)},t}(d.FieldCodeProcessor),Kc=n(717610),Jc=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isAutoUpdate=!0,t}return(0,r.__extends)(t,e),t.prototype.canFocusInField=function(e){return!1},t.prototype.requiredContext=function(){return[d.FieldCodeLayoutContextKey.PAGE_COUNT]},t.prototype.getFieldLayoutText=function(e,n){return t.parse(e,n)},t.parse=function(e,t){return"".concat(t.pageCount)},t}(d.FieldCodeProcessor),qc=Ye().lazy((function(){return n.e(7946).then(n.bind(n,827946)).then((function(e){return{default:e.RenderAttachment}}))})),Xc=(0,$s.Z)(qc),$c=n(156317);function el(e,t){return(0,d.isFieldBox)(e)?(0,p.twipsToPx)(e.edge.left)+(0,p.twipsToPx)(e.rect.width):t.displayLayoutType===d.FieldDisplayLayoutTypeChar.Preview||t.displayLayoutType===d.FieldDisplayLayoutTypeChar.Card?"100%":"auto"}var tl=n(240155),nl={textRenderConfig:{decorator:{decoratorCallback:function(e){return function(t){var n=t.children,r=t.box,o=t.fieldInfo,i=t.bridge;if(!o)return{component:n,overrideStyle:{}};var a=(0,$c.yS)(o.fieldCode);return{component:Ye().createElement(Xc,{editor:e,layoutBox:r,fieldInfo:o,bridge:i,info:a,key:"field-trigger-".concat(r.uuid)},n),overrideStyle:{paddingLeft:0,width:el(r,a),textAlign:"start",height:"auto",lineHeight:"normal"}}}},bridgeKey:gc.zE.Attachment},modelWrapper:function(){return function(e){var t,n=(0,$c.yS)(e.fieldCode).displayLayoutType;t=n===d.FieldDisplayLayoutTypeChar.Preview?new(d.PropertyFactory.getPropertyClass(d.PropertyType.RunProperty)):e.fieldResultProp.clone();var r=(0,p.pxToTwips)(20)+(t?(0,tl._y)(t.sz.val):0);return{metric:{padding:{before:0,start:n===d.FieldDisplayLayoutTypeChar.Inline?r:0,after:0,end:0}},fieldResultProp:t}}},draw:function(e){var t=e.fieldInfo,n=e.ctx,o=e.box,i=e.cssStyle,a=e.bridge,s=e.editor,c=(0,d.makeFrame)(0,0,o.totalWidth,o.totalHeight),l=(0,$c.yS)(t.fieldCode);if(l){var u=(0,Xs.Vo)(n,o),p=o.children.map((function(e){return e.hidden?null:Ye().createElement("span",{className:"melo-leaf",style:(0,r.__assign)((0,r.__assign)({},d.CssUtil.cssPropsToStyle(d.CssUtil.computeStyles(e).cssProperties)),{verticalAlign:"baseline"}),key:Math.random()},(0,d.isTextBox)(e)?e.textString():"")})),f=d.PoolNodeFactory.obtain(d.IComponentView,o.uuid,c,Ye().createElement(Xc,{editor:s,layoutBox:o,fieldInfo:t,key:"field-trigger-".concat(o.uuid),renderCanvas:!0,overrideStyle:i,info:l,bridge:a},p),u);n.addView(f)}}},containerRenderConfig:{children:function(e){var t=e.fieldInfo,n=e.editor,r=e.layoutBox,o=e.key,i=(0,$c.yS)(t.fieldCode);return Ye().createElement(Xc,{editor:n,layoutBox:r,fieldInfo:t,key:o,info:i})}}},rl=n(242901),ol=n(733284),il=n(734156),al="tdocs-card_text_link",sl="tdocs-card_selected",cl="tdocs-card_text_icon",ll="tdocs-card_text",ul=n(98813),dl=n(243562),pl=function(e){function t(t){var n=e.call(this,t)||this;return n.isTouching=!1,n.touchStartTime=0,n.touchStartX=0,n.touchStartY=0,n.loading=!1,n.isMobile=!1,n.loadingTimer=0,n.deselectCard=function(){var e=n.state.selected,t=n.props.onSelect;e&&(n.setState({selected:!1}),t&&t(!1))},n.deleteCard=function(e){var t=n.props,r=t.field,o=t.editor,i=t.onSelect,a=(null!=r?r:{}).fieldRange;a&&e.fieldInfo&&a.contains(e.fieldInfo.fieldCode.range)&&(n.state.selected?o.service.getDocument().getRange(a.begin(),a.end()).delete():(n.setState({selected:!0}),i&&i(!0)))},n.handleClick=function(e){n.isMobile||(e.stopPropagation(),n.clickCard(e))},n.clickCard=function(e){var t=n.props.onClick;!n.loading&&t&&(n.loading=!0,n.loadingTimer&&window.clearTimeout(n.loadingTimer),n.loadingTimer=window.setTimeout((function(){n.loadingTimer=0,n.loading&&(n.loading=!1)}),500),t(e))},n.handleTouchStart=function(e){e.stopPropagation(),n.touchStartX=e.touches[0].clientX,n.touchStartY=e.touches[0].clientY,n.isTouching=!0,n.touchStartTime=Date.now()},n.handleTouchMove=function(e){var t=e.touches[0].clientX,r=e.touches[0].clientY;Math.abs(t-n.touchStartX)+Math.abs(r-n.touchStartY)>30&&(n.isTouching=!1)},n.handleTouchEnd=function(e){var t;e.preventDefault(),e.stopPropagation(),n.isTouching&&(n.isTouching=!1,Date.now()-n.touchStartTime>=500?n.showToolbar():(null===(t=n.props.editor.surface)||void 0===t||t.requestBlur(),n.clickCard()))},n.handleMouseEnter=function(){n.isMobile||n.showToolbar()},n.showToolbar=function(){var e,t=n.props,r=t.editor,o=t.data,i=t.layoutBox,a=t.onShowToolbar,s=(null!==(e=n.props.field)&&void 0!==e?e:{}).fieldRange;if(s&&a){var c=r.getViewRangeFromGcpRange(s),l=null==c?void 0:c.start.getSurfaceOffset(r.zoom);if(l){var u=n.getTextAlignment();a({show:!0,posX:l.x,posY:l.y-50,fieldIndex:n.props.editor.getIndexFromRange(i.getRange()),layout:o.layout,align:u})}}},n.getTextAlignment=function(){var e,t,r,o,i=n.props.layoutBox,a=d.STJcWml.left;return(0,d.isFieldBox)(i)||(0,d.isFieldContainerBox)(i)?(o=(null===(e=i.parentBox)||void 0===e?void 0:e.parentBox).property.jc)&&(a=o.val):(o=null===(r=null===(t=i.parentBox)||void 0===t?void 0:t.property)||void 0===r?void 0:r.jc)&&(a=o.val),a},n.handleMouseLeave=function(){n.isMobile||n.toolbarService.toggleToolbar({show:!1})},n.handleContextMenu=function(){var e,t=n.props.editor,r=(null!==(e=n.props.field)&&void 0!==e?e:{}).fieldRange;r&&t.service.getSelection().setRange(r.begin(),r.end())},n.state={selected:!1},n}var n;return(0,r.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this.props.editor;e.on(d.RenderNotificationTypes.SELECTION_CHANGE,this.deselectCard),e.on(d.FieldCodeNotificationType.Delete,this.deleteCard)},t.prototype.componentWillUnmount=function(){var e=this.props.editor;e.removeCallBack(d.RenderNotificationTypes.SELECTION_CHANGE,this.deselectCard),e.removeCallBack(d.FieldCodeNotificationType.Delete,this.deleteCard),window.clearTimeout(this.loadingTimer)},t.prototype.render=function(){var e=this.props,t=e.domRef,n=e.children,r=e.data,o=this.state.selected,i="".concat(o?sl:"","\n            ").concat(this.isMobile||r.layout===d.FieldDisplayLayoutTypeChar.Inline?"":ul.Z["fieldcode-draggable"]);return Ye().createElement("div",{className:i,ref:t,onClick:this.handleClick,onTouchStart:this.handleTouchStart,onTouchMove:this.handleTouchMove,onTouchEnd:this.handleTouchEnd,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onContextMenu:this.handleContextMenu},n)},t.defaultProps={domRef:(0,Qe.createRef)()},(0,r.__decorate)([(0,S.tB)(),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==dl.Z&&dl.Z)?n:Object)],t.prototype,"toolbarService",void 0),t}(Qe.Component),fl=420,hl=function(e){var t=e.className,n=e.fontSize,r=e.children,o=e.onClick,i=e.onMouseEnter,a=e.onMouseLeave,s=e.onTouchStart,c=e.onTouchMove,l=e.onTouchEnd,u=e.onContextMenu,d=e.icon,p=d?{paddingLeft:1.3*n+2}:{};return Ye().createElement("span",{className:t?"".concat(al," ").concat(t):al,style:{fontSize:"".concat(n,"px")},onTouchStart:s,onTouchMove:c,onTouchEnd:l,onClick:o,onMouseEnter:i,onMouseLeave:a,onContextMenu:u},d&&Ye().createElement("span",{className:cl},Ye().createElement("span",{style:{width:"".concat(n,"px"),height:"".concat(n,"px")}},d)),Ye().createElement("span",{className:ll,style:p},r))},ml=function(e){var t=e.layoutBox,n=(0,Qe.useMemo)((function(){var e,n,r,o;return(0,d.isFieldBox)(t)?(0,p.twipsToPx)((null===(n=null===(e=t.content)||void 0===e?void 0:e.textStyle)||void 0===n?void 0:n.renderFontSize)||14):(0,p.twipsToPx)((null===(o=null===(r=t.content)||void 0===r?void 0:r.property)||void 0===o?void 0:o.renderFontSize)||14)}),[t]);return{fontSize:n}},gl=function(e){var t=e.className,n=e.layoutBox,r=e.children,o=ml({layoutBox:n}).fontSize;return Ye().createElement(hl,{className:t,fontSize:o,icon:Ye().createElement("svg",{viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Ye().createElement("path",{d:"M10.0333 0.5C9.2617 0.5 8.5432 0.708883 7.93334 1.0643C6.81442 1.71631 6.06666 2.869 6.06666 4.18366V9.64968C6.06666 10.6341 5.12643 11.4321 3.96667 11.4321C2.80685 11.4321 1.86667 10.6341 1.86667 9.64968C1.86667 8.9491 2.34404 8.34468 3.03673 8.05336C3.08673 8.03234 3.13738 8.01248 3.18954 7.99486C3.62552 7.81677 3.99959 7.48204 4.13845 7.09342C4.34343 6.51984 3.96176 6.05487 3.286 6.05487C3.11761 6.05487 2.94679 6.08385 2.78207 6.13616C2.78126 6.13637 2.7805 6.13659 2.7797 6.13681C1.80282 6.42253 0.987275 7.04902 0.497787 7.86731C0.181484 8.39594 0 9.00322 0 9.64968C0 11.6809 1.77943 13.3333 3.96667 13.3333C4.73824 13.3333 5.45674 13.1244 6.06666 12.769C7.18552 12.117 7.93334 10.9643 7.93334 9.64968V4.18366C7.93334 3.19923 8.87352 2.40124 10.0333 2.40124C11.1931 2.40124 12.1333 3.19923 12.1333 4.18366C12.1333 4.9142 11.6155 5.54205 10.8744 5.81734C10.3962 5.98045 10.0043 6.33296 9.85513 6.75051C9.65107 7.32151 10.031 7.78433 10.7037 7.78433C10.8562 7.78433 11.01 7.75777 11.1601 7.71436C11.1846 7.70755 11.2088 7.69987 11.2332 7.69262C12.2043 7.4052 13.0149 6.78064 13.5022 5.96607C13.8185 5.43739 14 4.83012 14 4.18366C14 2.15246 12.2206 0.5 10.0333 0.5Z",fill:"#7586DB"}))},r)},vl=n(508436),_l=function(e){function t(t){var n=e.call(this,t)||this;return n.refThumb=Ye().createRef(),n.updateSelection=function(e){n.setState({selected:e})},n.state={selected:!1},n.onClick=n.onClick.bind(n),n.showToolbar=n.showToolbar.bind(n),n}var n;return(0,r.__extends)(t,e),t.prototype.componentDidMount=function(){var e,t=this;if(vl.default.isWeChat){var n=this.props.appData.username;null===(e=this.loader.instance)||void 0===e||e.getAppInfo(this.props.appData).then((function(e){t.refThumb.current&&e&&(console.error("wx-open-launch-weapp: username: ".concat(n,", app_path: ").concat(e.app_path)),t.refThumb.current.innerHTML='\n                    <wx-open-launch-weapp\n                        id="launch-btn"\n                        username="'.concat(n.split("@")[0],'"\n                        path="').concat(e.app_path,'"\n                        class="mini-app-thumbnail-launch-weapp"\n                    >\n                        <script type="text/wxtag-template">\n                            <style>\n                            .btn {\n                                width: 232px;\n                                height: 186px;\n                                display: block;\n                                border: none;\n                                border-radius: 0;\n                                background-color: transparent;\n                                color: transparent;\n                            }\n                            </style>\n                            <button class="btn">open</button>\n                        <\/script>\n                    </wx-open-launch-weapp>\n                    '))}))}},t.prototype.componentWillUnmount=function(){var e;null===(e=this.loader.instance)||void 0===e||e.toggleToolbar({show:!1})},t.prototype.showToolbar=function(e){var t;null===(t=this.loader.instance)||void 0===t||t.toggleToolbar(e)},t.prototype.render=function(){var e,t=this.props,n=t.editor,r=t.fieldInfo,o=t.layoutBox,i=t.children,a=t.appData,s=this.state.selected,c=a.icon_url,l=a.thumb_url,u=a.name,p=a.title,f=a.layout;return e=(void 0===f?d.FieldDisplayLayoutTypeChar.Card:f)===d.FieldDisplayLayoutTypeChar.Inline?Ye().createElement(gl,{layoutBox:o},i):Ye().createElement("div",{className:"mini-app-card ".concat(s?"mini-app-card-active":"")},Ye().createElement("div",{className:"mini-app-header"},Ye().createElement("div",{className:"mini-app-icon",style:{backgroundImage:"url(".concat(c||"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjRjBGMEYwIiBkPSJNMCAwaDIwdjIwSDB6Ii8+PHBhdGggZD0iTTE1LjUgMTVoLTExYS4yNS4yNSAwIDAgMS0uMjUtLjI1di0uMjE5YzAtLjI2NC4xNC0uNTEuMzY3LS42NDVsMy44MzItMi4yNzRhLjg2My44NjMgMCAwIDAgLjE4OS0xLjMzMiAzLjA4MiAzLjA4MiAwIDAgMS0uODMzLTIuMTA4di0uOTc3YTIuMTk1IDIuMTk1IDAgMSAxIDQuMzkgMHYuOTc3YzAgLjc4My0uMjk3IDEuNTM3LS44MzMgMi4xMDhhLjg2My44NjMgMCAwIDAgLjE5IDEuMzMybDMuODMgMi4yNzRhLjc1Ljc1IDAgMCAxIC4zNjguNjQ1di4yMTlhLjI1LjI1IDAgMCAxLS4yNS4yNXoiIGZpbGw9IiNEMUQxRDEiLz48L3N2Zz4=",")")}}),Ye().createElement("div",{className:"mini-app-name mini-app-text"},u)),Ye().createElement("div",{className:"mini-app-title mini-app-text"},p),Ye().createElement("div",{ref:this.refThumb,className:"mini-app-thumbnail",style:{backgroundImage:"url(".concat(l||"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjMyIiBoZWlnaHQ9IjE4NiIgdmlld0JveD0iMCAwIDIzMiAxODYiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwXzExMjdfMTM4NDg1KSI+PHBhdGggZmlsbD0iI0YwRjBGMCIgZD0iTTAtMThoMjMydjIzMEgweiIvPjxnIGNsaXAtcGF0aD0idXJsKCNjbGlwMV8xMTI3XzEzODQ4NSkiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTI4Ljk0NCA2Ny40MDZjLTMuMDM5IDAtNS44NjguODIzLTguMjY5IDIuMjIyLTQuNDA2IDIuNTY3LTcuMzUgNy4xMDYtNy4zNSAxMi4yODN2MjEuNTIyYzAgMy44NzYtMy43MDIgNy4wMTgtOC4yNjkgNy4wMThzLTguMjY5LTMuMTQyLTguMjY5LTcuMDE4YzAtMi43NTggMS44OC01LjEzOCA0LjYwOC02LjI4NS4xOTctLjA4My4zOTYtLjE2MS42MDEtLjIzIDEuNzE3LS43MDIgMy4xOS0yLjAyIDMuNzM3LTMuNTUuODA3LTIuMjU5LS42OTYtNC4wOS0zLjM1Ny00LjA5LS42NjMgMC0xLjMzNi4xMTUtMS45ODQuMzJsLS4wMDkuMDAzYy0zLjg0NyAxLjEyNS03LjA1OCAzLjU5Mi04Ljk4NiA2LjgxNC0xLjI0NSAyLjA4MS0xLjk2IDQuNDczLTEuOTYgNy4wMTggMCA3Ljk5OCA3LjAwNyAxNC41MDUgMTUuNjE5IDE0LjUwNSAzLjAzOCAwIDUuODY3LS44MjMgOC4yNjktMi4yMjIgNC40MDYtMi41NjggNy4zNS03LjEwNyA3LjM1LTEyLjI4M1Y4MS45MTFjMC0zLjg3NyAzLjcwMi03LjAxOSA4LjI2OS03LjAxOSA0LjU2NiAwIDguMjY4IDMuMTQyIDguMjY4IDcuMDE5IDAgMi44NzYtMi4wMzggNS4zNDgtNC45NTcgNi40MzItMS44ODIuNjQyLTMuNDI1IDIuMDMtNC4wMTMgMy42NzUtLjgwMyAyLjI0OC42OTMgNC4wNyAzLjM0MSA0LjA3LjYwMSAwIDEuMjA2LS4xMDQgMS43OTctLjI3NS4wOTctLjAyNy4xOTItLjA1Ny4yODgtLjA4NiAzLjgyNC0xLjEzMiA3LjAxNi0zLjU5IDguOTM0LTYuNzk4YTEzLjYwNiAxMy42MDYgMCAwIDAgMS45Ni03LjAxOGMwLTcuOTk4LTcuMDA2LTE0LjUwNS0xNS42MTgtMTQuNTA1eiIgZmlsbD0iI0QxRDFEMSIvPjwvZz48L2c+PGRlZnM+PGNsaXBQYXRoIGlkPSJjbGlwMF8xMTI3XzEzODQ4NSI+PHJlY3Qgd2lkdGg9IjIzMiIgaGVpZ2h0PSIxODYiIHJ4PSIzIiBmaWxsPSIjZmZmIi8+PC9jbGlwUGF0aD48Y2xpcFBhdGggaWQ9ImNsaXAxXzExMjdfMTM4NDg1Ij48cGF0aCBmaWxsPSIjZmZmIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg4NSA2MSkiIGQ9Ik0wIDBoNjN2NjNIMHoiLz48L2NsaXBQYXRoPjwvZGVmcz48L3N2Zz4=",")")}}),Ye().createElement("div",{className:"mini-app-footer"},Ye().createElement("div",{className:"mini-app-default-icon"}),Ye().createElement("div",{className:"mini-app-default-name"},rl.Wo.WEAPP_TEXT))),Ye().createElement(pl,{data:a,editor:n,layoutBox:o,field:r,onClick:this.onClick,onShowToolbar:this.showToolbar,onSelect:this.updateSelection},e)},t.prototype.onClick=function(){var e;return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){return null===(e=this.loader.instance)||void 0===e||e.openMiniProgram(this.props.appData),[2]}))}))},(0,r.__decorate)([(0,S.aN)(ol.IFieldcodeWxworkAppFeature),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==me.IDynamicLoader&&me.IDynamicLoader)?n:Object)],t.prototype,"loader",void 0),(0,r.__decorate)([(0,il.kR)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",void 0)],t.prototype,"componentDidMount",null),(0,r.__decorate)([(0,il.kR)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",void 0)],t.prototype,"componentWillUnmount",null),(0,r.__decorate)([(0,il.kR)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",void 0)],t.prototype,"showToolbar",null),(0,r.__decorate)([(0,il.nB)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"onClick",null),t}(Ye().Component);function yl(e){if(!e.children)return[];var t=e.children.map((function(e){return e.hidden?null:Ye().createElement("span",{className:"melo-leaf",style:(0,r.__assign)((0,r.__assign)({},d.CssUtil.cssPropsToStyle(d.CssUtil.computeStyles(e).cssProperties)),{verticalAlign:"baseline"}),key:e.uuid},function(e){return(0,d.isTextBox)(e)?e.textString():""}(e))})).filter((function(e){return!!e}));return t}function bl(e){return function(t){var n,r=t.ctx,o=t.editor,i=t.box,a=t.fieldInfo,s=t.bridge,c=(0,d.makeFrame)(0,0,i.totalWidth,i.totalHeight),l=null!==(n=e(o,a,i,s,r))&&void 0!==n?n:{},u=l.element,p=l.overrideStyle;if(u){var f=d.PoolNodeFactory.obtain(d.IComponentView,i.uuid,c,u,p);r.addView(f)}}}function El(e,t){var n=e.getCurrentState(),r=n.contextState,o=n.docViewType,i=n.isFocusHeaderFooter,a=n.isInHeaderFooter;return d.CssUtil.computeContainerStyles(t,null==r?void 0:r.clipInfo,o,i,a)}var Cl=function(e,t,n,r,o){var i,a=null===(i=t.fieldCode.instructions)||void 0===i?void 0:i[0],s=a&&(0,rl.bB)(a,!0);return s?Ye().createElement(_l,{key:"field-trigger-".concat(n.uuid),editor:e,layoutBox:n,fieldInfo:t,appData:s,overrideStyle:r,bridge:o},yl(n)):null},wl=(gc.zE.WxworkApp,bl((function(e,t,n,r){var o=d.CssUtil.computeContainerStyles(n),i=Cl(e,t,n,o,r);return i?{element:i,overrideStyle:o}:null})),n(323503)),Tl=n(40494),Al=(n(732722),function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isAutoUpdate=!1,t.isShowDropdowns=!1,t.isShowHover=!1,t.fieldHeightMap=new Map,t}return(0,r.__extends)(t,e),t.prototype.updateFieldHeight=function(e,t){this.fieldHeightMap.set(e.fieldCode,t)},t.prototype.getFieldLayoutType=function(e){return d.FieldDisplayLayoutTypeChar.Card},t.prototype.getFieldHeight=function(e){return this.fieldHeightMap.get(e.fieldCode)||1},t.prototype.getFieldWidth=function(){return(0,p.pxToTwips)(fl)},t}(d.FieldCodeProcessor));function Sl(e,t){if(e.current&&t.editor.docEnv.docViewType!==d.DocViewType.SnapPreview){var n=t.layoutBox,r=t.editor,o=(0,p.pxToTwips)(e.current.getBoundingClientRect().height),i=d.FieldCodeManager.getInstance(),a=S.Am.get(Ks.D),s=t.fieldInfo&&a.convertToFieldCodeInfo(t.fieldInfo);if(s){var c=i.getFieldProcessorByFieldCodeInfo(s);c instanceof Al&&c.getFieldHeight(s)!==o&&(c.updateFieldHeight(s,o),r instanceof d.MeloEditor&&r.forceReflow(n.getRange()))}}}var Il,Rl=function(e){var t=e.refreshError,n=e.unknownError,r=e.memberError;t&&d.ReportHelper.weiMonitorCube({module:d.ICubeModule.Feature,name:ko.C.WxworkMeeting,action:"[cgi]refresh_doc_meeting_card",code:void 0===t.errorCode?void 0:Number(t.errorCode),msg:t.content}),r&&d.ReportHelper.weiMonitorCube({module:d.ICubeModule.Feature,name:ko.C.WxworkMeeting,action:"[cgi]member_info",msg:r.content}),n&&d.ReportHelper.weiMonitorCube({module:d.ICubeModule.Feature,name:ko.C.WxworkMeeting,action:"[component]unknown_error",msg:n})},Ml=function(e){var t=e.data,n=e.className,o=e.selected,i=void 0!==o&&o,a=e.onViewDetail,s=e.onEnterMeeting,l=e.onJoinMeeting,u=e.onUpdate,d=e.openMeetingRecord,f=(0,Qe.useRef)(null),h=(0,Qe.useMemo)((function(){return{subject:t.subject,content:t.content,meeting_room:t.meeting_room,creator_name:t.creator_name,creator_vid:t.creator_vid,start_time:t.start_time,end_time:t.end_time,repeat:t.repeat,attend_list:t.attend_list,place:t.place,is_api_create:t.is_api_create}}),[t]),m=(0,Qe.useMemo)((function(){var e=t.meeting_id,n=t.submeeting_id;return{meeting_id:e,submeeting_id:void 0===n?"":n,access_url:t.access_url,creator_source:t.creator_source,sharekey:t.sharekey,docid:(0,c.Yi)().padId}}),[t]),g=(0,Qe.useCallback)((function(){Sl(f,e)}),[e]),v=(0,Qe.useCallback)((function(e){void 0===e&&(e={}),f.current&&u((0,r.__assign)((0,r.__assign)({},e),{height:Math.floor((0,p.pxToTwips)(f.current.getBoundingClientRect().height))}))}),[u]),_=(0,Qe.useCallback)((function(e){d(e)}),[d]);return Ye().createElement("div",{className:n,style:{width:"".concat(fl,"px"),maxWidth:"100%"},ref:f},Ye().createElement(Tl.wq,{active:i,info:m,data:h,onEnterMeeting:s,onViewMeeting:a,onJoinMeeting:l,updateHeight:g,onViewRecord:_,readyCallback:v,onError:Rl}))},Ol=function(e){var t=e.className,n=e.layoutBox,r=e.children,o=e.onViewDetail,i=ml({layoutBox:n}).fontSize;return Ye().createElement(hl,{className:t,fontSize:i,onClick:o,icon:Ye().createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Ye().createElement("rect",{width:"24",height:"24",rx:"3",fill:"#539CF8"}),Ye().createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.06702 9.10046C5.06702 8.29044 5.72367 7.63379 6.53368 7.63379H13.867C14.677 7.63379 15.3337 8.29044 15.3337 9.10046V15.7005C15.3337 16.5105 14.677 17.1671 13.867 17.1671H6.53368C5.72367 17.1671 5.06702 16.5105 5.06702 15.7005V9.10046ZM16.0669 10.9338L18.5797 9.17487C19.0658 8.83465 19.7336 9.18236 19.7336 9.77564V15.0253C19.7336 15.6186 19.0658 15.9663 18.5797 15.6261L16.0669 13.8672V10.9338ZM12.2535 14.8019L12.4271 14.6268C12.5118 14.5413 12.5891 14.4218 12.6496 14.3137C12.7333 14.1638 12.675 13.9804 12.5305 13.8876L11.6168 13.3007C11.5398 13.2512 11.4413 13.2505 11.3636 13.2987L11.025 13.5089C10.9006 13.5862 10.7664 13.6535 10.6537 13.5612C10.6537 13.5612 10.0438 13.1238 9.78447 12.8621C9.523 12.5983 9.11196 12.0218 9.11196 12.0218C9.01943 11.9083 9.08735 11.7723 9.16378 11.6469L9.37434 11.3018C9.42277 11.2223 9.42031 11.122 9.36805 11.045L8.68365 10.0375C8.59697 9.90989 8.43698 9.85156 8.29715 9.91672C8.18701 9.96806 8.06129 10.04 7.97097 10.1311L7.79736 10.3063C7.31794 10.79 7.92682 12.1884 9.15734 13.4299C10.3879 14.6713 11.774 15.2856 12.2535 14.8019Z",fill:"white"}))},r)},Nl=function(){function e(e){this.contextService=e}var t;return e.prototype.$onReset=function(){},e.prototype.handleContextClick=function(e){this.contextService.context.editor.service.getSelection().setRange(e.begin(),e.end())},e.prototype.getCardPosition=function(e){var t=this.contextService.context.editor,n=e.getRange(),r=t.getViewRangeFromGcpRange(n),o=t.zoom;if(r){var i=r.start.getWindowOffset(o);return{x:i.x,y:i.y+r.start.caretHeight(o)}}return{x:0,y:0}},e=(0,r.__decorate)([(0,Ge.t)(),(0,r.__metadata)("design:paramtypes",["function"==typeof(t=void 0!==I.O&&I.O)?t:Object])],e)}(),kl=n(25138),Ll=function(e){function t(t){var n=e.call(this,t)||this;return n.isMobile=!1,n.updateSelection=function(e){n.setState({selected:e})},n.onViewDetail=function(e){return null==e||e.stopPropagation(),n.openDetail({x:null==e?void 0:e.clientX,y:null==e?void 0:e.clientY})},n.state={selected:!1},n.openDetail=n.openDetail.bind(n),n.showToolbar=n.showToolbar.bind(n),n.onEnterMeeting=n.onEnterMeeting.bind(n),n.onJoinMeeting=n.onJoinMeeting.bind(n),n.onUpdate=n.onUpdate.bind(n),n.openMeetingRecord=n.openMeetingRecord.bind(n),n}var n,o;return(0,r.__extends)(t,e),t.prototype.calcEmbeddedIframePosition=function(){var e,t,n={x:0,y:0};if(p.PlatformUtil.isWeWork()&&Ii.W.isWeWortkEmbeddedDiscussionDoc){var r=null===(t=null===(e=window.parent)||void 0===e?void 0:e.document)||void 0===t?void 0:t.querySelector(".doc-detail_wrapper");if(!r)return n;var o=null==r?void 0:r.getBoundingClientRect();return{x:(null==o?void 0:o.left)||0,y:(null==o?void 0:o.top)||0}}return n},t.prototype.openDetail=function(e){var t;return(0,r.__awaiter)(this,void 0,void 0,(function(){var n,o,i,a,s,c,l;return(0,r.__generator)(this,(function(u){switch(u.label){case 0:return n=this.props,o=n.data,i=n.layoutBox,a=this.calcEmbeddedIframePosition(),s=e||this.cardService.getCardPosition(i),c=s.x,l=s.y,[4,null===(t=this.loader.instance)||void 0===t?void 0:t.onViewDetail((0,r.__assign)((0,r.__assign)({},o),{x:a.x+(c||0),y:a.y+(l||0)}))];case 1:return u.sent(),[2]}}))}))},t.prototype.showToolbar=function(e){var t;null===(t=this.loader.instance)||void 0===t||t.toggleToolbar(e)},t.prototype.onEnterMeeting=function(){var e;return(0,r.__awaiter)(this,void 0,void 0,(function(){var t,n,o,i,a,s;return(0,r.__generator)(this,(function(c){switch(c.label){case 0:return t=this.props,n=t.data,o=t.layoutBox,i=this.cardService.getCardPosition(o),a=i.x,s=i.y,[4,null===(e=this.loader.instance)||void 0===e?void 0:e.onEnterMeeting((0,r.__assign)((0,r.__assign)({},n),{x:a,y:s}))];case 1:return c.sent(),[2]}}))}))},t.prototype.onJoinMeeting=function(){var e;return(0,r.__awaiter)(this,void 0,void 0,(function(){var t;return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return t=this.props.data,[4,null===(e=this.loader.instance)||void 0===e?void 0:e.onJoinMeeting(t)];case 1:return[2,n.sent()||!1]}}))}))},t.prototype.onUpdate=function(e){var t,n=this.props,r=n.data,o=n.layoutBox;null===(t=this.loader.instance)||void 0===t||t.onUpdate(r,e,this.props.editor.getIndexFromRange(o.getRange()))},t.prototype.openMeetingRecord=function(e){var t;return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return[4,null===(t=this.loader.instance)||void 0===t?void 0:t.openMeetingRecord(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.render=function(){var e,t=this.state.selected,n=this.props,r=n.data,o=n.editor,i=n.layoutBox,a=n.fieldInfo,s=n.children,c=r.layout;return e=(void 0===c?d.FieldDisplayLayoutTypeChar.Card:c)===d.FieldDisplayLayoutTypeChar.Inline?Ye().createElement(Ol,{onViewDetail:this.onViewDetail,layoutBox:i},s):Ye().createElement(Ml,{data:r,editor:o,layoutBox:i,fieldInfo:a,selected:t,onViewDetail:this.openDetail,onEnterMeeting:this.onEnterMeeting,onJoinMeeting:this.onJoinMeeting,onUpdate:this.onUpdate,openMeetingRecord:this.openMeetingRecord},s),Ye().createElement(pl,{data:r,editor:o,layoutBox:i,field:a,onClick:this.onViewDetail,onShowToolbar:this.showToolbar,onSelect:this.updateSelection},e)},(0,r.__decorate)([(0,S.aN)(kl.IFieldcodeWxworkMeetingFeature),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==me.IDynamicLoader&&me.IDynamicLoader)?n:Object)],t.prototype,"loader",void 0),(0,r.__decorate)([(0,S.tB)(),(0,r.__metadata)("design:type","function"==typeof(o=void 0!==Nl&&Nl)?o:Object)],t.prototype,"cardService",void 0),(0,r.__decorate)([(0,il.nB)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"openDetail",null),(0,r.__decorate)([(0,il.kR)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",void 0)],t.prototype,"showToolbar",null),(0,r.__decorate)([(0,il.nB)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"onEnterMeeting",null),(0,r.__decorate)([(0,il.nB)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"onJoinMeeting",null),(0,r.__decorate)([(0,il.kR)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",void 0)],t.prototype,"onUpdate",null),(0,r.__decorate)([(0,il.nB)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[String]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"openMeetingRecord",null),t}(Qe.Component),Dl=function(e,t,n,r,o){var i,a=null===(i=t.fieldCode.instructions)||void 0===i?void 0:i[0],s=a&&(0,wl.ph)(a,!0);return s?Ye().createElement(Ll,{key:"field-trigger-".concat(n.uuid),editor:e,layoutBox:n,fieldInfo:t,data:s,overrideStyle:r,bridge:o},yl(n)):null},Pl=(gc.zE.WxworkMeeting,bl((function(e,t,n,r){var o=d.CssUtil.computeContainerStyles(n),i=Dl(e,t,n,o,r);return i?{element:i,overrideStyle:o}:null})),n(266008)),xl=n(60280),Fl=n.n(xl),Bl=n(170752),Ul=n(352177),Hl=n(923549),Wl=n(558352),jl=n(765274),Gl=n.n(jl),Vl=n(613402),zl=n(338156),Ql=n(20871),Yl=n(935536),Zl=n(774945),Kl=n(386818),Jl=n(920412),ql=n(953981),Xl=(n(467060),n(473590)),$l=n.n(Xl),eu=n(95862),tu=n(681620),nu=n(227052),ru=n.n(nu),ou=n(74320),iu=n(178940),au=n(70324),su=null!==(Il="undefined"==typeof window?null:window.i18n)&&void 0!==Il?Il:No.ZP;function cu(e,t){var n=null==su?void 0:su.t(e,t);return n||"".concat(e)}!function(e,t){var n=function(n){su&&su.getResource&&su.addResource&&Object.entries(e).forEach((function(e){var r=(0,Ul.Z)(e,2),o=r[0],i=r[1];Object.entries(i).forEach((function(e){var r=(0,Ul.Z)(e,2),i=r[0],a=r[1],s=null!=t?t:n.defaultNS||"legacy";su.getResource(o,s,i)||su.addResource(o,s,i,a)}))}))};if(su&&"undefined"!=typeof window){if(window.noSharedI18next&&!window.i18n){window.i18n=No.ZP;var r="zh-CN";try{var o=localStorage.getItem("shared-language");o&&(r=o)}catch(e){}No.ZP.init({lng:r,resources:{},debug:!0,ns:"legacy",defaultNS:"legacy"})}su.isInitialized?n(su.options):su.on("initialized",n)}}({"en-US":{organizer:"Organizer: ",creator:"Creator: ",check:"Check","参与人：":"Participants: ","地点：{{place}}":"Place: {{place}}","等{{num}}人":"etc. {{num}} people","不重复":"Never","全天":"All day","加入日程":"Add Schedule","会议室：":"Room: ","请在企业微信中使用此功能":"Please use this function in Enterprise WeChat","已加入日程":"Added to the schedule","年":" ","查看详情":"Check detail"},"zh-CN":{organizer:"组织人：",creator:"创建者：",check:"查看","参与人：":"参与人：","地点：{{place}}":"地点：{{place}}","等{{num}}人":"等{{num}}人","不重复":"不重复","全天":"全天","加入日程":"加入日程","会议室：":"会议室：","请在企业微信中使用此功能":"请在企业微信中使用此功能","已加入日程":"已加入日程","查看详情":"查看详情"},"zh-HK":{organizer:"組織人：",creator:"創建者：",check:"查看","参与人：":"參與人：","地点：{{place}}":"地點：{{place}}","等{{num}}人":"等{{num}}人","不重复":"不重復","全天":"全天","加入日程":"加入日程","会议室：":"會議室：","请在企业微信中使用此功能":"請在企業微信中使用此功能","已加入日程":"已加入日程","查看详情":"查看詳情"}});var lu,uu,du=No.ZP.language,pu="CalendarEventPlain-module_event__NeCpO",fu="CalendarEventPlain-module_active__61-RH",hu="CalendarEventPlain-module_hover_btn__VP9YK",mu="CalendarEventPlain-module_content__aVvVY",gu="CalendarEventPlain-module_title__nHwnK",vu="CalendarEventPlain-module_sub-max-width__2B392",_u="CalendarEventPlain-module_time__-s6jI",yu="CalendarEventPlain-module_repeat__lyJQg",bu="CalendarEventPlain-module_info__amm8W",Eu="CalendarEventPlain-module_margin-top-2__gLPAa",Cu="CalendarEventPlain-module_participants-wrapper__4K9K6",wu="CalendarEventPlain-module_participants__Fb2zM",Tu="CalendarEventPlain-module_no-shrink__guTi6",Au="CalendarEventPlain-module_mobile-event__Wj0LX",Su="CalendarEventPlain-module_icon-left__Ce9A3",Iu="CalendarEventPlain-module_btn-container__mo8mt";function Ru(e){return"微信"===e?{color:"#1EBD43"}:{color:"#FC8F28"}}function Mu(e,t){return e!==t}!function(e){e[e.Unknown=0]="Unknown",e[e.TBD=1]="TBD",e[e.AcceptedAll=2]="AcceptedAll",e[e.Accepted=3]="Accepted",e[e.Rejected=4]="Rejected"}(lu||(lu={})),function(e){e[e.WholeDay=1]="WholeDay",e[e.Deleted=4096]="Deleted",e[e.CanJoin=524288]="CanJoin",e[e.Repeat=8]="Repeat",e[e.ReadOnly=8192]="ReadOnly",e[e.APIAppSchedule=4194304]="APIAppSchedule"}(uu||(uu={}));var Ou,Nu,ku,Lu,Du,Pu,xu,Fu=function(e,t){eu.default.isMobile?ru().show({message:e,type:t||"info",autoClose:!0,duration:5e3}):tu.ZP.show({message:e,type:t||"info",autoClose:!0,duration:5e3})},Bu=function(){return!eu.default.isWxWork&&(Fu(cu("请在企业微信中使用此功能")),!0)},Uu=eu.default.isWxWork&&(Ou="wxwork",Nu="4.1.2",function(e,t,n){var r=null==n?void 0:n.lexicographical,o=null==n?void 0:n.zeroExtend,i=e.split("."),a=t.split(".");if(o){for(;i.length<a.length;)i.push("0");for(;a.length<i.length;)a.push("0")}if(!r){for(var s=0;s<i.length;s++)i[s]=parseInt(i[s],10);for(var c=0;c<a.length;c++)a[c]=parseInt(a[c],10)}for(var l=0;l<i.length;++l){if(a.length===l)return 1;if(i[l]!==a[l])return i[l]>a[l]?1:-1}return i.length!==a.length?-1:0}((null==(ku=navigator.userAgent.match(new RegExp("".concat(Ou,"/([\\d\\.]+)"),"i")))?void 0:ku[1])||"0",Nu,{zeroExtend:!0})>=0),Hu=function(e){return"0"===e.vid||void 0===e.vid||"undefined"===e.vid||null===e.vid||"null"===e.vid||""===e.vid},Wu=new((0,iu.Z)((function e(){var t=this;(0,au.Z)(this,e),(0,Wl.Z)(this,"queue",[]),(0,Wl.Z)(this,"num",0),(0,Wl.Z)(this,"add",(function(e){t.queue.push((function(){e(t.endFn)})),t.startFn()})),(0,Wl.Z)(this,"startFn",(function(){if(t.num<1){var e=t.queue.shift();null==e||e(),t.num=t.num+1}})),(0,Wl.Z)(this,"endFn",(function(){t.num=t.num-1,t.queue.length>0&&t.startFn()}))}))),ju=function(e){var t,n=e.active,r=void 0!==n&&n,o=e.data,i=e.className,a=void 0===i?"":i,s=e.style,c=e.onViewDetail,l=e.onAccept,u=e.onQuery,d=e.updateHeight,p=e.readyCallback,f=e.onError,h=(0,Qe.useMemo)((function(){switch(du){case"en":case"en-US":return Kl.Z;case"zh-CN":default:return Zl.Z;case"zh-HK":return Jl.Z}}),[du]),m=o.start_time,g=o.end_time,v=o.subject,_=o.create_name,y=o.create_from,b=o.place,E=o.attend_list,C=o.create_id,w=o.repeat,T=o.meetting_room,A=o.flag,S=(0,Qe.useState)(E),I=(0,Ul.Z)(S,2),R=I[0],M=I[1],O=(0,Qe.useState)(_),N=(0,Ul.Z)(O,2),k=N[0],L=N[1],D=(0,Qe.useState)(),P=(0,Ul.Z)(D,2),x=P[0],F=P[1],B=(0,Qe.useState)(),U=(0,Ul.Z)(B,2),H=U[0],W=U[1],j=(0,Qe.useState)(!1),G=(0,Ul.Z)(j,2),V=G[0],z=G[1],Q=(0,Qe.useState)(),Y=(0,Ul.Z)(Q,2),Z=Y[0],K=Y[1],J=(0,Qe.useState)(!1),q=(0,Ul.Z)(J,2),X=q[0],$=q[1],ee=(0,Qe.useState)(),te=(0,Ul.Z)(ee,2),ne=te[0],re=te[1],oe=(0,Qe.useState)(A),ie=(0,Ul.Z)(oe,2),ae=ie[0],se=ie[1],ce=(0,Qe.useState)(v),le=(0,Ul.Z)(ce,2),ue=le[0],de=le[1],pe=(0,Qe.useState)(m),fe=(0,Ul.Z)(pe,2),he=fe[0],me=fe[1],ge=(0,Qe.useState)(g),ve=(0,Ul.Z)(ge,2),_e=ve[0],ye=ve[1],be=(0,Qe.useState)(w),Ee=(0,Ul.Z)(be,2),Ce=Ee[0],we=Ee[1],Te=(0,Qe.useState)(T),Ae=(0,Ul.Z)(Te,2),Se=Ae[0],Ie=Ae[1],Re=(0,Qe.useState)(b),Me=(0,Ul.Z)(Re,2),Oe=Me[0],Ne=Me[1],ke=(0,Qe.useState)(""),Le=(0,Ul.Z)(ke,2),De=Le[0],Pe=Le[1],xe=(0,Qe.useState)(),Fe=(0,Ul.Z)(xe,2),Be=Fe[0],Ue=Fe[1],He="api"===y?"creator":"organizer",We=$l()(pu,(t={},(0,Wl.Z)(t,hu,X),(0,Wl.Z)(t,fu,r),(0,Wl.Z)(t,Au,eu.default.isMobile),t),a),je=(0,Qe.useMemo)((function(){var e=new Date(1e3*he),t=new Date(1e3*_e),n=new Date,r="MMMdo E HH:mm",o="MMMdo E HH:mm";if((ae&uu.WholeDay)===uu.WholeDay){if((0,Vl.Z)(e,t)){var i="MMMdo E ".concat(cu("全天"));return(0,zl.Z)(n,e)||(i="yyyy".concat(cu("年")).concat(i)),(0,Ql.Z)(e,i,{locale:h})}r="MMMdo E",o="MMMdo E ".concat(cu("全天"))}else(0,Vl.Z)(e,t)&&(o="HH:mm");return(0,zl.Z)(n,e)&&!(0,zl.Z)(e,t)&&(o="yyyy".concat(cu("年")).concat(o)),(0,zl.Z)(n,e)||(r="yyyy".concat(cu("年")).concat(r),(0,Vl.Z)(e,t)||(o="yyyy".concat(cu("年")," MMMdo E HH:mm"))),"".concat((0,Ql.Z)(e,r,{locale:h})," - ").concat((0,Ql.Z)(t,o,{locale:h}))}),[he,_e,ae]),Ge=(0,Qe.useCallback)((function(e){V||(z(!0),setTimeout((function(){return null==d?void 0:d()})),p(e))}),[V,d,p]),Ve=function(){(function(e){return new Promise((function(t,n){Wu.add((function(r){e().then((function(e){t(e)})).catch((function(e){n(e)})).finally((function(){r()}))}))}))})(u).then((function(e){if(e){e.can_join=void 0===e.can_join?void 0:Boolean(e.can_join);var t=e.subject,n=e.is_joined,r=e.create_id,o=e.attend_list,i=e.flag,a=e.start_time,s=e.end_time,c=e.repeat,l=e.meetting_room,u=e.place,p=e.can_join;K(n),de(t),se(i),me(a),ye(s),we(c),Ie(l),Ne(u),Ue(p),function(e,t,n,r){var o=e.attend_list,i=e.create_id,a=o,s=(a||[]).filter((function(e){return Hu(e)})),c=(a||[]).filter((function(e){return!Hu(e)})).map((function(e){return e.vid})),l=c.includes(i);l||Hu({vid:i})||(c=[i].concat((0,ou.Z)(c)));var u=Array.from(c),d=function(e){var t={},r=e.map((function(e){var r=e.vid,a=e.corp_name,s=e.corp_id,c=e.avatar,u=e.name,d=o.find((function(e){return e.vid===r}));if(d){if("unknown"===u)return n({memberError:{vid:r,content:"查询失败vid unknown: ".concat(r)}}),{vid:r,username:d.username,avatar:d.avatar,status:d.status};var p=Yl.wdocsUserCenter.getDisplayNameWithoutCorp(e);if(r!==i||Hu({vid:i})||(t.createName=p,t.createCorpId=s,t.createCorpName=a,l))return{avatar:c,vid:r,status:d.status,username:p,corpname:a,corpid:s}}}));if(a.length>0){var c=[].concat((0,ou.Z)(r.filter((function(e){return void 0!==e}))),(0,ou.Z)(s));t.attendList=c}return t},p=u.map((function(e){return Yl.wdocsUserCenter.get(e)})).filter((function(e){return!!e}));p.length===u.length?t(d(p)):Yl.wdocsUserCenter.queryUserInfo(u).then((function(e){return t(d(e))})).catch((function(){r()}))}({create_id:r,attend_list:o},(function(t){var n=t.createCorpName,r=t.createCorpId,o=t.createName,i=t.attendList;F(n),W(r),o&&L(o),i&&M(i),Ge(e),setTimeout((function(){return null==d?void 0:d()}))}),f,(function(){Ge(e)}))}else Ge()})).catch((function(e){Ge(),console.log(e)}))};(0,Qe.useEffect)((function(){Yl.wdocsUserCenter.getUserInfo().then((function(e){re(C===e.vid),Pe(e.corp_id),eu.default.isWxWork&&!V?Ve():Ge()})).catch((function(e){Ge(),console.log(e)}))}),[]);var ze=(0,Qe.useMemo)((function(){var e=R.length;if(0!==e){var t=R;e>2&&(t=R.slice(0,2));var n=t.length;return Ye().createElement(Ye().Fragment,null,Ye().createElement("span",{className:Tu},cu("参与人：")),Ye().createElement("span",{className:wu},t.map((function(e,t){var r=e.username,o=e.corpid,i=e.corpname,a=e.name;return Ye().createElement("span",null,r||a,De&&Mu(De,o)&&i&&Ye().createElement("span",{style:Ru(i)},"@",i),t+1<n&&Ye().createElement("span",null,"、"))}))),Ye().createElement("span",{className:Tu},cu(e>2?"等共{{num}}人":"共{{num}}人",{num:e})))}}),[R]),Ze=(0,Qe.useCallback)((function(e){e.stopPropagation(),Bu()||c()}),[c]),Ke=(0,Qe.useCallback)((0,Hl.Z)(Gl().mark((function e(){var t;return Gl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Bu()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,l();case 4:return(t=e.sent)&&(Fu(cu("已加入日程"),"success"),K(!0)),e.abrupt("return",t);case 7:case"end":return e.stop()}}),e)}))),[l]),Je=(0,Qe.useMemo)((function(){return!Uu||!1===Be||void 0===Z||Z||ne||ae&uu.APIAppSchedule||!(ae&uu.CanJoin)?{text:cu("查看详情"),onCallback:Ze}:{text:cu("加入日程"),onCallback:Ke}}),[Z,ne,ae,Be,Ze,Ke]),qe=Je.text,Xe=Je.onCallback;return Ye().createElement("div",{className:We,style:s,onClick:Ze},Ye().createElement("div",{className:Su},Ye().createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Ye().createElement("path",{d:"M0 3C0 1.34315 1.34315 0 3 0H21C22.6569 0 24 1.34315 24 3V21C24 22.6569 22.6569 24 21 24H3C1.34315 24 0 22.6569 0 21V3Z",fill:"#4B95F3"}),Ye().createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7 5.5C5.89543 5.5 5 6.39543 5 7.5V16.5C5 17.6046 5.89543 18.5 7 18.5H17C18.1046 18.5 19 17.6046 19 16.5V7.5C19 6.39543 18.1046 5.5 17 5.5H7ZM7 8.5C7 8.22386 7.22386 8 7.5 8H16.5C16.7761 8 17 8.22386 17 8.5C17 8.77614 16.7761 9 16.5 9H7.5C7.22386 9 7 8.77614 7 8.5ZM8.5 12.5C8.91421 12.5 9.25 12.1642 9.25 11.75C9.25 11.3358 8.91421 11 8.5 11C8.08579 11 7.75 11.3358 7.75 11.75C7.75 12.1642 8.08579 12.5 8.5 12.5ZM12 12.5C12.4142 12.5 12.75 12.1642 12.75 11.75C12.75 11.3358 12.4142 11 12 11C11.5858 11 11.25 11.3358 11.25 11.75C11.25 12.1642 11.5858 12.5 12 12.5ZM16.25 11.75C16.25 12.1642 15.9142 12.5 15.5 12.5C15.0858 12.5 14.75 12.1642 14.75 11.75C14.75 11.3358 15.0858 11 15.5 11C15.9142 11 16.25 11.3358 16.25 11.75ZM8.5 15.5C8.91421 15.5 9.25 15.1642 9.25 14.75C9.25 14.3358 8.91421 14 8.5 14C8.08579 14 7.75 14.3358 7.75 14.75C7.75 15.1642 8.08579 15.5 8.5 15.5ZM12 15.5C12.4142 15.5 12.75 15.1642 12.75 14.75C12.75 14.3358 12.4142 14 12 14C11.5858 14 11.25 14.3358 11.25 14.75C11.25 15.1642 11.5858 15.5 12 15.5ZM16.25 14.75C16.25 15.1642 15.9142 15.5 15.5 15.5C15.0858 15.5 14.75 15.1642 14.75 14.75C14.75 14.3358 15.0858 14 15.5 14C15.9142 14 16.25 14.3358 16.25 14.75Z",fill:"white"}))),Ye().createElement("div",{className:mu},Ye().createElement("div",{className:"".concat(gu," ").concat(vu)},ue),Ye().createElement("div",{className:"".concat(_u," ").concat(vu," ").concat(Eu)},je),Ce&&Ce!==cu("不重复")&&Ye().createElement("div",{className:"".concat(_u," ").concat(Eu," ").concat(yu)},Ce),Ye().createElement("div",{className:bu,style:{marginTop:"8px"}},Ye().createElement(Ye().Fragment,null,Ye().createElement("span",null,cu(He),k),De&&Mu(De,H)&&x&&Ye().createElement("span",{style:Ru(x)},"@",x))),ze&&Ye().createElement("div",{className:"".concat(Cu," ").concat(Eu)},ze),Se&&Ye().createElement("div",{className:bu},cu("会议室："),Se),Oe&&Ye().createElement("div",{className:bu},cu("地点：{{place}}",{place:Oe}))),Ye().createElement("div",{className:Iu},!V||void 0===Be&&void 0===Z&&void 0===ne?null:Ye().createElement(ql.x,{onClick:function(e){return e.stopPropagation(),Xe(e)},onTouchEnd:function(e){e.stopPropagation()},onMouseOver:function(){return $(!0)},onMouseLeave:function(){return $(!1)},style:{padding:0}},qe)))},Gu=function(e){var t=e.unknownError,n=e.memberError;n&&d.ReportHelper.weiMonitorCube({module:d.ICubeModule.Feature,name:ko.C.WxworkCalender,action:"[cgi]member_info",msg:n.content}),t&&d.ReportHelper.weiMonitorCube({module:d.ICubeModule.Feature,name:ko.C.WxworkCalender,action:"[component]unknown_error",msg:t})},Vu=function(e){var t=e.data,n=e.selected,o=e.onViewDetail,i=e.onAccept,a=e.onQuery,s=e.onUpdate,c=e.layoutBox,l=(0,Qe.useRef)(null),u=(0,Qe.useCallback)((function(){Sl(l,e)}),[e]),f=(0,Qe.useCallback)((function(e){void 0===e&&(e={}),l.current&&s((0,r.__assign)((0,r.__assign)({},e),{height:Math.floor((0,p.pxToTwips)(Math.round(l.current.getBoundingClientRect().height)))}))}),[s]),h=(0,d.isFieldBox)(c)?c.totalHeight:0,m={height:"".concat((0,p.twipsToPx)(h||t.height||0),"px")};return Ye().createElement("div",{className:t.id,style:{width:"".concat(fl,"px"),maxWidth:"100%"},ref:l},Ye().createElement(ju,{active:n,data:t,onViewDetail:o,onAccept:i,onQuery:a,readyCallback:f,updateHeight:u,onError:Gu,placeholderStyle:m}))},zu=function(e){var t=e.className,n=e.layoutBox,r=e.children,o=e.onViewDetail,i=ml({layoutBox:n}).fontSize;return Ye().createElement(hl,{className:t,fontSize:i,onClick:o,icon:Ye().createElement("svg",{viewBox:"0 0 20 21",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Ye().createElement("path",{d:"M0.408726 2.04754C0 2.8497 0 3.8998 0 6V14C0 16.1002 0 17.1503 0.408726 17.9525C0.768251 18.6581 1.34193 19.2317 2.04754 19.5913C2.8497 20 3.8998 20 6 20H14C16.1002 20 17.1503 20 17.9525 19.5913C18.6581 19.2317 19.2318 18.6581 19.5913 17.9525C20 17.1503 20 16.1002 20 14V6C20 3.8998 20 2.8497 19.5913 2.04754C19.2318 1.34193 18.6581 0.768251 17.9525 0.408726C17.1503 0 16.1002 0 14 0H6C3.8998 0 2.8497 0 2.04754 0.408726C1.34193 0.768251 0.768251 1.34193 0.408726 2.04754ZM3 4.75C3 4.33579 3.33579 4 3.75 4H16.25C16.6642 4 17 4.33579 17 4.75C17 5.16421 16.6642 5.5 16.25 5.5H3.75C3.33579 5.5 3 5.16421 3 4.75ZM9.99974 11C9.30938 11 8.74974 10.4404 8.74974 9.75C8.74974 9.05964 9.30938 8.5 9.99974 8.5C10.6901 8.5 11.2497 9.05964 11.2497 9.75C11.2497 10.4404 10.6901 11 9.99974 11ZM5.24974 11.0013C4.55938 11.0013 3.99974 10.4417 3.99974 9.7513C3.99974 9.06095 4.55938 8.5013 5.24974 8.5013C5.9401 8.5013 6.49974 9.06095 6.49974 9.7513C6.49974 10.4417 5.9401 11.0013 5.24974 11.0013ZM15.9997 9.75C15.9997 10.4404 15.4401 11 14.7497 11C14.0594 11 13.4997 10.4404 13.4997 9.75C13.4997 9.05964 14.0594 8.5 14.7497 8.5C15.4401 8.5 15.9997 9.05964 15.9997 9.75ZM5.24967 15.5C4.55932 15.5 3.99967 14.9404 3.99967 14.25C3.99967 13.5596 4.55932 13 5.24967 13C5.94003 13 6.49967 13.5596 6.49967 14.25C6.49967 14.9404 5.94003 15.5 5.24967 15.5ZM9.99967 15.5C9.30932 15.5 8.74967 14.9404 8.74967 14.25C8.74967 13.5596 9.30932 13 9.99967 13C10.69 13 11.2497 13.5596 11.2497 14.25C11.2497 14.9404 10.69 15.5 9.99967 15.5ZM15.9997 14.25C15.9997 14.9404 15.44 15.5 14.7497 15.5C14.0593 15.5 13.4997 14.9404 13.4997 14.25C13.4997 13.5596 14.0593 13 14.7497 13C15.44 13 15.9997 13.5596 15.9997 14.25Z",fill:"#4B95F3"}))},r)},Qu=n(527954),Yu=function(e){function t(t){var n=e.call(this,t)||this;return n.isMobile=!1,n.updateSelection=function(e){n.setState({selected:e})},n.onViewDetail=function(e){return null==e||e.stopPropagation(),n.openDetail()},n.state={selected:!1,isJoined:void 0},n.openDetail=n.openDetail.bind(n),n.showToolbar=n.showToolbar.bind(n),n.onAccept=n.onAccept.bind(n),n.onQuery=n.onQuery.bind(n),n.onUpdate=n.onUpdate.bind(n),n}var n,o;return(0,r.__extends)(t,e),t.prototype.openDetail=function(){var e;return(0,r.__awaiter)(this,void 0,void 0,(function(){var t,n,o,i,a,s;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return t=this.props,n=t.data,o=t.layoutBox,n.flag&Qu.l3.Deleted?(this.isMobile?Fl().show({content:(0,j.$t)("card:event-deleted")}):Pl.ZP.show({content:(0,j.$t)("card:event-deleted")}),[3,3]):[3,1];case 1:return i=this.cardService.getCardPosition(o),a=i.x,s=i.y,[4,null===(e=this.loader.instance)||void 0===e?void 0:e.onViewDetail({scheduleId:n.schedule_id,shareKey:n.sharekey,x:a,y:s})];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))},t.prototype.showToolbar=function(e){var t;null===(t=this.loader.instance)||void 0===t||t.toggleToolbar(e)},t.prototype.componentWillUnmount=function(){var e;null===(e=this.loader.instance)||void 0===e||e.toggleToolbar({show:!1})},t.prototype.onAccept=function(){var e;return(0,r.__awaiter)(this,void 0,void 0,(function(){var t;return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return t=this.props.data,[4,null===(e=this.loader.instance)||void 0===e?void 0:e.onAccept(t.schedule_id,t.sharekey)];case 1:return[2,n.sent()||!1]}}))}))},t.prototype.onQuery=function(){var e;return(0,r.__awaiter)(this,void 0,void 0,(function(){var t;return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return t=this.props.data,[4,null===(e=this.loader.instance)||void 0===e?void 0:e.onQuery({schedule_id:t.schedule_id,sharekey:t.sharekey})];case 1:return[2,n.sent()]}}))}))},t.prototype.onUpdate=function(e){var t,n=this.props,r=n.data,o=n.layoutBox;null===(t=this.loader.instance)||void 0===t||t.onUpdate(r,e,this.props.editor.getIndexFromRange(o.getRange()))},t.prototype.render=function(){var e,t=this.state.selected,n=this.props,r=n.data,o=n.editor,i=n.layoutBox,a=n.fieldInfo,s=n.children,c=r.layout;return e=(void 0===c?d.FieldDisplayLayoutTypeChar.Card:c)===d.FieldDisplayLayoutTypeChar.Inline?Ye().createElement(zu,{onViewDetail:this.onViewDetail,layoutBox:i},s):Ye().createElement(Vu,{className:r.id,data:r,editor:o,layoutBox:i,fieldInfo:a,selected:t,onViewDetail:this.onViewDetail,onAccept:this.onAccept,onQuery:this.onQuery,onUpdate:this.onUpdate},s),Ye().createElement(pl,{data:r,editor:o,layoutBox:i,field:a,onClick:this.onViewDetail,onShowToolbar:this.showToolbar,onSelect:this.updateSelection},e)},(0,r.__decorate)([(0,S.aN)(Bl.IFieldcodeWxworkCalenderFeature),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==me.IDynamicLoader&&me.IDynamicLoader)?n:Object)],t.prototype,"loader",void 0),(0,r.__decorate)([(0,S.tB)(),(0,r.__metadata)("design:type","function"==typeof(o=void 0!==Nl&&Nl)?o:Object)],t.prototype,"cardService",void 0),(0,r.__decorate)([(0,il.nB)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"openDetail",null),(0,r.__decorate)([(0,il.kR)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",void 0)],t.prototype,"showToolbar",null),(0,r.__decorate)([(0,il.kR)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",void 0)],t.prototype,"componentWillUnmount",null),(0,r.__decorate)([(0,il.nB)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"onAccept",null),(0,r.__decorate)([(0,il.nB)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"onQuery",null),(0,r.__decorate)([(0,il.kR)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",void 0)],t.prototype,"onUpdate",null),t}(Qe.Component),Zu=n(359291),Ku=function(e,t,n,r,o){var i,a=null===(i=t.fieldCode.instructions)||void 0===i?void 0:i[0],s=a&&(0,Zu.J2)(a,!0);return s?Ye().createElement(Yu,{key:"field-trigger-".concat(n.uuid),editor:e,layoutBox:n,fieldInfo:t,data:s,overrideStyle:r,bridge:o},yl(n)):null},Ju=(gc.zE.WxworkCalender,bl((function(e,t,n,r,o){var i=El(o,n),a=Ku(e,t,n,i,r);return a?{element:a,overrideStyle:i}:null})),n(822416)),qu=null!==(Lu="undefined"==typeof window?void 0:window.i18n)&&void 0!==Lu?Lu:No.ZP;Du={"en-US":{"chat-history":"Chat History of {{group}}"},"zh-CN":{"chat-history":"{{group}}的聊天记录"}},xu=function(e){qu.getResource&&qu.addResource&&Object.entries(Du).forEach((function(t){var n=(0,Ul.Z)(t,2),r=n[0],o=n[1];Object.entries(o).forEach((function(t){var n=(0,Ul.Z)(t,2),o=n[0],i=n[1],a=null!=Pu?Pu:e.defaultNS||"legacy";qu.getResource(r,a,o)||qu.addResource(r,a,o,i)}))}))},qu.isInitialized?xu(qu.options):qu.on("initialized",xu);var Xu,$u,ed="ChatHistory_history__CyzbR",td="ChatHistory_active__iUmn1",nd="ChatHistory_title__DZEYH",rd="ChatHistory_content__L1vN7",od="Message_message__RJVYk",id=function(e){var t=e.username,n=e.textContent;return Ye().createElement("div",{className:od},t,": ",n)},ad=function(e){var t=e.groupName,n=e.chatList,r=e.onClick,o=e.className,i=void 0===o?"":o,a=e.style,s=e.active,c=void 0!==s&&s,l=function(e){var t=(0,Qe.useState)(!1),n=(0,Ul.Z)(t,2),r=n[0],o=n[1],i=(0,Qe.useCallback)((0,Hl.Z)(Gl().mark((function t(){var n,i,a,s=arguments;return Gl().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r){t.next=4;break}for(o(!0),n=s.length,i=new Array(n),a=0;a<n;a++)i[a]=s[a];return t.abrupt("return",e.apply(null,i).finally((function(){o(!1)})));case 4:case"end":return t.stop()}}),t)}))),[r,e]);return{awaiting:r,asyncAction:i}}((0,Hl.Z)(Gl().mark((function e(){return Gl().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r());case 1:case"end":return e.stop()}}),e)})))),u=l.asyncAction;return Ye().createElement("div",{className:"".concat(ed," ").concat(c?td:""," ").concat(i),style:a,onClick:u},Ye().createElement("div",{className:nd},function(){return qu.t.apply(qu,arguments)||(arguments.length<=0?void 0:arguments[0])}("chat-history",{group:t})),Ye().createElement("div",{className:rd},n.map((function(e,t){var n=e.iconurl,r=e.username,o=e.timestamp,i=e.textContent,a=e.company;return Ye().createElement(id,{key:t,iconurl:n,username:r,timestamp:o,textContent:i,company:a})}))))},sd=function(e){var t=e.data.jsonData,n=t.groupName,r=t.chatList,o=e.className,i=e.selected,a=(0,Qe.useRef)(null);return function(e,t){(0,Qe.useEffect)((function(){Sl(t,e)}),[t])}(e,a),Ye().createElement("div",{className:o,style:{width:"".concat(fl,"px"),maxWidth:"100%"},ref:a},Ye().createElement(ad,{active:i,groupName:n,chatList:r,onClick:function(){}}))},cd=function(e){var t=e.className,n=e.layoutBox,r=e.children,o=ml({layoutBox:n}).fontSize;return Ye().createElement(hl,{className:t,fontSize:o,icon:Ye().createElement("svg",{viewBox:"0 0 20 21",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Ye().createElement("path",{d:"M0 6.5C0 4.3998 0 3.3497 0.408726 2.54754C0.768251 1.84193 1.34193 1.26825 2.04754 0.908726C2.8497 0.5 3.8998 0.5 6 0.5H14C16.1002 0.5 17.1503 0.5 17.9525 0.908726C18.6581 1.26825 19.2317 1.84193 19.5913 2.54754C20 3.3497 20 4.3998 20 6.5V14.5C20 16.6002 20 17.6503 19.5913 18.4525C19.2317 19.1581 18.6581 19.7317 17.9525 20.0913C17.1503 20.5 16.1002 20.5 14 20.5H6C3.8998 20.5 2.8497 20.5 2.04754 20.0913C1.34193 19.7317 0.768251 19.1581 0.408726 18.4525C0 17.6503 0 16.6002 0 14.5V6.5Z",fill:"#4B95F3"}),Ye().createElement("path",{d:"M4.25 10.4636C4.25 7.72002 6.82456 5.5 10 5.5C13.1756 5.5 15.75 7.72002 15.75 10.4636C15.75 13.1974 13.1756 15.4174 10 15.4273C9.34397 15.4174 8.71042 15.3204 8.114 15.1409C8.06982 15.1286 8.07344 15.1292 7.95772 15.1056C7.842 15.0821 7.74133 15.1409 7.654 15.1886L6.412 15.9523C6.35482 15.984 6.321 16 6.274 16C6.17329 16 6.08777 15.9112 6.09 15.8091C6.08777 15.7527 6.10514 15.7079 6.11862 15.6606C6.13209 15.6133 6.28621 15.0311 6.366 14.6636C6.3773 14.6116 6.38347 14.5817 6.38347 14.4831C6.38347 14.3846 6.3343 14.2788 6.228 14.1864C5.0247 13.2978 4.25 11.9527 4.25 10.4636Z",fill:"white"}))},r)},ld=function(e){function t(t){var n=e.call(this,t)||this;return n.updateSelection=function(e){n.setState({selected:e})},n.state={selected:!1},n.openDetail=n.openDetail.bind(n),n.showToolbar=n.showToolbar.bind(n),n}var n;return(0,r.__extends)(t,e),t.prototype.openDetail=function(){var e;return(0,r.__awaiter)(this,void 0,void 0,(function(){var t;return(0,r.__generator)(this,(function(n){return t=this.props.data,[2,null===(e=this.loader.instance)||void 0===e?void 0:e.onOpen(t.chatMessageId)]}))}))},t.prototype.showToolbar=function(e){var t;null===(t=this.loader.instance)||void 0===t||t.toggleToolbar(e)},t.prototype.componentWillUnmount=function(){var e;null===(e=this.loader.instance)||void 0===e||e.toggleToolbar({show:!1})},t.prototype.render=function(){var e,t=this.state.selected,n=this.props,r=n.data,o=n.editor,i=n.layoutBox,a=n.fieldInfo,s=n.children,c=r.layout;return e=(void 0===c?d.FieldDisplayLayoutTypeChar.Card:c)===d.FieldDisplayLayoutTypeChar.Inline?Ye().createElement(cd,{layoutBox:i},s):Ye().createElement(sd,{data:r,editor:o,layoutBox:i,fieldInfo:a,selected:t},s),Ye().createElement(pl,{data:r,editor:o,layoutBox:i,field:a,onClick:this.openDetail,onShowToolbar:this.showToolbar,onSelect:this.updateSelection},e)},(0,r.__decorate)([(0,S.aN)(Ju.IFieldcodeWxworkGroupChatFeature),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==me.IDynamicLoader&&me.IDynamicLoader)?n:Object)],t.prototype,"loader",void 0),(0,r.__decorate)([(0,il.nB)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"openDetail",null),(0,r.__decorate)([(0,il.kR)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",void 0)],t.prototype,"showToolbar",null),(0,r.__decorate)([(0,il.kR)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",void 0)],t.prototype,"componentWillUnmount",null),t}(Qe.Component),ud=n(979633),dd=function(e,t,n,r,o){var i,a=null===(i=t.fieldCode.instructions)||void 0===i?void 0:i[0],s=a&&(0,ud.Bf)(a,!0);return s?Ye().createElement(ld,{key:"field-trigger-".concat(n.uuid),editor:e,layoutBox:n,fieldInfo:t,data:s,overrideStyle:r,bridge:o},yl(n)):null},pd=(gc.zE.WxworkGroupChat,bl((function(e,t,n,r,o){var i=El(o,n),a=dd(e,t,n,i,r);return a?{element:a,overrideStyle:i}:null})),n(823030)),fd="tdocs-wxwork-cold-start-button",hd="tdocs-wxwork-cold-start-button-mobile",md="tdocs-mask",gd=n(328413),vd=n(361401),_d=Wi.default,yd=["doc","docx","xls","xlsx","txt","csv","ppt","pptx","xmind","pos","vsd","vsdx"],bd=yd.reduce((function(e,t){return"".concat(e,".").concat(t,",")}),""),Ed=function(e){function t(t){var n=e.call(this,t)||this;return n.loading=!1,n.loadingTimer=0,n.inputEle=null,n.state={isTouched:!1},n.importFiles=n.importFiles.bind(n),n.stopPropagationImportFiles=n.stopPropagationImportFiles.bind(n),n.stopPropagation=n.stopPropagation.bind(n),n.visibilitychangeHandle=n.visibilitychangeHandle.bind(n),n.touchStart=n.touchStart.bind(n),n.touchEnd=n.touchEnd.bind(n),n.addContainer(),n}var n,o,i;return(0,r.__extends)(t,e),t.prototype.componentDidMount=function(){},t.prototype.componentWillUnmount=function(){var e;window.clearTimeout(this.loadingTimer),null===(e=this.inputEle)||void 0===e||e.remove()},t.prototype.visibilitychangeHandle=function(){var e;(null===(e=this.loader.instance)||void 0===e?void 0:e.isOpenNewDoc)&&"visible"===document.visibilityState&&pa.Z.post("/wedoc/query_import_doc").then((function(e){var t,n,r=null===(n=null===(t=e.data)||void 0===t?void 0:t.body)||void 0===n?void 0:n.doc_ids;if(r){var o=r[r.length-1];(0,gd.l)({url:o,replace:!1})}}))},t.prototype.importFiles=function(e,t){var n,o;return(0,r.__awaiter)(this,void 0,void 0,(function(){var i,a=this;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.capacityService.checkCapacityAsync({interceptType:vd.D.ImportFile,channel:"doc_default_pc"})];case 1:return r.sent()||this.loading||(this.loading=!0,i=this.props.editor,null===(n=i.surface)||void 0===n||n.requestBlur(),this.loadingTimer&&window.clearTimeout(this.loadingTimer),this.loadingTimer=window.setTimeout((function(){a.loadingTimer=0,a.loading&&(a.loading=!1)}),500),null===(o=this.loader.instance)||void 0===o||o.importFiles(e,t)),[2]}}))}))},t.prototype.stopPropagationImportFiles=function(e){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){switch(t.label){case 0:return this.stopPropagation(e),[4,this.capacityService.checkCapacityAsync({interceptType:vd.D.ImportFile,channel:"doc_default_pc"})];case 1:return t.sent()?[2]:this.inputEle?(this.inputEle.click(),[2]):[4,this.importFiles()];case 2:return t.sent(),[2]}}))}))},t.prototype.stopPropagation=function(e){e.preventDefault(),e.stopPropagation()},t.prototype.touchStart=function(e){this.setState({isTouched:!0}),this.stopPropagation(e)},t.prototype.touchEnd=function(e){this.setState({isTouched:!1}),this.stopPropagationImportFiles(e)},t.prototype.isValidFile=function(e){if(!e)return!1;var t=e.split(".");if(t.length<2)return!1;var n=t.pop();return!!n&&yd.includes(n)},t.prototype.addContainer=function(){var e=this,t=document.createElement("input");t.type="file",t.id="COLD_START_BUTTON_INPUT_CONTAINER",t.style.display="none",t.multiple=!0,p.PlatformUtil.isWeWork()||(t.accept=bd),t.addEventListener("change",(function(){if(t.files){for(var n=t.files,r=0;r<n.length;r++){var o=n.item(r);if(!e.isValidFile(null==o?void 0:o.name))return void _d.show({message:(0,j.$t)("仅支持 ".concat(yd.join("/")," 格式的文件")),autoClose:!0,duration:3e3})}e.importFiles(t.files,(function(){t.value=""}))}})),document.body.appendChild(t),this.inputEle=t},t.prototype.render=function(){var e,t=Ec()(((e={})[fd]=!0,e[hd]=!1,e));return Ye().createElement("div",{className:t,onClick:this.stopPropagation,onTouchStart:this.touchStart,onFocus:this.stopPropagation,onTouchEnd:this.touchEnd,onMouseDown:this.stopPropagation,onMouseUp:this.stopPropagationImportFiles},(0,j.$t)("导入本地文档"),this.state.isTouched&&Ye().createElement("div",{className:md}))},(0,r.__decorate)([(0,S.aN)(pd.IFieldcodeWxworkColdStartButtonFeature),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==me.IDynamicLoader&&me.IDynamicLoader)?n:Object)],t.prototype,"loader",void 0),(0,r.__decorate)([(0,S.tB)(),(0,r.__metadata)("design:type",Object)],t.prototype,"loading",void 0),(0,r.__decorate)([(0,S.tB)(vd.i),(0,r.__metadata)("design:type","function"==typeof(o=void 0!==vd.i&&vd.i)?o:Object)],t.prototype,"capacityService",void 0),(0,r.__decorate)([(0,il.kR)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",void 0)],t.prototype,"componentWillUnmount",null),(0,r.__decorate)([(0,il.nB)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",["function"==typeof(i="undefined"!=typeof FileList&&FileList)?i:Object,Function]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"importFiles",null),t}(Qe.Component),Cd=function(e,t,n,r,o){return Ye().createElement(Ed,{data:{},editor:e,layoutBox:n,fieldInfo:t,overrideStyle:r,bridge:o},yl(n))},wd=(gc.zE.WxworkColdStartButton,bl((function(e,t,n,r){var o=d.CssUtil.computeContainerStyles(n),i=Cd(e,t,n,o,r);return i?{element:i,overrideStyle:o}:null})),n(981879)),Td=n(511969),Ad={button:"base_button__5viNq",primary:"base_primary__CtbVy",disabled:"base_disabled__lwQvX",divider:"base_divider__qNZrk",avatar:"base_avatar__WgdLV",loading:"base_loading__hZ7SX"},Sd=["type","disabled","loading","children","className"],Id=function(e){var t=e.type,n=void 0===t?"primary":t,r=e.disabled,o=void 0!==r&&r,i=e.loading,a=void 0!==i&&i,s=e.children,c=e.className,l=(0,Td.Z)(e,Sd),u=[Ad.button,c];return o?u.push(Ad.disabled):"primary"===n?u.push(Ad.primary):"text-primary"===n&&u.push(Ad["text-primary"]),a&&u.push(Ad.loading),Ye().createElement("span",(0,wd.Z)({},l,{className:u.join(" ")}),s)};function Rd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Md(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Rd(Object(n),!0).forEach((function(t){(0,Wl.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rd(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Od(e){var t=e.radius,n=e.src,r=e.size,o=e.className,i=e.style;return Ye().createElement("span",{style:Md({borderRadius:t,width:"".concat(r,"px"),height:"".concat(r,"px")},i),className:"".concat(Ad.avatar," ").concat(o)},Ye().createElement("img",{src:n}))}!function(e){e[e.Unjoined=0]="Unjoined",e[e.Joined=1]="Joined",e[e.Expired=2]="Expired"}(Xu||(Xu={})),function(e){e[e.Male=1]="Male",e[e.Female=2]="Female"}($u||($u={}));var Nd,kd={card:"styles_card__3n8fz",active:"styles_active__Aes8x",hover_btn:"styles_hover_btn__Ar77P",disabled:"styles_disabled__K06Pq",content:"styles_content__rt1Ng",avatar:"styles_avatar__fYTgs",tag:"styles_tag__i0gaX",max_lines_2:"styles_max_lines_2__rP6Ck",footer:"styles_footer__ra1J9",info:"styles_info__pqjWQ",title:"styles_title__sU8ps",type:"styles_type__l8iTU",sub_title:"styles_sub_title__qCAwj",group_title:"styles_group_title__MdloU",group_name:"styles_group_name__EE23d",action:"styles_action__rajJh"},Ld=null!==(Nd="undefined"==typeof window?void 0:window.i18n)&&void 0!==Nd?Nd:No.ZP,Dd=function(){return Ld.t.apply(Ld,arguments)||(arguments.length<=0?void 0:arguments[0])},Pd=["status"],xd=function(e){var t=e.className,n=void 0===t?"":t,r=e.style,o=e.active,i=e.avatar,a=e.name,s=e.expiredTime,c=e.external,l=e.status,u=(0,Qe.useMemo)((function(){return l===Xu.Expired||s<Date.now()}),[s]),d=i||"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBmaWxsPSIjNEI5NUYzIiBkPSJNMCAwaDQwdjQwSDB6Ii8+PHBhdGggZD0iTTI2LjkyIDI5Ljk5aC03LjQzNGEuNDYyLjQ2MiAwIDAgMS0uNDcyLS40MyAzLjQ2MyAzLjQ2MyAwIDAgMSAuMDQxLS44NDZjLjEtLjQ4NS4zNDctLjYyNC4zOTMtLjY1bC4wMDgtLjAwNGMuMDMtLjEwMyAxLjMzNy0xLjIyNiAzLjQxMS0yLjMxNyAxLjU0Mi0uNzA0IDEuODUxLTEuMjEyIDIuMDk2LTEuODM4LjM3My0uOTU1LS4wNDctMS44MDEtLjA0Ny0xLjgwMS0xLjI2NC0yLjAxLTEuNDU2LTMuMzEyLTEuMDM0LTUuODIzLjI3LTEuNjE0IDEuNzA4LTIuMTIyIDIuNjczLTIuMjcuMi0uMDIyLjQxIDAgLjQxIDB2LjAwOGMuMDk2LS4wMDUuMzI1LS4wMTQuNDguMDAyLjk2NS4xNDkgMi40Mi42NDYgMi42OSAyLjI2LjQyMSAyLjUxLjIxMyAzLjgyNS0xLjA1MiA1LjgzMyAwIDAtLjQyLjg0Ni0uMDQ2IDEuODAyLjI0NS42MjUuNTU0IDEuMTM0IDIuMDk2IDEuODM4IDIuMDc0IDEuMDkgMy4zODIgMi4yMTQgMy40MTEgMi4zMTdsLjAwOC4wMDRjLjA0NS4wMjYuMjkyLjE2NS4zOTMuNjUuMDU2LjI3LjA1NS41OTMuMDQuODQ2YS40NjIuNDYyIDAgMCAxLS40NzEuNDI5SDI2Ljkydi0uMDF6IiBmaWxsPSIjZmZmIiBmaWxsLW9wYWNpdHk9Ii45Ii8+PHBhdGggZD0iTTI3LjA0OCAyNy40N2ExLjMxIDEuMzEgMCAwIDAtLjI3LS4yNTQgMS42MTggMS42MTggMCAwIDAtLjA4MS0uMDg3IDQuNzc3IDQuNzc3IDAgMCAwLS4yNTgtLjIzNWMtLjIxLS4xODEtLjUxLS40Mi0uODg4LS42OTVhMjUuOTI0IDI1LjkyNCAwIDAgMC0zLjE3Ny0xLjk2MmMtLjk0LS40MjktMS40Ni0uNzc5LTEuNzc2LTEuMDg4LS4zMDUtLjI5Ny0uNDQ2LS41NzgtLjU4Ni0uOTM2YTIuNDE5IDIuNDE5IDAgMCAxLS4xMTktMS4zMDUgMi41OCAyLjU4IDAgMCAxIC4xNS0uNTJsLjAwMi0uMDA3Yy44LTEuMjc1IDEuMjg5LTIuMzY4IDEuNS0zLjU2Mi4yMS0xLjE5OC4xMzQtMi40NTgtLjEzMy00LjA1LS4zOTctMi4zNjUtMi41MzYtMy4wNDUtMy43OC0zLjIzN2EuNTEyLjUxMiAwIDAgMC0uNjI2LS4wMTd2LjAwNWwuMDAxLS4wMDRIMTdsLS4wMTItLjAwMmEyLjc4IDIuNzggMCAwIDAtLjE3OC0uMDEgMy4wOTEgMy4wOTEgMCAwIDAtLjQ0NC4wMTVjLTEuMjUuMTkzLTMuMzYyLjg5LTMuNzU4IDMuMjUtLjI2NyAxLjU5LS4zNDggMi44NDctLjE0MyA0LjA0Mi4yMDUgMS4xOTEuNjkgMi4yODEgMS40OSAzLjU1N2wuMDAyLjAwN2EyLjU3MSAyLjU3MSAwIDAgMSAuMTUuNTJjLjA2LjM1LjA3LjgxNS0uMTIgMS4zMDQtLjE0LjM1OS0uMjgxLjY0LS41ODUuOTM3LS4zMTguMzA5LS44MzcuNjYtMS43NzcgMS4wODhhMjUuOTE0IDI1LjkxNCAwIDAgMC0zLjE3NyAxLjk2MmMtLjM3Ny4yNzUtLjY3Ny41MTQtLjg4OC42OTVhNC43OCA0Ljc4IDAgMCAwLS4yNTcuMjM1IDEuNTk3IDEuNTk3IDAgMCAwLS4wODIuMDg3Yy0uMDcyLjA1LS4xNy4xMy0uMjcuMjUzYTEuOTE3IDEuOTE3IDAgMCAwLS4zNzIuODM0Yy0uMDkzLjQ0OC0uMDc4Ljk2NS0uMDU0IDEuMzA1YS45NjguOTY4IDAgMCAwIC45NzQuODkyaDkuMjg2YS40OTkuNDk5IDAgMCAwIC4xMTUuMDEzSDI2LjVjLjQ5IDAgLjkzNi0uMzY0Ljk3NC0uODkyLjAyNC0uMzQuMDQtLjg1Ny0uMDUzLTEuMzA0YTEuOTE5IDEuOTE5IDAgMCAwLS4zNzMtLjgzNXoiIGZpbGw9IiNmZmYiIHN0cm9rZT0iIzRCOTVGMyIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+PC9zdmc+",p=(0,Qe.useState)(!1),f=(0,Ul.Z)(p,2),h=f[0],m=f[1],g=void 0!==l?function(e){var t=e.status,n=(0,Td.Z)(e,Pd);switch(t){case Xu.Unjoined:return Ye().createElement(Id,n,Dd("join-group"));case Xu.Joined:return Ye().createElement(Id,(0,wd.Z)({},n,{type:"primary"}),Dd("open-group"));case Xu.Expired:return Ye().createElement(Id,(0,wd.Z)({},n,{disabled:!0}),Dd("expired"))}}({status:l,onMouseOver:function(){return m(!0)},onMouseLeave:function(){return m(!1)}}):null,v="\n        ".concat(kd.card,"\n        ").concat(u?kd.disabled:kd.clickable,"\n        ").concat(h?kd.hover_btn:"","\n        ").concat(o?kd.active:"","\n        ").concat(n,"\n    ");return Ye().createElement("div",{className:v,style:r},Ye().createElement("div",{className:kd.content},Ye().createElement(Od,{style:{alignSelf:"flex-start",background:"none"},className:kd.avatar,size:40,radius:"5px",src:d}),Ye().createElement("div",{className:kd.info},Ye().createElement("div",{className:kd.group_name},Ye().createElement("div",{className:"".concat(kd.group_title," ").concat(kd.max_lines_2)},a),c&&Ye().createElement("span",{className:kd.tag},Dd("external")))),Ye().createElement("div",{className:kd.action},g)))},Fd=function(e){var t=e.active,n=void 0!==t&&t,r=e.avatar,o=e.name,i=e.jobTitle,a=e.type,s=e.corp_name,c=e.onOpen,l=e.className,u=void 0===l?"":l,d=e.style,p=e.gender,f=(0,Qe.useState)(!1),h=(0,Ul.Z)(f,2),m=h[0],g=h[1],v="".concat(m?kd.hover_btn:""," ").concat(kd.card,"\n        ").concat(n?kd.active:""," ").concat(u),_=r||"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZmlsbD0iIzRCOTVGMyIgZD0iTTAgMGg0MHY0MEgweiIvPjxwYXRoIGQ9Ik0zMS45ODkgMjkuMDQyYTEuNDY3IDEuNDY3IDAgMCAwLS4zMTUtLjI5MiAxLjc1OSAxLjc1OSAwIDAgMC0uMS0uMTA4IDUuNjQ4IDUuNjQ4IDAgMCAwLS4zMDQtLjI3N2MtLjI1LS4yMTYtLjYwOS0uNS0xLjA2LS44M2EzMS4wMTkgMzEuMDE5IDAgMCAwLTMuNzk4LTIuMzQ2Yy0xLjEzMy0uNTE3LTEuNzctLjk0NC0yLjE2Mi0xLjMyNy0uMzgtLjM3LS41NTUtLjcyMi0uNzI2LTEuMTZhMy4wMDUgMy4wMDUgMCAwIDEtLjE0OS0xLjYyIDMuMTkxIDMuMTkxIDAgMCAxIC4xODYtLjY0N2wuMDA3LS4wMTVjLjk1OC0xLjUyOCAxLjU0LTIuODMgMS43OS00LjI0OC4yNTEtMS40MjMuMTYyLTIuOTIzLS4xNTktNC44My0uNDY0LTIuNzcxLTIuOTctMy41NzUtNC40NTUtMy44MDVhLjUwNC41MDQgMCAwIDAtLjc0Ni0uMDJ2LjAwOC0uMDA3aC0uMDA3bC0uMDEzLS4wMDJhMy4xOTYgMy4xOTYgMCAwIDAtLjIwOC0uMDEyIDMuNjE0IDMuNjE0IDAgMCAwLS41MTQuMDE3Yy0xLjQ5My4yMy0zLjk2NiAxLjA1NC00LjQzIDMuODItLjMyIDEuOTA3LS40MTYgMy40MDItLjE3MiA0LjgyLjI0NCAxLjQxNi44MiAyLjcxNSAxLjc3OCA0LjI0M2wuMDA3LjAxNWEzLjE5MSAzLjE5MSAwIDAgMSAuMTg2LjY0NiAzLjAxMSAzLjAxMSAwIDAgMS0uMTQ5IDEuNjIyYy0uMTcuNDM3LS4zNDYuNzg5LS43MjYgMS4xNi0uMzkzLjM4My0xLjAyOS44MDktMi4xNjIgMS4zMjZhMzEuMDE0IDMxLjAxNCAwIDAgMC0zLjc5OCAyLjM0NmMtLjQ1MS4zMy0uODEuNjE0LTEuMDYuODNhNS42NTMgNS42NTMgMCAwIDAtLjMwNC4yNzdjLS4wMzUuMDM2LS4wNy4wNzItLjEuMTA4YTEuNDcxIDEuNDcxIDAgMCAwLS4zMTUuMjkyYy0uMTczLjIxNC0uMzM2LjUyMy0uNDI3Ljk2LS4xMDguNTIzLS4wOTEgMS4xMzItLjA2MiAxLjUzOC4wNDIuNTc4LjUzLjk3OCAxLjA3Ljk3OGgxMS4xNjNhLjUuNSAwIDAgMCAuMTI2LjAxNmgxMS41MjdjLjU0IDAgMS4wMjgtLjQgMS4wNy0uOTc4LjAzLS40MDYuMDQ2LTEuMDE1LS4wNjItMS41MzktLjA5LS40MzctLjI1NC0uNzQ1LS40MjctLjk1OXptLTguNDEyLTguNjQxem0tNy4xNTQtLjAxNnptLTcuNzYgOC43MjgtLjAwNi0uMDEyLjAwNy4wMTJ6IiBmaWxsPSIjZmZmIiBzdHJva2U9IiM0Qjk1RjMiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPjwvc3ZnPg==";return Ye().createElement("div",{className:v,onClick:function(e){return e.stopPropagation(),c(!1)},onTouchEnd:function(e){e.stopPropagation()},style:d},Ye().createElement("div",{className:kd.content},Ye().createElement(Od,{className:kd.avatar,size:40,radius:"5px",src:_}),Ye().createElement("div",{className:kd.info},Ye().createElement("div",{className:kd.title},o,1===a&&Ye().createElement("span",{className:kd.type,style:{color:"#ffb54d"}},"@",s),2===a&&Ye().createElement("span",{className:kd.type,style:{color:"#369746"}},"@",Dd("wechat"))),Ye().createElement("div",{className:kd.sub_title},i)),Ye().createElement("div",{className:kd.action},Ye().createElement(Id,{onClick:function(e){return e.stopPropagation(),c(!0)},onTouchEnd:function(e){e.stopPropagation()},type:"text-primary",onMouseOver:function(){return g(!0)},onMouseLeave:function(){return g(!1)}},Dd("contact",{context:p===$u.Male?"male":"female"})))))};!function(e,t){var n=function(n){Ld.getResource&&Ld.addResource&&Object.entries(e).forEach((function(e){var r=(0,Ul.Z)(e,2),o=r[0],i=r[1];Object.entries(i).forEach((function(e){var r=(0,Ul.Z)(e,2),i=r[0],a=r[1],s=null!=t?t:n.defaultNS||"legacy";Ld.getResource(o,s,i)||Ld.addResource(o,s,i,a)}))}))};Ld.isInitialized?n(Ld.options):Ld.on("initialized",n)}({"en-US":{"join-group":"Join","open-group":"Open Group",expired:"Expired",external:"External",contact:"Contact {{gender}}",contact_male:"Contact Him",contact_female:"Contact Her",wechat:"Wechat","view-caret":"View Caret"},"zh-CN":{"join-group":"加入群聊","open-group":"进入群聊",expired:"已过期",external:"外部",contact:"联系{{gender}}",contact_male:"联系他",contact_female:"联系她",wechat:"微信","view-caret":"查看名片"}});var Bd=n(234877),Ud=n(281976),Hd=(n(350154),function(e){var t=e.data,n=e.className,r=e.selected,o=e.status,i=t.iconurl,a=t.name,s=t.expire,c=t.external;return Ye().createElement("div",{className:n,style:{width:"".concat(fl,"px"),maxWidth:"100%"}},Ye().createElement(xd,{active:r,avatar:i,name:a,expiredTime:1e3*s,external:Boolean(c),status:o}))}),Wd=function(e){var t=e.className,n=e.layoutBox,r=e.children,o=ml({layoutBox:n}).fontSize;return Ye().createElement(hl,{className:t,fontSize:o,icon:Ye().createElement("svg",{viewBox:"0 0 20 21",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Ye().createElement("path",{d:"M0 6.27783C0 4.17764 0 3.12754 0.408726 2.32537C0.768251 1.61976 1.34193 1.04608 2.04754 0.686558C2.8497 0.277832 3.8998 0.277832 6 0.277832H14C16.1002 0.277832 17.1503 0.277832 17.9525 0.686558C18.6581 1.04608 19.2317 1.61976 19.5913 2.32537C20 3.12754 20 4.17764 20 6.27783V14.2778C20 16.378 20 17.4281 19.5913 18.2303C19.2317 18.9359 18.6581 19.5096 17.9525 19.8691C17.1503 20.2778 16.1002 20.2778 14 20.2778H6C3.8998 20.2778 2.8497 20.2778 2.04754 19.8691C1.34193 19.5096 0.768251 18.9359 0.408726 18.2303C0 17.4281 0 16.378 0 14.2778V6.27783Z",fill:"#4B95F3"}),Ye().createElement("path",{opacity:"0.6",d:"M13.9011 14.7778H16.809C16.9144 14.7778 16.9999 14.6924 16.9999 14.5869V14.298C16.9999 14.0893 16.8863 13.8971 16.7035 13.7964L14.1022 12.363C13.7646 12.1769 13.6926 11.7225 13.9563 11.4413C14.3231 11.0501 14.5271 10.534 14.5271 9.99777V9.30511C14.5271 8.46162 13.8434 7.77783 12.9999 7.77783C12.1564 7.77783 11.4726 8.46161 11.4726 9.3051V9.99777C11.4726 10.534 11.6767 11.0501 12.0434 11.4413C12.2819 11.6956 12.2459 12.0916 11.987 12.3027L13.226 12.9854C13.6648 13.2272 13.9374 13.6886 13.9374 14.1896V14.5278C13.9374 14.6147 13.9247 14.6986 13.9011 14.7778ZM9.01855 14.1528C9.05781 14.003 9.15689 13.8731 9.2962 13.7964L10.7019 13.0218L12.6227 14.0802C12.6515 14.096 12.6724 14.1223 12.6818 14.1528H9.01855Z",fill:"white"}),Ye().createElement("path",{d:"M13.0625 14.7778H3.25C3.11193 14.7778 3 14.6659 3 14.5278V14.1896C3 13.9163 3.14867 13.6647 3.38805 13.5328L6.73522 11.6884C7.17052 11.4485 7.26325 10.8628 6.92332 10.5002C6.45058 9.99596 6.1875 9.33067 6.1875 8.63948V7.74658C6.1875 6.65927 7.06894 5.77783 8.15625 5.77783C9.24356 5.77783 10.125 6.65927 10.125 7.74658V8.63948C10.125 9.33067 9.86192 9.99596 9.38918 10.5002C9.04925 10.8628 9.14198 11.4485 9.57728 11.6884L12.9245 13.5328C13.1638 13.6647 13.3125 13.9163 13.3125 14.1896V14.5278C13.3125 14.6659 13.2006 14.7778 13.0625 14.7778Z",fill:"white"}))},r)},jd=function(e){function t(n){var r=e.call(this,n)||this;r.isMobile=!1,r.mounted=!1,r.updateSelection=function(e){r.setState({selected:e})};var o=t.joinedCache.get(n.data.vcode);return r.state={selected:!1,status:o?Xu.Joined:Xu.Unjoined},r.hasJoin=r.hasJoin.bind(r),r.onConfirm=r.onConfirm.bind(r),r.handleClick=r.handleClick.bind(r),r.showToolbar=r.showToolbar.bind(r),r}var n;return(0,r.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;this.mounted=!0;var n=this.props.data;this.hasJoin().then((function(r){t.joinedCache.set(n.vcode,r),e.mounted&&e.setState({status:r?Xu.Joined:1e3*n.expire<Date.now()?Xu.Expired:Xu.Unjoined})}))},t.prototype.componentWillUnmount=function(){var e;this.mounted=!1,null===(e=this.loader.instance)||void 0===e||e.toggleToolbar({show:!1})},t.prototype.showToolbar=function(e){var t;null===(t=this.loader.instance)||void 0===t||t.toggleToolbar(e)},t.prototype.hasJoin=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return(0,r.__generator)(this,(function(r){return e=this.props,t=e.data,n=e.layoutBox,this.loader.instance?[2,this.loader.instance.checkIsJoined(t,this.props.editor.getIndexFromRange(n.getRange()))]:[2,!1]}))}))},t.prototype.onConfirm=function(){var e=this;return new Promise((function(t){if(!p.PlatformUtil.isWeWork()||e.isMobile)t(!0);else var n=e.props.data,r=Ae.default.confirm({type:"basic",title:null,content:Ye().createElement("div",null,Ye().createElement("span",{style:{display:"block",margin:"10px auto 20px"}},Ye().createElement(Od,{size:60,radius:"5px",src:n.iconurl})),Ye().createElement("div",{style:{fontWeight:500,fontSize:"18px",textAlign:"center"}},"".concat(n.name))),footer:Ye().createElement(Bd.default,{type:"primary",style:{display:"block",margin:"48px auto 0",borderRadius:"4px",width:"200px",height:"32px",fontSize:"14px"},onClick:function(){return t(!0)}},(0,j.$t)("card:join-group")),onOk:function(){r.close(),t(!0)},onCancel:function(){return t(!1)}})}))},t.prototype.handleClick=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,t;return(0,r.__generator)(this,(function(n){switch(n.label){case 0:return e=this.props.data,this.loader.instance?[4,this.hasJoin()]:[3,7];case 1:return n.sent()?[4,this.loader.instance.onOpen(e)]:[3,3];case 2:return n.sent(),[3,7];case 3:return[4,this.onConfirm()];case 4:return n.sent()?[4,this.loader.instance.onJoin(e)]:[3,7];case 5:return n.sent(),[4,this.hasJoin()];case 6:t=n.sent(),this.setState({status:t?Xu.Joined:Xu.Unjoined}),n.label=7;case 7:return[2]}}))}))},t.prototype.render=function(){var e,t=this.state,n=t.selected,r=t.status,o=this.props,i=o.data,a=o.editor,s=o.layoutBox,c=o.fieldInfo,l=o.children,u=i.layout;return e=(void 0===u?d.FieldDisplayLayoutTypeChar.Card:u)===d.FieldDisplayLayoutTypeChar.Inline?Ye().createElement(Wd,{layoutBox:s},l):Ye().createElement(Hd,{data:i,editor:a,layoutBox:s,fieldInfo:c,selected:n,status:r}),Ye().createElement(pl,{data:i,editor:a,layoutBox:s,field:c,onClick:this.handleClick,onShowToolbar:this.showToolbar,onSelect:this.updateSelection},e)},t.joinedCache=new Map,(0,r.__decorate)([(0,S.aN)(Ud.IFieldcodeWxworkGroupContactCardFeature),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==me.IDynamicLoader&&me.IDynamicLoader)?n:Object)],t.prototype,"loader",void 0),(0,r.__decorate)([(0,il.kR)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",void 0)],t.prototype,"componentWillUnmount",null),(0,r.__decorate)([(0,il.kR)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",void 0)],t.prototype,"showToolbar",null),(0,r.__decorate)([(0,il.nB)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"hasJoin",null),(0,r.__decorate)([(0,il.nB)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"handleClick",null),t}(Qe.Component),Gd=n(646932),Vd=function(e,t,n,r,o){var i,a=null===(i=t.fieldCode.instructions)||void 0===i?void 0:i[0],s=a&&(0,Gd.yD)(a,!0);return s?Ye().createElement(jd,{key:"field-trigger-".concat(n.uuid),editor:e,layoutBox:n,fieldInfo:t,data:s,overrideStyle:r,bridge:o},yl(n)):null},zd=(gc.zE.WxworkGroupContactCard,bl((function(e,t,n,r){var o=d.CssUtil.computeContainerStyles(n),i=Vd(e,t,n,o,r);return i?{element:i,overrideStyle:o}:null})),n(477874));n(350154);var Qd=function(e){var t=e.data,n=e.className,r=e.selected,o=e.onOpen,i=t.iconurl,a=t.name,s=t.position,c=t.gender,l=t.type,u=t.corp_name;return Ye().createElement("div",{className:n,style:{width:"".concat(fl,"px"),maxWidth:"100%"}},Ye().createElement(Fd,{active:r,avatar:i,name:a,gender:c,jobTitle:s,type:l,corp_name:u,onOpen:o}))},Yd=function(e){var t=e.className,n=e.layoutBox,r=e.children,o=ml({layoutBox:n}).fontSize;return Ye().createElement(hl,{className:t,fontSize:o,icon:Ye().createElement("svg",{viewBox:"0 0 20 21",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Ye().createElement("path",{d:"M0 6.5C0 4.3998 0 3.3497 0.408726 2.54754C0.768251 1.84193 1.34193 1.26825 2.04754 0.908726C2.8497 0.5 3.8998 0.5 6 0.5H14C16.1002 0.5 17.1503 0.5 17.9525 0.908726C18.6581 1.26825 19.2317 1.84193 19.5913 2.54754C20 3.3497 20 4.3998 20 6.5V14.5C20 16.6002 20 17.6503 19.5913 18.4525C19.2317 19.1581 18.6581 19.7317 17.9525 20.0913C17.1503 20.5 16.1002 20.5 14 20.5H6C3.8998 20.5 2.8497 20.5 2.04754 20.0913C1.34193 19.7317 0.768251 19.1581 0.408726 18.4525C0 17.6503 0 16.6002 0 14.5V6.5Z",fill:"#4B95F3"}),Ye().createElement("path",{d:"M15.5 15.5H4.5C4.36193 15.5 4.25 15.3881 4.25 15.25V15.0312C4.25 14.7665 4.38955 14.5213 4.6172 14.3862L8.4489 12.112C8.92321 11.8304 9.01521 11.1823 8.63797 10.7799C8.10253 10.2088 7.80455 9.45523 7.80455 8.67235V7.69545C7.80455 6.48294 8.78748 5.5 10 5.5C11.2125 5.5 12.1955 6.48294 12.1955 7.69545V8.67235C12.1955 9.45523 11.8975 10.2088 11.362 10.7799C10.9848 11.1823 11.0768 11.8304 11.5511 12.112L15.3828 14.3862C15.6104 14.5213 15.75 14.7665 15.75 15.0312V15.25C15.75 15.3881 15.6381 15.5 15.5 15.5Z",fill:"white"}))},r)},Zd=function(e){function t(t){var n=e.call(this,t)||this;return n.loading=!1,n.loadingTimer=0,n.handleClick=function(){n.props.data.layout===d.FieldDisplayLayoutTypeChar.Inline&&n.openDetail(!1)},n.updateSelection=function(e){n.setState({selected:e})},n.state={selected:!1},n.openDetail=n.openDetail.bind(n),n.showToolbar=n.showToolbar.bind(n),n}var n,o;return(0,r.__extends)(t,e),t.prototype.componentWillUnmount=function(){var e;window.clearTimeout(this.loadingTimer),null===(e=this.loader.instance)||void 0===e||e.toggleToolbar({show:!1})},t.prototype.openDetail=function(e){var t,n;return(0,r.__awaiter)(this,void 0,void 0,(function(){var o,i,a,s,c,l,u,d=this;return(0,r.__generator)(this,(function(r){return this.loading||(this.loading=!0,o=this.props,i=o.editor,a=o.data,s=o.layoutBox,null===(t=i.surface)||void 0===t||t.requestBlur(),c=this.cardService.getCardPosition(s),l=c.x,u=c.y,this.loadingTimer&&window.clearTimeout(this.loadingTimer),this.loadingTimer=window.setTimeout((function(){d.loadingTimer=0,d.loading&&(d.loading=!1)}),500),null===(n=this.loader.instance)||void 0===n||n.onOpen(a,e,l,u)),[2]}))}))},t.prototype.showToolbar=function(e){var t;null===(t=this.loader.instance)||void 0===t||t.toggleToolbar(e)},t.prototype.render=function(){var e,t=this.state.selected,n=this.props,r=n.data,o=n.editor,i=n.layoutBox,a=n.fieldInfo,s=n.children,c=r.layout;return e=(void 0===c?d.FieldDisplayLayoutTypeChar.Card:c)===d.FieldDisplayLayoutTypeChar.Inline?Ye().createElement(Yd,{layoutBox:i},s):Ye().createElement(Qd,{data:r,editor:o,layoutBox:i,fieldInfo:a,selected:t,onOpen:this.openDetail},s),Ye().createElement(pl,{data:r,editor:o,layoutBox:i,field:a,onClick:this.handleClick,onShowToolbar:this.showToolbar,onSelect:this.updateSelection},e)},(0,r.__decorate)([(0,S.aN)(zd.IFieldcodeWxworkMemberContactCardFeature),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==me.IDynamicLoader&&me.IDynamicLoader)?n:Object)],t.prototype,"loader",void 0),(0,r.__decorate)([(0,S.tB)(),(0,r.__metadata)("design:type","function"==typeof(o=void 0!==Nl&&Nl)?o:Object)],t.prototype,"cardService",void 0),(0,r.__decorate)([(0,il.kR)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",void 0)],t.prototype,"componentWillUnmount",null),(0,r.__decorate)([(0,il.nB)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Boolean]),(0,r.__metadata)("design:returntype",Promise)],t.prototype,"openDetail",null),(0,r.__decorate)([(0,il.kR)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",void 0)],t.prototype,"showToolbar",null),t}(Qe.Component),Kd=n(356815),Jd=function(e,t,n,r,o){var i,a=null===(i=t.fieldCode.instructions)||void 0===i?void 0:i[0],s=a&&(0,Kd.TK)(a,!0);return s?Ye().createElement(Zd,{editor:e,layoutBox:n,fieldInfo:t,data:s,overrideStyle:r,bridge:o},yl(n)):null},qd=(gc.zE.WxworkMemberContactCard,bl((function(e,t,n,r,o){var i=El(o,n),a=Jd(e,t,n,i,r);return a?{element:a,overrideStyle:i}:null})),n(458524)),Xd=(0,p.pxToTwips)(62),$d=(0,p.pxToTwips)(446),ep=(0,p.pxToTwips)(62),tp=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isAutoUpdate=!1,t.isShowDropdowns=!1,t.isShowHover=!1,t}return(0,r.__extends)(t,e),t.prototype.canFocusInField=function(e){return!1},t.prototype.getFieldLayoutType=function(e){var t=(0,$c.yS)(e);return(null==t?void 0:t.displayLayoutType)===d.FieldDisplayLayoutTypeChar.Text?d.FieldDisplayLayoutTypeChar.Inline:(null==t?void 0:t.displayLayoutType)||d.FieldDisplayLayoutTypeChar.Inline},t.prototype.getFieldHeight=function(e){var t=this.getFieldLayoutType(e),n=e&&(0,$c.yS)(e);return t===d.FieldDisplayLayoutTypeChar.Card?Xd:t===d.FieldDisplayLayoutTypeChar.Preview?(null==n?void 0:n.classify)===qd.FY.AUDIO?ep:$d:void 0},t.prototype.getPluginContainerFitRule=function(t){return this.getFieldLayoutType(t)===d.FieldDisplayLayoutTypeChar.Inline?e.prototype.getPluginContainerFitRule.call(this,t):{fitToParentWidth:!0,fitToParentHeight:!1}},t}(d.FieldCodeProcessor),np=n(718857),rp=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,r.__extends)(t,e),t.prototype.getFieldLayoutType=function(e){var t,n=null===(t=e.instructions)||void 0===t?void 0:t[0];if(n){var r=(0,rl.bB)(n,!0);if(null==r?void 0:r.layout)return r.layout}return d.FieldDisplayLayoutTypeChar.Card},t.prototype.getFieldHeight=function(){return(0,p.pxToTwips)(292)},t.prototype.getFieldWidth=function(){return(0,p.pxToTwips)(252)}}(np.A),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,r.__extends)(t,e),t.prototype.parse=function(){return""},t.prototype.getFieldLayoutType=function(e){var t,n=null===(t=e.instructions)||void 0===t?void 0:t[0];if(n){var r=(0,wl.ph)(n,!0);if(null==r?void 0:r.layout)return r.layout}return d.FieldDisplayLayoutTypeChar.Card},t.prototype.getFieldHeight=function(t){var n,r,o,i=null!==(r=null===(n=t.instructions)||void 0===n?void 0:n[0])&&void 0!==r?r:"";return e.prototype.getFieldHeight.call(this,t)||(null===(o=(0,wl.ph)(i,!0))||void 0===o?void 0:o.height)||(0,p.pxToTwips)(106)},t.prototype.getFieldWidth=function(){return(0,p.pxToTwips)(422)}}(Al),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,r.__extends)(t,e),t.prototype.parse=function(){return""},t.prototype.getFieldLayoutType=function(e){var t,n=null===(t=e.instructions)||void 0===t?void 0:t[0];if(n){var r=(0,Zu.J2)(n,!0);if(null==r?void 0:r.layout)return r.layout}return d.FieldDisplayLayoutTypeChar.Card},t.prototype.getFieldHeight=function(t){var n,r,o,i=null!==(r=null===(n=t.instructions)||void 0===n?void 0:n[0])&&void 0!==r?r:"";return e.prototype.getFieldHeight.call(this,t)||(null===(o=(0,Zu.J2)(i))||void 0===o?void 0:o.height)||(0,p.pxToTwips)(106)}}(Al),function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isAutoUpdate=!1,t.isShowDropdowns=!1,t.isShowHover=!1,t}(0,r.__extends)(t,e),t.prototype.getFieldLayoutType=function(e){var t,n=null===(t=e.instructions)||void 0===t?void 0:t[0];if(n){var r=(0,ud.Bf)(n,!0);if(null==r?void 0:r.layout)return r.layout}return d.FieldDisplayLayoutTypeChar.Card}}(Al),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,r.__extends)(t,e),t.prototype.getFieldLayoutType=function(){return d.FieldDisplayLayoutTypeChar.Card},t.prototype.getFieldHeight=function(){return(0,p.pxToTwips)(40)},t.prototype.getFieldWidth=function(){return(0,p.pxToTwips)(200)}}(np.A),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,r.__extends)(t,e),t.prototype.getFieldLayoutType=function(e){var t,n=null===(t=e.instructions)||void 0===t?void 0:t[0];if(n){var r=(0,Gd.yD)(n,!0);if(null==r?void 0:r.layout)return r.layout}return d.FieldDisplayLayoutTypeChar.Card},t.prototype.getFieldHeight=function(){return(0,p.pxToTwips)(62)},t.prototype.getFieldWidth=function(){return(0,p.pxToTwips)(fl)}}(np.A),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,r.__extends)(t,e),t.prototype.getFieldLayoutType=function(e){var t,n=null===(t=e.instructions)||void 0===t?void 0:t[0];if(n){var r=(0,Kd.TK)(n,!0);if(null==r?void 0:r.layout)return r.layout}return d.FieldDisplayLayoutTypeChar.Card},t.prototype.getFieldHeight=function(){return(0,p.pxToTwips)(62)},t.prototype.getFieldWidth=function(){return(0,p.pxToTwips)(fl)}}(np.A),n(463460)),op={tag:"svg",attrs:{viewBox:"0 0 11 11",width:"1em",height:"1em"},children:[{tag:"g",attrs:{id:"Icon/1-Common/checkmark-11",fill:"none",stroke:"none",fillRule:"evenodd",strokeWidth:1},children:[{tag:"path",attrs:{id:"path备份",fill:"currentColor",d:"M9.46 1.28a.75.75 0 011.24.85l-.06.09-6 7.5a.75.75 0 01-1.04.13l-.08-.07-3-3a.75.75 0 01.98-1.13l.08.07 2.4 2.4 5.48-6.84z"}}]}]},ip=(0,Qe.forwardRef)((function(e,t){return(0,Qe.createElement)(rp.A,Object.assign({},e,{id:"checkmark-11",ref:t,icon:op}))}));ip.displayName="Checkmark11";var ap=ip,sp="tdocs-mention-weixin-component",cp="tdocs-mention-weixin-component-disable",lp=n(700702),up=n(700419),dp=n(413182),pp=function(e){function t(t){var n=e.call(this,t)||this;return n.isTouching=!1,n.handleFieldClick=function(e){var t,r=n.props,o=r.editor,i=r.layoutBox;if(o.isEditable()&&3!==e.nativeEvent.which){var a=n.props.fieldInfo,s=(null!=a?a:{}).fieldCode;if(s&&a){var l=null===(t=s.instructions)||void 0===t?void 0:t[3],u=(0,c.Yi)().globalPadId;if(!l||l===u){var p=n.fieldService.convertToFieldCodeInfo(a),f=d.FieldCodeManager.getInstance().getFieldProcessorByFieldCodeInfo(p);f&&f.handleFieldClick(p,i)}}}},n.handleTouchEnd=function(e){n.isTouching&&n.handleFieldClick(e)},n.onListTodoUpdate=function(e){var t,r,o,i,a=e.todoItem,s=n.props.layoutBox,c=n.findTaskInfo(s);if(c&&c.taskId===a.id){var l=(null!==(r=null===(t=n.props)||void 0===t?void 0:t.fieldInfo)&&void 0!==r?r:{}).fieldCode,u=null===(o=null==l?void 0:l.instructions)||void 0===o?void 0:o[1],d=u&&(null===(i=a.followList)||void 0===i?void 0:i.get(u));if(d){var p=d.flag===up.wL.DONE;p!==n.state.isDone&&n.setState({isDone:p})}}},n.onTouchStart=function(e){e.stopPropagation(),n.isTouching=!0},n.onTouchMove=function(e){e.stopPropagation(),n.isTouching=!1},n.onMouseDown=function(e){p.PlatformUtil.isTencentDocsIPadApp()&&(e.stopPropagation(),e.cancelable&&e.preventDefault())},n.onDoubleClick=function(e){return function(){n.workbenchEventEmitter.emit(lp.yr.UnDoSendNotice,e)}},n.decorateTextWrapper=function(e){return n.props.editor.docEnv.renderType!==d.RenderType.Canvas?n.decorateLiteText(e[0]):n.decorateText(e)},n.decorateText=function(e){return e.map((function(e){if(!e||!n.state.isDone)return e;var t=e.props,r={position:"relative",top:"2px",fontSize:"".concat(t.style.fontSize.replace("pt","")/1.2,"pt"),marginRight:"2px"},o=t.children.substr(1);return Ye().cloneElement(e,{},Ye().createElement(Ye().Fragment,null,Ye().createElement(ap,{style:r}),o))}))},n.decorateLiteText=function(e){return e.map((function(e){if(!e)return e;var t=e.props,r=t.layoutBox.property.fontSize,o=e.props.layoutBox.text;if(!n.state.isDone)return Ye().createElement("span",{key:t.layoutBox.uuid,style:{lineHeight:"".concat((0,p.twipsToPt)(r)+1,"pt")}},e);var i=[],a={position:"relative",top:"2px",color:"#175CEB",fontSize:"".concat((0,p.twipsToPt)(r)-1,"pt"),marginRight:"2px"};return e.props.layoutBox.text=o.replace("@",""),i.push(Ye().createElement(ap,{style:a})),i.push(e),Ye().createElement("span",{key:o,style:{lineHeight:"".concat((0,p.twipsToPt)(r)+1,"pt")}},i)}))},n.rootRef=Ye().createRef(),n.state={showBackground:!1,isAutoUpdate:!1,isDone:!1},n}var n,o;return(0,r.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this.props.editor;null==e||e.on(dp.o.ON_UPDATE,this.onListTodoUpdate)},t.prototype.componentWillUnmount=function(){var e=this.props.editor;null==e||e.removeCallBack(dp.o.ON_UPDATE,this.onListTodoUpdate)},t.prototype.findTaskInfo=function(e){for(var t,n=e;n;){if((0,d.isParagraphBox)(n)||(0,d.isParagraphBoxLite)(n)){var r=(0,d.isParagraphBox)(n)?n.property.taskPr:null===(t=n.property)||void 0===t?void 0:t.taskPr;return r?{taskState:r.taskState,taskId:r.taskId}:null}n=n.parentBox}return null},t.prototype.render=function(){var e,t,n,o=this,i=this.props,a=i.children,s=i.overrideStyle,l=i.fieldInfo,u=(null!=l?l:{}).fieldCode,f="",h=!1;if(u){f=null!==(t=null===(e=u.instructions)||void 0===e?void 0:e[0])&&void 0!==t?t:"";var m=null===(n=u.instructions)||void 0===n?void 0:n[3],g=(0,c.Yi)().globalPadId;m&&m!==g&&(h=!0)}var v=this.decorateTextWrapper(a);return Ye().createElement("span",{id:f,style:(0,r.__assign)({cursor:p.PlatformUtil.isWeWork()?"pointer":void 0,background:this.state.showBackground?"#d1e6fc":void 0},d.CssUtil.cssPropsToStyle(s)),onMouseUp:function(e){return o.handleFieldClick(e)},onTouchEnd:function(e){return o.handleTouchEnd(e)},onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart,onTouchMove:this.onTouchMove,className:"".concat(h?cp:sp),onDoubleClick:this.onDoubleClick(f),ref:this.rootRef},v)},(0,r.__decorate)([(0,S.tB)(),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==pt.v&&pt.v)?n:Object)],t.prototype,"workbenchEventEmitter",void 0),(0,r.__decorate)([(0,S.tB)(),(0,r.__metadata)("design:type","function"==typeof(o=void 0!==Ks.D&&Ks.D)?o:Object)],t.prototype,"fieldService",void 0),t}(Qe.Component),fp={"mention-qq-component":"tdocs-mention-qq-component",mentionQqComponent:"tdocs-mention-qq-component","mention-qq-component-disable":"tdocs-mention-qq-component-disable",mentionQqComponentDisable:"tdocs-mention-qq-component-disable"},hp=n(252038),mp=n(505586),gp=function(e){function t(t){var n=e.call(this,t)||this;return n.defaultStyle={paddingLeft:5,marginLeft:1,paddingRight:8,marginRight:2},n.handleFieldClick=function(e){var t,r,o=n.props,i=o.layoutBox,a=o.editor,s=n.props.fieldInfo,l=(null!=s?s:{}).fieldCode;if(l&&s){var u=(0,c.Yi)().globalPadId,p=null===(t=l.instructions)||void 0===t?void 0:t[3];if((!p||p===u)&&a.docEnv.docViewType!==d.DocViewType.RecordPreview&&(!(a instanceof d.MeloEditor&&a.isRestrictProtectOn)||(null===(r=a.state)||void 0===r?void 0:r.getRestrictEdit().checkPermissionRangeByGcpRange(null==i?void 0:i.getRange())))){var f=n.fieldService.convertToFieldCodeInfo(s),h=d.FieldCodeManager.getInstance().getFieldProcessorByFieldCodeInfo(f);h&&h.handleFieldClick(f,i,e)}}},n.onTouchStart=function(e){e.stopPropagation()},n.onMouseDown=function(e){p.PlatformUtil.isTencentDocsIPadApp()&&(e.stopPropagation(),e.cancelable&&e.preventDefault())},n.rootRef=Ye().createRef(),n.ellipsisFormatter=new hp.J,n.state={showBackground:!1,isAutoUpdate:!1},n}var n,o;return(0,r.__extends)(t,e),t.prototype.calcMentionMaxWidthInTable=function(e,t){var n=-1,r=this.defaultStyle,o=r.paddingLeft+r.paddingRight+r.marginLeft+r.marginRight;if(e.renderType===d.RenderType.Canvas&&(0,d.isFieldBox)(t)){var i=t.getAncestorOf(d.BoxKind.TableCell);i&&(n=(0,p.twipsToPx)(i.totalWidth)-o)}else e.renderType===d.RenderType.Lite&&(0,d.isFieldBoxLite)(t)&&mp.S.isInLiteTableCell(t)&&(n=mp.S.calcLiteBoxMaxWidth(t,this.defaultStyle));return n},t.prototype.tableOverrideStyle=function(e,t){if(!t||!e)return{};var n=this.defaultStyle.paddingRight,r=this.calcMentionMaxWidthInTable(e,t);return r>0?{maxWidth:r,paddingRight:r<n?r-1:n}:{}},t.prototype.tableOverrideChildrenContent=function(e,t,n){var r,o;if(!(e&&t&&n&&Array.isArray(t)))return t;var i=null===(r=t.filter((function(e){var t,n;return"string"==typeof(null===(t=null==e?void 0:e.props)||void 0===t?void 0:t.children)&&0===(null===(n=null==e?void 0:e.props)||void 0===n?void 0:n.children.indexOf("@"))}))[0])||void 0===r?void 0:r.props.children;if(!i)return t;var a=this.calcMentionMaxWidthInTable(e,n);if(a>0){var s=t[0],c=s?null===(o=null==s?void 0:s.props)||void 0===o?void 0:o.style:void 0;return Ye().createElement("span",{key:"0",style:c?{color:c.color,textDecoration:c.textDecoration}:void 0},this.ellipsisFormatter.wrapLine(i,a,1,{classname:fp["mention-qq-component-font"]},"..."))}return t},t.prototype.render=function(){var e,t,n,o=this,i=this.props,a=i.children,s=i.overrideStyle,l=i.layoutBox,u=i.editor,p=i.fieldInfo,f=u.docEnv,h="",m=this.tableOverrideStyle(f,l),g=!1,v=(null!=p?p:{}).fieldCode;if(v){h=null!==(t=null===(e=v.instructions)||void 0===e?void 0:e[0])&&void 0!==t?t:"";var _=null===(n=v.instructions)||void 0===n?void 0:n[3],y=(0,c.Yi)().globalPadId;_&&_!==y&&(g=!0)}return Ye().createElement("span",{id:h,style:(0,r.__assign)((0,r.__assign)({background:this.state.showBackground?"#d1e6fc":void 0},d.CssUtil.cssPropsToStyle(s)),m),onMouseUp:function(e){return o.handleFieldClick(e)},onTouchEnd:function(e){return o.handleFieldClick(e)},onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart,className:"".concat(g?fp["mention-qq-component-disable"]:fp["mention-qq-component"]),ref:this.rootRef},this.tableOverrideChildrenContent(f,a,l))},(0,r.__decorate)([(0,S.tB)(),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==pt.v&&pt.v)?n:Object)],t.prototype,"workbenchEventEmitter",void 0),(0,r.__decorate)([(0,S.tB)(),(0,r.__metadata)("design:type","function"==typeof(o=void 0!==Ks.D&&Ks.D)?o:Object)],t.prototype,"fieldService",void 0),t}(Qe.Component),vp=function(e,t){return function(n){var o=n.fieldInfo,i=n.ctx,a=n.box,s=n.cssStyle,c=n.editor,l=(0,d.makeFrame)(0,0,a.totalWidth,a.totalHeight);if((0,d.isValidRegion)(l)){var u=(0,Xs.Vo)(i,a),p=a.children.map((function(e){return e.hidden?null:Ye().createElement("span",{key:e.uuid,className:"melo-leaf",style:(0,r.__assign)((0,r.__assign)((0,r.__assign)({},null==t?void 0:t(e)),d.CssUtil.cssPropsToStyle(d.CssUtil.computeStyles(e).cssProperties)),{verticalAlign:"baseline"})},(0,d.isTextBox)(e)?e.textString():"")})),f=d.PoolNodeFactory.obtain(d.IComponentView,a.uuid,l,Ye().createElement(e,{editor:c,layoutBox:a,fieldInfo:o,renderCanvas:!0,overrideStyle:s},p),u);i.addView(f)}}},_p={decorator:{decoratorCallback:function(e){return function(t){var n=t.children,r=t.box,o=t.fieldInfo;return{component:Ye().createElement(gp,{editor:e,layoutBox:r,fieldInfo:o},n),overrideStyle:{lineHeight:"20px"}}}}},modelWrapper:function(e){return function(t){var n=6,r=e.docEnv,o=(null==r?void 0:r.uniqueId)||"",i=t.fieldCode;i.instructions[3]&&i.instructions[3]!==o&&(n=2);var a=function(e){var t=e.fieldResultProp,n=new(d.PropertyFactory.getPropertyClass(d.PropertyType.RunProperty));return t&&(n.diff=t.diff),n.color.val=d.Defaults.mentionColor,n.rFonts=t.rFonts.clone(),n}(t);return{metric:{padding:{before:0,start:(0,p.pxToTwips)(4),after:0,end:(0,p.pxToTwips)(n)}},fieldResultProp:a}}},draw:vp(gp,(function(e){return{lineHeight:"20px"}}))},yp={decorator:{decoratorCallback:function(e){return function(t){var n=t.children,r=t.box,o=t.fieldInfo;return{component:Ye().createElement(pp,{editor:e,layoutBox:r,fieldInfo:o},n),overrideStyle:{}}}}},modelWrapper:function(e){return function(e){var t=function(e){var t=e.fieldResultProp,n=new(d.PropertyFactory.getPropertyClass(d.PropertyType.RunProperty));return t&&(n.diff=t.diff),n.color.val=d.Defaults.mentionColor,n.sz=t.sz,n}(e);return{metric:{padding:{before:0,start:(0,p.pxToTwips)(2),after:0,end:(0,p.pxToTwips)(2)}},fieldResultProp:t}}},draw:vp(pp,(function(e){return{paddingBottom:"".concat(Math.round((0,p.twipsToPx)(e.totalHeight)/8),"px")}}))},bp={draw:function(e){var t,n,o=e.fieldInfo,i=e.ctx,a=e.box,s=e.cssStyle,c=1,l=1,u=d.STNumberFormat.PBDEFAULT,p=a.getAncestorOf(d.BoxKind.Page);if((0,d.isPageBox)(p)){c=p.pageNumber,l=null!==(n=null===(t=p.parentBox)||void 0===t?void 0:t.children.length)&&void 0!==n?n:1;var f=p.getFirstDescendantOf(d.BoxKind.Section,(function(e){return e.firstVisibleChild}));f&&(u=f.property.pgNumType.fmt)}var h={pageNum:c,pageCount:l,pageNumFormat:u},m=a.subType===d.FieldName.NUM_PAGES?"".concat(l):Kc.Y.parseFieldCodeSwitches(o.fieldCode.switches,h),g=-1,v=a.children.find((function(e,t){return!(e instanceof d.TextFieldCharBox)&&e instanceof d.TextBox&&(g=t,!0)}));if(v instanceof d.TextBox&&g>=0){v.text=m;var _=(0,d.makeFrame)(0,a.ascent,a.totalWidth,a.totalHeight),y=(0,Xs.Vo)(i,a),b=d.CssUtil.computeStyles(v).cssProperties,E={uuid:a.uuid},C=(0,r.__assign)((0,r.__assign)((0,r.__assign)({},s),y),b),w=d.PoolNodeFactory.obtain(d.ITextView,_,v.text,E,C);i.addView(w)}}},Ep=n(628199),Cp=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isAutoUpdate=!0,t.isShowDropdowns=!1,t.isShowHover=!1,t}(0,r.__extends)(t,e),t.prototype.getFieldLayoutText=function(e,t){var n,r,o=null!==(r=null===(n=e.instructions)||void 0===n?void 0:n[0])&&void 0!==r?r:"",i=(0,Ep.kz)(o,!0);return i?(0,Ep.hC)(i):"parseDateReminderFailed"}}(d.FieldCodeProcessor),n(745386)),wp=n(787087),Tp=n(912571),Ap=n(327297),Sp=n.n(Ap);function Ip(e){var t=Sp()(+new Date),n=e.timestamp,r=e.notify,o=e.fullDay;return e.repeat===wp.cm.NEVER&&function(e,t){var n=Sp()(e);return t===wp.Ov.FIVE_MINUTES_BEFORE?n=n.subtract(5,"minute"):t===wp.Ov.FIFTEEN_MINUTES_BEFORE?n=n.subtract(15,"minute"):t===wp.Ov.ONE_HOUR_BEFORE?n=n.subtract(60,"minute"):t===wp.Ov.ONE_DAY_BEFORE||t===wp.EG.ONE_DAY?n=n.subtract(1,"day"):t===wp.EG.TWO_DAYS?n=n.subtract(2,"day"):t===wp.EG.ONE_WEEK&&(n=n.subtract(1,"week")),n}(n,r).isBefore(t,o?"day":"minute")}function Rp(e){if(e){if(e.status===wp.QM.Disabled)return"rgba(0,0,0, 0.5)";if(Ip(e))return"#F27F4E"}return"#3376D8"}function Mp(){return Ye().createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1.3em",height:"1.3em",viewBox:"0 0 24 24"},Ye().createElement("g",{fill:"none",fillRule:"evenodd"},Ye().createElement("g",{fill:"currentColor"},Ye().createElement("g",null,Ye().createElement("path",{d:"M11.5 5c4.143 0 7.5 3.36 7.5 7.5 0 4.14-3.357 7.5-7.5 7.5S4 16.64 4 12.5C4 8.36 7.357 5 11.5 5zm.8 4H11v4h4v-1.3h-2.7V9zm4.699-5L20 7.013 19.001 8 16 4.987 16.999 4zM6 4L7 4.987 3.999 8 3 7.013 6.001 4z",transform:"translate(-88.000000, -439.000000) translate(88.000000, 439.000000)"})))))}function Op(e){var t=function(){var t,n,r,o,i,a,s,c,l,u,f=e.layoutBox;return(0,d.isFieldBox)(f)?{fontSize:(0,p.twipsToPx)((null===(n=null===(t=f.content)||void 0===t?void 0:t.textStyle)||void 0===n?void 0:n.renderFontSize)||0),fontFamily:(null===(o=null===(r=f.content)||void 0===r?void 0:r.textStyle)||void 0===o?void 0:o.fontFamily)||d.Defaults.fontFamily,text:null===(i=f.content)||void 0===i?void 0:i.text}:{fontSize:(0,p.twipsToPx)(null===(s=null===(a=f.content)||void 0===a?void 0:a.property)||void 0===s?void 0:s.renderFontSize),fontFamily:(null===(l=null===(c=f.content)||void 0===c?void 0:c.property)||void 0===l?void 0:l.fontFamily)||d.Defaults.fontFamily,text:null===(u=f.content)||void 0===u?void 0:u.text}}(),n=t.fontSize,o=t.fontFamily,i=t.text,a=e.layoutBox,s=e.dateReminder,c=e.overrideStyle,l=function(e){return e.stopPropagation()},u=(0,r.__read)((0,Qe.useState)(void 0),2),f=u[0],h=u[1],m=(0,r.__assign)({padding:"0px ".concat(2,"px"),margin:"0px ".concat(2,"px"),fontSize:"".concat(n,"px"),color:Rp(f),fontFamily:o},d.CssUtil.cssPropsToStyle(c)),g=function(t){var n=function(){if(e.bridge){var t=e.bridge,n=t.instance,r=t.bridgeKey;return n.get(r)}}();null==n||n.onTap(s,a.content)};(0,Qe.useEffect)((function(){var t=function(){var t;null===(t=e.bridge)||void 0===t||t.instance.sendAction(e.bridge.bridgeKey,{type:Tp.k.DATA_CALLBACK,data:{dataCallback:function(e){var t=e.getDraftItem(s);t?h(t):setTimeout((function(){e.itemLoader(s,!1,!1).then((function(e){e&&h(e)}))}),500)}}},!0,!0)},n=function(e){e.reminderId===s.id&&t()};return e.editor.on(wp._E,n),t(),function(){e.editor.removeCallBack(wp._E,n)}}),[]);var v=Ye().createElement("span",{className:"melo-date-reminder ".concat("pc"),onMouseDown:l,onMouseUp:function(e){3!==e.nativeEvent.which&&g()},onTouchStart:l,onTouchEnd:function(){return g()},style:m},Ye().createElement("span",{className:"date-reminder-icon-wrapper"},Ye().createElement(Mp,null)),Ye().createElement("span",{className:"date-reminder-text-wrapper",style:{paddingLeft:"".concat(1.3*n,"px")}},i)),_="";if(f){if(Ip(f))_="提醒已过期";else if(f.remindAll||f.reminderUsers&&f.reminderUsers.length>0){var y="";y=f.remindAll?"所有人":"[".concat(f.reminderUsers.map((function(e){return e.name})).slice(0,2).join("、")).concat(f.reminderUsers.length>2?" 等人":"","]"),_="提醒".concat(y),f.repeat!==wp.cm.NEVER&&(_+=", ".concat(wp.lv.get(f.repeat),"重复"))}}else _="尚未设置提醒";return _&&!e.editor.docEnv.isSSR?Ye().createElement(wc.u,{placement:"top",title:_,style:{maxWidth:"100%",overflow:"hidden"}},v):Ye().createElement("div",{style:{maxWidth:"100%",overflow:"hidden",display:"flex"}},v)}!function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n,o;(0,r.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;t.processed||(t.processed=!0,be.qO.getInstance().isEditable?this.loadFeature():this.eventEmitter.listenOnce("$editableChanged",(function(t){t&&e.loadFeature()})))},t.prototype.loadFeature=function(){},t.prototype.render=function(){return Ye().createElement(Op,(0,r.__assign)({},this.props))},t.processed=!1,(0,r.__decorate)([(0,S.aN)(Cp.IFieldcodeDateHandler),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==me.IDynamicLoader&&me.IDynamicLoader)?n:Object)],t.prototype,"fieldCodeDateLoader",void 0),(0,r.__decorate)([(0,S.tB)(),(0,r.__metadata)("design:type","function"==typeof(o=void 0!==pt.v&&pt.v)?o:Object)],t.prototype,"eventEmitter",void 0),(0,r.__decorate)([(0,il.kR)("fieldCodeDateLoader"),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[]),(0,r.__metadata)("design:returntype",void 0)],t.prototype,"loadFeature",null)}(Qe.Component);var Np,kp,Lp=(gc.zE.DateReminder,function(){function e(){}var t,n;return e.prototype.$onEditorOpen=function(e){this.initFirstRenderConfig(),this.editorCloseCallback=this.fieldRenderService.initializeField(e,!0),this.editor=e},e.prototype.initFirstRenderConfig=function(){this.initAttachment(),this.initHyperlinkConfig(),this.initMention(),this.initPageName(),this.initEnterpriseFeature()},e.prototype.initHyperlinkConfig=function(){this.fieldService.addFieldRenderConfig({name:d.FieldName.HYPERLINK,processor:new Zc,render:Vc}),this.fieldService.addFieldRenderConfig({name:d.FieldName.HYPERLINK,subtype:Js.m7.DocLink,processor:new Zc,render:Gc}),this.fieldService.addFieldRenderConfig({name:d.FieldName.HYPERLINK,subtype:Js.m7.NormalLink,processor:new Zc,render:Vc}),this.fieldService.addFieldRenderConfig({name:d.FieldName.HYPERLINK,subtype:Js.m7.AddonLink,processor:new Zc,render:zc})},e.prototype.initPageName=function(){this.fieldService.addFieldRenderConfig({name:d.FieldName.PAGE,processor:new Kc.Y(this.editor),render:bp}),this.fieldService.addFieldRenderConfig({name:d.FieldName.NUM_PAGES,processor:new Jc,render:bp})},e.prototype.initAttachment=function(){this.fieldService.addFieldRenderConfig({name:d.FieldName.ATTACHMENT,processor:new tp,render:nl})},e.prototype.initEnterpriseFeature=function(){},e.prototype.initMention=function(){this.fieldService.addFieldRenderConfig({name:d.FieldName.MENTION_QQ,render:_p}),this.fieldService.addFieldRenderConfig({name:d.FieldName.MENTION_WXWORK,render:yp})},e.prototype.$onEditorClose=function(){var e;null===(e=this.editorCloseCallback)||void 0===e||e.call(this)},(0,r.__decorate)([(0,S.tB)(),(0,r.__metadata)("design:type","function"==typeof(t=void 0!==Zs.o&&Zs.o)?t:Object)],e.prototype,"fieldRenderService",void 0),(0,r.__decorate)([(0,S.tB)(),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==Ks.D&&Ks.D)?n:Object)],e.prototype,"fieldService",void 0),e=(0,r.__decorate)([(0,Vs.L)({name:ko.C.FieldRender,adapters:["melo","mobilePagedView"]})],e)}()),Dp=n(751729),Pp=n(90236);!function(e){e.MARK="mark",e.LIFE_CYCLE="lifeCycle",e.RESOURCE="resource",e.CGI="cgi",e.IMG="img",e.MEASURE="measure"}(Np||(Np={})),function(e){e.LCP="LCP",e.TTI="TTI",e.TTE="TTE",e.HTML="html",e.HTML_TTFB="html-ttfb",e.OPEN_DOC="opendoc",e.PAGE_LOAD_FINISHED="PAGE_LOAD_FINISHED",e.ENTRY_START="entryStart",e.CLICK_START="clickStart",e.NAVIGATION_START="navigationStart",e.CLIENT_SIDE_RENDER_END="clientSideRenderEnd",e.SERVER_SIDE_RENDER_END="serverSideRenderEnd",e.FIRST_REAL_RENDER_END="firstRealRenderEnd",e.DOCUMENT_EDITABLE="documentEditable"}(kp||(kp={}));var xp,Fp={xmlhttprequest:Np.CGI,img:Np.IMG,script:Np.RESOURCE,link:Np.RESOURCE},Bp=[window.location.host];!function(e){e[e.low=0]="low",e[e.high=1]="high"}(xp||(xp={}));var Up=[{name:"https://".concat(window.location.host,"/dop-api/opendoc"),alias:"opendoc",weight:xp.high}],Hp="1"===(0,p.getUrlParameter)("alloyperf"),Wp=function(){function e(e,t,n,r,o){var i,a;this.name=e,this.entryType=t,this.startTime=n,this.duration=r,this.alias=null!==(i=null==o?void 0:o.alias)&&void 0!==i?i:this.autoGenerateAlias(e),this.weight=null!==(a=null==o?void 0:o.weight)&&void 0!==a?a:xp.low,this.decodedBodySize=null==o?void 0:o.decodedBodySize,this.encodedBodySize=null==o?void 0:o.encodedBodySize,this.transferSize=null==o?void 0:o.transferSize}return Object.defineProperty(e.prototype,"endTime",{get:function(){return this.startTime+this.duration},enumerable:!1,configurable:!0}),e.prototype.setEndTime=function(e){this.duration=e-this.startTime},e.prototype.toJSON=function(){var e,t,n,r,o;return{name:null!==(e=this.name)&&void 0!==e?e:this.alias,alias:null!==(t=this.alias)&&void 0!==t?t:this.name,entryType:this.entryType,startTime:this.startTime,endTime:this.startTime+this.duration,duration:this.duration,weight:this.weight,decodedBodySize:null!==(n=this.decodedBodySize)&&void 0!==n?n:0,encodedBodySize:null!==(r=this.encodedBodySize)&&void 0!==r?r:0,transferSize:null!==(o=this.transferSize)&&void 0!==o?o:0}},e.prototype.autoGenerateAlias=function(e){var t=e;switch(this.entryType){case Np.RESOURCE:(n=e.lastIndexOf("/"))>0&&(t=e.substring(n+1)),t=this.generateMaxLengthAlias(t);break;case Np.CGI:case Np.IMG:var n;(n=e.lastIndexOf("?"))>0&&(t=e.substring(0,n))}return t},e.prototype.generateMaxLengthAlias=function(e){var t=e.split("~");if(e.length>50&&t.length>0){for(var n=t[t.length-1],r=t.length-2;r>=0&&!(n.length+t[r].length>50);r--)n="".concat(t[r],"~").concat(n);return n}return e},e}(),jp=function(){function e(){this.customEntries=[],this.performanceTimingKeys=Object.keys(Object.getPrototypeOf(this.getPerformanceTiming())).filter((function(e){return"toJSON"!==e})),this.initPerformanceSettings()}return Object.defineProperty(e.prototype,"timing",{get:function(){var e=this,t=[Np.MARK,Np.LIFE_CYCLE],n=this.getEntries().filter((function(e){return t.includes(e.entryType)})).reduce((function(e,t){var n;return(0,r.__assign)((0,r.__assign)({},e),((n={})[t.name]=t.startTime,n))}),{}),o=this.performanceTimingKeys.reduce((function(t,n){var o,i=e.getPerformanceTiming()[n];return(0,r.__assign)((0,r.__assign)({},t),((o={})[n]=i,o))}),{});return(0,r.__assign)((0,r.__assign)({},o),n)},enumerable:!1,configurable:!0}),e.prototype.getEntries=function(){return this.customEntries.sort((function(e,t){return e.startTime-t.startTime}))},e.prototype.getEntriesByName=function(e,t){return this.getEntries().filter((function(n){return!(n.name!==e&&n.alias!==e||t&&n.entryType!==t)}))},e.prototype.getEntryByName=function(e,t){var n;return null===(n=this.getEntriesByName(e,t))||void 0===n?void 0:n[0]},e.prototype.getEntriesByType=function(e,t){return void 0===t&&(t=xp.low),this.getEntries().filter((function(n){return n.entryType===e&&n.weight>=t}))},e.prototype.getEntryByType=function(e){var t;return null===(t=this.getEntriesByType(e))||void 0===t?void 0:t[0]},e.prototype.mark=function(e,t){var n,r;if(Hp&&(!t||void 0!==t.startTime)){var o=new Wp(e,null!==(n=null==t?void 0:t.entryType)&&void 0!==n?n:Np.MARK,null!==(r=null==t?void 0:t.startTime)&&void 0!==r?r:this.now(),0);return this.customEntries.push(o),o}},e.prototype.markLifeCycle=function(e,t){var n;return this.mark(e,{startTime:null!==(n=null==t?void 0:t.startTime)&&void 0!==n?n:this.now(),entryType:Np.LIFE_CYCLE})},e.prototype.clearMarks=function(){this.clearEntriesByType(Np.MARK)},e.prototype.measure=function(e,t){if(Hp&&(!t||void 0!==t.startTime||void 0!==t.endTime)){var n=this.getPerformanceTiming().navigationStart,o=this.now(),i=null!=t?t:{},a=i.startTime,s=i.endTime,c=i.entryType,l=(0,r.__rest)(i,["startTime","endTime","entryType"]),u=new Wp(e,null!=c?c:Np.MEASURE,null!=a?a:n,(null!=s?s:o)-(null!=a?a:n),l);return this.customEntries.push(u),u}},e.prototype.measureStart=function(e,t){var n=new Wp(e,Np.MEASURE,t,0);return this.customEntries.push(n),n},e.prototype.measureEnd=function(e,t){var n=this.getEntriesByName(e,Np.MEASURE);if(0===n.length)throw new Error("不存在 name 为".concat(e,"的 entry，请确认是否有先调用 measureStart。"));if(n.length>1)throw new Error("存在多个 name 为".concat(e,"的 entry，请确认是否对同个 name 多次调用 measureStart。"));return n[0].setEndTime(t),n},e.prototype.measureResource=function(e){var t=this;e.forEach((function(e){var n=Fp[e.initiatorType];if(n&&!t.filterByWhiteList(e)){var r=t.getPerformanceTiming().navigationStart+e.fetchStart,o=t.getPerformanceTiming().navigationStart+e.responseEnd,i=t.getResourceExternalInfo(e),a=i.alias,s=i.weight,c=e.decodedBodySize,l=e.encodedBodySize,u=e.transferSize;t.measure(e.name,{startTime:r,endTime:o,entryType:n,alias:a,weight:s,decodedBodySize:c,encodedBodySize:l,transferSize:u})}}))},e.prototype.clearMeasures=function(e){this.clearEntriesByType(Np.MEASURE,e)},e.prototype.now=function(){return Date.now()},e.prototype.toJSON=function(){return(0,r.__assign)((0,r.__assign)({},this.timing),{customEntries:this.customEntries})},e.prototype.getBeginTimestamp=function(){var e;return null!==(e=this.timing.clickStart)&&void 0!==e?e:this.timing.navigationStart},e.prototype.getElapsedTimes=function(){var e=this.getBeginTimestamp(),t=this.getEntryStartTimeByName(kp.LCP,e),n=this.getEntryStartTimeByName(kp.TTI,e),o=this.getEntryStartTimeByName(kp.TTE,e),i=(0,r.__read)(this.getEntriesByName(kp.HTML),1)[0],a=(0,r.__read)(this.getEntriesByName(kp.OPEN_DOC),1)[0],s=this.getEntryStartTimeByName(kp.PAGE_LOAD_FINISHED,e),c=this.getEntryStartTimeByName(kp.ENTRY_START,e);return{LCP:t-e,TTI:n-e,TTE:o-e,HTML:(null==i?void 0:i.endTime)-(null==i?void 0:i.startTime),OPENDOC:(null==a?void 0:a.endTime)-(null==a?void 0:a.startTime),PAGE_LOAD_FINISHED:s-e,ENTRY_START:c-e}},e.prototype.getAllLogicEntries=function(){var e=this.timing,t=e.entryStart,n=e.PAGE_LOAD_FINISHED;return this.getEntries().filter((function(e){return e.startTime>=t&&e.startTime<=n})).map((function(e){return e.toJSON()}))},e.prototype.getAllLogicEntriesBeforeTTE=function(){var e=this.timing,t=e.entryStart,n=e.TTE;return this.getEntries().filter((function(e){return e.startTime>=t&&e.startTime<=n})).map((function(e){return e.toJSON()}))},e.prototype.getAllLogicEntriesBeforeEditable=function(){var e=this.timing,t=e.entryStart,n=e.SPREAD_SHEET_EDITABLE;return this.getEntries().filter((function(e){return e.startTime>=t&&e.startTime<=n})).map((function(e){return e.toJSON()}))},e.prototype.getAllEntriesByMark=function(e,t){var n,r,o=null!==(n=e&&this.timing[e])&&void 0!==n?n:this.getBeginTimestamp(),i=null!==(r=t&&this.timing[t])&&void 0!==r?r:this.now();return this.getEntries().filter((function(e){return e.startTime>=o&&e.startTime<=i})).map((function(e){return e.toJSON()}))},e.prototype.getAllEntriesBeforeTTE=function(){var e=this.timing.TTE;return this.getEntries().filter((function(t){return t.startTime<=e})).map((function(e){return e.toJSON()}))},e.prototype.getAllEntriesValue=function(){return this.getEntries().map((function(e){return e.toJSON()}))},e.prototype.getAllEntriesWithoutLowWeightResource=function(){var e=this;return this.getEntries().filter((function(t){return!e.isLowWeightResourceEntry(t)})).map((function(e){return e.toJSON()}))},e.prototype.clearEntriesByType=function(e,t){this.customEntries=this.customEntries.filter((function(n){return n.entryType!==e||!(!t||n.name===t)}))},e.prototype.filterByWhiteList=function(e){var t=[Np.CGI,Np.IMG],n=Fp[e.initiatorType];if(-1===t.indexOf(n))return!1;var r=new URL(e.name);return-1===Bp.indexOf(r.host)},e.prototype.getResourceExternalInfo=function(e){var t,n,o;try{for(var i=(0,r.__values)(Up),a=i.next();!a.done;a=i.next()){var s=a.value;if(0===e.name.indexOf(s.name))return{alias:null!==(o=s.alias)&&void 0!==o?o:s.name,weight:s.weight}}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return{weight:xp.low}},e.prototype.isLowWeightResourceEntry=function(e){return e.weight!==xp.low&&e.entryType===Np.RESOURCE},e.prototype.getPerformanceTiming=function(){var e;return(null===(e=window.performance)||void 0===e?void 0:e.timing)?window.performance.timing:{navigationStart:this.now()}},e.prototype.getEntryStartTimeByName=function(e,t){var n,r;return null!==(r=null===(n=this.getEntryByName(e))||void 0===n?void 0:n.startTime)&&void 0!==r?r:t},e.prototype.initPerformanceSettings=function(){var e,t;Hp&&window.performance&&(null===(t=(e=window.performance).setResourceTimingBufferSize)||void 0===t||t.call(e,2e3),window.performance.onresourcetimingbufferfull=this.onResourceTimingBufferFull.bind(this))},e.prototype.onResourceTimingBufferFull=function(){if(window.performance){var e=window.performance.getEntriesByType("resource");this.measureResource(e)}},e}();function Gp(){var e={};try{var t=performance.timing;if(t.loadEventEnd-t.loadEventStart<0)return void setTimeout((function(){Gp()}),200);e["重定向时间"]=t.redirectEnd-t.redirectStart,e["DNS解析时间"]=t.domainLookupEnd-t.domainLookupStart,e["TCP完成握手时间"]=t.connectEnd-t.connectStart,e["HTTP请求响应完成时间"]=t.responseEnd-t.requestStart,e["DOM开始加载前所花费时间"]=t.responseEnd-t.navigationStart,e["DOM加载完成时间"]=t.domComplete-t.domLoading,e["DOM结构解析完成时间"]=t.domInteractive-t.domLoading,e["脚本加载时间"]=t.domContentLoadedEventEnd-t.domContentLoadedEventStart,e["onload事件时间"]=t.loadEventEnd-t.loadEventStart,e.domContentLoaded=t.domContentLoadedEventEnd-t.navigationStart,e.load=t.loadEventEnd-t.navigationStart,window.showSnapshotEnd&&(e.snapshotShow=window.showSnapshotEnd-t.navigationStart),e["页面完全加载时间"]=e["重定向时间"]+e["DNS解析时间"]+e["TCP完成握手时间"]+e["HTTP请求响应完成时间"]+e["DOM结构解析完成时间"]+e["DOM加载完成时间"],Object.keys(e).forEach((function(t){console.log("".concat(t,":").concat(e[t],"毫秒(ms)"))})),console.log(t)}catch(e){console.error(e)}}window.tDocsPerformance||(window.tDocsPerformance=new jp);var Vp,zp,Qp,Yp,Zp,Kp,Jp=n(997097),qp=n(983266),Xp=n(541008);!function(e){e[e.NUM_0_2K=0]="NUM_0_2K",e[e.NUM_2K_1W=1]="NUM_2K_1W",e[e.NUM_1W_5W=2]="NUM_1W_5W",e[e.NUM_5W_20W=3]="NUM_5W_20W",e[e.NUM_20W_INF=4]="NUM_20W_INF"}(Vp||(Vp={})),function(e){e[e.PAGE_1=0]="PAGE_1",e[e.PAGE_2_5=1]="PAGE_2_5",e[e.PAGE_6_10=2]="PAGE_6_10",e[e.PAGE_11_30=3]="PAGE_11_30",e[e.PAGE_31_50=4]="PAGE_31_50",e[e.PAGE_51_100=5]="PAGE_51_100",e[e.PAGE_100_INF=6]="PAGE_100_INF"}(zp||(zp={})),function(e){e[e.FPS_EDIT=0]="FPS_EDIT",e[e.FPS_SCROLL=1]="FPS_SCROLL",e[e.FPS_FAST_SCROLL=2]="FPS_FAST_SCROLL"}(Qp||(Qp={})),function(e){e[e.FPS_10=10]="FPS_10",e[e.FPS_24=24]="FPS_24"}(Yp||(Yp={})),function(e){e[e.COST_0_1=0]="COST_0_1",e[e.COST_1_3=1]="COST_1_3",e[e.COST_3_10=2]="COST_3_10",e[e.COST_10_30=3]="COST_10_30",e[e.COST_30_60=4]="COST_30_60",e[e.COST_60_600=5]="COST_60_600",e[e.COST_600_1800=6]="COST_600_1800",e[e.COST_1800_INF=7]="COST_1800_INF"}(Zp||(Zp={})),function(e){e[e.FILE_NUM_0=0]="FILE_NUM_0",e[e.FILE_NUM_0_5=1]="FILE_NUM_0_5",e[e.FILE_NUM_5_10=2]="FILE_NUM_5_10",e[e.FILE_NUM_10_15=3]="FILE_NUM_10_15",e[e.FILE_NUM_15_20=4]="FILE_NUM_15_20",e[e.FILE_NUM_20_INF=5]="FILE_NUM_20_INF"}(Kp||(Kp={}));var $p=function(){function e(){}return e.isLargeDoc=function(e){return!!e&&e.dom_num>2e4},e.getDomNums=function(e){if(e&&e.collab_client_vars&&e.collab_client_vars.initialAttributedText){var t=e.collab_client_vars.initialAttributedText.attribs;return t?t.length:0}return 0},e.getOfflinceContainer=function(){var e=li.u.getInstance((0,ei.pb)()).containerEnv;return JSON.stringify({container:e,offline_package:window.__isOfflinePkg?1:0})},e.getSnapshotMessage=function(e){var t;switch(e){case qp.Ag.EDIT:t=(0,j.$t)("编辑快照");break;case qp.Ag.SSR:t=(0,j.$t)("SSR快照");break;case qp.Ag.CSR:t=(0,j.$t)("CSR快照");break;case qp.Ag.CSR_NATIVE:t=(0,j.$t)("CSR Native快照");break;default:t=(0,j.$t)("不使用快照")}return t},e.getWordNumLevel=function(e){var t,n=null!==(t=null==e?void 0:e.wordNum)&&void 0!==t?t:0;return n>2e3&&n<=1e4?Vp.NUM_2K_1W:n>1e4&&n<=5e4?Vp.NUM_1W_5W:n>5e4&&n<=2e5?Vp.NUM_5W_20W:n>2e5?Vp.NUM_20W_INF:Vp.NUM_0_2K},e.getPageCountLevel=function(e){var t,n=null!==(t=null==e?void 0:e.page_count)&&void 0!==t?t:1;return n>1&&n<=5?zp.PAGE_2_5:n>5&&n<=10?zp.PAGE_6_10:n>10&&n<=30?zp.PAGE_11_30:n>30&&n<=50?zp.PAGE_31_50:n>50&&n<=100?zp.PAGE_51_100:n>100?zp.PAGE_100_INF:zp.PAGE_1},e.getComplexityLevel=function(e){return e},e.getLayoutCostLevel=function(e){return e>1e3&&e<=3e3?Zp.COST_1_3:e>3e3&&e<=1e4?Zp.COST_3_10:e>1e4&&e<=3e4?Zp.COST_10_30:e>3e4&&e<=6e4?Zp.COST_30_60:e>6e4&&e<=6e5?Zp.COST_60_600:e>6e5&&e<=18e5?Zp.COST_600_1800:e>18e5?Zp.COST_1800_INF:Zp.COST_0_1},e.getFileNumLevel=function(e){return 0===e?Kp.FILE_NUM_0:e>0&&e<=5?Kp.FILE_NUM_0_5:e>5&&e<=10?Kp.FILE_NUM_5_10:e>10&&e<=15?Kp.FILE_NUM_10_15:e>15&&e<=20?Kp.FILE_NUM_15_20:e>20?Kp.FILE_NUM_20_INF:void 0},e}(),ef=(n(541706),n(929605)),tf=n(795775),nf=function(){function e(){this.isLayoutReflow=!1,this.init()}var t;return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.report=function(e,t){this.reportWebLoad(),this.reportCommon(e,t),this.reportDataLoad(),this.reportSRE(e),this.reportDocInfo(),this.reportLayout(),this.reportFeatureLoad()},e.prototype.reportWebLoad=function(){var e,t=window.performance.getEntriesByType("resource");d.ReportHelper.aegisReportTime(d.ReportName.RESOURCE_DOWNLOAD_START,Math.round(null===(e=t[0])||void 0===e?void 0:e.startTime))},e.prototype.reportCommon=function(e,t){var n=this.contextService.context.editor,o=n.factory.get(d.ILayoutController),i=null==o?void 0:o.complexity,a=n.perfManager.getPerfInfo().firstRender;[[Dp.fb,d.ReportName.WORKBENCH_INIT_BEGIN],[Dp.fK,d.ReportName.WORKBENCH_INIT_COST],[Dp.bv,d.ReportName.PAD_EDITOR_INIT_BEGIN],[Dp.an,d.ReportName.PAD_EDITOR_INIT_COST],[Dp.DN,d.ReportName.FEATURE_INIT_BEGIN],[Dp.gv,d.ReportName.FEATURES_INIT_COST],[Dp.gA,d.ReportName.FIRST_LAYOUT_BEGIN],[Dp.CE,d.ReportName.FIRST_VISIBLE_COST],[Dp.z4,d.ReportName.FIRST_VISIBLE_WITH_SSR_COST],[Dp.zj,d.ReportName.FIRST_VISIBLE_WITHOUT_SSR_COST],[Dp.$i,d.ReportName.FIRST_INTERACTION_COST],[Dp.xg,d.ReportName.FIRST_EDIT_COST],[Dp.JX,d.ReportName.TOTAL_LAYOUT_AND_RENDER_COST],[Dp.bB,d.ReportName.TOTAL_RENDER_COST],[Dp.E0,d.ReportName.LOAD_COMPLETE_COST]].forEach((function(t){var n=(0,r.__read)(t,2),o=n[0],a=n[1];[Dp.CE,Dp.z4,Dp.zj,Dp.$i,Dp.xg].includes(o)&&e[o]<=0||d.ReportHelper.aegisReportTime({name:a,duration:e[o],custom_complexity:String($p.getComplexityLevel(i))})})),d.ReportHelper.aegisReportTime({name:d.ReportName.CLIENT_DATA_INIT_BEGIN,duration:Math.round(p.PerfUtil.getMark("clientDataInitBegin")-t),custom_complexity:String($p.getComplexityLevel(i))}),d.ReportHelper.aegisReportTime({name:d.ReportName.CLIENT_DATA_PROMISE_RESOLVED,duration:Math.round(p.PerfUtil.getMark("clientDataPromiseResolved")-t),custom_complexity:String($p.getComplexityLevel(i))}),d.ReportHelper.aegisReportTime({name:d.ReportName.CLIENT_DATA_PROMISE_RESOLVED_COST,duration:Math.round(p.PerfUtil.measure("clientDataInitBegin","clientDataPromiseResolved")),custom_complexity:String($p.getComplexityLevel(i))}),d.ReportHelper.aegisReportTime({name:d.ReportName.DATA_PARSE_BEGIN,duration:Math.round(p.PerfUtil.getMark("dataParseBegin")-t),custom_complexity:String($p.getComplexityLevel(i))}),d.ReportHelper.aegisReportTime({name:d.ReportName.DATA_ENGINE_TO_EDITOR_BEGIN,duration:Math.round(p.PerfUtil.getMark("dataEngineToEditorBegin")-t),custom_complexity:String($p.getComplexityLevel(i))}),d.ReportHelper.aegisReportTime({name:d.ReportName.FIRST_RENDER_BEGIN,duration:Math.round(p.PerfUtil.getMark("firstRenderBegin")-t),custom_complexity:String($p.getComplexityLevel(i))}),d.ReportHelper.aegisReportTime({name:d.ReportName.FIRST_RENDER_COST,duration:a,custom_complexity:String($p.getComplexityLevel(i))})},e.prototype.reportDataLoad=function(){d.ReportHelper.aegisReportTime(d.ReportName.GET_CLIENT_VARS_COST,window.getClientVarsCost.getClientVarsCost),d.ReportHelper.aegisReportTime(d.ReportName.CLIENT_DATA_INIT_COST,Math.round(p.PerfUtil.measure("clientDataInitBegin","clientDataInitEnd"))),d.ReportHelper.aegisReportTime(d.ReportName.DATA_ENGINE_TO_EDITOR_COST,Math.round(p.PerfUtil.measure("dataEngineToEditorBegin","dataEngineToEditorEnd"))),d.ReportHelper.aegisReportTime(d.ReportName.DATA_PARSE_COST,Math.round(p.PerfUtil.measure("dataParseBegin","dataParseEnd")))},e.prototype.reportSRE=function(e){e[Dp.$i]<=5e3?d.ReportHelper.aegisReportEvent(d.ReportName.FIRST_INTERACTION_IN_5S):d.ReportHelper.aegisReportEvent(d.ReportName.FIRST_INTERACTION_ABOVE_5S)},e.prototype.reportFPS=function(e,t){d.ReportHelper.aegisReportTime({name:d.ReportName.FPS,duration:e,custom_fpsType:t})},e.prototype.getExtraReportInfo=function(){var e=this.contextService.context.editor.factory.get(d.ILayoutController),t=null==e?void 0:e.complexityLevel2,n=null==e?void 0:e.extraFlowInfo,r={};return n&&Object.keys(n).forEach((function(e){r[e]=String(n[e])})),t&&(r.custom_complexityLevel2=String(t)),r},e.prototype.reportDocInfo=function(){var e,t,n,o,i,a=this.contextService.context.editor,s=a.factory.get(d.ILayoutController),c=null==s?void 0:s.complexity,l=a.service.getDocument().getInlineShapes().imagesCount(),u=S.Am.get(Ks.D).getFieldList({name:d.FieldName.ATTACHMENT}).length,p=this.getExtraReportInfo();d.ReportHelper.aegisReportEvent((0,r.__assign)({name:d.ReportName.DOC_INFO,custom_padId:null===(e=window.clientVars)||void 0===e?void 0:e.padId,custom_layoutType:String(a.currentLayoutType),custom_wordNum:String(null!==(n=null===(t=null==a?void 0:a.statisticInfo)||void 0===t?void 0:t.wordNum)&&void 0!==n?n:0),custom_pageNum:String(null!==(i=null===(o=null==a?void 0:a.statisticInfo)||void 0===o?void 0:o.page_count)&&void 0!==i?i:1),custom_complexity:String($p.getComplexityLevel(c)),custom_imageNum:String(l),custom_attachmentNum:String(u)},p))},e.prototype.reportLayout=function(){var e=this,t=this.contextService.context.editor,n=t.perfManager,o=n.getPerfInfo().firstLayout,i=t.factory.get(d.ILayoutController),a=null==i?void 0:i.complexity,s=this.getExtraReportInfo();o>0&&d.ReportHelper.aegisReportTime((0,r.__assign)({name:d.ReportName.FIRST_LAYOUT_COST,duration:o,custom_complexity:String($p.getComplexityLevel(a))},s));var c=n.getPerfInfo().layout;c>0&&(d.ReportHelper.aegisReportTime((0,r.__assign)({name:d.ReportName.LAYOUT_AVERAGE_PAGE_COST,duration:c,custom_complexity:String($p.getComplexityLevel(a))},s)),d.ReportHelper.aegisReportTime((0,r.__assign)({name:d.ReportName.TOTAL_LAYOUT_COST,duration:Math.round(c*t.statisticInfo.page_count),custom_complexity:String($p.getComplexityLevel(a))},s))),t.on(d.LayoutNotification.LayoutChanged,(function(t){if(t.isReflow){var o=e.getExtraReportInfo();e.isLayoutReflow=!0,n.getPerfInfo().reflow>d.LAYOUT_THRESHOLD.EDIT_LAG&&(d.ReportHelper.aegisReportTime((0,r.__assign)({name:d.ReportName.REFLOW_LAYOUT_LAG_COST,duration:n.getPerfInfo().reflow,custom_complexity:String($p.getComplexityLevel(a))},o)),d.ReportHelper.aegisReportEvent((0,r.__assign)({name:d.ReportName.REFLOW_LAYOUT_LAG,custom_complexity:String($p.getComplexityLevel(a))},o))),Math.random()>.95&&d.ReportHelper.aegisReportTime((0,r.__assign)({name:d.ReportName.REFLOW_LAYOUT_COST,duration:n.getPerfInfo().reflow,custom_complexity:String($p.getComplexityLevel(a))},o))}}),this),t.on(d.RenderNotificationTypes.RE_RENDER_PAGE,(function(e){var t,n,r,o,i,a,s;e.cost&&Math.random()>.99&&(null!==(t=e.cost.render)&&void 0!==t||d.ReportHelper.aegisReportTime({name:d.ReportName.RENDER_PAGE_COST,duration:null!==(n=e.cost.render)&&void 0!==n?n:0}),null!==(r=e.cost.collect)&&void 0!==r||d.ReportHelper.aegisReportTime({name:d.ReportName.RENDER_COLLECT_COST,duration:null!==(o=e.cost.collect)&&void 0!==o?o:0}),null!==(i=e.cost.paint)&&void 0!==i||d.ReportHelper.aegisReportTime({name:d.ReportName.RENDER_PAINT_COST,duration:null!==(a=e.cost.paint)&&void 0!==a?a:0})),(null===(s=e.cost)||void 0===s?void 0:s.render)&&e.cost.render>100&&d.ReportHelper.aegisReportTime({name:d.ReportName.RENDER_LAG_COST,duration:e.cost.render,custom_flag:e.cost.containSubPage?1:0})}))},e.prototype.reportFeatureLoad=function(){d.ReportHelper.aegisReportTime(d.ReportName.FEATURES_LEVEL1_INIT_COST,Math.round(p.PerfUtil.measure("featuresLevel1InitBegin","featuresLevel1InitEnd")));var e=Math.round(p.PerfUtil.measure("featuresReadonlyInitBegin","featuresReadonlyInitEnd")),t=Math.round(p.PerfUtil.measure("featuresPublishInitBegin","featuresPublishInitEnd"));e>0&&d.ReportHelper.aegisReportTime(d.ReportName.FEATURES_READONLY_INIT_COST,e),t>0&&d.ReportHelper.aegisReportTime(d.ReportName.FEATURES_PUBLISH_INIT_COST,t),d.ReportHelper.aegisReportTime(d.ReportName.FEATURES_EDIT_INIT_COST,Math.round(p.PerfUtil.measure("featuresEditInitBegin","featuresEditInitEnd")))},e.prototype.init=function(){var e,t,n,r,o,i=this.contextService.context.editor,a=i.factory.get(d.ILayoutController),s=null==a?void 0:a.complexity;d.ReportHelper.aegisSetConfig({extField:{custom_padId:null===(e=window.clientVars)||void 0===e?void 0:e.padId,custom_layoutType:String(i.currentLayoutType),costum_wordNum:String(null!==(n=null===(t=null==i?void 0:i.statisticInfo)||void 0===t?void 0:t.wordNum)&&void 0!==n?n:0),custom_complexity:String($p.getComplexityLevel(s)),custom_pageNum:String(null!==(o=null===(r=null==i?void 0:i.statisticInfo)||void 0===r?void 0:r.page_count)&&void 0!==o?o:1)}})},(0,r.__decorate)([(0,S.tB)(),(0,r.__metadata)("design:type","function"==typeof(t=void 0!==I.O&&I.O)?t:Object)],e.prototype,"contextService",void 0),e}(),rf=function(){function e(){this.startFpsRecording=function(){var e,t=performance.now(),n=[],r=function(){n.push(performance.now()),e=requestAnimationFrame(r)};return e=requestAnimationFrame(r),function(){cancelAnimationFrame(e);var r=performance.now()-1e3,o=n.filter((function(e){return e<=r})).length;return o>0?(r-t)/o:void 0}}}var t;return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.report=function(e){this.reportOpenIndexes(e),this.reportReadIndexes(),this.reportEditIndexes()},e.prototype.reportOpenIndexes=function(e){[[Dp.zj,d.ReportName.DSI_FPR],[Dp.xg,d.ReportName.DSI_FPE]].forEach((function(t){var n=(0,r.__read)(t,2),o=n[0],i=n[1];e[o]<=0||d.ReportHelper.aegisReportTime((0,r.__assign)({name:i,duration:e[o]},nf.getInstance().getExtraReportInfo()))}))},e.prototype.reportReadIndexes=function(){this.reportScroll()},e.prototype.reportScroll=function(){var e=this,t=this.contextService.context.editor,n=0,o=!1,i=void 0,a=void 0;t.scrollHandler.addScrollListener((function(){if(o){clearTimeout(i);var s=t.scrollHandler.getCachedScrollTop();Math.abs(s-n),n=s,i=setTimeout((function(){i=void 0,o=!1;var e=null==a?void 0:a();e&&d.ReportHelper.aegisReportTime((0,r.__assign)({name:d.ReportName.DSI_ANSF,duration:e},nf.getInstance().getExtraReportInfo()))}),1e3)}else Math.random()<=.02&&(o=!0,n=t.scrollHandler.getCachedScrollTop(),a=e.startFpsRecording())}))},e.prototype.reportEditIndexes=function(){this.contextService.context.editor.on(d.LayoutNotification.LayoutChanged,(function(e){if(e.isReflow&&Math.random()<=.05){var t=p.PerfUtil.measure("editBegin","editEnd");d.ReportHelper.aegisReportTime((0,r.__assign)({name:d.ReportName.DSI_ENR,duration:t},nf.getInstance().getExtraReportInfo()))}}))},(0,r.__decorate)([(0,S.tB)(),(0,r.__metadata)("design:type","function"==typeof(t=void 0!==I.O&&I.O)?t:Object)],e.prototype,"contextService",void 0),e}(),of=function(){function e(e){this.performance=window.performance,this.totalPromises=[],this.isReportedLargeDoc=!1,this.replaceUrlTime=0,this.meloUpCost=0,this.quickLookShowTime=0,this.quickLookType=qp.Ag.DEFAULT,this.isDestroyed=!1,this.clickToShowCost=0,this.renderFinishTimeStamp=0,this.startedEdit=!1,this.started=!1,this.makeFPSCaculator=function(){var e,t=+new Date,n=0,r=function(){n+=1,e=requestAnimationFrame(r)};return e=requestAnimationFrame(r),function(){cancelAnimationFrame(e);var r=+new Date-t;return Math.round(n/(r/1e3))}},this.editor=e,this.secretId=(0,ei.pb)(),this.init()}var t,n;return e.prototype.init=function(){if(this.performance&&this.performance.timing){this.timing=this.performance.timing,this.reportData=this.createDefaultData();var e=li.u.getInstance(this.secretId).replaceUrlTime;this.replaceUrlTime=e,this.registPromises(),this.handleReport(),this.startEditFpsCaculate(),this.startScrollFPSDetector()}this.monitorLongTask()},e.prototype.destroy=function(){this.isDestroyed=!0,this.editor.removeListener(d.RenderNotificationTypes.FIRST_RENDER,this),d.GlobalContext.removeListener(d.FeatureNotificationType.FEATURE_LOADED,this),this.editor.removeListener(d.RenderNotificationTypes.RENDER_FINISH,this),this.editor.removeListener(d.RenderNotificationTypes.RENDER_LAYOUT_CHANGE,this),this.stopObserveLargeDoc(),this.isReportedLargeDoc=!1,this.meloUpCost=0,this.replaceUrlTime=0},e.prototype.splitReportDataForTdw=function(){var e=this,t={},n={};Object.keys(this.reportData).forEach((function(r){r===Dp.aI||r===Dp.Zp?t[r]=e.reportData[r]:n[r]=e.reportData[r]}));var r=(0,Pp.fp)(),o=r.openMode,i=r.preloadWebviewCount;return{ver8:JSON.stringify(n),ver10:JSON.stringify(t),ver11:o,ver12:i}},e.prototype.isRenderTimeError=function(e,t){return e>Math.max(2*t,2e4)||e<=0||0===t},e.prototype.handleReport=function(){var e=this;this.totalPromises.forEach((function(t){t.then((function(t){Object.keys(t).forEach((function(n){var r=t[n],o=(0,Dp.WN)(n);e.reportData[n]=r,o&&p.Logger.info("Timing|".concat(o,": ").concat(JSON.stringify(r)))}))}))})),Promise.all(this.totalPromises).then((function(){var t;Gp(),p.Logger.info("report data");var n=JSON.stringify(e.reportData);window.loadPerfInfo=n;var r=e.isRenderTimeError(e.reportData[Dp.CE],e.editor.state.dataEngine.getMutNum()||0);if(!((0,p.getUrlParameter)("prerender")||e.isDestroyed||r||(0,si.g6)())){if(d.ReportHelper.monitor007Value(d.MonitorName.DOC_WORD_NUM,(null===(t=e.statisticInfo)||void 0===t?void 0:t.wordNum)||0),d.ReportHelper.monitor007Value(d.MonitorName.FIRST_RENDER_TIME,e.reportData[Dp.CE]),d.ReportHelper.monitor007Value(d.MonitorName.FIRST_EDIT_TIME,e.reportData[Dp.$i]),d.ReportHelper.monitor007Status(d.MonitorName.FIRST_EDIT_IN_5S,e.reportData[Dp.$i]<=5e3?d.Status007.SUCCESS:d.Status007.FAIL),n[Dp.CE]<=0||n[Dp.$i]<=0){p.Logger.info("PerformanceHandler handleReport NegativeError reportInfo = ".concat(n));var o=n[Dp.CE]<=0?"Word_FirstRenderNegativeError":"Word_FirstInteractionNegativeError";e.reportToWeblog(o),d.ReportHelper.captureException(d.MonitorName.PERFORMANCE_REPORT_NEGATIVE_ERROR,{},new Error(o))}e.start<=0?p.Logger.info("PerformanceHandler handleReport start invalid!!!"):(e.reportOpenDocCost(),e.reportLargeDoc(),e.isReportedLargeDoc||e.startObserveLargeDoc(),e.startEditPerfReport(),nf.getInstance().report(e.reportData,e.start),rf.getInstance().report(e.reportData),document.dispatchEvent(new CustomEvent(Dp.Xr.AllPerformanceDataReady)))}}))},e.prototype.reportOpenDocCost=function(){var e,t,n,r=this.splitReportDataForTdw(),o=r.ver8,i=r.ver10,a=r.ver11,s=r.ver12;if((0,si.g6)())p.Logger.debug("report init_container_time_cost"),d.ReportHelper.tdwReport({opername:"quality_doc_melo",module:"detail",action:"init_container_time_cost",file_type:"1",ver7:JSON.stringify(this.statisticInfo||{}),ver8:o,ver9:this.prepareVer9Data(),ver10:i});else if(this.quickLookType!==qp.Ag.CSR_NATIVE){p.Logger.debug("report open_time_cost"),d.ReportHelper.tdwReport({opername:"quality_doc_melo",module:"detail",action:"open_time_cost",file_type:"1",ver5:null===(t=(0,c.Yi)().collab_client_vars.dver)||void 0===t?void 0:t.substr(0,3),ver7:JSON.stringify(this.statisticInfo||{}),ver8:o,ver9:this.prepareVer9Data(),ver10:i,ver11:a,ver12:s}),d.ReportHelper.monitor007Value(d.MonitorName.FIRST_RENDER_TIME_3_0,this.reportData[Dp.CE]),d.ReportHelper.monitor007Value(d.MonitorName.FIRST_EDIT_TIME_3_0,this.reportData[Dp.$i]);var l=((null===(n=this.statisticInfo)||void 0===n?void 0:n.wordNum)||0)>1e4;l&&(d.ReportHelper.monitor007Value(d.MonitorName.FIRST_RENDER_TIME_LARGE_DOC_3_0,this.reportData[Dp.CE]),d.ReportHelper.monitor007Value(d.MonitorName.FIRST_EDIT_TIME_LARGE_DOC_3_0,this.reportData[Dp.$i])),window.getClientVarsCost&&(d.ReportHelper.monitor007Value(d.MonitorName.OPEN_DOC_COST_3_0,window.getClientVarsCost.getClientVarsCost),l&&d.ReportHelper.monitor007Value(d.MonitorName.OPEN_DOC_COST_LARGE_DOC_3_0,window.getClientVarsCost.getClientVarsCost),d.ReportHelper.monitor007Value(d.MonitorName.OPEN_DOC_RETRY_COUNT,window.getClientVarsCost.getClientVarsOnlineCount)),d.ReportHelper.tdwReport({opername:"quality_doc_melo",module:"detail",action:"open_time_cost_minify",file_type:"1",ver7:JSON.stringify(this.statisticInfo||{}),ver8:JSON.stringify((e={},e[Dp.iB]=this.reportData[Dp.iB],e[Dp.$i]=this.reportData[Dp.$i],e[Dp.bB]=this.reportData[Dp.bB],e[Dp.E0]=this.reportData[Dp.E0],e)),ver9:this.prepareVer9Data(),ver10:i,ver11:a,ver12:s}),this.reportOpenDocCgiCost(l)}},e.prototype.reportOpenDocCgiCost=function(e){var t;if(window.getClientVarsCost){var n=window._openDocEndTime,r="JSONP"===window.openDocType?this.performance.timing.responseEnd:null!==(t=window._openDocStartTime)&&void 0!==t?t:window.getClientVarsCost.getClientVarsStart;d.ReportHelper.tdwReport({opername:"quality_doc_melo",module:"detail",action:"open_time_cgi_cost",file_type:"1",ver7:n-r,ver8:e?"1":"0",ver9:window.__globalReleaseVersion})}},e.prototype.reportOpenWebEvent=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,t,n,o,i,a,s,c,l,u,d;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:switch(e=Bs._.getInstance(),t=e.createTS,n=e.templateId,o=e.csid,i=Bs._.getInstance().getOpenWebType()){case Bs.w.CREATE_ONLINE_NATIVE:return[3,1];case Bs.w.OPEN_NATIVE:case Bs.w.CREATE_LOCAL_NATIVE:return[3,2]}return[3,5];case 1:return t&&(c=parseInt(t,10),this.reportOpenWebCost(Bs.w.CREATE_ONLINE_NATIVE,c,n)),[3,5];case 2:return o?[4,ef.M.getMetric({csid:o})]:[3,4];case 3:(a=r.sent())?(s=a.data,c=s.doc_item_click_timestamp,l=s.doc_loadurl_timestamp,u=Math.round(l-c),d=Math.round(this.start-l),this.reportOpenWebCost(i,c,void 0,{clickToLoadCost:u,loadToStartCost:d},a.data)):p.Logger.error("getMetric for ".concat(o," failed ").concat(a)),r.label=4;case 4:return[3,5];case 5:return[2]}}))}))},e.prototype.buildAppPerformanceData=function(e){var t=Math.round(this.renderFinishTimeStamp-e),n=t;return this.clickToShowCost?n=this.clickToShowCost:this.quickLookShowTime>e&&(n=Math.round(this.quickLookShowTime-e)),{clickToShowCost:n,clickToEditCost:t}},e.prototype.reportOpenWebCost=function(e,t,n,o,i){var a=this.buildAppPerformanceData(t),s=a.clickToShowCost,c=a.clickToEditCost;if(c<=0||s<=0)return p.Logger.error("clickToEditCost or clickToShowCost is not legal: clickToEditCost:".concat(c,", clickToShowCost:").concat(s)),!1;var l=JSON.stringify((0,r.__assign)({clickToEditCost:c,clickToShowCost:s},o)),u=this.prepareVer9Data(i);return p.Logger.info("report open_web openWebType:".concat(e," clickToEditCost:").concat(c,", clickToShowCost:").concat(s)),d.ReportHelper.tdwReport({opername:"doc_core",module:"open",action:"open_web",file_type:"1",obj3:l,ver5:e,ver6:n,ver7:JSON.stringify(this.statisticInfo||{}),ver9:u,ver10:JSON.stringify({version:this.reportData[Dp.Gf]})}),!0},e.prototype.prepareVer9Data=function(e){var t,n,o,i=li.u.getInstance((0,ei.pb)()).containerEnv,a=(0,r.__assign)({offline_package:window.__isOfflinePkg?1:0,container:i,replaceCount:li.u.replaceCount,usingPreCreate:Bs._.getInstance().createMode,usingPreloadWebview:"preload"===window.openUrlFrom?1:0,usingPreloadDB:tf.Y.preGetDBDataSuccess&&"database"===window.clientvarsDataFrom?1:0,usingQuickLook:this.quickLookShowTime?1:0,quickLookType:this.quickLookType,isDebugEnv:(0,d.isDebugEnviroment)()?1:0,renderType:this.editor.docEnv.renderType,releaseHash:null!==(o=null===(n=null===(t=null===window||void 0===window?void 0:window.App)||void 0===t?void 0:t.GlobalConfig)||void 0===n?void 0:n.hash)&&void 0!==o?o:""},e);return window.immeJsSize&&(a.immeJsSize=window.immeJsSize),(0,Pp.Z$)("".concat(window.__globalReleaseVersion,"\n").concat([a.offline_package?"离线":"非离线",a.usingQuickLook?"秒看":"非秒看",a.usingPreloadDB?"预DB":"非预DB",a.usingPreloadWebview?"预热":a.container===li.K.iframe?"容器":"非容器",a.usingPreCreate].filter(Boolean).join("+"),"\n").concat(this.reportData[Dp.$i],"ms")),JSON.stringify(a)},e.prototype.reportToWeblog=function(e,t){void 0===t&&(t=18e4);var n=Date.now(),r=n-t;window.log&&window.log.report(e,{query:{startTs:r,endTs:n}})},e.prototype.getQuickLookInfo=function(){var e;if(null===(e=window.meloPerformanceCache)||void 0===e?void 0:e.ssrShowTime)return{quickLookShowTime:window.meloPerformanceCache.ssrShowTime,quickLookType:qp.Ag.SSR};var t=li.u.getInstance(this.secretId).quickLookShowTime;return t?{quickLookShowTime:t,quickLookType:li.u.getInstance(this.secretId).quickLookType}:void 0},e.prototype.showSnapshotResult=function(e){var t=$p.getSnapshotMessage(e);Wi.default.show({message:(0,j.$t)("快照类型为{{snapshotMessage}}",{snapshotMessage:t}),type:"info",duration:1e3})},e.prototype.registPromises=function(){var e=this,t=new Promise((function(t){var n,r=e.timing;if(r){var o=r.responseEnd-r.requestStart,i=r.responseStart-r.requestStart;return t(((n={})[Dp.gK]=i,n[Dp.Jy]=o,n))}return t({})})),n=new Promise((function(t){var n,r=e.timing;if(r){var o=r.responseEnd-e.start,i=e.firstPaint||o,a=e.firstContentPaint||o;e.replaceUrlTime>0&&(i=0,a=0),t(((n={})[Dp.iB]=Math.round(i),n[Dp._x]=Math.round(a),n))}return t({})})),o=new Promise((function(t){e.editor.once(d.RenderNotificationTypes.FIRST_RENDER,(function(){return(0,r.__awaiter)(e,void 0,void 0,(function(){var e,n,o,i,a,s,c,l,u,d;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return e=this.start,n=p.PerfUtil.now(),this.renderFinishTimeStamp=n,o={},(i=p.PerfUtil.getMark("firstLayoutStart"))&&(o[Dp.gA]=Math.round(i-e),o[Dp.vB]=Math.round(n-i)),a=n-e,o[Dp.zj]=Math.round(a),s=a,(c=this.getQuickLookInfo())&&(this.quickLookShowTime=c.quickLookShowTime,this.quickLookType=c.quickLookType,a=this.quickLookShowTime-this.start,o[Dp.z4]=Math.round(a)),[3,2];case 1:(l=r.sent())>0&&(this.quickLookType=qp.Ag.CSR_NATIVE,this.clickToShowCost=l),r.label=2;case 2:return(a<=0||s<=0)&&p.Logger.info("PerformanceHandler firstRenderPromise","start:".concat(e," curTime:").concat(n," quickLookShowTime:").concat(this.quickLookShowTime," replaceUrlTime:").concat(this.replaceUrlTime," navigationStart:").concat(this.timing.navigationStart," meloUpCost:").concat(this.meloUpCost)),(u=Jp.f.getStepCostFromStart(qp.Fu.SnapshotShowEnd))&&(o[qp.Fu.SnapshotShowEnd]=u),(d=Jp.f.getStepCostFromStart(qp.Fu.SnapshotShowRenderEnd))&&(o[qp.Fu.SnapshotShowRenderEnd]=d),window.timeFirstShown=a,o[Dp.CE]=Math.round(a),p.Logger.info("Timing|".concat((0,Dp.WN)("FirstRender"),":").concat(o[Dp.CE])),t(o),[2]}}))}))}),e,{priority:p.NotificationPriority.high})})),i=new Promise((function(t){e.editor.docEnv.preview&&t({});var n=function(){return(0,r.__awaiter)(e,void 0,void 0,(function(){var e,o;return(0,r.__generator)(this,(function(r){return document.removeEventListener("first_render_hided_quick_look",n),e={},o=p.PerfUtil.now()-this.start,e[Dp.$i]=Math.round(o),window.timeFirstInteraction=o,p.Logger.info("Timing|".concat((0,Dp.WN)("FirstInteraction"),":").concat(e[Dp.$i])),t(e),[2]}))}))};document.addEventListener("first_render_hided_quick_look",n)})),a=new Promise((function(t){e.editor.docEnv.preview&&t({});var n=function(){return(0,r.__awaiter)(e,void 0,void 0,(function(){var e,o,i,a,s=this;return(0,r.__generator)(this,(function(r){return document.removeEventListener("performance_edit_hidden_input_inited",n),e={},o=p.PerfUtil.now()-this.start,e[Dp.oj]=Math.round(o),p.Logger.info("Timing|".concat((0,Dp.WN)("HiddenInputInited"),":").concat(e[Dp.oj])),this.editor.isEditable()||!this.contextService.context.permission.canEdit?(e[Dp.xg]=e[Dp.oj],p.Logger.info("Timing|".concat((0,Dp.WN)("FirstEdit"),":").concat(e[Dp.xg])),t(e)):this.contextService.context.permission.canEdit&&(i=!1,a=function(){if(!i){i=!0;var n=p.PerfUtil.now()-s.start;e[Dp.xg]=Math.round(n),p.Logger.info("Timing|".concat((0,Dp.WN)("FirstEdit"),":").concat(e[Dp.xg])),t(e)}},this.eventEmitter.listenOnce("$editableChanged",a),setTimeout((function(){return a()}),3e4)),[2]}))}))};document.addEventListener("performance_edit_hidden_input_inited",n)})),s=o.then((function(){return new Promise((function(t){d.GlobalContext.once(d.FeatureNotificationType.FEATURE_LOADED,(function(){var n;t(((n={})[Dp.fb]=Math.round(p.PerfUtil.getMark("workbenchInitBegin")-e.start),n[Dp.bv]=Math.round(p.PerfUtil.getMark("padEditorInitBegin")-e.start),n[Dp.DN]=Math.round(p.PerfUtil.getMark("featuresInitBegin")-e.start),n[Dp.fK]=Math.round(p.PerfUtil.measure("workbenchInitBegin","workbenchInitEnd")),n[Dp.an]=Math.round(p.PerfUtil.measure("padEditorInitBegin","padEditorInitEnd")),n[Dp.gv]=Math.round(p.PerfUtil.measure("featuresInitBegin","featuresInitEnd")),n[Dp.bd]=Math.round(p.PerfUtil.getMark("featuresInitEnd")-e.start),n[Dp.$G]=Math.round(p.PerfUtil.getMark("featuresRenderInitEnd")-e.start),n[Dp.Cx]=Math.round(p.PerfUtil.getMark("featuresPublishInitEnd")-e.start),n[Dp.kk]=Math.round(p.PerfUtil.getMark("featuresReadonlyInitEnd")-e.start),n[Dp.At]=Math.round(p.PerfUtil.getMark("featuresEditInitEnd")-e.start),n[Dp.Mc]=Math.round(p.PerfUtil.getMark("hideFirstScreen")-e.start),n))}),e,{priority:p.NotificationPriority.high})}))})),c=o.then((function(){return new Promise((function(t){e.editor.once(d.LayoutNotification.LayoutFinished,(function(){var n=p.PerfUtil.now()-e.start,r={};r[Dp.E6]=p.PerfUtil.getMark(Dp.E6),r[Dp.JX]=Math.round(p.PerfUtil.measure(Dp.gA,Dp.E6)),window.timeTotalRendered=n,r[Dp.bB]=Math.round(n),window.visibilitychangeStrForReport&&(r[Dp.EE]=window.visibilitychangeStrForReport);var o=e.editor.perfManager.getPerfInfo();r[Dp.z9]=o.layout,e.statisticInfo=e.editor.statisticInfo,t(r)}),e,{priority:p.NotificationPriority.high})}))})),l=s.then((function(){return e.createPrepareScriptLoadDataPromise()})),u=new Promise((function(t){e.reportData[Dp.E0]=Math.round(p.PerfUtil.now()-e.start),window.addEventListener("load",t)}));this.totalPromises=(0,r.__spreadArray)((0,r.__spreadArray)([t,n,o,s,c,l,i],(0,r.__read)([]),!1),(0,r.__read)(this.replaceUrlTime?[]:[u,a]),!1)},e.prototype.createPrepareScriptLoadDataPromise=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e=this;return(0,r.__generator)(this,(function(t){return[2,new Promise((function(t){var n,o={},i=e.performance&&e.performance.getEntriesByType&&e.performance.getEntriesByType("resource"),a=window.immeJs||[];if(window.tDocsPerformance.measureResource(i),i){var s=i.filter((function(e){if("resource"===e.entryType&&"script"===e.initiatorType){var t=e.name;return a.reduce((function(e,n){return e||t.indexOf(n)>=0}),!1)}return!1})),c=Math.max.apply(Math,(0,r.__spreadArray)((0,r.__spreadArray)([],(0,r.__read)(s.map((function(e){return e.startTime+e.duration}))),!1),[0],!1))-Math.min.apply(Math,(0,r.__spreadArray)((0,r.__spreadArray)([],(0,r.__read)(s.map((function(e){return e.startTime}))),!1),[0],!1));o[Dp.xS]=Math.round(c),o[Dp.aI]=s.map((function(e){var t=e.name.split("/");return{name:t[t.length-1],duration:Math.round(e.duration)}}))}null===(n=window.cachedPerformanceEntries)||void 0===n||n.forEach((function(e){var t=e,n=t.name,r=t.startTime,o=t.endTime;window.tDocsPerformance.measure(n,{startTime:r,endTime:o})})),t(o)}))]}))}))},e.prototype.createDefaultBaseData=function(){return(0,r.__assign)({TimeToFirstByte:0,TimeToLasterByte:0,FirstPaint:0,FirstContentPaint:0,workbenchInitBegin:0,workbenchInit:0,padEditorInitBegin:0,padEditorInit:0,featuresInitBegin:0,featuresInit:0,featuresInitEnd:0,featuresRenderInitEnd:0,featuresReadonlyInitEnd:0,featuresPublishInitEnd:0,featuresEditInitEnd:0,hideFirstScreen:0,firstLayoutStart:0,firstLayoutCost:0,lastLayoutFinish:0,totalLayoutCost:0,FIRST_RENDER:0,FIRST_EDIT:0,FIRST_INTERACTION:0,totalRender:0,totalRenderTable:0,loadComplete:0,scriptLoading:0,layoutCost:0,hiddenInputInited:0},{})},e.prototype.createDefaultData=function(){return(0,r.__assign)((0,r.__assign)({},this.createDefaultBaseData()),{scriptEntries:"",visibility:document.visibilityState,USERAGENT:navigator.userAgent,version:window.__globalReleaseVersion||"",isOfflinePkg:window.__isOfflinePkg||!1})},e.prototype.getPerformancePaintTiming=function(e){var t=this.performance&&this.performance.getEntriesByName&&this.performance.getEntriesByName(e);if(t&&t.length>0){var n=(0,r.__read)(t,1)[0];return n.startTime+n.duration}},Object.defineProperty(e.prototype,"firstPaint",{get:function(){return this.getPerformancePaintTiming("first-paint")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"firstContentPaint",{get:function(){return this.getPerformancePaintTiming("first-contentful-paint")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"start",{get:function(){var e=this.timing?this.timing.navigationStart:0;return 1===(0,c.Yi)().collab_client_vars.isMeloUp&&"number"==typeof(0,c.Yi)().collab_client_vars.meloUpCost&&(this.meloUpCost=(0,c.Yi)().collab_client_vars.meloUpCost||0,e+=(0,c.Yi)().collab_client_vars.meloUpCost||0),this.replaceUrlTime>0&&(e=this.replaceUrlTime),0===e&&(e=window.htmlLoadStart),e},enumerable:!1,configurable:!0}),e.prototype.reportLargeDoc=function(){var e;if(!this.isReportedLargeDoc&&$p.isLargeDoc(this.statisticInfo)){var t=localStorage&&localStorage.getItem("tdsourcetag");d.ReportHelper.tdwReport({opername:"doc_core",module:"visit",action:"detail_page_large",source3:t||"",obj3:p.PlatformUtil.getBrowser(),ver5:1===(0,c.Yi)().collab_client_vars.dirty?"limited":"normal",ver7:null===(e=(0,c.Yi)().collab_client_vars.dver)||void 0===e?void 0:e.substr(0,3)},{immediate:!0}),this.isReportedLargeDoc=!0}},e.prototype.startObserveLargeDoc=function(){var e=this;this.largeDocObserver=new MutationObserver((0,p.throttle)((function(){e.statisticInfo=e.editor.statisticInfo,e.reportLargeDoc(),e.isReportedLargeDoc&&e.stopObserveLargeDoc()}),5e3));var t=this.editor.getRoot(),n=t&&t.querySelector(".".concat(d.renderStyles.meloDocView));n&&this.largeDocObserver.observe(n,{childList:!0,subtree:!0})},e.prototype.stopObserveLargeDoc=function(){this.largeDocObserver&&this.largeDocObserver.disconnect()},e.prototype.onEditChange=function(e){var t=this;return this.editor.on(d.StateNotification.ModelChange,(function(t){t.fullReflow||e()})),function(){t.editor.removeCallBack(d.StateNotification.ModelChange,e)}},e.prototype.startEditPerfReport=function(){var e=this;this.onEditChange((function(){e.editor.once(d.RenderNotificationTypes.RENDER_LAYOUT_CHANGE,(function(){var t,n=e.editor.perfManager,r=p.PerfUtil.now();if(!(n.editTimes>10)){n.lastTime=r;var i=JSON.stringify(e.statisticInfo||{}),a=n.getPerfInfo(),s=JSON.stringify(a);d.ReportHelper.tdwReport({opername:"quality_doc_melo",module:"detail",action:"edit_time_cost",file_type:"1",ver5:null===(t=(0,c.Yi)().collab_client_vars.dver)||void 0===t?void 0:t.substr(0,3),ver7:i,ver8:s,ver9:e.editor.docEnv.renderType}),o.M.isDevEvn()&&p.Logger.info("Timing|".concat(s))}}),e)}))},e.prototype.monitorLongTask=function(){var e=this;if(o.M.isDevEvn()&&p.PlatformUtil.isChrome())try{new PerformanceObserver((function(t){t.getEntries().forEach((function(t){if(t.duration>=500){var n=e.editor.perfManager.getPerfInfo();p.Logger.warn("longTask|duration:".concat(t.duration,",perf:").concat(JSON.stringify(n)))}}))})).observe({entryTypes:["longtask"]})}catch(e){}},e.prototype.setDomNums=function(){this.statisticInfo&&(this.statisticInfo.dom_num=$p.getDomNums((0,c.Yi)()))},e.prototype.startEditFpsCaculate=function(){var e=this;if(!this.startedEdit){var t;this.startedEdit=!0;var n,r=!1,o=0,i=void 0;i=this.onEditChange((function(){o>10?null==i||i():(!1===r&&(n=e.makeFPSCaculator(),r=!0),clearTimeout(t),t=setTimeout((function(){var t,i;r=!1;var a=n();a&&(console.log("编辑的平均帧率: ".concat(a,"pfs")),o+=1,d.ReportHelper.tdwReport({opername:"quality_doc_melo",module:"detail",action:"edit_fps",file_type:"1",source3:navigator.userAgent,ver5:null===(t=(0,c.Yi)().collab_client_vars.dver)||void 0===t?void 0:t.substr(0,3),ver7:JSON.stringify(e.statisticInfo||{}),ver8:Math.min(a,60),ver10:null===(i=(0,c.Yi)().collab_client_vars.dver)||void 0===i?void 0:i.substr(0,3)}),nf.getInstance().reportFPS(Math.min(a,60),String(Qp.FPS_EDIT)))}),1e3))}))}},e.prototype.startScrollFPSDetector=function(){var e=this;if(!this.started){var t;this.started=!0;var n,r=!1,o=0,i=!1,a=0,s=this.editor.scrollHandler.getClientHeight(),l=function(){if(o>10)e.editor.scrollHandler.removeScrollListener(l);else{!1===r&&(n=e.makeFPSCaculator(),r=!0);var u=e.editor.scrollHandler.getScrollTop();a&&u&&Math.abs(a-u)>s&&(i=!0),a=u,clearTimeout(t),t=setTimeout((function(){var t,s,l=n();l&&(r=!1,console.log("滚动的平均帧率: ".concat(l,"pfs")),i&&console.log("触发快速滚动，平均帧率: ".concat(l,"pfs")),o+=1,d.ReportHelper.tdwReport({opername:"quality_doc_melo",module:"detail",action:i?"fast_scroll_fps":"scroll_fps",source3:navigator.userAgent,file_type:"1",ver5:null===(t=(0,c.Yi)().collab_client_vars.dver)||void 0===t?void 0:t.substr(0,3),ver7:JSON.stringify(e.statisticInfo||{}),ver8:Math.min(l,60),ver10:null===(s=(0,c.Yi)().collab_client_vars.dver)||void 0===s?void 0:s.substr(0,3)}),nf.getInstance().reportFPS(Math.min(l,60),String(i?Qp.FPS_FAST_SCROLL:Qp.FPS_SCROLL))),i=!1,a=0}),1e3)}};this.editor.scrollHandler.addScrollListener(l)}},(0,r.__decorate)([(0,S.tB)(),(0,r.__metadata)("design:type","function"==typeof(t=void 0!==I.O&&I.O)?t:Object)],e.prototype,"contextService",void 0),(0,r.__decorate)([(0,S.tB)(),(0,r.__metadata)("design:type","function"==typeof(n=void 0!==pt.v&&pt.v)?n:Object)],e.prototype,"eventEmitter",void 0),e}(),af=function(){function e(){}return e.prototype.$onEditorOpen=function(e){this.performanceManager=new of(e),d.GlobalContext.on($r.f8.BEFORE_REPLACE_URL,(function(){p.PerfUtil.clearMarks(),Xp.t.clearMarks()}),this)},e.prototype.$onEditorClose=function(){this.performanceManager&&(this.performanceManager.destroy(),this.performanceManager=void 0),d.GlobalContext.removeListener($r.f8.BEFORE_REPLACE_URL,this)},e=(0,r.__decorate)([(0,Vs.L)({name:ko.C.PerformanceReport,adapters:["melo","mobilePagedView"]})],e)}(),sf=n(86680),cf=n(869993),lf=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),t.prototype.initContainerRender=function(t){e.prototype.initContainerRender.call(this,t)},t.prototype.initDecoratorRender=function(t){e.prototype.initDecoratorRender.call(this,t)},t.prototype.initExtendRenderer=function(t){e.prototype.initExtendRenderer.call(this,t)},t=(0,r.__decorate)([(0,Vs.L)({name:ko.C.TdocsTdocsRender,adapters:["melo","mobilePagedView"]})],t)}(n(74935).J),uf=n(368332),df=n(436278),pf=n(984982),ff=n(695185),hf=function(){function e(){}return e.prototype.$onEditorOpen=function(e){e&&e instanceof d.MeloEditor&&this.initMathRenderer(e)},e.prototype.initMathRenderer=function(e){e.addExtendRenderer(d.ExtendRendererTypes.LeafContainer,(0,ff.O)())},e=(0,r.__decorate)([(0,Vs.L)({name:ko.C.FieldRender,adapters:["melo","mobilePagedView"]})],e)}(),mf=function(){function e(){}return e.load=function(e){e.mount((0,r.__spreadArray)([Ys.TemplateRecommendationHandler,Lp,af,sf.CoreEditHandler,io.ZoomBaseHandler,cf.TitlebarHandler,lf,uf.ZoomPcHandler,df.SnippetHandler,pf.TitleHandler,hf],(0,r.__read)([]),!1))},e}(),gf=(n(185997),["toolbar-start","toolbar-insert","toolbar-page","toolbar-reference","toolbar-review","toolbar-efficiency","toolbar-government"]),vf="toolbar-simple",_f=function(e){function t(t,n,r,i,s,c,f,g,v){var _=e.call(this)||this;return _.toolbarService=t,_.startupService=n,_.contextService=r,_.configLoader=i,_.featureService=s,_.store=c,_.workbench=f,_.configService=g,_.middlewareService=v,p.PerfUtil.mark("workbenchInitBegin"),function(){var e=new ae;if(e.initSentryErrorReport(),d.ReportHelper.errorHandler=e,!o.M.isDevEvn()||(0,p.getUrlParameter)("force_prod_env")){var t=new F;t.initMonitorErrorReport(),d.ReportHelper.monitorHandler=t;var n=new a;d.ReportHelper.tdwHandler=n;var r=new l;d.ReportHelper.zzsHandler=r}d.ReportHelper.idkeyHandler=new u,d.ReportHelper.KVRHandler=new h,d.ReportHelper.aegisHandler=new m}(),i.initConfig(),_.store.register("rootEditor",""),d.GlobalContext.on($r.f8.ON_DATA_READY,(function(){_.onDataReady()})),window.workbench=_,_}var i,s,f,g,v,_,y,b,E,C;return(0,r.__extends)(t,e),t.prototype.getHandler=function(e){return S.Am.get(Symbol.for("feature:".concat(e)))},t.prototype.onDataReady=function(){S.Am.emit("$onReset"),this.id&&this.workbench.close(this.id),this.configLoader.syncConfig(),this.init()},t.prototype.init=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var e,t,o,i=this;return(0,r.__generator)(this,(function(a){switch(a.label){case 0:return p.PerfUtil.mark("padEditorInitBegin"),mf.load(this.featureService),this.startupService.isLevel1Loaded=!0,p.PerfUtil.mark("featuresRenderInitEnd"),[4,this.workbench.open(Gs,{content:""})];case 1:return e=a.sent(),t=e.editor,o=e.id,this.settings.namespace=(0,c.Yi)().userId,this.settings.set("namespace",(0,c.Yi)().userId),this.id=o,this.store.update("rootEditor",o),p.PerfUtil.mark("padEditorInitEnd"),this.startupService.init(Ps.Ev.Pc,t,{beforeInit:function(){},initClientDataCallback:function(){return(0,r.__awaiter)(i,void 0,void 0,(function(){var e;return(0,r.__generator)(this,(function(t){switch(t.label){case 0:return[4,Promise.all([n.e(5070),n.e(9440),n.e(9820),n.e(7797),n.e(8859),n.e(6370),n.e(3712),n.e(4292),n.e(299)]).then(n.bind(n,849794))];case 1:return e=t.sent().CONTROLLERS_PC,this.settings.addMountSettings({controllers:e}),[2]}}))}))},level2LoadedCallback:function(){i.store.update(je.R.ToolbarSchemaAnimation,!0),i.hidePreloadHeaderDelay(),i.subscribeToolbarModeChange()}}),[2]}}))}))},t.prototype.subscribeToolbarModeChange=function(){var e=this;this.store.get(eo.pR).pipe((0,Wn.x)()).subscribe((function(t){t===eo.SA.SINGLE?e.settings.set("toolbar.fixedKeys",vf):t===eo.SA.DOUBLE&&e.settings.set("toolbar.fixedKeys",gf)}))},t.prototype.hidePreloadHeaderDelay=function(){to.p.hide(to.j.ALL),to.p.hideStatusbar()},t.prototype.$onReady=function(){p.PerfUtil.mark("workbenchInitEnd"),this.contextService.inject("clientVars",(function(){return(0,c.Yi)()})),this.contextService.inject("appid",""),this.configService.get("common.titlebar"),this.middlewareService.use(Ee,{on:Ur.O,callbackNames:["shouldDisabled"]}),this.middlewareService.use(Te,{on:Ur.O,callbackNames:["onClick"]}),this.middlewareService.use(Te,{on:"menu",callbackNames:["onClick"]}),this.middlewareService.use(no.AK,{on:Ur.O,callbackNames:["shouldDisabled"]}),this.middlewareService.use(no.AK,{on:"menu",callbackNames:["shouldDisabled"]}),this.middlewareService.use(no.uF,{on:Jn.L,callbackNames:["shouldDisabled"]}),this.middlewareService.use(ro.lt,{on:Ur.O,callbackNames:["shouldDisabled"]}),this.middlewareService.use(ro.lt,{on:"menu",callbackNames:["shouldDisabled"]}),this.middlewareService.use(ro.EE,{on:Jn.L,callbackNames:["shouldDisabled"]}),this.middlewareService.use(Se,{on:Ur.O,callbackNames:["shouldDisabled","onClick","tooltip"]}),this.middlewareService.use(Se,{on:"menu",callbackNames:["shouldDisabled","onClick","tooltip"]}),this.init(),this.configLoader.syncConfig(),this.setSchema()},t.prototype.$onWorkbenchInitError=function(e){console.error(e)},t.prototype.setSchema=function(){var e=this.configService.get("common.menu"),t=this.configService.get("common.toolbar"),n=this.configService.get("common.contextmenu");e&&this.configLoader.serviceSetSchema(e,"menuService"),t&&this.configLoader.serviceSetSchema(t,"toolbarService"),n&&this.configLoader.serviceSetSchema(n,"contextMenuService")},t=(0,r.__decorate)([(C={platform:"pc",menu:{schema:Ao,adapterMismatchBehavior:"disabled"},toolbar:{schema:Do,fixedKeys:(0,oo.gz)()===eo.SA.DOUBLE?gf:vf,pinnedKey:"toolbar-pinned",adapterMismatchBehavior:"disabled"},statusbar:{schema:Oo,adapterMismatchBehavior:"disabled"},contextMenu:{schema:fo,adapterMismatchBehavior:"disabled"},titlebar:{schema:[],height:56,hoverable:!0},mount:{controllers:[],features:[io.ZoomBaseHandler,ao.IEditFollowFeature],services:[so.J,co.$],overrides:[lo.ax]}},function(e){Ie.SF.set(Re.C,C,e),S.Am.set(e)}),(0,r.__metadata)("design:paramtypes",["function"==typeof(i=void 0!==Ur.O&&Ur.O)?i:Object,"function"==typeof(s=void 0!==Hs&&Hs)?s:Object,"function"==typeof(f=void 0!==I.O&&I.O)?f:Object,"function"==typeof(g=void 0!==$o&&$o)?g:Object,"function"==typeof(v=void 0!==Fe.U&&Fe.U)?v:Object,"function"==typeof(_=void 0!==He.O&&He.O)?_:Object,"function"==typeof(y=void 0!==xe.M&&xe.M)?y:Object,"function"==typeof(b=void 0!==lo.ax&&lo.ax)?b:Object,"function"==typeof(E=void 0!==Ne.K&&Ne.K)?E:Object])],t)}(ze);Xr.load(_f,document.getElementById("workbench"))},645177:function(e,t,n){var r,o,i,a,s,c,l,u,d,p,f,h;window,e.exports=(r=n(679624),o=n(176790),i=n(765274),a=n(730913),s=n(95862),c=n(556256),l=n(947750),u=n(896562),d=n(452545),p=n(790541),f=n(595764),h=n(888003),function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=14)}([function(e,t){e.exports=r},function(e,t,n){var r,o,i;n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i})),function(e){e.DOC_SID="DOC_SID",e.SID="SID",e.UID="uid",e.UID_KEY="uid_key",e.USER_TYPE="utype"}(r||(r={})),function(e){e.P_LONG_UIN="p_luin",e.P_LONG_SKEY="p_lskey",e.P_UIN="p_uin",e.P_SKEY="p_skey"}(o||(o={})),function(e){e.UID="tdoc_uid",e.SKEY="wedoc_skey"}(i||(i={}))},function(e,t){e.exports=o},function(e,t){e.exports=i},function(e,t,n){n.r(t),n.d(t,"getUid",(function(){return s})),n.d(t,"getNowUserId",(function(){return c})),n.d(t,"isLogin",(function(){return l})),n.d(t,"getSid",(function(){return u})),n.d(t,"loginType",(function(){return d})),n.d(t,"checkWeWork",(function(){return p}));var r=n(2),o=n(0),i=n(1);function a(){return location.hostname===(null===r.npmConfig||void 0===r.npmConfig?void 0:r.npmConfig.WECOM_DOMAIN)||"doc.weixin.qq.com"}function s(){var e,t,n;return(null===(e=window.global_multi_user)||void 0===e?void 0:e.uid)||(null===(n=null===(t=window.clientVars)||void 0===t?void 0:t.userInfo)||void 0===n?void 0:n.uid)||Object(o.getCookie)("uid")||(a()?Object(o.getCookie)(i.a.UID):"")}function c(){return window.nowUserIndex||s()}function l(){return!!(Object(o.getCookie)(i.c.UID)&&Object(o.getCookie)(i.c.UID_KEY)||Object(o.getCookie)(i.c.DOC_SID)||Object(o.getCookie)(i.c.SID)||Object(o.getCookie)(i.b.P_UIN)&&Object(o.getCookie)(i.b.P_SKEY)||Object(o.getCookie)(i.b.P_LONG_UIN)&&Object(o.getCookie)(i.b.P_LONG_SKEY))||!(!a()||!Object(o.getCookie)(i.a.SKEY))}function u(){var e,t;return null!==(t=null!==(e=Object(o.getCookie)(i.c.DOC_SID))&&void 0!==e?e:Object(o.getCookie)(i.c.SID))&&void 0!==t?t:""}function d(){var e,t=Object(o.getCookie)(i.c.USER_TYPE);return(null===(e=window.global_multi_user)||void 0===e?void 0:e.utype)||t}function p(){return"ww"===d()}},function(e,t){e.exports=a},function(e,t){e.exports=s},function(e,t){e.exports=c},function(e,t){e.exports=l},function(e,t){e.exports=u},function(e,t){e.exports=d},function(e,t){e.exports=p},function(e,t){e.exports=f},function(e,t){e.exports=h},function(e,t,n){n.r(t),n.d(t,"isMultiLoginGray",(function(){return V})),n.d(t,"checkMultiLoginGrayAsync",(function(){return z})),n.d(t,"mobileIsMultiLoginGray",(function(){return Q})),n.d(t,"mobileCheckMultiLoginGrayAsync",(function(){return Y})),n.d(t,"quickQQLoginAsync",(function(){return Z})),n.d(t,"quickQQLogin",(function(){return K})),n.d(t,"getUid",(function(){return J})),n.d(t,"getNowUserId",(function(){return q})),n.d(t,"isLogin",(function(){return X})),n.d(t,"loginType",(function(){return $})),n.d(t,"getLoginType",(function(){return ee})),n.d(t,"getUtype",(function(){return te})),n.d(t,"inWeWork",(function(){return ne}));var r,o=n(4),i=n(3),a=n.n(i),s=n(6),c=n.n(s),l=n(0),u=n(11),d=n.n(u),p=n(7),f=n.n(p),h=n(8),m=n.n(h),g=n(2),v=n.n(g),_=n(12),y=n.n(_),b=n(13),E=n.n(b),C=n(1),w=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},T=function(e){return e},A=function(){var e,t,n;return Object(l.getCookie)(C.c.UID)||(null===(e=window.global_multi_user)||void 0===e?void 0:e.uid)||(null===(n=null===(t=window.clientVars)||void 0===t?void 0:t.userInfo)||void 0===n?void 0:n.uid)},S=function(){function e(){f()(this,e),this.url=(null===g.npmConfig||void 0===g.npmConfig?void 0:g.npmConfig.TOGGLE_PROXY_URL)||"https://service-4y7r0fta-1251316161.gz.apigw.tencentcs.com/release/toggleProxy-1613409159",this.productEn="tdocs_manager",this.productKey="ab1ef06b-d248-4d99-b937-e18af1b82d14",this.productId="698ba977-c8d4-47cb-bf51-b79b305e38d4",this.version="1.0.1",this.moduleId="219"}return m()(e,[{key:"isEnabled",value:function(e,t){return w(this,void 0,void 0,a.a.mark((function n(){var r,o,i,s,c,l,u;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=this.productId,o=this.productEn,i=this.moduleId,s=this.version,c=this.productKey,l={productEn:o,productKey:c,toggleKey:e,productId:r,version:s,moduleId:i,data:JSON.stringify(t)},n.next=4,y.a.post(this.url,E.a.stringify(l));case 4:if(!(u=n.sent).data||0!==u.data.retCode){n.next=7;break}return n.abrupt("return",u.data.isEnabled);case 7:return n.abrupt("return",!1);case 8:case"end":return n.stop()}}),n,this)})))}}]),e}(),I=function(){function e(t){var n=this,r=t.toggleAPI,o=t.toggleKey,i=t.handlerMap,s=t.localStorageKey;f()(this,e),this.checkMultiLoginGrayAsync=function(e){return w(n,void 0,void 0,a.a.mark((function t(){var n,r,o,i,s,c,l,u,d;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return null===(r=null===(n=this.handlerMap)||void 0===n?void 0:n.checkMultiLoginGrayAsync)||void 0===r||r.call(n),void 0===e&&(e=A()||"0"),l=this._getDevContext(),u=Object.assign({userId:e},l),t.next=6,this.toggleAPI.isEnabled(this.toggleKey,u);case 6:if(!0!==(d=t.sent)){t.next=10;break}return null===(i=null===(o=this.handlerMap)||void 0===o?void 0:o.isEnabledTrue)||void 0===i||i.call(o),t.abrupt("return",this._enterGray(e));case 10:if(!1!==d){t.next=14;break}return null===(c=null===(s=this.handlerMap)||void 0===s?void 0:s.isEnabledFalse)||void 0===c||c.call(s),t.next=14,this._checkAllUserGrayState(e);case 14:case"end":return t.stop()}}),t,this)})))},this.isMultiLoginGray=function(){var e,t,r,o,i,a=n._getLocalHashMap(),s=[];for(var c in a)s.push(a[c]);var u=0!==s.length&&s.every(T),d=null!==(e=Object(l.getCookie)(C.c.DOC_SID))&&void 0!==e?e:Object(l.getCookie)(C.c.SID);return u?null===(r=null===(t=n.handlerMap)||void 0===t?void 0:t.isGrayTrue)||void 0===r||r.call(t):null===(i=null===(o=n.handlerMap)||void 0===o?void 0:o.isGrayFalse)||void 0===i||i.call(o),u||!!d},this.toggleAPI=r,this.toggleKey=o,this.handlerMap=i,this.localStorageKey=s}return m()(e,[{key:"_getLocalHashMap",value:function(){var e=localStorage.getItem(this.localStorageKey);return e&&(e=JSON.parse(e)),e||{}}},{key:"_setLocalHashMap",value:function(e){e&&localStorage.setItem(this.localStorageKey,JSON.stringify(e))}},{key:"_enterGray",value:function(e){void 0===e&&(e="0");var t=d()({},"".concat(e),!0),n=this._getLocalHashMap();this._setLocalHashMap(Object.assign(Object.assign({},n),t))}},{key:"_checkAllUserGrayState",value:function(e){return w(this,void 0,void 0,a.a.mark((function e(){var t,n,r,o,i,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this._getLocalHashMap(),n=Object.keys(t),r=[],o=0;case 4:if(!(o<n.length)){e.next=13;break}return i={userId:n[o]},e.next=8,this.toggleAPI.isEnabled(this.toggleKey,i);case 8:s=e.sent,r.push(s);case 10:o++,e.next=4;break;case 13:if(0===r.length||!r.every(T)){e.next=16;break}return e.abrupt("return");case 16:case"end":return e.stop()}}),e,this)})))}},{key:"_getDevContext",value:function(){var e=Object(l.getCookie)("dev_route_id"),t={};return e&&(t.properties={dev_route_id:e,fd:Object(l.getCookie)("fd")||"webserver"}),t}}]),e}(),R=function(e){var t;try{null===(t=null===window||void 0===window?void 0:window.AlloyReport)||void 0===t||t.zzsValue({attrid:e,value:1})}catch(e){console.warn(e)}},M=new S,O=n(9),N=n(10),k=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},L=v.a.getConfig("runtime.domainName")||"docs.qq.com",D="https://".concat(L,"/cgi-bin/online_docs/user_info"),P="https://".concat(L,"/cgi-bin/api/account-list"),x=n(5),F=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};function B(e,t){var n=e.split("?");if(t=Array.isArray(t)?t:[t],n.length>=2){for(var r=n[1].split(/[&;]/g),o=0,i=t.length;o<i;o++)for(var a="".concat(encodeURIComponent(t[o]),"="),s=r.length-1;s>=0;s--)-1!==r[s].lastIndexOf(a,0)&&r.splice(s,1);return n[0]+(r.length>0?"?".concat(r.join("&")):"")}return e}var U=(r||(r=new I({toggleAPI:M,toggleKey:"PC_multi_login",handlerMap:{isGrayTrue:function(){R("pc_multi_gray_true")},isGrayFalse:function(){R("pc_multi_gray_false")},isEnabledTrue:function(){R("pc_multi_endabled_true")},isEnabledFalse:function(){R("pc_multi_endabled_false")},checkMultiLoginGrayAsync:function(){R("pc_multi_check_multi_login")}},localStorageKey:"multi-login-gray"})),r),H=function(){return U.isMultiLoginGray()};function W(){var e=Object(x.getQuery)("jumpuin");return new Promise((function(t,n){var r;(r=parseInt(e),k(void 0,void 0,void 0,a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){var n={xsrf:Object(N.getXsrf)()};Object(O.ajaxGet)({url:P,param:n,success:function(n){if(0===n.retcode){var o=n.data,i=!1;null==o||o.forEach((function(t){if(t.uin===r&&"qq"===t.uType)return e(!0),void(i=!0)})),i||t(!1)}t(!1)},error:function(){t(!1)}})})));case 1:case"end":return e.stop()}}),e)})))).then((function(e){t(e)})).catch((function(){n(!1)}))}))}function j(){var e=Object(x.getQuery)("jumpuin"),t=Object(l.getCookie)("utype"),n=Object(l.getCookie)("p_luin")||Object(l.getCookie)("p_uin"),r=n?n.replace(/^[o0]+/i,""):null;return new Promise((function(n,o){"qq"===t&&e==r?k(void 0,void 0,void 0,a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){var n={xsrf:Object(N.getXsrf)()};Object(O.ajaxGet)({url:D,param:n,success:function(n){console.log(n),0===n.retcode?e(!0):t(!1)},error:function(){t(!1)}})})));case 1:case"end":return e.stop()}}),e)}))).then((function(e){if(console.log("checkUserLogin:",e),e){console.error("jump uin already login");var t=B(window.location.href,"jumpuin");window.history.replaceState(window.history.state,null,t)}n(e)})).catch((function(){o(!1)})):o(!1)}))}function G(){return!(c.a.isMobilePhone||c.a.isAndroidPad||!Object(x.getQuery)("jumpuin"))}var V=function(){return!0},z=function(){return new Promise((function(e){return e(!0)}))},Q=function(){return!0},Y=function(){return new Promise((function(e){return e(!0)}))},Z=function(){return F(this,void 0,void 0,a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=H(),!G()){e.next=11;break}if(!t){e.next=8;break}return e.next=5,W();case 5:case 10:return e.abrupt("return",e.sent);case 8:return e.next=10,j();case 11:return e.abrupt("return",!0);case 12:case"end":return e.stop()}}),e)})))},K=function(e){var t=H();G()&&(t?W().then((function(t){if(console.log("multiQuickLogin:",t),t){console.error("jump uin already login");var n=B(window.location.href,"jumpuin");window.history.replaceState(null,"",n)}e&&e(t)})).catch((function(t){console.log(t),e&&e(!1)})):j().then((function(t){e&&e(t)})).catch((function(){e&&e(!1)})))},J=o.getUid,q=o.getNowUserId,X=o.isLogin,$=o.loginType,ee=$,te=$,ne=o.checkWeWork}]))},176790:function(e,t,n){var r=n(623470).default;Object.defineProperty(t,"__esModule",{value:!0}),t.npmConfig=t.getAppConfigInstance=t.default=void 0;var o=r(n(223786)),i=function(){return null===o.default||void 0===o.default?void 0:o.default.getInstance()};t.getAppConfigInstance=i;var a=i(),s=null==a?void 0:a.getConfig('npm["@tencent/docs-scenario-components"]');t.npmConfig=s;var c=a;t.default=c},452545:function(e,t){function n(){var e=/iphone/gi.test(window.navigator.userAgent)&&window.devicePixelRatio&&3===window.devicePixelRatio&&(812===window.screen.width&&375===window.screen.height||375===window.screen.width&&812===window.screen.height),t=/iphone/gi.test(window.navigator.userAgent)&&window.devicePixelRatio&&3===window.devicePixelRatio&&(414===window.screen.width&&896===window.screen.height||896===window.screen.width&&414===window.screen.height),n=/iphone/gi.test(window.navigator.userAgent)&&window.devicePixelRatio&&2===window.devicePixelRatio&&(414===window.screen.width&&896===window.screen.height||896===window.screen.width&&414===window.screen.height);return e||t||n}Object.defineProperty(t,"__esModule",{value:!0}),t.checkIsIphoneX=n,t.checkPayTencentDocs=function(){var e,t,n=/TencentDocs\/[\d\.]+/.exec(window.navigator.userAgent),r=n&&n[0].split("/")||!1,o=0,i=0;if(r){var a=String(r[1]).split("."),s="1.8.1".split(".");for(o=0,t=Math.max(a.length,s.length);o<t;o++){if((i=isFinite(Number(a[o]))&&Number(a[o])||0)<(e=isFinite(Number(s[o]))&&Number(s[o])||0))return-1;if(i>e)return 1}}return 0},t.closest=function(e,t){for(var n=e.matches||e.webkitMatchesSelector||e.mozMatchesSelector||e.msMatchesSelector;e;){if(n.call(e,t))return e;e=e.parentElement}return null},t.getBkn=function(){var e=i("skey"),t=5381;if(e){for(var n=0,r=e.length;r>n;++n)t+=(t<<5)+e.charAt(n).charCodeAt();return 2147483647&t}},t.getCookie=i,t.getIOSVersion=function(){var e=navigator.userAgent.toLowerCase(),t=null;if(e.indexOf("like mac os x")>0){var n=e.match(/os [\d._]+/gi);t=String(n).replace(/[^0-9|_.]/gi,"").replace(/_/gi,"."),t=parseInt(t.split(".")[0],10)}return t},t.getLoginType=function(){var e=i("utype");return"qq"===e?1:"wx"===e?2:"ww"===e?3:0},t.getXsrf=function(){return i("TOK")||""},t.inWhichSplitView=function(){var e=o()?window.screen.width:window.screen.height,t=window.innerWidth/e;return t<.4?.33:t>=.4&&t<.6?.5:t>=.6&&t<.9?.66:1},t.isIphoneX=void 0,t.isPortrait=o;var r=n();function o(){if("number"==typeof window.orientation)return window.orientation/90%2==0;try{var e=window.screen.orientation.angle;if("number"==typeof e)return e/90%2==0}catch(e){}return!0}function i(e){var t=document.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)"));return t?decodeURIComponent(t[2]):""}t.isIphoneX=r},730913:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getQuery=function(e){var t="",n=window.location;return null!=n&&n.search&&(t=n.search.match(new RegExp("(\\?|&)"+e+"=([^&]*)(#|&|$)"))),t?decodeURIComponent(t[2]):""}},286909:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(338104).__importDefault(n(152910));t.default="data-dui-"+r.default.replace(/\./g,"-")},425378:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.i18n=void 0;var r=n(338104),o=r.__importDefault(n(598476)),i=r.__importDefault(n(25374)),a=r.__importDefault(n(144310)),s=new(r.__importDefault(n(515017)).default);"undefined"==typeof window||s.addDetector({name:"userAgent",lookup:function(){var e=navigator.userAgent.match(/language\/([a-zA-Z'-_]+)/i);if(e)return e[1].replace("_","-")}});var c={avatar:["Avatar","头像"],ok:["OK","确定"],cancel:["Cancel","取消"],select:["Select","请选择"],search:["Search","搜索选项"],hour:["H","时"],minute:["M","分"],second:["S","秒"],now:["Now","此刻"],inputHour:["Input Hour","输入小时"],inputMinute:["Input Minute","输入分"],inputSecond:["Input Second","输入秒"],close:["Close","关闭"],loadingFailed:["Loading Failed","加载失败"],noOptions:["No Options","暂无选项"],copySuccessed:["Copy Succeeded","复制成功"],copyFailed:["Copy Failed","复制失败"],eyedropper:["Eyedropper","取色器"],eyedropperFailedSafari:["Eyedropper is not supported by this browser. Please open it in Chrome","取色器暂不支持本浏览器, 请在 Chrome 中使用"],eyedropperFailedEdge:["Eyedropper is not supported by this browser. Please open it in Chrome","取色器暂不支持本浏览器, 请在 Chrome 中使用"]},l={};["en","zh-CN"].forEach((function(e,t){var n=o.default({},c,(function(e,n){return n[t]}));i.default(l,[e,"translation"],n)}));var u=a.default.createInstance();u.use(s).init({resources:l,fallbackLng:{"zh-TW":["zh-HK","zh-CN"],default:["zh-CN"]},detection:{order:["querystring","userAgent","cookie"],lookupCookie:"language",caches:[]}}),t.i18n=function(e){return u.t(e)}},152910:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default="0.123.2"},534977:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(338104),o=n(620943).h,i=r.__importStar(n(87363)),a=r.__importStar(n(234272));n(390354).D("components/Loading/style/spin.css",'[data-dui-0-123-2~="dui-spin"]{position:relative;width:100%;height:100%}[data-dui-0-123-2~="dui-spin-container"]{position:absolute;left:50%;top:50%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-flow:row nowrap;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;width:48px;height:48px}[data-dui-0-123-2~="dui-spin-circle"]{border-radius:50%;width:100%;height:100%;-webkit-animation:dui-spin-rotate .8s linear infinite;animation:dui-spin-rotate .8s linear infinite;-webkit-box-sizing:border-box;box-sizing:border-box}[data-dui-0-123-2~="dui-spin-circle-light"]{border:4px solid hsla(0,0%,100%,.4);border-top-color:#fff}[data-dui-0-123-2~="dui-spin-circle-dark"]{border:4px solid rgba(0,0,0,.12);border-top-color:rgba(0,0,0,.32)}[data-dui-0-123-2~="dui-spin-circle-primary"]{border:4px solid rgba(30,111,255,.24);border-top:4px solid var(--accent-default,#1e6fff)}@-webkit-keyframes dui-spin-rotate{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes dui-spin-rotate{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}');var s=n(751950),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rootRef=i.createRef(),t.themedRender=function(e){var n=t.props,r=n.prefixCls,i=n.className,a=n.style,s=n.type,c=n.circleClassName,l=n.circleStyle,u=e(r,i),d=e(r+"-circle",r+"-circle-"+s,c);return o("div",{className:u,style:a,ref:t.rootRef},o("div",{className:e(r+"-container"),style:t.calcContainerTransform()},o("div",{className:d,style:l})))},t}return r.__extends(t,e),t.prototype.calcContainerTransform=function(){var e=this.rootRef.current;if(e){var t=e.clientWidth,n=e.clientHeight;return{transform:"translate(-50%,-50%) scale("+Math.min(t,n)/48+")"}}},t.prototype.componentDidMount=function(){this.forceUpdate()},t.prototype.render=function(){return s.consumeTheme(this.themedRender)},t}(i.PureComponent);t.default=c,c.defaultProps={prefixCls:"dui-spin",type:"dark"},c.propTypes={prefixCls:a.string,style:a.object,className:a.string,type:a.oneOf(["light","dark","primary"]),circleClassName:a.string,circleStyle:a.object}},463468:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(338104),o=n(620943).h,i=r.__importStar(n(87363)),a=r.__importStar(n(234272)),s=n(376957),c=n(751950),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ref=i.createRef(),t.themedRender=function(e){var n=t.props,i=n.prefixCls,a=n.className,c=n.style,l=n.children,u=e(i,a);return o("div",{className:u,style:r.__assign({position:"relative"},c),ref:t.ref},o(s.ContainerContext.Provider,{value:t.ref.current},l))},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.forceUpdate()},t.prototype.render=function(){return c.consumeTheme(this.themedRender)},t}(i.Component);t.default=l,l.defaultProps={prefixCls:"dui-snackbar-container"},l.propTypes={prefixCls:a.string,style:a.object,className:a.string}},295130:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(338104),o=n(620943).h,i=r.__importStar(n(87363)),a=r.__importDefault(n(661533)),s=n(445247),c=n(715395),l=r.__importDefault(n(534977)),u=n(376957),d=n(751950),p=n(514885),f=n(92849),h=n(425378),m=function(e){function t(){var t,n=e.apply(this,arguments)||this;return n.selfRef=i.createRef(),n.disableAutoFocus=s.isBrowser&&(null===(t=window.__dui_disable_auto_focus_map__)||void 0===t?void 0:t.Snackbar),n.handleClickAction=function(){n.props.onClickAction(),n.handleClose()},n.handleClose=function(){n.props.onClose()},n.themedRender=function(e){var t,i=n.props,s=i.prefixCls,l=i.className,u=i.style,d=i.action,m=i.children,g=i.message,v=i.visible,_=i.closable,y=i.type,b=i.zIndex,E=i.showIcon,C=i.testId,w=e(s+"-message");if(!c.decideKeepDom.call(n,f.SNACKBAR_LEAVING_TRANSITION_DURATION,v))return null;var T=n.getContainerDom(),A=e(s,l,s+"-top",s+"-"+y,((t={})[s+"-with-icon"]=E&&!n.renderUserSetIcon(e),t[s+"-hidden"]=!v,t[s+"-in-container"]=T!==document.body,t));return a.default.createPortal(o("div",{className:A,style:r.__assign({zIndex:b,marginTop:p.getMarginTop(n)+"px"},u),ref:n.selfRef,role:"alert","aria-live":"assertive","aria-atomic":!0,"data-testid":C},n.renderIcon(e),o("span",{className:w},m||g),d||_?o("span",{className:e(s+"-controls")},n.renderAction(e),_?o("button",{className:e(s+"-close"),onClick:n.handleClose,"aria-label":h.i18n("close")}):null):null),T)},n}return r.__extends(t,e),t.prototype.getContainerDom=function(){return s.isDom(this.context)?this.context:this.props.containerDom},t.prototype.componentDidMount=function(){this.handleEffect()},t.prototype.componentDidUpdate=function(){this.handleEffect()},t.prototype.handleEffect=function(){this.fixShrinkedWidthForIE(),p.updateVisibleSnackbars(this)},t.prototype.fixShrinkedWidthForIE=function(){var e=this.props,t=e.visible,n=e.style;if(t&&s.isIE()){var r=this.selfRef.current;if(r&&(!n||!("width"in n))){var o=r.style.left;r.style.left="-9999px";var i=r.getBoundingClientRect().width;r.style.width=i+"px",r.style.left=o}}},t.prototype.renderUserSetIcon=function(e){var t=this.props,n=t.prefixCls,r=t.type,a=t.showIcon,s=t.icon;return a&&s?i.isValidElement(s)?o("div",{className:e(n+"-icon-container")},s):"object"==typeof s&&s[r]?o("div",{className:e(n+"-icon-container")},s[r]):null:null},t.prototype.renderAction=function(e){var t=this,n=this.props,r=n.prefixCls,i=n.action;return i?Array.isArray(i)&&i.length>0&&i[0].text?o("span",{className:e(r+"-actions")},i.map((function(n,i){return o("button",{key:i,className:e(r+"-action"),onClick:function(){var e;null===(e=n.onClick)||void 0===e||e.call(n),t.handleClose()},autoFocus:!t.disableAutoFocus&&0===i},n.text)}))):o("button",{className:e(r+"-action"),onClick:this.handleClickAction,autoFocus:!this.disableAutoFocus},i):null},t.prototype.renderIcon=function(e){var t=this.props,n=t.prefixCls,r=t.spinType,i=t.type;if(!t.showIcon)return null;var a=this.renderUserSetIcon(e);return a||("loading"===i?o(l.default,{type:r,className:e(n+"-loading-indicator"),circleClassName:e(n+"-loading-indicator-circle")}):null)},t.prototype.render=function(){return d.consumeTheme(this.themedRender)},t.contextType=u.ContainerContext,t}(i.Component);t.default=m,m.defaultProps={prefixCls:"dui-snackbar",onClickAction:s.emptyFn,closable:!1,type:"info",onClose:s.emptyFn,showIcon:!0,containerDom:"undefined"!=typeof document?document.body:void 0,spinType:"primary"}},92849:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SNACKBAR_LEAVING_TRANSITION_DURATION=void 0,t.SNACKBAR_LEAVING_TRANSITION_DURATION=200},376957:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.ContainerContext=void 0;var r=n(338104).__importStar(n(87363));t.ContainerContext=r.createContext(null)},681620:function(e,t,n){var r=n(338104),o=r.__importDefault(n(295130));o.default,n(390354).D("components/Snackbar/style/index.css",'@-webkit-keyframes dui-snackbar-slide-in{0%{opacity:0;-webkit-transform:translate(-50%,-20px);transform:translate(-50%,-20px)}to{opacity:1;-webkit-transform:translate(-50%);transform:translate(-50%)}}@keyframes dui-snackbar-slide-in{0%{opacity:0;-webkit-transform:translate(-50%,-20px);transform:translate(-50%,-20px)}to{opacity:1;-webkit-transform:translate(-50%);transform:translate(-50%)}}@-webkit-keyframes dui-snackbar-slide-in-container{0%{opacity:0;-webkit-transform:translate(-50%,-10px);transform:translate(-50%,-10px)}to{opacity:1;-webkit-transform:translate(-50%);transform:translate(-50%)}}@keyframes dui-snackbar-slide-in-container{0%{opacity:0;-webkit-transform:translate(-50%,-10px);transform:translate(-50%,-10px)}to{opacity:1;-webkit-transform:translate(-50%);transform:translate(-50%)}}[data-dui-0-123-2~="dui-snackbar"]{-webkit-box-sizing:border-box;box-sizing:border-box;position:fixed;z-index:10000;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-flow:row nowrap;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;left:50%;height:40px;border-radius:4px;padding:10px 10px 10px 12px;-webkit-box-shadow:0 4px 20px 0 rgba(0,0,0,.08);box-shadow:0 4px 20px 0 rgba(0,0,0,.08);border:1px solid rgba(0,0,0,.08);background-color:var(--bg-lv4-default,#fff);color:var(--text-ultrastrong,rgba(0,0,0,.88));font-size:14px;white-space:nowrap;-webkit-transform:translateX(-50%);transform:translateX(-50%);-webkit-animation:dui-snackbar-slide-in .4s cubic-bezier(.4,0,.2,1);animation:dui-snackbar-slide-in .4s cubic-bezier(.4,0,.2,1);-webkit-transition-property:opacity,-webkit-transform;transition-property:opacity,-webkit-transform;transition-property:opacity,transform;transition-property:opacity,transform,-webkit-transform;-webkit-transition-duration:.2s;transition-duration:.2s;-webkit-transition-timing-function:cubic-bezier(.4,0,.2,1);transition-timing-function:cubic-bezier(.4,0,.2,1)}[data-dui-0-123-2~="dui-snackbar-with-icon"]:before{content:"";display:inline-block;background-position:50%;background-repeat:no-repeat;background-size:contain}[data-dui-0-123-2~="dui-snackbar-icon-container"],[data-dui-0-123-2~="dui-snackbar-with-icon"]:before{width:20px;height:20px;margin-right:8px}[data-dui-0-123-2~="dui-snackbar-info"]:before{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' width=\'20\' height=\'20\' fill-rule=\'evenodd\'%3E%3Ccircle cx=\'10\' cy=\'10\' r=\'8\' fill=\'%231e6fff\'/%3E%3Cg fill=\'%23fff\'%3E%3Cpath d=\'M11.778 14.89V14h-.9V8.668H8.223v.89h.888V14h-.89v.89h3.556z\'/%3E%3Ccircle cx=\'10\' cy=\'6.444\' r=\'1.333\'/%3E%3C/g%3E%3C/svg%3E")}[data-dui-0-123-2~="dui-snackbar-error"]:before{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' width=\'20\' height=\'20\'%3E%3Cpath fill=\'%23fff\' d=\'M10 2a8 8 0 110 16 8 8 0 110-16zm0 10.222a1.333 1.333 0 100 2.665 1.333 1.333 0 000-2.664zm1.333-7.1H8.667l.444 6.22h1.778l.444-6.222z\' fill-rule=\'evenodd\'/%3E%3C/svg%3E")}[data-dui-0-123-2~="dui-snackbar-success"]:before{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' width=\'20\' height=\'20\' fill-rule=\'evenodd\'%3E%3Ccircle cx=\'10\' cy=\'10\' r=\'8\' fill=\'%2308ea86\'/%3E%3Cpath fill=\'%23fff\' d=\'M7.47 9.167l1.645 1.646 4.126-4.125 1.178 1.178-5.303 5.303-2.824-2.824L7.47 9.167z\'/%3E%3C/svg%3E")}[data-dui-0-123-2~="dui-snackbar-warning"]:before{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' width=\'20\' height=\'20\'%3E%3Cpath fill=\'%23ff4747\' d=\'M10 2a8 8 0 110 16 8 8 0 110-16zm0 10.222a1.333 1.333 0 100 2.665 1.333 1.333 0 000-2.664zm1.333-7.1H8.667l.444 6.22h1.778l.444-6.222z\' fill-rule=\'evenodd\'/%3E%3C/svg%3E")}[data-dui-0-123-2~="dui-snackbar-error"]{background-color:var(--critical-default,#ff4747);border-color:transparent;color:var(--bg-lv1-default,#fff)}[data-dui-0-123-2~="dui-snackbar-loading"]:before{content:none}[data-dui-0-123-2~="dui-snackbar-loading-indicator"]{width:16px;height:16px;margin:0 10px 0 2px}[data-dui-0-123-2~="dui-snackbar-loading-indicator-circle"]{border-width:6px}[data-dui-0-123-2~="dui-snackbar-hidden"]{opacity:0;-webkit-transform:translateX(-50%) translateY(-20px);transform:translateX(-50%) translateY(-20px)}[data-dui-0-123-2~="dui-snackbar-top"]{top:105px}[data-dui-0-123-2~="dui-snackbar-bottom"]{bottom:105px}[data-dui-0-123-2~="dui-snackbar-in-container"]{-webkit-animation-name:dui-snackbar-slide-in-container;animation-name:dui-snackbar-slide-in-container;position:absolute;top:14px}[data-dui-0-123-2~="dui-snackbar-in-container"][data-dui-0-123-2~="dui-snackbar-hidden"]{-webkit-transform:translate(-50%,-10px);transform:translate(-50%,-10px)}[data-dui-0-123-2~="dui-snackbar-message"]{color:inherit}[data-dui-0-123-2~="dui-snackbar-controls"]{margin-left:12px;line-height:20px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-flow:row nowrap;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center}[data-dui-0-123-2~="dui-snackbar-controls"]>:not(:last-child){margin-right:10px}[data-dui-0-123-2~="dui-snackbar-action"],[data-dui-0-123-2~="dui-snackbar-close"]{display:inline-block;border-radius:2px;cursor:pointer;border:none;margin:0;padding:0;background:transparent;-webkit-tap-highlight-color:transparent}[data-dui-0-123-2~="dui-snackbar-action"]:hover,[data-dui-0-123-2~="dui-snackbar-close"]:hover{background-color:var(--feedback-hover,rgba(51,77,102,.06))}[data-dui-0-123-2~="dui-snackbar-action"]:active,[data-dui-0-123-2~="dui-snackbar-close"]:active{background-color:var(--feedback-active,rgba(51,77,102,.08))}[data-dui-0-123-2~="dui-snackbar-actions"]>:not(:first-child){margin-left:7px}[data-dui-0-123-2~="dui-snackbar-action"]{color:var(--text-link,#175ceb);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;padding:0 4px;font-weight:500;font-size:14px}[data-dui-0-123-2~="dui-snackbar-error"] [data-dui-0-123-2~="dui-snackbar-action"],[data-dui-0-123-2~="dui-snackbar-error"] [data-dui-0-123-2~="dui-snackbar-close"]{color:var(--bg-lv1-default,#fff)}[data-dui-0-123-2~="dui-snackbar-error"] [data-dui-0-123-2~="dui-snackbar-action"]:hover,[data-dui-0-123-2~="dui-snackbar-error"] [data-dui-0-123-2~="dui-snackbar-close"]:hover{background-color:hsla(0,0%,100%,.24)}[data-dui-0-123-2~="dui-snackbar-error"] [data-dui-0-123-2~="dui-snackbar-action"]:active,[data-dui-0-123-2~="dui-snackbar-error"] [data-dui-0-123-2~="dui-snackbar-close"]:active{background-color:hsla(0,0%,100%,.4)}[data-dui-0-123-2~="dui-snackbar-close"]{width:20px;height:20px;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' width=\'16\' height=\'16\'%3E%3Cpath fill=\'%2381868f\' fill-rule=\'evenodd\' d=\'M8.63 8L13 12.368l-.632.632L8 8.63 3.632 13 3 12.368 7.368 8 3 3.632 3.632 3 8 7.368 12.368 3l.632.632L8.63 8z\'/%3E%3C/svg%3E");background-position:50%;background-size:16px;background-repeat:no-repeat}[data-dui-0-123-2~="dui-snackbar-error"] [data-dui-0-123-2~="dui-snackbar-close"]{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' width=\'16\' height=\'16\'%3E%3Cpath fill=\'%23fff\' fill-rule=\'evenodd\' d=\'M8.63 8L13 12.368l-.632.632L8 8.63 3.632 13 3 12.368 7.368 8 3 3.632 3.632 3 8 7.368 12.368 3l.632.632L8.63 8z\'/%3E%3C/svg%3E")}');var i=r.__importDefault(n(109595)),a=r.__importDefault(n(463468)),s=n(514885);o.default.show=i.default,o.default.closeAll=s.closeAll,o.default.closeById=s.closeById,o.default.Container=a.default,t.ZP=o.default},514885:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.closeById=t.closeAll=t.getMarginTop=t.updateVisibleSnackbars=void 0;var n=50;function r(e){var t=e.getContainerDom();return t.__dui_visible_snackbars__=t.__dui_visible_snackbars__||[],t.__dui_visible_snackbars__}function o(e){return r(e).findIndex((function(t){return t.instance===e}))}function i(e){var t=r(e),n=e.props.id;if(n){var o=t.findIndex((function(e){return e.instance.props.id===n}));if(o>=0)return t[o]}var i=t.findIndex((function(e){return e.instance.props.autoClose}));return i>=0?t[i]:null}function a(e){var t=i(e);if(t)return t.marginTop;var o=r(e).map((function(e){return e.marginTop})).sort((function(e,t){return e-t}));if(0===o.length)return 0;for(var a=0;a<o.length;a++){var s=n*a;if(s!==o[a])return s}return o[o.length-1]+n}t.updateVisibleSnackbars=function(e){var t=e.props.visible,n=o(e),s=r(e);if(t&&-1===n){var c=i(e);null==c||c.instance.handleClose(),s.push({instance:e,marginTop:a(e)})}t||-1===n||s.splice(n,1)},t.getMarginTop=function(e){var t=o(e),n=r(e);return-1!==t?n[t].marginTop:a(e)},t.closeAll=function(e){var t=document.body.__dui_visible_snackbars__;null==t||t.filter((function(t){var n=t.instance.props,r=n.autoClose,o=n.closable;return e||r||o})).forEach((function(e){return e.instance.handleClose()}))},t.closeById=function(e){var t=document.body.__dui_visible_snackbars__;null==t||t.filter((function(t){return t.instance.props.id===e})).forEach((function(e){return e.instance.handleClose()}))}},109595:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(338104).__importDefault(n(295130)),o=n(779370),i=n(445247),a=n(92849);t.default=i.wrapWithConfigDefaults((function(e){var t=e.autoClose,n=void 0===t||t;return e.autoClose=n,o.showWithTransition({Component:r.default,transitionDuration:a.SNACKBAR_LEAVING_TRANSITION_DURATION,autoClose:n,props:e,injectClosePropNames:["onClose"],contexts:e.contexts})}))},620943:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.h=t.isScopedAttributeDisabled=void 0;var r,o,i=n(338104),a=n(87363),s=i.__importDefault(n(286909)),c=n(445247);t.isScopedAttributeDisabled=("object"==typeof window&&(r=window.__dui_disable_scoped_attribute__),"object"==typeof n.g&&(o=n.g.__dui_disable_scoped_attribute__),Boolean(r||o)),c.isBrowser&&(window.__dui_disable_auto_focus_map__=window.__dui_disable_auto_focus_map__||{}),t.h=function(e,n){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];var c=n;return(null==n?void 0:n.className)&&"string"==typeof e&&!t.isScopedAttributeDisabled&&(c[s.default]=n.className),a.createElement.apply(void 0,i.__spreadArray([e,c],r))}},445247:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.createContextValueGetter=t.shallowEqual=t.isBrowser=t.isDom=t.wrapWithConfigDefaults=t.inject=t.assert=t.isIE=t.createStringParamFunc=t.canBeDivided=t.roundByStep=t.castInto=t.nullFn=t.trueFn=t.falseFn=t.emptyFn=void 0;var r,o=n(338104),i=o.__importDefault(n(85180));function a(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);return n.length===r.length&&n.every((function(n){return e[n]===t[n]}))}t.emptyFn=function(){},t.falseFn=function(){return!1},t.trueFn=function(){return!0},t.nullFn=function(){return null},t.castInto=function(e,t){return e>t[1]?t[1]:e<t[0]?t[0]:e},t.roundByStep=function e(t,n){if(t<0)return-e(-t,n);var r=t%n;return r<n/2?t-r:t-r+n},t.canBeDivided=function(e,t){var n=e/t;return(0|n)===n},t.createStringParamFunc=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=t.map((function(e){return Number(e)}));return e.apply(void 0,r)}},t.isIE=function(){if("boolean"==typeof r)return r;var e=navigator.userAgent;return r=!(!/compatible/.test(e)||!/MSIE/.test(e))||!(!/Trident/.test(e)||!/rv:11\.0/.test(e))},t.assert=function(e,t){e||console.error(t)},t.inject=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=e.apply(null,n);return!1!==o&&t(),o}},t.wrapWithConfigDefaults=function(e){var t={},n=function(n){var r=o.__assign(o.__assign({},t),n);return e(r)};return n.configDefaults=function(e){t=e},n},t.isDom=function(e){return e&&"object"==typeof e&&1===e.nodeType},t.isBrowser="undefined"!=typeof window&&"undefined"!=typeof document,t.shallowEqual=a,t.createContextValueGetter=function(){return i.default((function(e){return e}),(function(e,t){return a(e[0],t[0])}))}},715395:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.decideKeepDom=void 0,t.decideKeepDom=function(e,t){var n=this,r=!t&&this._ALC_HELPER_prevVisible;return this._ALC_HELPER_prevVisible=t,!!t||!!r&&(setTimeout((function(){n.forceUpdate()}),e),!0)}},105697:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),"function"!=typeof String.prototype.repeat&&(String.prototype.repeat=function(e){if(null==this)throw new TypeError("can't convert "+this+" to object");var t=""+this;if((e=+e)!=e&&(e=0),e<0)throw new RangeError("repeat count must be non-negative");if(e==1/0)throw new RangeError("repeat count must be less than infinity");if(e=Math.floor(e),0==t.length||0==e)return"";if(t.length*e>=1<<28)throw new RangeError("repeat count must not overflow maximum string size");var n=t.length*e;for(e=Math.floor(Math.log(e)/Math.log(2));e;)t+=t,e--;return t+=t.substring(0,n-t.length)}),"function"!=typeof String.prototype.padStart&&(String.prototype.padStart=function(e,t){return e|=0,t=String(void 0!==t?t:" "),this.length>e?String(this):((e-=this.length)>t.length&&(t+=t.repeat(e/t.length)),t.slice(0,e)+String(this))}),"function"!=typeof Array.prototype.fill&&(Array.prototype.fill=function(e){if(null==this)throw new TypeError("this is null or not defined");for(var t=Object(this),n=t.length>>>0,r=0|arguments[1],o=r<0?Math.max(n+r,0):Math.min(r,n),i=arguments[2],a=void 0===i?n:0|i,s=a<0?Math.max(n+a,0):Math.min(a,n);o<s;)t[o]=e,o++;return t}),"undefined"!=typeof Element&&"function"!=typeof Element.prototype.remove&&(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),Array.prototype.findIndex||(Array.prototype.findIndex=function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var r=arguments[1],o=0;o<n;){var i=t[o];if(e.call(r,i,o,t))return o;o++}return-1}),Array.prototype.includes||(Array.prototype.includes=function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),r=n.length>>>0;if(0===r)return!1;for(var o,i,a=0|t,s=Math.max(a>=0?a:r-Math.abs(a),0);s<r;){if((o=n[s])===(i=e)||"number"==typeof o&&"number"==typeof i&&isNaN(o)&&isNaN(i))return!0;s++}return!1})},779370:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.showWithTransition=void 0;var r=n(338104),o=n(620943).h,i=r.__importDefault(n(661533)),a=n(445247);t.showWithTransition=function(e){var t,n=e.Component,s=e.transitionDuration,c=e.autoClose,l=e.props,u=e.forcedProps,d=e.injectClosePropNames,p=void 0===d?[]:d,f=e.deepInjectClose,h=void 0===f?[]:f,m=e.contexts,g=document.createElement("div");document.body.appendChild(g);var v=!1;p.forEach((function(e){y(l,e)})),h.forEach((function(e){var t=e[0],n=e[1];Array.isArray(t)?t.forEach((function(e){return y(e,n)})):y(t,n)}));var _=r.__assign(r.__assign(r.__assign({},l),u),{visible:!0});function y(e,t){var n=e[t]||a.emptyFn;e[t]=a.inject(n,b)}function b(){v||(v=!0,clearTimeout(t),E(_=r.__assign(r.__assign({},_),{visible:!1})),setTimeout((function(){i.default.unmountComponentAtNode(g),g.remove()}),s+20))}function E(e){var t=(null==m?void 0:m.length)?function(e,t){return e.reduce((function(e,t){var n=t.provider,r=t.value;return o(n,{value:r},e)}),t)}(m,o(n,r.__assign({},e))):o(n,r.__assign({},e));i.default.render(t,g)}return E(_),c&&(t=setTimeout(b,l.duration||2e3)),{update:function(e){v||E(_=r.__assign(r.__assign(r.__assign(r.__assign({},_),e),u),{visible:!0}))},close:b}}},390354:function(e,t,n){t.D=void 0;var r=n(338104).__importDefault(n(152910)),o=n(620943),i=n(445247),a=function(){function e(){var e=i.isBrowser?window:n.g;e.__dui_style_registry__=e.__dui_style_registry__||{},this.registry=e.__dui_style_registry__}return Object.defineProperty(e.prototype,"length",{get:function(){return Object.keys(this.registry).length},enumerable:!1,configurable:!0}),e.prototype.set=function(e,t){this.registry[e]=t},e.prototype.get=function(e){return this.registry[e]},e.prototype.add=function(e,t){this.registry[e]||(this.registry[e]=[]),this.registry[e].push(t)},e}(),s=new a;t.D=function(e,t){var n=r.default+"-"+e,a=o.isScopedAttributeDisabled?e:n,u=Boolean(i.isBrowser&&document.querySelector('style[data-dui-key="'+a+'"]')||!i.isBrowser);if(Array.isArray(s.get(n))&&u)return s.add(n,"1"),void function(e){if(i.isBrowser&&s.length&&Array.isArray(s.get(e))){var t=s.get(e).length;setTimeout((function(){s.get(e).length>t||console.warn("[DUI] "+e+" 重复引入了 "+t+" 次")}),c)}}(n);s.set(n,["1"]);var d=l(e);if(d.length>1&&function(e,t){i.isBrowser&&setTimeout((function(){l(e).length>t.length||console.warn("[DUI] "+e+" 存在多个版本:  "+t.join("  "))}),c)}(e,d),i.isBrowser)(p=document.createElement("style")).setAttribute("type","text/css"),p.setAttribute("data-dui-key",a),p.innerText=t,document.head.appendChild(p);else if("function"==typeof injectContentBeforeRoot){var p='<style type="text/css" data-dui-key="'+a+'">'+t+"</style>";injectContentBeforeRoot(p)}};var c=3e3;function l(e){return s.length?Object.getOwnPropertyNames(s.registry).filter((function(t){return-1!==t.indexOf(e)})).map((function(e){return e.split("-")[0]})):[]}},751950:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.createThemedClassNames=t.consumeTheme=void 0;var r=n(338104),o=n(620943).h,i=r.__importStar(n(87363)),a=r.__importDefault(n(473590)),s=r.__importDefault(n(95862));n(105697),n(390354).D("common/global.css","[data-dui-0-123-2]{font-family:-apple-system,PingFang SC,Microsoft YaHei,Source Han Sans SC,Noto Sans CJK SC,WenQuanYi Micro Hei,sans-serif}[data-dui-0-123-2]:focus{outline:none}"),s.default.isMac&&!s.default.isIPadEmulatedMac&&!s.default.isFirefox&&n(390354).D("common/anti-alias.css",'[data-dui-0-123-2]{-webkit-font-smoothing:antialiased}[data-dui-0-123-2~="dui-button"]{font-weight:500}');var c=i.createContext(null);function l(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return function(e,t){if(!t||!e)return t;var n=t.split(/\s+/);return n.concat.apply(n,n.map((function(t){return e[t]})).filter((function(e){return e}))).join(" ")}(e,a.default.apply(void 0,t))}}t.consumeTheme=function(e){return o(c.Consumer,null,(function(t){var n=l(t);return e(n)}))},t.createThemedClassNames=l,t.default=c},28259:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.TOAST_TRANSITION_DURATION=void 0;var r=n(338104),o=n(815892).h,i=r.__importStar(n(87363)),a=r.__importDefault(n(661533)),s=r.__importDefault(n(473590)),c=n(206159);t.TOAST_TRANSITION_DURATION=200;var l=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(n,e),n.prototype.componentDidMount=function(){console.warn("PC端Toast组件不符合交互规则，为避免破坏性更新，当前版本仍将提供。未来会移除此组件，请尽量使用Snackbar组件。")},n.prototype.render=function(){var e,n,r=this.props,i=r.prefixCls,l=r.className,u=r.style,d=r.children,p=r.content,f=r.visible,h=r.mask,m=r.position,g=s.default(i,l,i+"-"+m,((e={})[i+"-hidden"]=!f,e)),v=s.default(i+"-mask",((n={})[i+"-mask-display"]=h,n[i+"-mask-hidden"]=!f,n));return c.decideKeepDom.call(this,t.TOAST_TRANSITION_DURATION,f)?a.default.createPortal(o("div",{className:v},o("div",{className:g,style:u},d||p)),document.body):null},n}(i.Component);t.default=l,l.defaultProps={prefixCls:"dui-toast",visible:!1,content:"",mask:!1,position:"top"}},266008:function(e,t,n){var r=n(338104),o=r.__importDefault(n(28259));o.default,n(304372).D("components/Toast/style/index.css",'@-webkit-keyframes dui-toast-slide-in-top{0%{opacity:0;-webkit-transform:scaleX(1) translateY(-50px);transform:scaleX(1) translateY(-50px)}to{opacity:1;-webkit-transform:scaleX(1) translate(0);transform:scaleX(1) translate(0)}}@keyframes dui-toast-slide-in-top{0%{opacity:0;-webkit-transform:scaleX(1) translateY(-50px);transform:scaleX(1) translateY(-50px)}to{opacity:1;-webkit-transform:scaleX(1) translate(0);transform:scaleX(1) translate(0)}}@-webkit-keyframes dui-toast-slide-in-bottom{0%{opacity:0;-webkit-transform:scaleX(1) translateY(50px);transform:scaleX(1) translateY(50px)}to{opacity:1;-webkit-transform:scaleX(1) translate(0);transform:scaleX(1) translate(0)}}@keyframes dui-toast-slide-in-bottom{0%{opacity:0;-webkit-transform:scaleX(1) translateY(50px);transform:scaleX(1) translateY(50px)}to{opacity:1;-webkit-transform:scaleX(1) translate(0);transform:scaleX(1) translate(0)}}@-webkit-keyframes dui-toast-fade-in{0%{opacity:0}to{opacity:1}}@keyframes dui-toast-fade-in{0%{opacity:0}to{opacity:1}}[data-dui-1-2-0~="dui-toast"]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;padding:10px 20px;background:rgba(0,0,0,.8);border-radius:2px;font-size:14px;color:#fff;-webkit-transition:all .2s ease-out;transition:all .2s ease-out}[data-dui-1-2-0~="dui-toast-top"][data-dui-1-2-0~="dui-toast-hidden"]{opacity:0;-webkit-transform:scaleX(1) translateY(-50px);transform:scaleX(1) translateY(-50px)}[data-dui-1-2-0~="dui-toast-top"]{margin-top:100px;-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;-webkit-animation:dui-toast-slide-in-top .2s ease-out;animation:dui-toast-slide-in-top .2s ease-out}[data-dui-1-2-0~="dui-toast-bottom"][data-dui-1-2-0~="dui-toast-hidden"]{opacity:0;-webkit-transform:scaleX(1) translateY(50px);transform:scaleX(1) translateY(50px)}[data-dui-1-2-0~="dui-toast-bottom"]{margin-bottom:100px;-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;-webkit-animation:dui-toast-slide-in-bottom .2s ease-out;animation:dui-toast-slide-in-bottom .2s ease-out}[data-dui-1-2-0~="dui-toast-mask"]{position:fixed;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;z-index:10000;top:0;left:0;right:0;bottom:0;pointer-events:none;-webkit-transition:all .2s linear;transition:all .2s linear}[data-dui-1-2-0~="dui-toast-mask-display"]{background:rgba(0,0,0,.15);pointer-events:auto;-webkit-animation:dui-toast-fade-in .2s linear;animation:dui-toast-fade-in .2s linear}[data-dui-1-2-0~="dui-toast-mask-hidden"]{opacity:0;visibility:hidden}');var i=r.__importDefault(n(884710));o.default.show=i.default,t.ZP=o.default},884710:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(338104).__importStar(n(28259)),o=n(944316);t.default=function(e){return o.showWithTransition({Component:r.default,transitionDuration:r.TOAST_TRANSITION_DURATION,autoClose:!0,props:e,contexts:e.contexts})}},225525:function(e,t,n){n.d(t,{VF:function(){return se}});var r=n(74320),o=n(95862),i=n(937069),a=n(64792),s=n.n(a),c=n(923549),l=n(765274),u=n.n(l),d=n(489712),p=n(616832),f=n(70324),h=n(178940),m=n(558352),g=(i.default.default||i.default).getInstance().getConfig('npm["@tencent/tencent_doc_net"]'),v="undefined"==typeof location?"":location.host,_=(null==g?void 0:g.TOB_HOST)||"doc.weixin.qq.com",y=new RegExp((null==g?void 0:g.TOB_HOST_REGEXP)||"^doc\\.weixin\\.qq\\.com","i");null==g||g.esLogUrl;var b,E,C=Object.values((null==g?void 0:g.REPORT_URLS)||["report.idqqimg.com","aegis.qq.com","report.url.cn","access.toggle.qq.com","event.toggle.qq.com"]),w=Object.values((null==g?void 0:g.WEBSOCKET_URLS)||["docs.qq.com/websocket"]),T=Object.values((null==g?void 0:g.OTHER_URLS)||["gz.apigw.tencentcs.com","otheve.beacon.qq.com","casestudy.html5.qq.com","docrp.weixin.qq.com"]),A=Object.values((null==g?void 0:g.PRIVATE_REPORT_URLS)||["report.idqqimg.com","aegis.qq.com","report.url.cn","access.toggle.qq.com","event.toggle.qq.com","docrp.weixin.qq.com/report/","at.idqqimg.com/node/weblog"]),S=["data_report_collection"].concat((0,r.Z)(C)),I=(0,r.Z)(w),R=[].concat((0,r.Z)(T),[".json"]),M=["data_report_collection"].concat((0,r.Z)(A)),O=[].concat(["fcg_get_multiple_strategy","cgi-bin/online_docs/wxqrcode","cgi-bin/online_docs/polling","docs/components/assets.v4.json","myqcloud.com"],(0,r.Z)(S),(0,r.Z)(I),(0,r.Z)(R)),N=[10004,10005,11e3,11005,1e5,12105,12100,60006,-20002,-1001],k=[10004,30004],L=1e3;function D(){return"undefined"!=typeof window?window:"undefined"!=typeof self?self:void 0}function P(e){var t=new RegExp("(?:^|;+|\\s+)".concat(e,"=([^;]*)")),n=null,r=D();return null!=r&&r.document&&(n=r.document.cookie.match(t)),(n?n[1]:"")||null}function x(e,t){var n=e.split("?");if(n.length>=2){var r="".concat(encodeURIComponent(t),"="),o=n[1].split(/[&;]/g);console.warn(o,n[1],n[1].split(/[&;]/g));for(var i=o.length;i-=1;i>0)-1!==o[i].lastIndexOf(r,0)&&o.splice(i,1);return e=n[0]+(o.length>0?"?".concat(o.join("&")):"")}return e}function F(e,t){var n,r=function(e){return"string"==typeof e?e:e.search}(t||(null===(n=D())||void 0===n||null===(n=n.location)||void 0===n?void 0:n.href)||"").match(new RegExp("(\\?|&)".concat(e,"=([^&]*)(#|&|$)")));return r?decodeURIComponent(r[2]):""}function B(e,t){try{if(-1===e.responseURL.indexOf(location.host))return 0;var n=e.getResponseHeader(t);if(null!==n)return Number(n)}catch(e){}return 0}var U=null!==(b=null===(E=window.global_multi_user)||void 0===E?void 0:E.queryUserIndex)&&void 0!==b?b:F("u");function H(){var e;return(null===(e=window.global_multi_user)||void 0===e?void 0:e.nowUserIndex)||U||window.nowUserIndex}var W=function(e){return e.UPDATE_USER_INDEX="account:update-user-index",e.DELETE_USER_INDEX="account:delete-user-index",e}(W||{}),j=!1;function G(){navigator.serviceWorker&&setTimeout((function(){var e;H()&&(V(),void 0!==document.hidden?e="visibilitychange":void 0!==document.msHidden?e="msvisibilitychange":void 0!==document.webkitHidden&&(e="webkitvisibilitychange"),document.addEventListener(e,(function(){"visible"===document.visibilityState&&V()})))}),L)}function V(){var e,t,n;j||null===(e=navigator.serviceWorker)||void 0===e||null===(e=e.controller)||void 0===e||e.postMessage({type:W.UPDATE_USER_INDEX,data:{url:"https://".concat(v).concat(location.pathname),userIndex:H(),userType:(null===(n=window.global_multi_user)||void 0===n?void 0:n.utype)||"",uid:(null===(t=window.global_multi_user)||void 0===t?void 0:t.uid)||""}})}function z(e){var t=!1;return O.forEach((function(n){e.indexOf(n)>-1&&(t=!0)})),t}function Q(e){var t=function(e){return e.indexOf("user_info?")>0&&e.indexOf("u=login")>0}(e),n=F("u",e);if(t||e&&n||z(e))return e;var r=window.nowUserIndex,o=e,i=e.split(/(\?|#)/),a=i[0],s=i[2]?"&".concat(i[2]):"";return J()&&(o="".concat(a,"?u=").concat(null!=r?r:"").concat(s)),o}function Y(){var e,t=location.href,n="",r=F("debug");U&&"1"!==r&&(e=location.pathname,!/^\/(desktop|mall)/i.test(e))&&(n=x(t,"u"),window.history.replaceState(null,"",n))}function Z(e){if(e){var t,n,r,o,i,a,s,c,l,u,d,p=(t="u",n=e,o=(null===(r=D())||void 0===r?void 0:r.location)||{},i=o.host,a=o.search,s=void 0===a?"":a,c=o.pathname,l=o.hash,u="".concat(s,"&").concat(t,"=").concat(n),d=s.indexOf("?")>=0?u:"?".concat(u),"https://".concat(i).concat(c).concat(d).concat(l));window.history.replaceState(null,"",p)}}function K(){window.global_multi_user||(window.global_multi_user={}),function(){var e,t=null===(e=window.global_multi_user)||void 0===e?void 0:e.nowUserIndex;t&&(window.global_multi_user.changeByServer=!0)}();var e=H();return window.nowUserIndex=e,!(!e&&J())}function J(){return!!P("SID")||!!P("DOC_SID")}function q(){console.info("----- re add user index");var e=location.href;setTimeout((function(){var t;F("u",e)||null!==(t=navigator.serviceWorker)&&void 0!==t&&null!==(t=t.controller)&&void 0!==t&&t.scriptURL.includes("service-worker.js")||Z(H())}),L)}s().setCallback((function(e){e&&10001===e.code&&(j=!0)}));var X=v===_,$=function(e){return!(!X||o.default.isWxWork||o.default.isTencentMeeting||o.default.isWxWorkTencentMeeting)&&!!function(e){try{return!!e&&new URL(e).host===_}catch(e){console.error(e)}return!1}(e.responseURL)&&function(e,t){if("-20078"===e||"session disable by admin"===t){window.__is_ent_login_forbidden=!0;var n=new Event("ENT_LOGIN_FORBIDDEN");return window.dispatchEvent(n),!0}return!1}(e.getResponseHeader("x-session-ret")||void 0,function(e){try{var t,n,r="string"==typeof e?JSON.parse(e):e;return void 0!==(null==r||null===(t=r.head)||void 0===t?void 0:t.ret)&&(null==r||null===(n=r.head)||void 0===n?void 0:n.msg)||""}catch(e){return""}}(e.response))};function ee(e){var t,n;if(null!==(t=window)&&void 0!==t&&t.log){var r=e.type,o=e.options;null===(n=window)||void 0===n||null===(n=n.log)||void 0===n||n[r](o)}}var te=v===_;function ne(e){try{return function(e){var t,n,r,o;return void 0!==(null==e?void 0:e.retcode)?e.retcode:void 0!==(null==e?void 0:e.code)?e.code:void 0!==(null==e?void 0:e.retCode)?e.retCode:void 0!==(null==e||null===(t=e.head)||void 0===t?void 0:t.ret)?e.head.ret:void 0!==(null==e||null===(n=e.header)||void 0===n?void 0:n.code)?e.header.code:void 0!==(null==e||null===(r=e.result)||void 0===r||null===(r=r.etype)||void 0===r?void 0:r.retcode)?e.result.etype.retcode:void 0!==(null==e||null===(o=e.param)||void 0===o?void 0:o.retcode)?e.param.retcode:0}("string"==typeof e?JSON.parse(e):e)}catch(e){return 0}}var re,oe,ie=function(e){return e[e.PENDING=0]="PENDING",e[e.SUCCESS=1]="SUCCESS",e[e.FAIL=2]="FAIL",e[e.EMPTY=3]="EMPTY",e}(ie||{}),ae=function(){function e(){(0,f.Z)(this,e),(0,m.Z)(this,"retryNum",0),(0,m.Z)(this,"MAX_RETRY_NUM",3),(0,m.Z)(this,"renewPromise",void 0),(0,m.Z)(this,"defaultPromise",void 0),(0,m.Z)(this,"renewState",ie.EMPTY),(0,m.Z)(this,"needRenewUrl",[]),this.defaultPromise=new Promise((function(e){return e()})),this.renewPromise=this.defaultPromise}return(0,h.Z)(e,[{key:"awaitLoginTicket",value:function(e){return this.needRenewUrl.includes(e)?this.renewPromise:this.defaultPromise}},{key:"renewTicket",value:function(e){var t=this.canRenewLoginticket();return t&&this.insertRenewUrl(e),this.renewState!==ie.PENDING&&t?(this.renewPromise=this.createRenewPromise(),!0):t}},{key:"renewSuccess",value:function(e){this.needRenewUrl.includes(e)&&(this.retryNum=0,this.renewPromise=this.defaultPromise,this.clearRenewUrl())}},{key:"insertRenewUrl",value:function(e){this.needRenewUrl.includes(e)||this.needRenewUrl.push(e)}},{key:"clearRenewUrl",value:function(){this.needRenewUrl=[]}},{key:"renewFail",value:function(){console.warn("续票失败,重置promise"),ee({type:"warn",options:{msg:"续票失败,重置promise"}}),this.renewPromise=this.defaultPromise,this.clearRenewUrl()}},{key:"createRenewPromise",value:function(){var e=this;return new Promise((function(t,n){e.renewState=ie.PENDING;var r=t,o=n;t=function(){e.renewState=ie.SUCCESS,r.apply(void 0,arguments)},n=function(){e.renewState=ie.FAIL,o.apply(void 0,arguments)};var i=window.tdocs;if(!e.canRenewLoginticket())return console.warn("且连续请求次数达到最大次，就直接rj"),ee({type:"warn",options:{msg:"且连续请求次数达到最大次，就直接rj"}}),void n();e.retryNum+=1,null==i||i.docLogin().then((function(r){if(!r||r.retcode)return console.warn("续票失败!:",e.retryNum,r.retcode),ee({type:"warn",options:{msg:"续票失败"}}),void e.createRenewPromise().then(t).catch(n);console.warn("single 续票成功, 准备重发请求"),ee({type:"warn",options:{msg:"single 续票成功, 准备重发请求"}}),t()})).catch((function(){e.renewState=ie.FAIL,e.renewFail();for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];n(r)}))}))}},{key:"canRenewLoginticket",value:function(){var e;return(null===(e=window.tdocs)||void 0===e?void 0:e.docLogin)&&this.retryNum<this.MAX_RETRY_NUM}}]),e}(),se=new ae,ce=o.default.isWxWork,le=null===(re=window)||void 0===re||null===(re=re.XMLHttpRequest)||void 0===re?void 0:re.prototype,ue=null==le?void 0:le.open,de=null==le?void 0:le.send,pe=null==le?void 0:le.setRequestHeader,fe=null===(oe=window)||void 0===oe?void 0:oe.fetch,he=3;function me(e,t){var n,r=t.args,o=t.shouldSetCurrentUserIndex,i=t.readyStateChange;i&&(i.call(e),null!==(n=window)&&void 0!==n&&n.PRIVATE||o&&function(e,t){var n,r;if(!te){var o=(null==e?void 0:e.responseURL)||t,i=(null==e||null===(n=e.target)||void 0===n||null===(r=n.getResponseHeader)||void 0===r?void 0:r.call(n,"content-type"))||"";if(!z(o)&&o&&["application/json; charset=UTF-8","text/plain; charset=utf-8","application/json","application/x-javascript; charset=utf-8"].includes(i)){var a;if(200!==e.status)return(0,p.monitor)(35469267),null===(a=window)||void 0===a||null===(a=a.log)||void 0===a||a.log("网络拦截：status:".concat(e.status," ,url:").concat(o)),void(0,p.tdw)({opername:"multi",module:"multi-net",action:"multi-cgi-result",ver1:Date.now(),ver2:e.status,ver3:o,ver4:navigator.userAgent,ver5:JSON.stringify(e.response)});(0,p.monitor)(35469266);try{var s;0!=ne(e)&&((0,p.monitor)(35469268),null===(s=window)||void 0===s||null===(s=s.log)||void 0===s||s.log("网络拦截: url:".concat(o," ,response:").concat(JSON.stringify(e.response))),(0,p.tdw)({opername:"multi",module:"multi-net",action:"multi-cgi-result",ver1:Date.now(),ver2:e.status,ver3:o,ver4:navigator.userAgent,ver5:JSON.stringify(e.response)}))}catch(e){}}}}(e.response,r[1]))}function ge(e){if(window&&"XMLHttpRequest"in window){le.hijackXmlOpen=function(){var t,n=this;n.requestStart=Date.now();for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];n.requestOpenParams=o,n.headerMap=n.headerMap||new Map;var a=null===(t=n.requestOpenParams)||void 0===t?void 0:t[1];if(!ve(a)){n.retryTimes=n.retryTimes||0,n.isLoaded=!1;var s,c=o,l=(s=this.responseType,!["blob","document","arraybuffer"].includes(s));e&&l&&(c=o.map((function(e,t){return 1===t&&e?Q(e):e})));var u=(0,d.Q6)({url:o[1],method:o[0]}).url;return u!==o[1]&&(c[1]=u),null==ue?void 0:ue.apply(n,c)}console.log("[私有化上报]拦截 XML",a)},le.open=le.hijackXmlOpen,le.hijackXmlSend=(0,c.Z)(u().mark((function e(){var t,r,i,a,s,c=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!ve(null===(t=(r=this).requestOpenParams)||void 0===t?void 0:t[1])){e.next=5;break}return o(r),e.abrupt("return");case 5:for(n(r),i=c.length,a=new Array(i),s=0;s<i;s++)a[s]=c[s];return r.requestSendParams=a,e.abrupt("return",null==de?void 0:de.apply(r,a));case 9:case"end":return e.stop()}}),e,this)}))),le.send=le.hijackXmlSend,le.setRequestHeader=function(e,t){var n,r,o=this;ve(null===(n=o.requestOpenParams)||void 0===n?void 0:n[1])||(null===(r=o.headerMap)||void 0===r||r.set(e,t),null==pe||pe.call(o,e,t))};var t=function(e,t){var n;ve(null===(n=e.requestOpenParams)||void 0===n?void 0:n[1])||null==t||t.forEach((function(t,n){e.setRequestHeader(n,t)}))},n=function(n){var o,i=n;i.originOnload=i.originOnload?i.originOnload:i.onload||function(){},i.originOnloadend=i.originOnloadend?i.originOnloadend:i.onloadend||function(){},i.originOnreadystatechange=i.originOnreadystatechange?i.originOnreadystatechange:i.onreadystatechange||function(){};var a=new Promise((function(e){o=e})),s=function(){var e=(0,c.Z)(u().mark((function e(){var t,n,r,o,s,c,l,d=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=d.length,r=new Array(n),o=0;o<n;o++)r[o]=d[o];if(null===(t=i.originOnreadystatechange)||void 0===t||t.call(i,r),i.isLoaded||4!==i.readyState){e.next=9;break}return e.next=5,a;case 5:l=e.sent,null===(s=i.originOnload)||void 0===s||s.call(i,l),i.isLoaded=!0,null===(c=i.originOnloadend)||void 0===c||c.call(i,l);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();i.onload=function(e){var t;null===(t=o)||void 0===t||t(e)},i.onloadend=i.onload,i.onreadystatechange=function(){if(200===i.status&&4===i.readyState){var n;if($(i))return;if(l=i.response,ye(null!==(u=ne(l))&&void 0!==u?u:0)){if(i.retryTimes<1){i.retryTimes+=1,i.hijackXmlOpen.apply(i,(0,r.Z)(i.requestOpenParams)),t(i,i.headerMap),i.hijackXmlSend.apply(i,(0,r.Z)(i.requestSendParams));var o="scode不匹配,尝试重发请求 retryTimes=".concat(i.retryTimes);console.warn(o),ee({type:"warn",options:{msg:o}})}else me(i,{args:i.requestOpenParams,shouldSetCurrentUserIndex:e,requestStart:i.requestStart,readyStateChange:s});return}if(function(e,t){var n,r=function(e){return e&&(B(e,"trpc-func-ret")||B(e,"cgi_code"))||0}(t),o=null!==(n=ne(e))&&void 0!==n?n:0;return _e(o,r)}(i.response,i)){var a=i.requestOpenParams[1];return se.renewTicket(a)&&i.retryTimes<he?(i.retryTimes+=1,console.warn("需要续票,重发请求"),ee({type:"warn",options:{msg:"需要续票,重发请求"}}),void se.awaitLoginTicket(a).then((function(){i.hijackXmlOpen.apply(i,(0,r.Z)(i.requestOpenParams)),t(i,i.headerMap),i.hijackXmlSend.apply(i,(0,r.Z)(i.requestSendParams))})).catch((function(e){console.warn(e,"续票失败!~~~~~"),ee({type:"warn",options:{msg:"续票失败!~~~~~"}})}))):(ee({type:"warn",options:{msg:"需要续票, 但是已经到重试上限"}}),console.warn("需要续票, 但是已经到重试上限"),void me(i,{args:i.requestOpenParams,shouldSetCurrentUserIndex:e,requestStart:i.requestStart,readyStateChange:s}))}var c=null===(n=i.requestOpenParams)||void 0===n?void 0:n[1];i.retryTimes=0,se.renewSuccess(c),me(i,{args:i.requestOpenParams,shouldSetCurrentUserIndex:e,requestStart:i.requestStart,readyStateChange:s})}else me(i,{args:i.requestOpenParams,shouldSetCurrentUserIndex:e,requestStart:i.requestStart,readyStateChange:s});var l,u}},o=function(e){var t=e;t.send=function(){},t.originOnload=function(){},t.originOnreadystatechange=function(){},t.onload=function(){},t.onreadystatechange=function(){},t.setRequestHeader=function(){}}}}function ve(e){var t;if(null===(t=window)||void 0===t||!t.PRIVATE||!e)return!1;var n="string"==typeof e?e:e.href;return M.findIndex((function(e){return n.includes(e)}))>-1}function _e(e,t){var n,r;return!!(null!==(n=window.tdocs)&&void 0!==n&&n.docLogin&&ce&&(r=location.host,y.test(r)))&&(N.includes(e)||k.includes(null!=t?t:0))}function ye(e){return-20036===e}function be(e){return Ee.apply(this,arguments)}function Ee(){return(Ee=(0,c.Z)(u().mark((function e(t){var n,r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=-1,e.prev=1,e.next=4,t.json();case 4:r=e.sent,n=ne(r),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),n=0;case 11:return e.abrupt("return",n);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})))).apply(this,arguments)}window.AI_SPACE={fetch:fe};var Ce=!1,we=function(){var e,t,n,r=o.default.isMiniProgram;!r&&Y(),!r&&q(),e=["otel_traceparent","otel_tracestate","otel_baggage"],t=location.href,n="",e.forEach((function(e){F(e)&&(n=x(t,e))})),n&&window.history.replaceState(null,"",n),function(){var e=location.href,t="",n="wwapp_cst";(F("cst")||F("st")||F(n))&&(t=x(e,n),t=x(t,"wwapp_vid"),t=x(t,"wwapp_deviceid"),t=x(t,"cst"),t=x(t,"vid"),t=x(t,"st"),window.history.replaceState(null,"",t))}(),function(){var e=location.href,t="",n="is_precreate",r="newEmptyDoc",o="dver";(F(n)||F(r)||F(o))&&(t=x(e,n),t=x(t,r),t=x(t,o),window.history.replaceState(null,"",t))}()};!function(e){console.warn("初始化拦截器-2.0");var t=o.default.isMiniProgram;e&&O.splice.apply(O,[0,0].concat((0,r.Z)(e.urlWhiteList))),"undefined"==typeof window||window.hadIntercepted?console.log("[doc-net]:已经初始化过网络拦截器了"):(Ce=K(),!t&&G(),ge(Ce),window&&"fetch"in window&&(window.fetch=function(e,t){if(ve(e))return new Promise(function(){var t=(0,c.Z)(u().mark((function t(n){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("[私有化上报]拦截 fetch",e),n("fetch 请求': ".concat(e));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());var n=e;return K()&&(n=Q(e)),new Promise(function(){var r=(0,c.Z)(u().mark((function r(o,i){return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,se.awaitLoginTicket(e);case 2:console.warn(" wait :",e),null==fe||fe(n,t).then(function(){var r=(0,c.Z)(u().mark((function r(i){var a,s,c;return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a=i.clone(),r.next=3,be(a);case 3:if(!ye(s=r.sent)){r.next=9;break}return c="scode不匹配,尝试重发请求, url=".concat(n),console.warn(c),ee({type:"warn",options:{msg:c}}),r.abrupt("return",null==fe?void 0:fe(e,t).then((function(e){return o(e)})));case 9:if(!_e(s)){r.next=12;break}if(!se.renewTicket(n)){r.next=12;break}return r.abrupt("return",window.fetch(e,t).then((function(e){return o(e)})));case 12:se.renewSuccess(e),o(i);case 14:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()).catch((function(e){console.log(e),i(e)}));case 4:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}())}),we(),window.hadIntercepted=!0)}()},953981:function(e,t,n){n.d(t,{x:function(){return f}});var r=n(981879),o=n(511969),i=n(87363),a=n.n(i),s=n(95862),c="base-module_button__8benR",l="base-module_mobile-button__gGTIT",u="base-module_button-plain__MdPCj",d="base-module_button-primary__4OraC",p=["type","children","className"],f=function(e){var t=e.type,n=void 0===t?"plain":t,i=e.children,f=e.className,h=(0,o.Z)(e,p),m=[c,f];return"primary"===n?m.push(d):"plain"===n&&m.push(u),s.default.isMobile&&m.push(l),a().createElement("span",(0,r.Z)({},h,{className:m.join(" ")}),i)}},40494:function(e,t,n){n.d(t,{wq:function(){return kt},vM:function(){return tt}});var r=n(352177),o=n(783504),i=n(923549),a=n(70324),s=n(178940),c=n(558352),l=n(765274),u=n.n(l),d=n(87363),p=n.n(d),f=n(338156),h=n(20871),m=n(613402),g=n(953981),v=(n(467060),n(95862)),_=n(473590),y=n.n(_),b=n(285485),E=n(184253),C=n(948763),w=n(493626),T=n(592870),A=n(774945),S=n(386818),I=n(920412),R=n(74320),M=n(994280),O=n(935536),N=n(681620),k=n(227052),L=n.n(k),D=n(981879),P=n(751501),x=n(473924),F=n(165076),B=n(945556),U=n(333529),H=n(768749),W=n(399213),j=n(576278),G=n(586600),V=n(247650),z={tag:"svg",attrs:{viewBox:"0 0 8 8",width:"1em",height:"1em"},children:[{tag:"g",attrs:{id:"Icon/1-Common/cross-8",fill:"none",stroke:"none",fillRule:"evenodd",strokeWidth:1},children:[{tag:"g",attrs:{id:"Path",stroke:"#979797",transform:"translate(.47 .47)",strokeLinecap:"round"},children:[{tag:"path",attrs:{id:"直线",d:"M.07.07L7 7"}},{tag:"path",attrs:{id:"直线备份",d:"M.07.07L7 7",transform:"matrix(-1 0 0 1 7.07 0)"}}]},{tag:"path",attrs:{id:"cross",fill:"currentColor",d:"M.82.12l.07.06 3.1 3.11L7.12.18l.07-.06a.5.5 0 01.64.77l-3.11 3.1 3.11 3.12a.5.5 0 01-.64.77l-.07-.06L4 4.71.89 7.82l-.07.06a.5.5 0 01-.64-.77L3.29 4 .18.89A.5.5 0 01.82.12z"}}]}]},Q=(0,d.forwardRef)((function(e,t){return(0,d.createElement)(V.A,Object.assign({},e,{id:"cross-8",ref:t,icon:z}))}));Q.displayName="Cross8";var Y=Q;function Z(e){var t,n=e.arrow,r=void 0===n||n,o=e.children,i=e.showEvenOverlayEmpty,a=void 0!==i&&i,s=e.mouseEnterDelay,l=void 0===s?200:s,u=e.mouseLeaveDelay,f=void 0===u?l:u,h=e.transitionSpeed,m=void 0===h?200:h,g=e.title,v=e.placements,_=void 0===v?"bottom":v,b=e.isMaintainPlacement,E=void 0!==b&&b,C=e.trigger,w=e.visible,T=e.backgroundColor,A=e.overlayStyle,S=e.overlayClassName,I=void 0===S?"":S,R=e.contentStyle,M=e.contentClassName,O=void 0===M?"":M,N=e.arrowStyle,k=e.arrowClassName,L=void 0===k?"":k,V=e.zIndex,z=void 0===V?"auto":V,Q=e.showCloseBtn,Z=void 0!==Q&&Q,K=e.tip,J=e.content,q=e.isUnMount,X=void 0===q||q,$=e.minimumEdge,ee=void 0===$?3:$,te=e.onVisibleChange,ne=e.disabled,re=void 0!==ne&&ne,oe=e.scrollListener,ie=e.viewport,ae=e.isHiddenOutsideViewport,se=void 0!==ae&&ae,ce=e.isObserverOverlayReSize,le=void 0!==ce&&ce,ue=function(e){var t=d.Children.only(e);if("number"==typeof t||"string"==typeof t)throw new TypeError("[wec] expect child to be a ReactElement");return t}(o),de=(0,d.useRef)(null),pe=(0,d.useRef)(null),fe=(0,d.useRef)(null),he=(0,x._)({visible:w&&!!g,transitionSpeed:m,changeVisibleCallback:te,disabled:re}),me=he.visible,ge=he.show,ve=he.hide,_e=(0,d.useMemo)((function(){return!g&&!J}),[g,J]),ye=(0,F.I)({triggers:C?(0,G.VL)(C):void 0,show:function(){a?ge():_e||ge()},hide:ve,child:ue,visible:me,delay:l,leaveDelay:f,disabled:re}),be=ye.callbacks,Ee=ye.overlayCallbacks,Ce=(0,B.Sl)({origin:function(){return pe.current},overlay:function(){return de.current},arrow:function(){return fe.current},flexible:!0,placements:(0,G.VL)(_),visible:me,arrowGap:12,overlayRadius:3,minimumEdge:ee,disabled:re,scrollListener:oe,viewport:ie,isMaintainPlacement:E,isHiddenOutsideViewport:se,isObserverOverlayReSize:le}),we=Ce.placement,Te=Ce.overlayPoint,Ae=Ce.arrowMoveTransform,Se=Ce.isShowOverlay,Ie=y()((t={popover:!0},(0,c.Z)(t,"popover-show-arrow",r&&(0,B.iU)(we)),(0,c.Z)(t,"popover-placement-".concat(we),!0),(0,c.Z)(t,"popover-show",w||me),t)),Re=Te?{top:"".concat(Te.y,"px"),left:"".concat(Te.x,"px"),display:Se?"block":"none"}:null;return p().createElement(d.Fragment,null,p().createElement(U.h,{prefix:"popover",position:"fixed",zIndex:z},p().createElement(H.L,{detectTarget:function(){return de.current},disabled:w||"click"!==C&&"contextMenu"!==C,onClickOutside:function(){return ve()}},p().createElement(P.Z,{in:!(!Te||!me),timeout:m,classNames:"popover",unmountOnExit:X},p().createElement("div",(0,D.Z)({style:(0,D.Z)((0,D.Z)((0,D.Z)({},Re),A),{transitionDuration:"".concat(m,"ms")}),className:"".concat(Ie," ").concat(I),ref:de},Ee),(0,W.Y)(r&&(0,B.iU)(we),p().createElement("div",{className:"popover-arrow ".concat(L),ref:fe,style:(0,D.Z)((0,D.Z)({borderColor:T},N),{transform:Ae})})),p().createElement("div",{className:"popover-content ".concat(O),style:(0,D.Z)({backgroundColor:T},R)},J||p().createElement("div",{className:"popover-content-main"},g,p().createElement("div",{className:"popover-content-main-tip"},(0,W.Y)(K,K))),(0,W.Y)(Z,p().createElement(Y,{className:"popover-content-cross",onClick:function(){return ve()}}))))))),(0,d.cloneElement)(ue,(0,D.Z)((0,D.Z)((0,D.Z)({},ue.props),be),{ref:(0,j.s)(pe)})))}var K=n(661337),J=n.n(K),q={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"url(#progress-ring-white-16_paint0_linear_1_26)",d:"M8 15A7 7 0 108 1v3a4 4 0 010 8v3z"}},{tag:"path",attrs:{fill:"url(#progress-ring-white-16_paint1_linear_1_26)",d:"M8 1a7 7 0 000 14v-3a4 4 0 010-8V1z"}},{tag:"path",attrs:{fill:"#fff",d:"M8 15a1.5 1.5 0 010-3v3z"}},{tag:"defs",attrs:{},children:[{tag:"linearGradient",attrs:{id:"progress-ring-white-16_paint0_linear_1_26",x1:11.5,x2:11.5,y1:3.23,y2:15,gradientUnits:"userSpaceOnUse"},children:[{tag:"stop",attrs:{stopColor:"#fff",stopOpacity:.38}},{tag:"stop",attrs:{offset:.61,stopColor:"#fff"}}]},{tag:"linearGradient",attrs:{id:"progress-ring-white-16_paint1_linear_1_26",x1:4.5,x2:4.5,y1:3.23,y2:15,gradientUnits:"userSpaceOnUse"},children:[{tag:"stop",attrs:{stopColor:"#fff",stopOpacity:.38}},{tag:"stop",attrs:{offset:1,stopColor:"#fff",stopOpacity:0}}]}]}],defIds:["progress-ring-white-16_paint0_linear_1_26","progress-ring-white-16_paint1_linear_1_26"]},X=(0,d.forwardRef)((function(e,t){return(0,d.createElement)(V.A,Object.assign({},e,{id:"progress-ring-white-16",ref:t,icon:q}))}));X.displayName="ProgressRingWhite16";var $=X,ee={tag:"svg",attrs:{fill:"none",viewBox:"0 0 20 20",width:"1em",height:"1em"},children:[{tag:"g",attrs:{clipPath:"url(#play-circle-fill-20_clip0_886_28780)"},children:[{tag:"circle",attrs:{cx:10,cy:10,r:10,fill:"currentColor",fillOpacity:.5}},{tag:"circle",attrs:{cx:10,cy:10,r:9.5,stroke:"#fff",strokeOpacity:.5}},{tag:"path",attrs:{fill:"#fff",d:"M8 6.93c0-.4.45-.63.78-.41l4.6 3.06c.3.2.3.64 0 .84l-4.6 3.06a.5.5 0 01-.78-.41V6.93z"}}]},{tag:"defs",attrs:{},children:[{tag:"clipPath",attrs:{id:"play-circle-fill-20_clip0_886_28780"},children:[{tag:"rect",attrs:{width:20,height:20,fill:"#fff",rx:10}}]}]}],defIds:["play-circle-fill-20_clip0_886_28780"]},te=(0,d.forwardRef)((function(e,t){return(0,d.createElement)(V.A,Object.assign({},e,{id:"play-circle-fill-20",ref:t,icon:ee}))}));te.displayName="PlayCircleFill20";var ne,re=te,oe=n(930607),ie=n(64802),ae=n(616832),se=null!==(ne="undefined"==typeof window?null:window.i18n)&&void 0!==ne?ne:o.ZP;function ce(e,t){var n=null==se?void 0:se.t(e,t);return n||"".concat(e)}!function(e,t){var n=function(n){se&&se.getResource&&se.addResource&&Object.entries(e).forEach((function(e){var o=(0,r.Z)(e,2),i=o[0],a=o[1];Object.entries(a).forEach((function(e){var o=(0,r.Z)(e,2),a=o[0],s=o[1],c=null!=t?t:n.defaultNS||"legacy";se.getResource(i,c,a)||se.addResource(i,c,a,s)}))}))};if(se&&"undefined"!=typeof window){if(window.noSharedI18next&&!window.i18n){window.i18n=o.ZP;var i="zh-CN";try{var a=localStorage.getItem("shared-language");a&&(i=a)}catch(e){}o.ZP.init({lng:i,resources:{},debug:!0,ns:"legacy",defaultNS:"legacy"})}se.isInitialized?n(se.options):se.on("initialized",n)}}({"en-US":{"发起人：":"Initiator: ","参与人：":"Participants: ","地点：":"Location: ","添加会议":"Add meeting","等共{{num}}人":"etc. {{num}} people","共{{num}}人":"all {{num}} people","开始录制":"start recording","每天":"Every day","每周工作日":"Monday to Friday","每周":"Every week","每两周":"Every two weeks","每月":"Every month","{{ repeat }}重复，{{ until }}结束":"{{ repeat }} until {{ until }}","第 {{num}} 场":"Math {{num}}","会议室：":"Room: ","已结束":"Ended","进行中":"Doing","进入会议":"Join Meeting","录制生成中":"Load Video","查看录制":"View Video","会议记录":"Record",check:"Check","暂不支持此功能，请升级企业微信后使用":"This function is not supported at the moment, please use it after upgrading WeChat Enterprise","请在企业微信中使用此功能":"Please use this function in Enterprise WeChat","会议已被发起人删除":"The meeting has been deleted by the initiator","已加入会议":"Joined the meeting","年":" ","已取消":"Cancelled","查看详情":"Check detail","添加到我的会议":"Add to my meeting"},"zh-CN":{"发起人：":"发起人：","参与人：":"参与人：","地点：":"地点：","添加会议":"添加会议","等共{{num}}人":"等共{{num}}人","共{{num}}人":"共{{num}}人","开始录制":"开始录制","{{ repeat }}重复，{{ until }}结束":"{{ repeat }}重复，{{ until }}结束","第 {{num}} 场":"第 {{num}} 场","MM-dd":"M月d日","yyyy-":"yyyy年","会议室：":"会议室：","已结束":"已结束","进行中":"进行中","进入会议":"进入会议","录制生成中":"录制生成中","查看录制":"查看录制","会议记录":"会议记录",check:"查看","暂不支持此功能，请升级企业微信后使用":"暂不支持此功能，请升级企业微信后使用","请在企业微信中使用此功能":"请在企业微信中使用此功能","会议已被发起人删除":"会议已被发起人删除","已加入会议":"已加入会议","已取消":"已取消","查看详情":"查看详情","添加到我的会议":"添加到我的会议"},"zh-HK":{"发起人：":"發起人：","参与人：":"參與人：","地点：":"地點：","添加会议":"添加會議","等共{{num}}人":"等共{{num}}人","共{{num}}人":"共{{num}}人","开始录制":"開始錄製","{{ repeat }}重复，{{ until }}结束":"{{ repeat }}重復，{{ until }}結束","第 {{num}} 场":"第 {{num}} 場","会议室：":"會議室：","已结束":"已結束","进行中":"進行中","进入会议":"進入會議","录制生成中":"錄製生成中","查看录制":"查看錄製","会议记录":"會議記錄",check:"查看","暂不支持此功能，请升级企业微信后使用":"暫不支持此功能，請升級企業微信後使用","请在企业微信中使用此功能":"請在企業微信中使用此功能","会议已被发起人取消":"會議已被發起人取消","已加入会议":"已加入會議","已取消":"已取消","查看详情":"查看詳情","添加到我的会议":"添加到我的會議"}});var le="MeetingCard-module_meeting-card-wrapper__ZIXgK",ue="MeetingCard-module_icon-left__S6apF",de="MeetingCard-module_content__toj8d",pe="MeetingCard-module_c-top__MH9dW",fe="MeetingCard-module_top-left__M8KiP",he="MeetingCard-module_subject__-5Ziq",me="MeetingCard-module_top-info__yy6Mk",ge="MeetingCard-module_btn-container__t9rab",ve="MeetingCard-module_repeat__cyddZ",_e="MeetingCard-module_sub-divide__ci0Rx",ye="MeetingCard-module_sub__qwr20",be="MeetingCard-module_margin-top-2__s0m9c",Ee="MeetingCard-module_participants-wrapper__P5IZq",Ce="MeetingCard-module_participants__qUl-d",we="MeetingCard-module_no-shrink__EMxLg",Te="MeetingCard-module_mobile-meeting-card-wrapper__NQncv",Ae="MeetingCard-module_active__Pe0y-";function Se(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,w.Z)(e);if(t){var o=(0,w.Z)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,C.Z)(this,n)}}var Ie,Re,Me,Oe,Ne=function(e){(0,E.Z)(n,e);var t=Se(n);function n(e){var r;return(0,a.Z)(this,n),(r=t.call(this)).data=e,r}return(0,s.Z)(n)}((0,T.Z)(Error));!function(e){e[e.Unknown=0]="Unknown",e[e.Doing=1]="Doing",e[e.Done=2]="Done"}(Ie||(Ie={})),function(e){e[e.EveryDay=0]="EveryDay",e[e.MondayToFriday=1]="MondayToFriday",e[e.EveryWeek=2]="EveryWeek",e[e.EveryTwoWeek=3]="EveryTwoWeek",e[e.EveryMonth=4]="EveryMonth"}(Re||(Re={})),function(e){e.Success="0",e.Disabled="-65000046"}(Me||(Me={})),function(e){e[e.Wait=1]="Wait",e[e.Doing=2]="Doing",e[e.Ended=3]="Ended"}(Oe||(Oe={}));var ke,Le=o.ZP.language,De=function(){switch(Le){case"en":case"en-US":return S.Z;case"zh-CN":default:return A.Z;case"zh-HK":return I.Z}},Pe=function(){return{locale:(0,d.useMemo)(De,[Le])}},xe="status-module_status__V69zJ",Fe="status-module_dot__OX7hk",Be="status-module_text__UAhvB",Ue="status-module_doing__r6nIR",He="status-module_done__DJCIm";function We(){return p().createElement("div",{className:"".concat(xe," ").concat(He)},p().createElement("span",{className:Fe}),p().createElement("span",{className:Be},ce("已结束")))}function je(){return p().createElement("div",{className:"".concat(xe," ").concat(Ue)},p().createElement("img",{src:"data:image/gif;base64,R0lGODlhDAAMAMQWAHvWkFLLbiG+RSO+R+z177XmwcTqzTTDVT7GXqDgsHfVjvT39SC9RETHY6/kvHrWkNTv243boCjATEzJaa7kux69Q/f4+AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMC1jMDAwIDc5LjE3MWMyN2ZhYiwgMjAyMi8wOC8xNi0yMjozNTo0MSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoyZDgwNWU0Ny0xM2NjLTQxZDktYTk2YS1hMGZiZmE1ZDRiZjYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MTg1MEE1RTZCNUI1MTFFREE5QkE4MDc0Q0IzMTA4N0IiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MTg1MEE1RTVCNUI1MTFFREE5QkE4MDc0Q0IzMTA4N0IiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDIzLjMgKE1hY2ludG9zaCkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowNGY2Njc2ZS02MGZjLTQzYmYtODQyNi00YTVlOTBmZTVhODgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MmQ4MDVlNDctMTNjYy00MWQ5LWE5NmEtYTBmYmZhNWQ0YmY2Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkEBQQAFgAsAAAAAAwADAAABSegJY5kaQaBaBgqa1WVOAwy/ca3COv4nv++YG/Iqxl/q1bRNEIxTSEAIfkECQQAFgAsAQABAAoACgAABRygJY4iYALispBVJSIIKc90bcvtG4/Ak643iykEACH5BAUEABYALAAAAAAMAAwAAAUqoCWO5EgQpVUU4nGkgiBWlagoc23Reb/rvJ8vSAQafTefCyaznFKrlDQEACH5BAkEABYALAEAAQAKAAoAAAUZYFFYZEkQglCWx7EmySrPdG3b8JrOrTifIQAh+QQFBAAWACwAAAAADAAMAAAFKaAljuQIAGVZVekprqLjvKwFWwxD73Z9/76gKMe7OSjFGgnwELlSUGgIACH5BAUEABYALAEAAQAKAAoAAAUaYBBYZGmelmGYSUIOg1lVaG3Xs92+ca2KthAAIfkECQQAFgAsAQABAAoACgAABRhg01hkaZ7WspiKQiIIKs90zboWPKviHAIAIfkEBQQAFgAsAAAAAAwADAAABSigJY7kGARlWVXisqSriCCiooixle+s3vO4nzBI9MloFlvRlTqlntAQACH5BAUEABYALAEAAQAKAAoAAAUYIABYZGmShnGWw0AmySrPdG22b1ympjiHACH5BAUEABYALAEAAQAKAAoAAAUfYFFYZEkKAgkApllVpOO0JcPQeI7bLmw5FJTqYRLlQgAh+QQJBAAWACwBAAEACgAKAAAFHCBBWJZIkseBqmfbJol7VpVs3zZ9w+namqXRKQQAIfkEBQQAFgAsAAAAAAwADAAABSqgJY5kKRaFCQCiIJhVJcaiosyyRev57vdAnJA3/NVuFsCj9TKNUM6oKAQAIfkEBQQAFgAsAQABAAoACgAABR+gJVoAMFqGIVaVuCzDcIoIMt94rs/xXaerluV1Kp1CACH5BAkEABYALAEAAQAKAAoAAAUboCVaQTBay3KKhoEgqzUMcW3f+BvPadyepVMIACH5BAUEABYALAAAAAAMAAwAAAUnoCWOZCk2jUlWlQgAoqKILN1aNX7n/O7bQF0wJxveVjfAw4RSOUUhACH5BAUEABYALAEAAQAKAAoAAAUYoCVaQSASxKhax5EkayzPdD2+9tqq5UmEACH5BAUEABYALAEAAQAKAAoAAAUcoCVaACAWxahaguA468gwcW3Xs+1Qd92qpVMhBAAh+QQFBAAWACwBAAEACgAKAAAFHqAlWkUhAsBoCYJYVVGkqu9s37hb4XE+sjpV6QQIAQAh+QQJBAAWACwBAAEACgAKAAAFGKAlWgQhBsFoHYc6TWosz3Rdv7bI0uUZhAAh+QQFBAAWACwAAAAADAAMAAAFKKAljmRpNo0IQSIAiFUlShIsW7Gt43fO775gb7ijAW+r1mNnEqGaphAAOw=="}),p().createElement("span",{className:Be},ce("进行中")))}var Ge=(ke={},(0,c.Z)(ke,Re.EveryDay,ce("每天")),(0,c.Z)(ke,Re.MondayToFriday,ce("工作日")),(0,c.Z)(ke,Re.EveryWeek,ce("每周")),(0,c.Z)(ke,Re.EveryTwoWeek,ce("每两周")),(0,c.Z)(ke,Re.EveryMonth,ce("每月")),ke);function Ve(e){return"微信"===e?{color:"#1EBD43"}:{color:"#FC8F28"}}function ze(e,t){return e!==t}var Qe=function(e,t){var n=new Date(1e3*e),r=Date.now(),o=ce("MM-dd");return(0,f.Z)(r,n)||(o=ce("yyyy-")+o),"".concat((0,h.Z)(n,o,{locale:t}))};function Ye(e,t){if(void 0!==e.recurring_type){var n=Ge[e.recurring_type];return n?ce("{{ repeat }}重复，{{ until }}结束",{repeat:n,until:e.until_date?Qe(e.until_date,t):""}):""}return""}function Ze(e){if(e){var t=e.roomname,n=e.floorname,r=e.buildingname,o="";if(r)return o=r,n&&(o="".concat(r,"-").concat(n)),"".concat(t,"(").concat(o,")")}return""}var Ke,Je,qe,Xe=v.default.isWxWork&&(Ke="wxwork",Je="4.1.2",function(e,t,n){var r=null==n?void 0:n.lexicographical,o=null==n?void 0:n.zeroExtend,i=e.split("."),a=t.split(".");if(o){for(;i.length<a.length;)i.push("0");for(;a.length<i.length;)a.push("0")}if(!r){for(var s=0;s<i.length;s++)i[s]=parseInt(i[s],10);for(var c=0;c<a.length;c++)a[c]=parseInt(a[c],10)}for(var l=0;l<i.length;++l){if(a.length===l)return 1;if(i[l]!==a[l])return i[l]>a[l]?1:-1}return i.length!==a.length?-1:0}((null==(qe=navigator.userAgent.match(new RegExp("".concat(Ke,"/([\\d\\.]+)"),"i")))?void 0:qe[1])||"0",Je,{zeroExtend:!0})>=0),$e=function(e,t){v.default.isMobile?L().show({message:e,type:t||"info",autoClose:!0,duration:5e3}):N.ZP.show({message:e,type:t||"info",autoClose:!0,duration:5e3})},et=function(){return v.default.isWxWork?!Xe&&($e(ce("暂不支持此功能，请升级企业微信后使用")),!0):($e(ce("请在企业微信中使用此功能")),!0)};function tt(e){return nt.apply(this,arguments)}function nt(){return(nt=(0,i.Z)(u().mark((function e(t){var n,r,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,dt(t);case 3:n=e.sent,e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),new Ne({refreshError:{content:"refresh_doc_meeting_card, ".concat(e.t0.message)}});case 9:if(!n.data.recurring_rule){e.next=13;break}return r=De(),o=Ye(n.data.recurring_rule,r),e.abrupt("return",o);case 13:return e.abrupt("return",void 0);case 14:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}var rt=new((0,s.Z)((function e(){var t=this;(0,a.Z)(this,e),(0,c.Z)(this,"queue",[]),(0,c.Z)(this,"num",0),(0,c.Z)(this,"add",(function(e){t.queue.push((function(){e(t.endFn)})),t.startFn()})),(0,c.Z)(this,"startFn",(function(){if(t.num<4){var e=t.queue.shift();null==e||e(),t.num=t.num+1}})),(0,c.Z)(this,"endFn",(function(){t.num=t.num-1,t.queue.length>0&&t.startFn()}))})));function ot(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return it(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?it(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function it(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function at(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function st(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?at(Object(n),!0).forEach((function(t){(0,c.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):at(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ct=function(e){return"0"===e.vid||void 0===e.vid||"undefined"===e.vid||null===e.vid||"null"===e.vid||""===e.vid};function lt(e,t,n){return ut.apply(this,arguments)}function ut(){return(ut=(0,i.Z)(u().mark((function e(t,n,r){var o,i,a,s,c,l,d,p,f,h,m,g,v,_,y,b,E,C;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,dt(t);case 3:o=e.sent,e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),new Ne({refreshError:{content:"refresh_doc_meeting_card, ".concat(e.t0.message)}});case 9:if(a=(i=o).data,s=i.status,c=i.errorCode,l=i.errorMsg,void 0!==c&&c!==Me.Success){e.next=39;break}a.meeting_room=Ze(a.meeting_room_param)||a.meeting_room,d=ot(a.meeting_records||[]);try{for(d.s();!(p=d.n()).done;)(f=p.value).name=f.name||n.subject}catch(e){d.e(e)}finally{d.f()}if(n.is_api_create&&ct({vid:n.creator_vid})){e.next=25;break}return e.prev=15,e.next=18,O.wdocsUserCenter.queryUserInfo([n.creator_vid]);case 18:h=e.sent,e.next=24;break;case 21:e.prev=21,e.t1=e.catch(15),r({unknownError:"unknownError, 处理组织人: ".concat(e.t1.message)});case 24:h&&h.length>0&&(m=h[0],g=m.corp_id,v=m.corp_name,"unknown"!==m.name?(_=O.wdocsUserCenter.getDisplayNameWithoutCorp(m),a.creator_name=_,a.creator_corp_id=g,a.creator_corp_name=v):r({memberError:{vid:n.creator_vid,content:"查询失败vid unknown: ".concat(n.creator_vid)}}));case 25:return a.attend_len=a.attend_list.length,y=(a.attend_list||[]).filter((function(e){return ct(e)})),b=(a.attend_list||[]).filter((function(e){return!ct(e)})).map((function(e){return e.vid})),e.prev=28,e.next=31,O.wdocsUserCenter.queryUserInfo(b.slice(0,10));case 31:E=e.sent,e.next=37;break;case 34:e.prev=34,e.t2=e.catch(28),r({unknownError:"unknownError, 处理参与人: ".concat(e.t2.message)});case 37:return E&&(C=E.map((function(e){var t=e.vid,o=e.corp_name,i=e.corp_id;if("unknown"===e.name){r({memberError:{vid:t,content:"查询失败vid unknown: ".concat(t)}});var s=a.attend_list.find((function(e){return e.vid===t}));if(null!=s&&s.username)return{vid:t,username:s.username};var c=n.attend_list.find((function(e){return e.vid===t}));if(c)return{vid:t,username:c.username}}var l=O.wdocsUserCenter.getDisplayNameWithoutCorp(e);return{vid:t,username:l,corpname:o,corpid:i}})),a.attend_list.length>0&&(a.attend_list=[].concat((0,R.Z)(C),(0,R.Z)(y)))),e.abrupt("return",a);case 39:throw new Ne({refreshError:{errorCode:c,errorMsg:l,status:s,content:"refresh_doc_meeting_card, errorCode: ".concat(c,", errorMsg: ").concat(l,", status: ").concat(s)}});case 40:case"end":return e.stop()}}),e,null,[[0,6],[15,21],[28,34]])})))).apply(this,arguments)}function dt(e){return new Promise((function(t,n){rt.add((function(r){M.Z.post("/wework/wwdocweb/refresh_doc_meeting_card",st(st({},e),{},{share_key:e.sharekey,doc_id:e.docid,creator_source:Number(e.creator_source)}),{timeout:5e3}).then((function(e){var n=e.data,r=e.headers,o=e.status,i=r["error-code"],a=r["error-msg"];t({status:o,data:n,errorCode:i,errorMsg:a})})).catch((function(e){n(e)})).finally((function(){r()}))}))}))}var pt="MeetingRecords-module_meeting-records__36Ges",ft="MeetingRecords-module_meeting-records-item__qcJvG",ht="MeetingRecords-module_meeting-records-item-left__vFKix",mt="MeetingRecords-module_loading__l2EeZ",gt="MeetingRecords-module_time__V7n2P",vt="MeetingRecords-module_meeting-records-item-play__Fc5GE",_t="MeetingRecords-module_meeting-records-item-loading__s5Tpu",yt="MeetingRecords-module_meeting-records-item-right__zsqgi",bt="MeetingRecords-module_meeting-records-item-timestamp__2Gn0c",Et="MeetingRecords-module_mobile-meeting-records__0ZkR-",Ct={background:"#fff",boxShadow:"0 2px 8px 2px rgb(68 73 77 / 16%)",padding:"5px",lineHeight:"12px",color:"rgba(0, 0, 0, .88)",position:"relative",wordBreak:"break-word",borderRadius:"8px"},wt={width:"0px",height:"0px",border:"4.5px solid #fff",borderRadius:"0px",zIndex:1};function Tt(e){var t=e.children,n=e.records,r=e.recordsPStyle,o=e.recordsPClassName,i=e.onViewRecord,a=Pe().locale,s=y()(pt,(0,c.Z)({},Et,v.default.isMobile)),l=(0,d.useMemo)((function(){return p().createElement("div",{className:s},n.map((function(e,t){return p().createElement("div",{onClick:function(){2===e.status&&e.media_url&&i(e.media_url)},className:ft,id:e.id},p().createElement("div",{className:ht},1===e.status?p().createElement(p().Fragment,null,p().createElement("div",{className:mt}),p().createElement($,{className:_t})):p().createElement(p().Fragment,null,p().createElement("img",{src:e.thumb,alt:""}),p().createElement(re,{className:vt}),p().createElement("span",{className:gt},function(e){for(var t=e,n=[];t>=60;){var r=t%60;n.unshift(r<10?"0".concat(r):String(r)),t=Math.floor(t/60)}return 0===n.length?n.unshift(t<10?"0".concat(t):String(t)):n.unshift(String(t)),1===n.length&&n.unshift("0"),n.join(":")}(e.duration)))),p().createElement("div",{className:yt},p().createElement("span",null,ce("第 {{num}} 场",{num:t+1})),p().createElement("span",{className:bt},1===e.status?"生成中...":"".concat((0,h.Z)(new Date(1e3*e.timestamp),"HH:mm",{locale:a})," ").concat(ce("开始录制")))))})))}),[n]),u=(0,d.useCallback)((function(){J().show({title:null,okText:null,content:l})}),[l]);return v.default.isMobile?p().createElement("span",{onClick:u},t):p().createElement(Z,{overlayStyle:r,overlayClassName:o,contentStyle:Ct,arrowStyle:wt,placements:["right","bottom","right"],content:l,mouseEnterDelay:0,mouseLeaveDelay:0,trigger:"click",zIndex:1e3},t)}function At(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function St(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?At(Object(n),!0).forEach((function(t){(0,c.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):At(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function It(e){ae.KVR.oss(St(St({},e),{},{biz:"wecomDocs"}))}function Rt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Mt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Rt(Object(n),!0).forEach((function(t){(0,c.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ot=function(e){e.stopPropagation(),et()||$e(ce("会议已被发起人取消"))},Nt=function(){function e(t){(0,a.Z)(this,e),(0,c.Z)(this,"timerId",0),this.meetingJob=t}return(0,s.Z)(e,[{key:"clear",value:function(){clearTimeout(this.timerId)}},{key:"start",value:function(e,t){var n=this;t?this.shouldFilter(t)||this.start(t.refresh_interval):this.timerId=window.setTimeout((function(){n.meetingJob().then((function(e){n.start(e.refresh_interval,e)})).catch((function(e){e instanceof Ne&&e.message===Me.Disabled||n.start(30)}))}),1e3*e)}},{key:"shouldFilter",value:function(e){var t=e.status,n=e.recurring_rule;return!!e.refresh_finish||!(t!==Oe.Ended||null!=n&&n.recurring_type)}}]),e}(),kt=function(e){var t,n=e.data,o=e.info,a=e.active,s=e.style,l=e.className,_=e.recordsPStyle,E=e.recordsPClassName,C=e.onEnterMeeting,w=e.onViewMeeting,T=e.onJoinMeeting,A=e.onViewRecord,S=e.updateHeight,I=e.readyCallback,R=e.onError,M=n.subject,N=n.start_time,k=n.end_time,L=n.repeat,D=n.creator_name,P=n.meeting_room,x=n.attend_list,F=void 0===x?[]:x,B=n.place,U=n.is_api_create,H=o.meeting_id,W=(0,d.useState)(L),j=(0,r.Z)(W,2),G=j[0],V=j[1],z=(0,d.useState)(M),Q=(0,r.Z)(z,2),Y=Q[0],Z=Q[1],K=(0,d.useState)(0),J=(0,r.Z)(K,2),q=J[0],X=J[1],$=(0,d.useState)(N),ee=(0,r.Z)($,2),te=ee[0],ne=ee[1],re=(0,d.useState)(k),ae=(0,r.Z)(re,2),se=ae[0],Se=ae[1],Re=(0,d.useState)(),Me=(0,r.Z)(Re,2),ke=Me[0],Le=Me[1],De=(0,d.useState)([]),xe=(0,r.Z)(De,2),Fe=xe[0],Be=xe[1],Ue=(0,d.useState)(""),He=(0,r.Z)(Ue,2),Ge=He[0],Qe=He[1],Ze=(0,d.useState)(P),Ke=(0,r.Z)(Ze,2),Je=Ke[0],qe=Ke[1],Xe=(0,d.useState)(B),tt=(0,r.Z)(Xe,2),nt=tt[0],rt=tt[1],ot=(0,d.useState)(F),it=(0,r.Z)(ot,2),at=it[0],st=it[1],ct=(0,d.useState)(D),ut=(0,r.Z)(ct,2),dt=ut[0],pt=ut[1],ft=(0,d.useState)(),ht=(0,r.Z)(ft,2),mt=ht[0],gt=ht[1],vt=(0,d.useState)(),_t=(0,r.Z)(vt,2),yt=_t[0],bt=_t[1],Et=(0,d.useState)(!1),Ct=(0,r.Z)(Et,2),wt=Ct[0],At=Ct[1],St=(0,d.useState)(""),Rt=(0,r.Z)(St,2),kt=Rt[0],Lt=Rt[1],Dt=(0,d.useState)(),Pt=(0,r.Z)(Dt,2),xt=Pt[0],Ft=Pt[1],Bt=(0,d.useState)(F.length),Ut=(0,r.Z)(Bt,2),Ht=Ut[0],Wt=Ut[1],jt=(0,d.useState)(!1),Gt=(0,r.Z)(jt,2),Vt=Gt[0],zt=Gt[1],Qt=(0,d.useRef)(null),Yt=(0,d.useRef)(null),Zt=(0,d.useRef)(0),Kt=Pe().locale,Jt=(0,d.useCallback)((function(){et()||(0,b.tencentDocOpenUrlForAll)({url:Ge})}),[Ge]),qt=(0,d.useCallback)((function(e){et()||A(e)}),[A]),Xt=function(){var e=(0,i.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",lt(o,n,R).then((function(e){var t;return Z(e.subject),X(e.status),ne(e.start_time),Se(e.end_time),Le(e.is_joined),Be(e.meeting_records),Qe(e.meeting_minutes),st(e.attend_list),qe(e.meeting_room),rt(e.place),e.creator_corp_id&&bt(e.creator_corp_id),e.creator_corp_name&&gt(e.creator_corp_name),e.creator_name&&pt(e.creator_name),Ft(e.is_meeting_cancled),Wt(e.attend_len),e.recurring_rule&&(t=Ye(e.recurring_rule,Kt),V(t)),Mt(Mt({},e),{},{repeat:t})})).catch((function(e){throw e instanceof Ne&&R(e.data),e})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),$t=(0,d.useRef)(new Nt(Xt));(0,d.useEffect)((function(){return O.wdocsUserCenter.getUserInfo().then((function(e){Lt(e.corp_id),void 0!==e.corp_id?Xt().then((function(e){var t=new Map;n.attend_list.forEach((function(e){t.set(e.vid,e)})),At(!0),null==I||I(Mt(Mt({},n),{},{subject:e.subject,repeat:e.repeat,creator_name:e.creator_name||n.creator_name,meeting_room:e.meeting_room,place:e.place,start_time:e.start_time,end_time:e.end_time,attend_list:e.attend_list.map((function(e){return Mt(Mt({},t.get(e.vid)),{},{username:e.username||e.name||"",vid:e.vid})}))})),$t.current.start(e.refresh_interval,e)})).catch((function(e){$t.current.start(30),At(!0),null==I||I()})):(At(!0),null==I||I())})).catch((function(e){At(!0),null==I||I(),console.log(e)})),function(){$t.current.clear()}}),[]),(0,oe.gj)({element:Yt.current,onResize:(0,ie.P2)((function(){var e,t=null===(e=Yt.current)||void 0===e?void 0:e.getBoundingClientRect().height;Zt.current!==t&&(setTimeout((function(){return null==S?void 0:S()})),Zt.current=t||0)}))});var en=(0,d.useMemo)((function(){var e=new Date(1e3*te),t=new Date(1e3*se),n=Date.now(),r="MMMdo E HH:mm",o="MMMdo E HH:mm";return(0,m.Z)(e,t)&&(o="HH:mm"),(0,f.Z)(n,e)&&!(0,f.Z)(e,t)&&(o="yyyy".concat(ce("年")).concat(o)),(0,f.Z)(n,e)||(r="yyyy".concat(ce("年")).concat(r),(0,m.Z)(e,t)||(o="yyyy".concat(ce("年")," MMMdo E HH:mm"))),"".concat((0,h.Z)(e,r,{locale:Kt})," - ").concat((0,h.Z)(t,o,{locale:Kt}))}),[te,se]),tn=(0,d.useMemo)((function(){if(0!==Ht&&void 0!==Ht){var e=at;Ht>2&&(e=at.slice(0,2));var t=e.length;return p().createElement("span",{className:"".concat(Ee," ").concat(be)},p().createElement("span",{className:we},ce("参与人：")),p().createElement("span",{className:Ce},e.map((function(e,n){var r=e.username,o=e.corpid,i=e.corpname,a=e.name;return p().createElement("span",{key:r||a},r||a,kt&&ze(kt,o)&&i&&p().createElement("span",{style:Ve(i)},"@",i),n+1<t&&p().createElement("span",null,"、"))}))),p().createElement("span",{className:we},ce(Ht>2?"等共{{num}}人":"共{{num}}人",{num:Ht})))}}),[at,kt,Ht]),nn=(0,d.useCallback)((function(e){null==e||e.stopPropagation(),et()||(xt?$e(ce("会议已被发起人取消")):w({x:null==e?void 0:e.clientX,y:null==e?void 0:e.clientY}))}),[w,xt]),rn=(0,d.useMemo)((function(){if(q===Oe.Doing)return{text:ce("进入会议"),onCallBack:function(){It({itemname:"nmeeting_enter_fromdoc",Extra1:H}),et()||C()},iconStatus:Ie.Doing};if(q===Oe.Ended){if(xt)return{text:ce("已取消"),onCallBack:Ot,iconStatus:Ie.Unknown};if(1===Fe.length){var e=Fe[0],t=e.status,n=e.media_url;return 1===t?{text:ce("录制生成中"),onCallBack:function(){},iconStatus:Ie.Done,style:{opacity:.4}}:{text:ce("查看录制"),onCallBack:function(){It({itemname:"nmeeting_record_click_fromdoc",Extra1:H}),qt(n)},iconStatus:Ie.Done}}return Fe.length>1?{text:p().createElement(Tt,{records:Fe,recordsPStyle:_,recordsPClassName:E,onViewRecord:function(e){It({itemname:"nmeeting_record_click_fromdoc",Extra1:H}),qt(e)}},p().createElement("span",{style:{display:"inline-block",width:"100%",textAlign:"center"}},ce("查看录制"))),onCallBack:function(){},iconStatus:Ie.Done}:Ge?{text:ce("会议记录"),onCallBack:function(){It({itemname:"nmeeting_history_click_fromdoc",Extra1:H}),Jt()},iconStatus:Ie.Done}:{text:ce("会议记录"),onCallBack:function(e){It({itemname:"nmeeting_history_click_fromdoc",Extra1:H}),nn(e)},iconStatus:Ie.Done}}return U||ke||void 0===ke?{text:ce("查看详情"),onCallBack:function(e){It({itemname:"nmeeting_detail_fromdoc",Extra1:H}),nn(e)},iconStatus:Ie.Unknown}:{text:ce("添加到我的会议"),onCallBack:function(){It({itemname:"nmeeting_add_fromdoc",Extra1:H}),et()||T().then((function(e){e&&$e(ce("已加入会议"),"success")}))},iconStatus:q===Oe.Ended?Ie.Done:Ie.Unknown}}),[C,T,Jt,nn,qt,ke,Fe,q,U,xt,H]),on=rn.text,an=rn.onCallBack,sn=rn.iconStatus,cn=rn.style;(0,d.useEffect)((function(){Qt.current&&zt(function(e,t){if(t===Ie.Unknown)return!1;var n=e.getBoundingClientRect(),r=e.firstChild,o=r.length,i=document.createRange();if(i.setStart(r,0),i.setEnd(r,o),i.getBoundingClientRect().height<40)return!1;i.setStart(r,o);var a=i.getBoundingClientRect();if(n.bottom<a.bottom)return!0;var s=e.lastChild.getBoundingClientRect().width;return a.right+s>n.right}(Qt.current,sn))}),[Y,sn]);var ln=(0,d.useMemo)((function(){return sn===Ie.Doing?p().createElement(je,null):sn===Ie.Done?p().createElement(We,null):""}),[sn]),un=y()(le,(t={},(0,c.Z)(t,Te,v.default.isMobile),(0,c.Z)(t,Ae,a),t),l);return p().createElement("div",{style:s,ref:Yt,className:un,onClick:function(e){It({itemname:"nmeeting_detail_fromdoc",Extra1:H}),nn(e)}},p().createElement("svg",{className:ue,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},p().createElement("rect",{width:"24",height:"24",rx:"3",fill:"#539CF8"}),p().createElement("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M5.06702 9.10046C5.06702 8.29044 5.72367 7.63379 6.53368 7.63379H13.867C14.677 7.63379 15.3337 8.29044 15.3337 9.10046V15.7005C15.3337 16.5105 14.677 17.1671 13.867 17.1671H6.53368C5.72367 17.1671 5.06702 16.5105 5.06702 15.7005V9.10046ZM16.0669 10.9338L18.5797 9.17487C19.0658 8.83465 19.7336 9.18236 19.7336 9.77564V15.0253C19.7336 15.6186 19.0658 15.9663 18.5797 15.6261L16.0669 13.8672V10.9338ZM12.2535 14.8019L12.4271 14.6268C12.5118 14.5413 12.5891 14.4218 12.6496 14.3137C12.7333 14.1638 12.675 13.9804 12.5305 13.8876L11.6168 13.3007C11.5398 13.2512 11.4413 13.2505 11.3636 13.2987L11.025 13.5089C10.9006 13.5862 10.7664 13.6535 10.6537 13.5612C10.6537 13.5612 10.0438 13.1238 9.78447 12.8621C9.523 12.5983 9.11196 12.0218 9.11196 12.0218C9.01943 11.9083 9.08735 11.7723 9.16378 11.6469L9.37434 11.3018C9.42277 11.2223 9.42031 11.122 9.36805 11.045L8.68365 10.0375C8.59697 9.90989 8.43698 9.85156 8.29715 9.91672C8.18701 9.96806 8.06129 10.04 7.97097 10.1311L7.79736 10.3063C7.31794 10.79 7.92682 12.1884 9.15734 13.4299C10.3879 14.6713 11.774 15.2856 12.2535 14.8019Z",fill:"white"})),p().createElement("div",{className:de},p().createElement("div",{className:pe},p().createElement("div",{className:fe},p().createElement("div",{ref:Qt,className:"".concat(he," ").concat(me)},Y,ln),Vt&&ln,p().createElement("div",{className:"".concat(me," ").concat(be)},en)),p().createElement("div",{className:ge},wt&&p().createElement(g.x,{style:Mt(Mt({},cn),{},{width:"auto"}),onClick:function(e){return e.stopPropagation(),an(e)},onTouchEnd:function(e){e.stopPropagation()},type:sn===Ie.Doing?"primary":"plain"},on))),G&&p().createElement("div",{className:"".concat(be," ").concat(ve)},G),p().createElement("div",{className:_e}),p().createElement("div",{className:"".concat(ye)},p().createElement(p().Fragment,null,p().createElement("span",null,ce("发起人："),dt),kt&&ze(kt,yt)&&mt&&p().createElement("span",{style:Ve(mt)},"@",mt))),tn&&p().createElement(p().Fragment,null,tn),Je&&p().createElement("div",{className:ye},ce("会议室："),Je),nt&&p().createElement("div",{className:ye},ce("地点："),nt)))}},165076:function(e,t,n){n.d(t,{I:function(){return i}});var r=n(87363),o=n(586600);function i(e){var t=e.triggers,n=void 0===t?["hover"]:t,i=e.delay,a=void 0===i?200:i,s=e.leaveDelay,c=void 0===s?a:s,l=e.show,u=e.hide,d=e.child,p=e.visible,f=e.disabled,h=void 0!==f&&f,m=(0,o.e$)(n,"hover"),g=(0,o.e$)(n,"click"),v=(0,o.e$)(n,"contextMenu"),_=(0,o.e$)(n,"focus"),y=(0,r.useRef)(null),b=(0,r.useCallback)((function(){y.current&&(clearTimeout(y.current),y.current=null)}),[]),E=(0,r.useCallback)((function(){b(),y.current=setTimeout((function(){u(),b()}),c)}),[b,c,u]),C=(0,r.useCallback)((function(){b(),y.current=setTimeout((function(){l(),b()}),a)}),[b,a,l]),w=(0,r.useCallback)((function(){return l()}),[l]),T=(0,r.useCallback)((function(){return p?u():w()}),[p,u,w]),A=(0,r.useMemo)((function(){var e={},t=d.props;return m&&(e.onMouseEnter=function(e){var n;C(),null===(n=t.onMouseEnter)||void 0===n||n.call(t,e)},e.onMouseLeave=function(e){var n;E(),null===(n=t.onMouseLeave)||void 0===n||n.call(t,e)}),g&&(e.onClick=function(){var e;T(),null===(e=t.onClick)||void 0===e||e.call(t)}),v&&(e.onContextMenu=function(){var e;l(),null===(e=t.onContextMenu)||void 0===e||e.call(t)}),_&&(e.onFocus=function(){var e;l(),null===(e=t.onFocus)||void 0===e||e.call(t)},e.onBlur=function(){var e;u(),null===(e=t.onBlur)||void 0===e||e.call(t)}),e}),[d.props,m,g,v,_,C,E,T]),S=(0,r.useMemo)((function(){var e={};return m&&(e.onMouseEnter=function(){y.current&&C()},e.onMouseLeave=function(){return E()}),e}),[E,C,m]);return h?{callbacks:function(){},overlayCallbacks:function(){}}:{callbacks:A,overlayCallbacks:S}}},473924:function(e,t,n){n.d(t,{_:function(){return a},b:function(){return r}});var r,o=n(352177),i=n(87363);function a(e){var t=e.duration,n=void 0===t?0:t,a=e.visible,s=e.transitionSpeed,c=void 0===s?200:s,l=e.unmountCallback,u=e.changeVisibleCallback,d=e.disabled,p=void 0!==d&&d,f=void 0!==a,h=(0,i.useState)((function(){return!1})),m=(0,o.Z)(h,2),g=m[0],v=m[1],_=(0,i.useState)((function(){return r.NONE})),y=(0,o.Z)(_,2),b=y[0],E=y[1],C=(0,i.useCallback)((function(e){E(r.LEAVE),setTimeout((function(){v(!1),E(r.NONE),null==u||u(!1),e&&(null==l||l())}),c)}),[u,c,l]),w=(0,i.useCallback)((function(){v(!0),E(r.ENTER),setTimeout((function(){null==u||u(!0),E(r.NONE)}),c)}),[u,c]),T=f?a:g,A=(0,i.useRef)(void 0),S=(0,i.useCallback)((function(){A.current&&(clearTimeout(A.current),A.current=void 0)}),[]);return(0,i.useEffect)((function(){return 0!==n&&(S(),A.current=setTimeout((function(){C(!0)}),n)),function(){S()}}),[n,S,C]),p?{visible:T,hide:function(){},show:function(){},transitionState:r.NONE}:{visible:T,hide:C,show:w,transitionState:b}}!function(e){e[e.NONE=0]="NONE",e[e.APPEAR=1]="APPEAR",e[e.ENTER=2]="ENTER",e[e.LEAVE=3]="LEAVE"}(r||(r={}))},333529:function(e,t,n){n.d(t,{h:function(){return a}});var r=n(87363),o=n(661533),i=0;function a(e){var t=e.prefix,n=void 0===t?"":t,a=e.getContainerElement,s=e.children,c=e.position,l=void 0===c?"absolute":c,u=e.zIndex,d=void 0===u?"auto":u,p=(0,r.useRef)(null);if(!p.current){var f=(null==a?void 0:a())||function(e,t,n){var r=document.createElement("div");return r.id="portal-element-".concat(i++),r.style.position=t,r.style.left="0",r.style.top="0",e&&r.classList.add("".concat(e,"-portal")),n&&(r.style.zIndex=n.toString()),document.body.appendChild(r),r}(n,l,d);p.current=f}return(0,r.useEffect)((function(){return function(){var e;if(!a){var t=p.current;null===(e=t.parentElement)||void 0===e||e.removeChild(t)}}}),[a]),(0,o.createPortal)(s,p.current)}},399213:function(e,t,n){function r(e,t){return e?t:null}function o(e){var t=e.condition,n=e.children;return t?n:null}n.d(t,{If:function(){return o},Y:function(){return r}})},84475:function(e,t,n){var r=n(87363),o=n(463460),i={tag:"svg",attrs:{fill:"none",viewBox:"0 0 20 20",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"#10141A",d:"M1.98 10.14C2.95 6.93 5.35 3.5 10 3.5c4.65 0 7.05 3.43 8.02 6.64a.5.5 0 10.96-.28C17.95 6.44 15.29 2.5 10 2.5c-5.29 0-7.95 3.94-8.98 7.36a.5.5 0 00.96.28zm11.77 1.11a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zm1 0a4.75 4.75 0 11-9.5 0 4.75 4.75 0 019.5 0z",fillRule:"evenodd",clipRule:"evenodd"}}]},a=(0,r.forwardRef)((function(e,t){return(0,r.createElement)(o.A,Object.assign({},e,{id:"eye-20",ref:t,icon:i}))}));a.displayName="Eye20",t.Z=a},267876:function(e,t,n){n.d(t,{j:function(){return o}});var r={};function o(){return r}},460348:function(e,t,n){function r(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}n.d(t,{Z:function(){return r}})},297041:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(616722),o=n(460348),i=n(296840),a=n(267876);function s(e,t){var n,s,c,l,u,d,p,f;(0,o.Z)(1,arguments);var h=(0,a.j)(),m=(0,i.Z)(null!==(n=null!==(s=null!==(c=null!==(l=null==t?void 0:t.weekStartsOn)&&void 0!==l?l:null==t||null===(u=t.locale)||void 0===u||null===(d=u.options)||void 0===d?void 0:d.weekStartsOn)&&void 0!==c?c:h.weekStartsOn)&&void 0!==s?s:null===(p=h.locale)||void 0===p||null===(f=p.options)||void 0===f?void 0:f.weekStartsOn)&&void 0!==n?n:0);if(!(m>=0&&m<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var g=(0,r.Z)(e),v=g.getUTCDay(),_=(v<m?7:0)+v-m;return g.setUTCDate(g.getUTCDate()-_),g.setUTCHours(0,0,0,0),g}},296840:function(e,t,n){function r(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}n.d(t,{Z:function(){return r}})},20871:function(e,t,n){n.d(t,{Z:function(){return W}});var r=n(133157),o=n(460348),i=n(616722);function a(e){if((0,o.Z)(1,arguments),!function(e){return(0,o.Z)(1,arguments),e instanceof Date||"object"===(0,r.Z)(e)&&"[object Date]"===Object.prototype.toString.call(e)}(e)&&"number"!=typeof e)return!1;var t=(0,i.Z)(e);return!isNaN(Number(t))}var s=n(296840);function c(e,t){return(0,o.Z)(2,arguments),function(e,t){(0,o.Z)(2,arguments);var n=(0,i.Z)(e).getTime(),r=(0,s.Z)(t);return new Date(n+r)}(e,-(0,s.Z)(t))}function l(e){(0,o.Z)(1,arguments);var t=(0,i.Z)(e),n=t.getUTCDay(),r=(n<1?7:0)+n-1;return t.setUTCDate(t.getUTCDate()-r),t.setUTCHours(0,0,0,0),t}function u(e){(0,o.Z)(1,arguments);var t=(0,i.Z)(e),n=t.getUTCFullYear(),r=new Date(0);r.setUTCFullYear(n+1,0,4),r.setUTCHours(0,0,0,0);var a=l(r),s=new Date(0);s.setUTCFullYear(n,0,4),s.setUTCHours(0,0,0,0);var c=l(s);return t.getTime()>=a.getTime()?n+1:t.getTime()>=c.getTime()?n:n-1}function d(e){(0,o.Z)(1,arguments);var t=(0,i.Z)(e),n=l(t).getTime()-function(e){(0,o.Z)(1,arguments);var t=u(e),n=new Date(0);return n.setUTCFullYear(t,0,4),n.setUTCHours(0,0,0,0),l(n)}(t).getTime();return Math.round(n/6048e5)+1}var p=n(297041),f=n(267876);function h(e,t){var n,r,a,c,l,u,d,h;(0,o.Z)(1,arguments);var m=(0,i.Z)(e),g=m.getUTCFullYear(),v=(0,f.j)(),_=(0,s.Z)(null!==(n=null!==(r=null!==(a=null!==(c=null==t?void 0:t.firstWeekContainsDate)&&void 0!==c?c:null==t||null===(l=t.locale)||void 0===l||null===(u=l.options)||void 0===u?void 0:u.firstWeekContainsDate)&&void 0!==a?a:v.firstWeekContainsDate)&&void 0!==r?r:null===(d=v.locale)||void 0===d||null===(h=d.options)||void 0===h?void 0:h.firstWeekContainsDate)&&void 0!==n?n:1);if(!(_>=1&&_<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var y=new Date(0);y.setUTCFullYear(g+1,0,_),y.setUTCHours(0,0,0,0);var b=(0,p.Z)(y,t),E=new Date(0);E.setUTCFullYear(g,0,_),E.setUTCHours(0,0,0,0);var C=(0,p.Z)(E,t);return m.getTime()>=b.getTime()?g+1:m.getTime()>=C.getTime()?g:g-1}function m(e,t){(0,o.Z)(1,arguments);var n=(0,i.Z)(e),r=(0,p.Z)(n,t).getTime()-function(e,t){var n,r,i,a,c,l,u,d;(0,o.Z)(1,arguments);var m=(0,f.j)(),g=(0,s.Z)(null!==(n=null!==(r=null!==(i=null!==(a=null==t?void 0:t.firstWeekContainsDate)&&void 0!==a?a:null==t||null===(c=t.locale)||void 0===c||null===(l=c.options)||void 0===l?void 0:l.firstWeekContainsDate)&&void 0!==i?i:m.firstWeekContainsDate)&&void 0!==r?r:null===(u=m.locale)||void 0===u||null===(d=u.options)||void 0===d?void 0:d.firstWeekContainsDate)&&void 0!==n?n:1),v=h(e,t),_=new Date(0);return _.setUTCFullYear(v,0,g),_.setUTCHours(0,0,0,0),(0,p.Z)(_,t)}(n,t).getTime();return Math.round(r/6048e5)+1}function g(e,t){for(var n=e<0?"-":"",r=Math.abs(e).toString();r.length<t;)r="0"+r;return n+r}var v={y:function(e,t){var n=e.getUTCFullYear(),r=n>0?n:1-n;return g("yy"===t?r%100:r,t.length)},M:function(e,t){var n=e.getUTCMonth();return"M"===t?String(n+1):g(n+1,2)},d:function(e,t){return g(e.getUTCDate(),t.length)},a:function(e,t){var n=e.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];default:return"am"===n?"a.m.":"p.m."}},h:function(e,t){return g(e.getUTCHours()%12||12,t.length)},H:function(e,t){return g(e.getUTCHours(),t.length)},m:function(e,t){return g(e.getUTCMinutes(),t.length)},s:function(e,t){return g(e.getUTCSeconds(),t.length)},S:function(e,t){var n=t.length,r=e.getUTCMilliseconds();return g(Math.floor(r*Math.pow(10,n-3)),t.length)}},_="midnight",y="noon",b="morning",E="afternoon",C="evening",w="night",T={G:function(e,t,n){var r=e.getUTCFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if("yo"===t){var r=e.getUTCFullYear(),o=r>0?r:1-r;return n.ordinalNumber(o,{unit:"year"})}return v.y(e,t)},Y:function(e,t,n,r){var o=h(e,r),i=o>0?o:1-o;return"YY"===t?g(i%100,2):"Yo"===t?n.ordinalNumber(i,{unit:"year"}):g(i,t.length)},R:function(e,t){return g(u(e),t.length)},u:function(e,t){return g(e.getUTCFullYear(),t.length)},Q:function(e,t,n){var r=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return g(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){var r=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return g(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){var r=e.getUTCMonth();switch(t){case"M":case"MM":return v.M(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){var r=e.getUTCMonth();switch(t){case"L":return String(r+1);case"LL":return g(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){var o=m(e,r);return"wo"===t?n.ordinalNumber(o,{unit:"week"}):g(o,t.length)},I:function(e,t,n){var r=d(e);return"Io"===t?n.ordinalNumber(r,{unit:"week"}):g(r,t.length)},d:function(e,t,n){return"do"===t?n.ordinalNumber(e.getUTCDate(),{unit:"date"}):v.d(e,t)},D:function(e,t,n){var r=function(e){(0,o.Z)(1,arguments);var t=(0,i.Z)(e),n=t.getTime();t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0);var r=n-t.getTime();return Math.floor(r/864e5)+1}(e);return"Do"===t?n.ordinalNumber(r,{unit:"dayOfYear"}):g(r,t.length)},E:function(e,t,n){var r=e.getUTCDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){var o=e.getUTCDay(),i=(o-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return g(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(o,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(o,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(o,{width:"short",context:"formatting"});default:return n.day(o,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){var o=e.getUTCDay(),i=(o-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return g(i,t.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(o,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(o,{width:"narrow",context:"standalone"});case"cccccc":return n.day(o,{width:"short",context:"standalone"});default:return n.day(o,{width:"wide",context:"standalone"})}},i:function(e,t,n){var r=e.getUTCDay(),o=0===r?7:r;switch(t){case"i":return String(o);case"ii":return g(o,t.length);case"io":return n.ordinalNumber(o,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){var r=e.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(e,t,n){var r,o=e.getUTCHours();switch(r=12===o?y:0===o?_:o/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(e,t,n){var r,o=e.getUTCHours();switch(r=o>=17?C:o>=12?E:o>=4?b:w,t){case"B":case"BB":case"BBB":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(e,t,n){if("ho"===t){var r=e.getUTCHours()%12;return 0===r&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return v.h(e,t)},H:function(e,t,n){return"Ho"===t?n.ordinalNumber(e.getUTCHours(),{unit:"hour"}):v.H(e,t)},K:function(e,t,n){var r=e.getUTCHours()%12;return"Ko"===t?n.ordinalNumber(r,{unit:"hour"}):g(r,t.length)},k:function(e,t,n){var r=e.getUTCHours();return 0===r&&(r=24),"ko"===t?n.ordinalNumber(r,{unit:"hour"}):g(r,t.length)},m:function(e,t,n){return"mo"===t?n.ordinalNumber(e.getUTCMinutes(),{unit:"minute"}):v.m(e,t)},s:function(e,t,n){return"so"===t?n.ordinalNumber(e.getUTCSeconds(),{unit:"second"}):v.s(e,t)},S:function(e,t){return v.S(e,t)},X:function(e,t,n,r){var o=(r._originalDate||e).getTimezoneOffset();if(0===o)return"Z";switch(t){case"X":return S(o);case"XXXX":case"XX":return I(o);default:return I(o,":")}},x:function(e,t,n,r){var o=(r._originalDate||e).getTimezoneOffset();switch(t){case"x":return S(o);case"xxxx":case"xx":return I(o);default:return I(o,":")}},O:function(e,t,n,r){var o=(r._originalDate||e).getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+A(o,":");default:return"GMT"+I(o,":")}},z:function(e,t,n,r){var o=(r._originalDate||e).getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+A(o,":");default:return"GMT"+I(o,":")}},t:function(e,t,n,r){var o=r._originalDate||e;return g(Math.floor(o.getTime()/1e3),t.length)},T:function(e,t,n,r){return g((r._originalDate||e).getTime(),t.length)}};function A(e,t){var n=e>0?"-":"+",r=Math.abs(e),o=Math.floor(r/60),i=r%60;if(0===i)return n+String(o);var a=t||"";return n+String(o)+a+g(i,2)}function S(e,t){return e%60==0?(e>0?"-":"+")+g(Math.abs(e)/60,2):I(e,t)}function I(e,t){var n=t||"",r=e>0?"-":"+",o=Math.abs(e);return r+g(Math.floor(o/60),2)+n+g(o%60,2)}var R=T,M=function(e,t){switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},O=function(e,t){switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},N={p:O,P:function(e,t){var n,r=e.match(/(P+)(p+)?/)||[],o=r[1],i=r[2];if(!i)return M(e,t);switch(o){case"P":n=t.dateTime({width:"short"});break;case"PP":n=t.dateTime({width:"medium"});break;case"PPP":n=t.dateTime({width:"long"});break;default:n=t.dateTime({width:"full"})}return n.replace("{{date}}",M(o,t)).replace("{{time}}",O(i,t))}},k=["D","DD"],L=["YY","YYYY"];function D(e,t,n){if("YYYY"===e)throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(t,"`) for formatting years to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("YY"===e)throw new RangeError("Use `yy` instead of `YY` (in `".concat(t,"`) for formatting years to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("D"===e)throw new RangeError("Use `d` instead of `D` (in `".concat(t,"`) for formatting days of the month to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("DD"===e)throw new RangeError("Use `dd` instead of `DD` (in `".concat(t,"`) for formatting days of the month to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var P=n(386818).Z,x=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,F=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,B=/^'([^]*?)'?$/,U=/''/g,H=/[a-zA-Z]/;function W(e,t,n){var r,l,u,d,p,h,m,g,v,_,y,b,E,C,w,T,A,S;(0,o.Z)(2,arguments);var I=String(t),M=(0,f.j)(),O=null!==(r=null!==(l=null==n?void 0:n.locale)&&void 0!==l?l:M.locale)&&void 0!==r?r:P,W=(0,s.Z)(null!==(u=null!==(d=null!==(p=null!==(h=null==n?void 0:n.firstWeekContainsDate)&&void 0!==h?h:null==n||null===(m=n.locale)||void 0===m||null===(g=m.options)||void 0===g?void 0:g.firstWeekContainsDate)&&void 0!==p?p:M.firstWeekContainsDate)&&void 0!==d?d:null===(v=M.locale)||void 0===v||null===(_=v.options)||void 0===_?void 0:_.firstWeekContainsDate)&&void 0!==u?u:1);if(!(W>=1&&W<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var j=(0,s.Z)(null!==(y=null!==(b=null!==(E=null!==(C=null==n?void 0:n.weekStartsOn)&&void 0!==C?C:null==n||null===(w=n.locale)||void 0===w||null===(T=w.options)||void 0===T?void 0:T.weekStartsOn)&&void 0!==E?E:M.weekStartsOn)&&void 0!==b?b:null===(A=M.locale)||void 0===A||null===(S=A.options)||void 0===S?void 0:S.weekStartsOn)&&void 0!==y?y:0);if(!(j>=0&&j<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!O.localize)throw new RangeError("locale must contain localize property");if(!O.formatLong)throw new RangeError("locale must contain formatLong property");var G=(0,i.Z)(e);if(!a(G))throw new RangeError("Invalid time value");var V=function(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),e.getTime()-t.getTime()}(G),z=c(G,V),Q={firstWeekContainsDate:W,weekStartsOn:j,locale:O,_originalDate:G};return I.match(F).map((function(e){var t=e[0];return"p"===t||"P"===t?(0,N[t])(e,O.formatLong):e})).join("").match(x).map((function(r){if("''"===r)return"'";var o,i,a=r[0];if("'"===a)return(i=(o=r).match(B))?i[1].replace(U,"'"):o;var s,c=R[a];if(c)return null!=n&&n.useAdditionalWeekYearTokens||(s=r,-1===L.indexOf(s))||D(r,t,String(e)),null!=n&&n.useAdditionalDayOfYearTokens||!function(e){return-1!==k.indexOf(e)}(r)||D(r,t,String(e)),c(z,r,O.localize,Q);if(a.match(H))throw new RangeError("Format string contains an unescaped latin alphabet character `"+a+"`");return r})).join("")}},613402:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(616722),o=n(460348);function i(e){(0,o.Z)(1,arguments);var t=(0,r.Z)(e);return t.setHours(0,0,0,0),t}function a(e,t){(0,o.Z)(2,arguments);var n=i(e),r=i(t);return n.getTime()===r.getTime()}},338156:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(616722),o=n(460348);function i(e,t){(0,o.Z)(2,arguments);var n=(0,r.Z)(e),i=(0,r.Z)(t);return n.getFullYear()===i.getFullYear()}},98868:function(e,t,n){function r(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}n.d(t,{Z:function(){return r}})},447976:function(e,t,n){function r(e){return function(t,n){var r;if("formatting"===(null!=n&&n.context?String(n.context):"standalone")&&e.formattingValues){var o=e.defaultFormattingWidth||e.defaultWidth,i=null!=n&&n.width?String(n.width):o;r=e.formattingValues[i]||e.formattingValues[o]}else{var a=e.defaultWidth,s=null!=n&&n.width?String(n.width):e.defaultWidth;r=e.values[s]||e.values[a]}return r[e.argumentCallback?e.argumentCallback(t):t]}}n.d(t,{Z:function(){return r}})},104055:function(e,t,n){function r(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.width,o=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],i=t.match(o);if(!i)return null;var a,s=i[0],c=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(c)?function(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return n}(c,(function(e){return e.test(s)})):function(e,t){for(var n in e)if(e.hasOwnProperty(n)&&t(e[n]))return n}(c,(function(e){return e.test(s)}));return a=e.valueCallback?e.valueCallback(l):l,{value:a=n.valueCallback?n.valueCallback(a):a,rest:t.slice(s.length)}}}n.d(t,{Z:function(){return r}})},521666:function(e,t,n){function r(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.match(e.matchPattern);if(!r)return null;var o=r[0],i=t.match(e.parsePattern);if(!i)return null;var a=e.valueCallback?e.valueCallback(i[0]):i[0];return{value:a=n.valueCallback?n.valueCallback(a):a,rest:t.slice(o.length)}}}n.d(t,{Z:function(){return r}})},386818:function(e,t,n){n.d(t,{Z:function(){return p}});var r={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},o=function(e,t,n){var o,i=r[e];return o="string"==typeof i?i:1===t?i.one:i.other.replace("{{count}}",t.toString()),null!=n&&n.addSuffix?n.comparison&&n.comparison>0?"in "+o:o+" ago":o},i=n(98868),a={date:(0,i.Z)({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:(0,i.Z)({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:(0,i.Z)({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},s={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},c=function(e,t,n,r){return s[e]},l=n(447976),u={ordinalNumber:function(e,t){var n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},era:(0,l.Z)({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:(0,l.Z)({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:(0,l.Z)({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:(0,l.Z)({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:(0,l.Z)({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},d=n(104055),p={code:"en-US",formatDistance:o,formatLong:a,formatRelative:c,localize:u,match:{ordinalNumber:(0,n(521666).Z)({matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:function(e){return parseInt(e,10)}}),era:(0,d.Z)({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:(0,d.Z)({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:(0,d.Z)({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:(0,d.Z)({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:(0,d.Z)({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}}},774945:function(e,t,n){n.d(t,{Z:function(){return m}});var r={lessThanXSeconds:{one:"不到 1 秒",other:"不到 {{count}} 秒"},xSeconds:{one:"1 秒",other:"{{count}} 秒"},halfAMinute:"半分钟",lessThanXMinutes:{one:"不到 1 分钟",other:"不到 {{count}} 分钟"},xMinutes:{one:"1 分钟",other:"{{count}} 分钟"},xHours:{one:"1 小时",other:"{{count}} 小时"},aboutXHours:{one:"大约 1 小时",other:"大约 {{count}} 小时"},xDays:{one:"1 天",other:"{{count}} 天"},aboutXWeeks:{one:"大约 1 个星期",other:"大约 {{count}} 个星期"},xWeeks:{one:"1 个星期",other:"{{count}} 个星期"},aboutXMonths:{one:"大约 1 个月",other:"大约 {{count}} 个月"},xMonths:{one:"1 个月",other:"{{count}} 个月"},aboutXYears:{one:"大约 1 年",other:"大约 {{count}} 年"},xYears:{one:"1 年",other:"{{count}} 年"},overXYears:{one:"超过 1 年",other:"超过 {{count}} 年"},almostXYears:{one:"将近 1 年",other:"将近 {{count}} 年"}},o=function(e,t,n){var o,i=r[e];return o="string"==typeof i?i:1===t?i.one:i.other.replace("{{count}}",String(t)),null!=n&&n.addSuffix?n.comparison&&n.comparison>0?o+"内":o+"前":o},i=n(98868),a={date:(0,i.Z)({formats:{full:"y'年'M'月'd'日' EEEE",long:"y'年'M'月'd'日'",medium:"yyyy-MM-dd",short:"yy-MM-dd"},defaultWidth:"full"}),time:(0,i.Z)({formats:{full:"zzzz a h:mm:ss",long:"z a h:mm:ss",medium:"a h:mm:ss",short:"a h:mm"},defaultWidth:"full"}),dateTime:(0,i.Z)({formats:{full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},defaultWidth:"full"})},s=n(460348),c=n(297041);function l(e,t,n){var r="eeee p";return function(e,t,n){(0,s.Z)(2,arguments);var r=(0,c.Z)(e,n),o=(0,c.Z)(t,n);return r.getTime()===o.getTime()}(e,t,n)?r:e.getTime()>t.getTime()?"'下个'"+r:"'上个'"+r}var u={lastWeek:l,yesterday:"'昨天' p",today:"'今天' p",tomorrow:"'明天' p",nextWeek:l,other:"PP p"},d=function(e,t,n,r){var o=u[e];return"function"==typeof o?o(t,n,r):o},p=n(447976),f={ordinalNumber:function(e,t){var n=Number(e);switch(null==t?void 0:t.unit){case"date":return n.toString()+"日";case"hour":return n.toString()+"时";case"minute":return n.toString()+"分";case"second":return n.toString()+"秒";default:return"第 "+n.toString()}},era:(0,p.Z)({values:{narrow:["前","公元"],abbreviated:["前","公元"],wide:["公元前","公元"]},defaultWidth:"wide"}),quarter:(0,p.Z)({values:{narrow:["1","2","3","4"],abbreviated:["第一季","第二季","第三季","第四季"],wide:["第一季度","第二季度","第三季度","第四季度"]},defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:(0,p.Z)({values:{narrow:["一","二","三","四","五","六","七","八","九","十","十一","十二"],abbreviated:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],wide:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]},defaultWidth:"wide"}),day:(0,p.Z)({values:{narrow:["日","一","二","三","四","五","六"],short:["日","一","二","三","四","五","六"],abbreviated:["周日","周一","周二","周三","周四","周五","周六"],wide:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"]},defaultWidth:"wide"}),dayPeriod:(0,p.Z)({values:{narrow:{am:"上",pm:"下",midnight:"凌晨",noon:"午",morning:"早",afternoon:"下午",evening:"晚",night:"夜"},abbreviated:{am:"上午",pm:"下午",midnight:"凌晨",noon:"中午",morning:"早晨",afternoon:"中午",evening:"晚上",night:"夜间"},wide:{am:"上午",pm:"下午",midnight:"凌晨",noon:"中午",morning:"早晨",afternoon:"中午",evening:"晚上",night:"夜间"}},defaultWidth:"wide",formattingValues:{narrow:{am:"上",pm:"下",midnight:"凌晨",noon:"午",morning:"早",afternoon:"下午",evening:"晚",night:"夜"},abbreviated:{am:"上午",pm:"下午",midnight:"凌晨",noon:"中午",morning:"早晨",afternoon:"中午",evening:"晚上",night:"夜间"},wide:{am:"上午",pm:"下午",midnight:"凌晨",noon:"中午",morning:"早晨",afternoon:"中午",evening:"晚上",night:"夜间"}},defaultFormattingWidth:"wide"})},h=n(104055),m={code:"zh-CN",formatDistance:o,formatLong:a,formatRelative:d,localize:f,match:{ordinalNumber:(0,n(521666).Z)({matchPattern:/^(第\s*)?\d+(日|时|分|秒)?/i,parsePattern:/\d+/i,valueCallback:function(e){return parseInt(e,10)}}),era:(0,h.Z)({matchPatterns:{narrow:/^(前)/i,abbreviated:/^(前)/i,wide:/^(公元前|公元)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^(前)/i,/^(公元)/i]},defaultParseWidth:"any"}),quarter:(0,h.Z)({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^第[一二三四]刻/i,wide:/^第[一二三四]刻钟/i},defaultMatchWidth:"wide",parsePatterns:{any:[/(1|一)/i,/(2|二)/i,/(3|三)/i,/(4|四)/i]},defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:(0,h.Z)({matchPatterns:{narrow:/^(一|二|三|四|五|六|七|八|九|十[二一])/i,abbreviated:/^(一|二|三|四|五|六|七|八|九|十[二一]|\d|1[12])月/i,wide:/^(一|二|三|四|五|六|七|八|九|十[二一])月/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^一/i,/^二/i,/^三/i,/^四/i,/^五/i,/^六/i,/^七/i,/^八/i,/^九/i,/^十(?!(一|二))/i,/^十一/i,/^十二/i],any:[/^一|1/i,/^二|2/i,/^三|3/i,/^四|4/i,/^五|5/i,/^六|6/i,/^七|7/i,/^八|8/i,/^九|9/i,/^十(?!(一|二))|10/i,/^十一|11/i,/^十二|12/i]},defaultParseWidth:"any"}),day:(0,h.Z)({matchPatterns:{narrow:/^[一二三四五六日]/i,short:/^[一二三四五六日]/i,abbreviated:/^周[一二三四五六日]/i,wide:/^星期[一二三四五六日]/i},defaultMatchWidth:"wide",parsePatterns:{any:[/日/i,/一/i,/二/i,/三/i,/四/i,/五/i,/六/i]},defaultParseWidth:"any"}),dayPeriod:(0,h.Z)({matchPatterns:{any:/^(上午?|下午?|午夜|[中正]午|早上?|下午|晚上?|凌晨|)/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^上午?/i,pm:/^下午?/i,midnight:/^午夜/i,noon:/^[中正]午/i,morning:/^早上/i,afternoon:/^下午/i,evening:/^晚上?/i,night:/^凌晨/i}},defaultParseWidth:"any"})},options:{weekStartsOn:1,firstWeekContainsDate:4}}},920412:function(e,t,n){n.d(t,{Z:function(){return p}});var r={lessThanXSeconds:{one:"少於 1 秒",other:"少於 {{count}} 秒"},xSeconds:{one:"1 秒",other:"{{count}} 秒"},halfAMinute:"半分鐘",lessThanXMinutes:{one:"少於 1 分鐘",other:"少於 {{count}} 分鐘"},xMinutes:{one:"1 分鐘",other:"{{count}} 分鐘"},xHours:{one:"1 小時",other:"{{count}} 小時"},aboutXHours:{one:"大約 1 小時",other:"大約 {{count}} 小時"},xDays:{one:"1 天",other:"{{count}} 天"},aboutXWeeks:{one:"大約 1 個星期",other:"大約 {{count}} 個星期"},xWeeks:{one:"1 個星期",other:"{{count}} 個星期"},aboutXMonths:{one:"大約 1 個月",other:"大約 {{count}} 個月"},xMonths:{one:"1 個月",other:"{{count}} 個月"},aboutXYears:{one:"大約 1 年",other:"大約 {{count}} 年"},xYears:{one:"1 年",other:"{{count}} 年"},overXYears:{one:"超過 1 年",other:"超過 {{count}} 年"},almostXYears:{one:"將近 1 年",other:"將近 {{count}} 年"}},o=function(e,t,n){var o,i=r[e];return o="string"==typeof i?i:1===t?i.one:i.other.replace("{{count}}",String(t)),null!=n&&n.addSuffix?n.comparison&&n.comparison>0?o+"內":o+"前":o},i=n(98868),a={date:(0,i.Z)({formats:{full:"y'年'M'月'd'日' EEEE",long:"y'年'M'月'd'日'",medium:"yyyy-MM-dd",short:"yy-MM-dd"},defaultWidth:"full"}),time:(0,i.Z)({formats:{full:"zzzz a h:mm:ss",long:"z a h:mm:ss",medium:"a h:mm:ss",short:"a h:mm"},defaultWidth:"full"}),dateTime:(0,i.Z)({formats:{full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},defaultWidth:"full"})},s={lastWeek:"'上個'eeee p",yesterday:"'昨天' p",today:"'今天' p",tomorrow:"'明天' p",nextWeek:"'下個'eeee p",other:"P"},c=function(e,t,n,r){return s[e]},l=n(447976),u={ordinalNumber:function(e,t){var n=Number(e);switch(null==t?void 0:t.unit){case"date":return n+"日";case"hour":return n+"時";case"minute":return n+"分";case"second":return n+"秒";default:return"第 "+n}},era:(0,l.Z)({values:{narrow:["前","公元"],abbreviated:["前","公元"],wide:["公元前","公元"]},defaultWidth:"wide"}),quarter:(0,l.Z)({values:{narrow:["1","2","3","4"],abbreviated:["第一季","第二季","第三季","第四季"],wide:["第一季度","第二季度","第三季度","第四季度"]},defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:(0,l.Z)({values:{narrow:["一","二","三","四","五","六","七","八","九","十","十一","十二"],abbreviated:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],wide:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]},defaultWidth:"wide"}),day:(0,l.Z)({values:{narrow:["日","一","二","三","四","五","六"],short:["日","一","二","三","四","五","六"],abbreviated:["週日","週一","週二","週三","週四","週五","週六"],wide:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"]},defaultWidth:"wide"}),dayPeriod:(0,l.Z)({values:{narrow:{am:"上",pm:"下",midnight:"午夜",noon:"晌",morning:"早",afternoon:"午",evening:"晚",night:"夜"},abbreviated:{am:"上午",pm:"下午",midnight:"午夜",noon:"中午",morning:"上午",afternoon:"下午",evening:"晚上",night:"夜晚"},wide:{am:"上午",pm:"下午",midnight:"午夜",noon:"中午",morning:"上午",afternoon:"下午",evening:"晚上",night:"夜晚"}},defaultWidth:"wide",formattingValues:{narrow:{am:"上",pm:"下",midnight:"午夜",noon:"晌",morning:"早",afternoon:"午",evening:"晚",night:"夜"},abbreviated:{am:"上午",pm:"下午",midnight:"午夜",noon:"中午",morning:"上午",afternoon:"下午",evening:"晚上",night:"夜晚"},wide:{am:"上午",pm:"下午",midnight:"午夜",noon:"中午",morning:"上午",afternoon:"下午",evening:"晚上",night:"夜晚"}},defaultFormattingWidth:"wide"})},d=n(104055),p={code:"zh-HK",formatDistance:o,formatLong:a,formatRelative:c,localize:u,match:{ordinalNumber:(0,n(521666).Z)({matchPattern:/^(第\s*)?\d+(日|時|分|秒)?/i,parsePattern:/\d+/i,valueCallback:function(e){return parseInt(e,10)}}),era:(0,d.Z)({matchPatterns:{narrow:/^(前)/i,abbreviated:/^(前)/i,wide:/^(公元前|公元)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^(前)/i,/^(公元)/i]},defaultParseWidth:"any"}),quarter:(0,d.Z)({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^第[一二三四]季/i,wide:/^第[一二三四]季度/i},defaultMatchWidth:"wide",parsePatterns:{any:[/(1|一)/i,/(2|二)/i,/(3|三)/i,/(4|四)/i]},defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:(0,d.Z)({matchPatterns:{narrow:/^(一|二|三|四|五|六|七|八|九|十[二一])/i,abbreviated:/^(一|二|三|四|五|六|七|八|九|十[二一]|\d|1[12])月/i,wide:/^(一|二|三|四|五|六|七|八|九|十[二一])月/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^一/i,/^二/i,/^三/i,/^四/i,/^五/i,/^六/i,/^七/i,/^八/i,/^九/i,/^十(?!(一|二))/i,/^十一/i,/^十二/i],any:[/^一|1/i,/^二|2/i,/^三|3/i,/^四|4/i,/^五|5/i,/^六|6/i,/^七|7/i,/^八|8/i,/^九|9/i,/^十(?!(一|二))|10/i,/^十一|11/i,/^十二|12/i]},defaultParseWidth:"any"}),day:(0,d.Z)({matchPatterns:{narrow:/^[一二三四五六日]/i,short:/^[一二三四五六日]/i,abbreviated:/^週[一二三四五六日]/i,wide:/^星期[一二三四五六日]/i},defaultMatchWidth:"wide",parsePatterns:{any:[/日/i,/一/i,/二/i,/三/i,/四/i,/五/i,/六/i]},defaultParseWidth:"any"}),dayPeriod:(0,d.Z)({matchPatterns:{any:/^(上午?|下午?|午夜|[中正]午|早上?|下午|晚上?|凌晨)/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^上午?/i,pm:/^下午?/i,midnight:/^午夜/i,noon:/^[中正]午/i,morning:/^早上/i,afternoon:/^下午/i,evening:/^晚上?/i,night:/^凌晨/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}}},616722:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(133157),o=n(460348);function i(e){(0,o.Z)(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"===(0,r.Z)(e)&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):("string"!=typeof e&&"[object String]"!==t||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn((new Error).stack)),new Date(NaN))}},327297:function(e){e.exports=function(){var e=1e3,t=6e4,n=36e5,r="millisecond",o="second",i="minute",a="hour",s="day",c="week",l="month",u="quarter",d="year",p="date",f="Invalid Date",h=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,m=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,g={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],n=e%100;return"["+e+(t[(n-20)%10]||t[n]||t[0])+"]"}},v=function(e,t,n){var r=String(e);return!r||r.length>=t?e:""+Array(t+1-r.length).join(n)+e},_={s:v,z:function(e){var t=-e.utcOffset(),n=Math.abs(t),r=Math.floor(n/60),o=n%60;return(t<=0?"+":"-")+v(r,2,"0")+":"+v(o,2,"0")},m:function e(t,n){if(t.date()<n.date())return-e(n,t);var r=12*(n.year()-t.year())+(n.month()-t.month()),o=t.clone().add(r,l),i=n-o<0,a=t.clone().add(r+(i?-1:1),l);return+(-(r+(n-o)/(i?o-a:a-o))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:l,y:d,w:c,d:s,D:p,h:a,m:i,s:o,ms:r,Q:u}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},y="en",b={};b[y]=g;var E=function(e){return e instanceof A},C=function e(t,n,r){var o;if(!t)return y;if("string"==typeof t){var i=t.toLowerCase();b[i]&&(o=i),n&&(b[i]=n,o=i);var a=t.split("-");if(!o&&a.length>1)return e(a[0])}else{var s=t.name;b[s]=t,o=s}return!r&&o&&(y=o),o||!r&&y},w=function(e,t){if(E(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new A(n)},T=_;T.l=C,T.i=E,T.w=function(e,t){return w(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var A=function(){function g(e){this.$L=C(e.locale,null,!0),this.parse(e)}var v=g.prototype;return v.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if(T.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var r=t.match(h);if(r){var o=r[2]-1||0,i=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],o,r[3]||1,r[4]||0,r[5]||0,r[6]||0,i)):new Date(r[1],o,r[3]||1,r[4]||0,r[5]||0,r[6]||0,i)}}return new Date(t)}(e),this.$x=e.x||{},this.init()},v.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},v.$utils=function(){return T},v.isValid=function(){return!(this.$d.toString()===f)},v.isSame=function(e,t){var n=w(e);return this.startOf(t)<=n&&n<=this.endOf(t)},v.isAfter=function(e,t){return w(e)<this.startOf(t)},v.isBefore=function(e,t){return this.endOf(t)<w(e)},v.$g=function(e,t,n){return T.u(e)?this[t]:this.set(n,e)},v.unix=function(){return Math.floor(this.valueOf()/1e3)},v.valueOf=function(){return this.$d.getTime()},v.startOf=function(e,t){var n=this,r=!!T.u(t)||t,u=T.p(e),f=function(e,t){var o=T.w(n.$u?Date.UTC(n.$y,t,e):new Date(n.$y,t,e),n);return r?o:o.endOf(s)},h=function(e,t){return T.w(n.toDate()[e].apply(n.toDate("s"),(r?[0,0,0,0]:[23,59,59,999]).slice(t)),n)},m=this.$W,g=this.$M,v=this.$D,_="set"+(this.$u?"UTC":"");switch(u){case d:return r?f(1,0):f(31,11);case l:return r?f(1,g):f(0,g+1);case c:var y=this.$locale().weekStart||0,b=(m<y?m+7:m)-y;return f(r?v-b:v+(6-b),g);case s:case p:return h(_+"Hours",0);case a:return h(_+"Minutes",1);case i:return h(_+"Seconds",2);case o:return h(_+"Milliseconds",3);default:return this.clone()}},v.endOf=function(e){return this.startOf(e,!1)},v.$set=function(e,t){var n,c=T.p(e),u="set"+(this.$u?"UTC":""),f=(n={},n[s]=u+"Date",n[p]=u+"Date",n[l]=u+"Month",n[d]=u+"FullYear",n[a]=u+"Hours",n[i]=u+"Minutes",n[o]=u+"Seconds",n[r]=u+"Milliseconds",n)[c],h=c===s?this.$D+(t-this.$W):t;if(c===l||c===d){var m=this.clone().set(p,1);m.$d[f](h),m.init(),this.$d=m.set(p,Math.min(this.$D,m.daysInMonth())).$d}else f&&this.$d[f](h);return this.init(),this},v.set=function(e,t){return this.clone().$set(e,t)},v.get=function(e){return this[T.p(e)]()},v.add=function(r,u){var p,f=this;r=Number(r);var h=T.p(u),m=function(e){var t=w(f);return T.w(t.date(t.date()+Math.round(e*r)),f)};if(h===l)return this.set(l,this.$M+r);if(h===d)return this.set(d,this.$y+r);if(h===s)return m(1);if(h===c)return m(7);var g=(p={},p[i]=t,p[a]=n,p[o]=e,p)[h]||1,v=this.$d.getTime()+r*g;return T.w(v,this)},v.subtract=function(e,t){return this.add(-1*e,t)},v.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return n.invalidDate||f;var r=e||"YYYY-MM-DDTHH:mm:ssZ",o=T.z(this),i=this.$H,a=this.$m,s=this.$M,c=n.weekdays,l=n.months,u=function(e,n,o,i){return e&&(e[n]||e(t,r))||o[n].slice(0,i)},d=function(e){return T.s(i%12||12,e,"0")},p=n.meridiem||function(e,t,n){var r=e<12?"AM":"PM";return n?r.toLowerCase():r},h={YY:String(this.$y).slice(-2),YYYY:this.$y,M:s+1,MM:T.s(s+1,2,"0"),MMM:u(n.monthsShort,s,l,3),MMMM:u(l,s),D:this.$D,DD:T.s(this.$D,2,"0"),d:String(this.$W),dd:u(n.weekdaysMin,this.$W,c,2),ddd:u(n.weekdaysShort,this.$W,c,3),dddd:c[this.$W],H:String(i),HH:T.s(i,2,"0"),h:d(1),hh:d(2),a:p(i,a,!0),A:p(i,a,!1),m:String(a),mm:T.s(a,2,"0"),s:String(this.$s),ss:T.s(this.$s,2,"0"),SSS:T.s(this.$ms,3,"0"),Z:o};return r.replace(m,(function(e,t){return t||h[e]||o.replace(":","")}))},v.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},v.diff=function(r,p,f){var h,m=T.p(p),g=w(r),v=(g.utcOffset()-this.utcOffset())*t,_=this-g,y=T.m(this,g);return y=(h={},h[d]=y/12,h[l]=y,h[u]=y/3,h[c]=(_-v)/6048e5,h[s]=(_-v)/864e5,h[a]=_/n,h[i]=_/t,h[o]=_/e,h)[m]||_,f?y:T.a(y)},v.daysInMonth=function(){return this.endOf(l).$D},v.$locale=function(){return b[this.$L]},v.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),r=C(e,t,!0);return r&&(n.$L=r),n},v.clone=function(){return T.w(this.$d,this)},v.toDate=function(){return new Date(this.valueOf())},v.toJSON=function(){return this.isValid()?this.toISOString():null},v.toISOString=function(){return this.$d.toISOString()},v.toString=function(){return this.$d.toUTCString()},g}(),S=A.prototype;return w.prototype=S,[["$ms",r],["$s",o],["$m",i],["$H",a],["$W",s],["$M",l],["$y",d],["$D",p]].forEach((function(e){S[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),w.extend=function(e,t){return e.$i||(e(t,A,w),e.$i=!0),w},w.locale=C,w.isDayjs=E,w.unix=function(e){return w(1e3*e)},w.en=b[y],w.Ls=b,w.p={},w}()},751501:function(e,t,n){var r=n(981879),o=n(539166),i=n(145429),a=n(106383),s=n(734128),c=n(87363),l=n.n(c),u=n(386764),d=n(738673),p=function(e,t){return e&&t&&t.split(" ").forEach((function(t){return(0,s.Z)(e,t)}))},f=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this).appliedClasses={appear:{},enter:{},exit:{}},t.onEnter=function(e,n){var r=t.resolveArguments(e,n),o=r[0],i=r[1];t.removeClasses(o,"exit"),t.addClass(o,i?"appear":"enter","base"),t.props.onEnter&&t.props.onEnter(e,n)},t.onEntering=function(e,n){var r=t.resolveArguments(e,n),o=r[0],i=r[1]?"appear":"enter";t.addClass(o,i,"active"),t.props.onEntering&&t.props.onEntering(e,n)},t.onEntered=function(e,n){var r=t.resolveArguments(e,n),o=r[0],i=r[1]?"appear":"enter";t.removeClasses(o,i),t.addClass(o,i,"done"),t.props.onEntered&&t.props.onEntered(e,n)},t.onExit=function(e){var n=t.resolveArguments(e)[0];t.removeClasses(n,"appear"),t.removeClasses(n,"enter"),t.addClass(n,"exit","base"),t.props.onExit&&t.props.onExit(e)},t.onExiting=function(e){var n=t.resolveArguments(e)[0];t.addClass(n,"exit","active"),t.props.onExiting&&t.props.onExiting(e)},t.onExited=function(e){var n=t.resolveArguments(e)[0];t.removeClasses(n,"exit"),t.addClass(n,"exit","done"),t.props.onExited&&t.props.onExited(e)},t.resolveArguments=function(e,n){return t.props.nodeRef?[t.props.nodeRef.current,e]:[e,n]},t.getClassNames=function(e){var n=t.props.classNames,r="string"==typeof n,o=r?(r&&n?n+"-":"")+e:n[e];return{baseClassName:o,activeClassName:r?o+"-active":n[e+"Active"],doneClassName:r?o+"-done":n[e+"Done"]}},t}(0,i.Z)(t,e);var n=t.prototype;return n.addClass=function(e,t,n){var r=this.getClassNames(t)[n+"ClassName"],o=this.getClassNames("enter").doneClassName;"appear"===t&&"done"===n&&o&&(r+=" "+o),"active"===n&&e&&(0,d.Q)(e),r&&(this.appliedClasses[t][n]=r,function(e,t){e&&t&&t.split(" ").forEach((function(t){return(0,a.Z)(e,t)}))}(e,r))},n.removeClasses=function(e,t){var n=this.appliedClasses[t],r=n.base,o=n.active,i=n.done;this.appliedClasses[t]={},r&&p(e,r),o&&p(e,o),i&&p(e,i)},n.render=function(){var e=this.props,t=(e.classNames,(0,o.Z)(e,["classNames"]));return l().createElement(u.ZP,(0,r.Z)({},t,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},t}(l().Component);f.defaultProps={classNames:""},f.propTypes={},t.Z=f},221352:function(e,t,n){n.d(t,{H:function(){return s}});var r=n(662654),o=n(878029),i=n(340193),a=n(539738);function s(e,t,n){void 0===e&&(e=0);var s=-1;return(0,i.k)(t)?s=Number(t)<1?1:Number(t):(0,a.K)(t)&&(n=t),(0,a.K)(n)||(n=o.P),new r.y((function(t){var r=(0,i.k)(e)?e:+e-n.now();return n.schedule(c,r,{index:0,period:s,subscriber:t})}))}function c(e){var t=e.index,n=e.period,r=e.subscriber;if(r.next(t),!r.closed){if(-1===n)return r.complete();e.index=t+1,this.schedule(e,n)}}},368206:function(e,t,n){var r=n(201044),o=n(307499),i=n(812439),a=n(735156),s=function(){function e(e,t){var n=t.taskPriority;this.versionManager=new o.Z(e),this.taskQueueManager=new r.ZP(n),i.Z.debug("baseMessageCenter created")}return e.prototype.pause=function(e){void 0===e&&(e=a.Q.ALL),i.Z.debug("baseMessageCenter pause type:".concat(e)),this.taskQueueManager.pause()},e.prototype.resume=function(e){void 0===e&&(e=a.Q.ALL),i.Z.debug("baseMessageCenter resume type:".concat(e)),this.taskQueueManager.resume()},e.prototype.forceResume=function(e){void 0===e&&(e=a.Q.ALL),i.Z.debug("baseMessageCenter forceResume type:".concat(e)),this.taskQueueManager.forceResume()},e.prototype.dispose=function(){i.Z.debug("baseMessageCenter dispose"),this.taskQueueManager.dispose(),this.versionManager.dispose()},e}();t.Z=s},63990:function(){},188758:function(){},616545:function(e,t,n){n.d(t,{k:function(){return f}});var r=n(839461),o=n(281213),i=n(812439),a=n(795901),s=function(){function e(e){this.collabCenter=e}return e.prototype.handleCommitError=function(e){var t=e.errorCode,n=e.result,a="".concat((null==n?void 0:n.errMsg)||t);if([o.RoomErrorCode.EXIST,o.RoomErrorCode.ROOM_CLOSE,o.RoomErrorCode.ROOM_SHUTDOWN].includes(t))i.Z.error("handle commit error, code: ".concat(t," reason: ").concat(a));else{if([40021,40027].includes(t))return this.collabCenter.messageCenter.sendMessageManager.commitAfterUpdateVersionToLatest(void 0,0),void i.Z.error("handle commit error, fetch miss change, code: ".concat(t," reason: ").concat(a));[1e4,10001,4e4,40002,40003,40007,40022,40023,41001,41002].includes(t)?a="COMMIT_ERROR code=".concat(t):[40001,40020].includes(t)?a="TSSD_ERROR code=".concat(t):[60007,60015].includes(t)&&(a="COMMIT_UNAUTH code=".concat(t)),this.collabCenter.disconnect(a,t);var s=e.commitingQueue,c=(0,r.__read)(s,1)[0],l="\n            taskId: ".concat(c.taskId,",\n            subId: ").concat(c.subId,",\n            baseRev: ").concat(c.baseRev,",\n            commands: ").concat(c.commands,"\n            changeset: ").concat(c.changeset,"\n        ");i.Z.error("userchange commit error, code: ".concat(t," reason: ").concat(a," message: ").concat(l)),this.collabCenter.messageCenter.sendMessageManager.onCommitFailEmitter.fire(e)}},e.prototype.handleCommitBlock=function(e){var t={errorCode:a.K.SEND_BLOCK,commitingQueue:e,type:"ON_SEND_ACCEPT"};i.Z.error("handleCommitBlock userchange commit block, code: ".concat(t.errorCode)),this.collabCenter.messageCenter.sendMessageManager.onCommitFailEmitter.fire(t)},e}(),c=n(683371),l=n(634667),u=n(735156),d=n(227218),p=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},f=function(){function e(e){this.options=e,this.init()}return Object.defineProperty(e.prototype,"version",{get:function(){return this.messageCenter.versionManager.getCurrentVersion()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"connectionController",{get:function(){return this.messageCenter.connectionController},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConnected",{get:function(){return this.messageCenter.isConnected()},enumerable:!1,configurable:!0}),e.prototype.connect=function(e){this.messageCenter.openRoom(e)},e.prototype.disconnect=function(e,t){this.messageCenter.shutDown(e,t)},e.prototype.reconnect=function(e){this.messageCenter.reconnect(e)},e.prototype.pause=function(e){void 0===e&&(e=u.Q.ALL),this.messageCenter.pause(e)},e.prototype.resume=function(e){void 0===e&&(e=u.Q.ALL),this.messageCenter.resume(e)},e.prototype.forceResume=function(e){void 0===e&&(e=u.Q.ALL),this.messageCenter.forceResume(e)},e.prototype.onTaskDestroy=function(e,t,n){var r,o;return null===(o=(r=this.messageCenter.taskQueueManager).onTaskDestroy)||void 0===o?void 0:o.call(r,e,t,n)},e.prototype.sendUserChange=function(e){var t=this.messageCenter.localUserChangeManager,n=e.filter((function(e){return!t.has(e)}));n.length>0&&this.messageCenter.addUserChange(n)},e.prototype.sendMessage=function(e){var t=this;e.map((function(e){return t.messageCenter.sendMessage(e)}))},e.prototype.handleServerUserChanges=function(e){return p(this,void 0,void 0,(function(){var t,n=this;return(0,r.__generator)(this,(function(r){return t=e.map((function(e){return n.messageCenter.receiveMessageManager.handleServerUserChange(e)})),[2,(0,d.A)(t)]}))}))},e.prototype.startGetMissChanges=function(e,t){this.messageCenter.startGetMissChanges(e,t)},e.prototype.getMissChanges=function(e,t){return p(this,void 0,void 0,(function(){var n,o;return(0,r.__generator)(this,(function(r){if(!(n=this.options.collabCenterDelegate.getMissChangesUrl))throw new Error("getMissChangesUrl is not implements!");return o=this.options.connectionOptions.serverVars.globalPadId,[2,(0,l.getMissChange)({from:e,to:t,globalPadId:o},n)]}))}))},e.prototype.on=function(e,t){var n=Object.getOwnPropertyDescriptor(this.messageCenter.eventManager,e);return n?(0,n.value)(t):{dispose:function(){}}},e.prototype.dispose=function(){this.messageCenter.dispose()},e.prototype.init=function(){var e,t,n,r,o,i,a,u,d,p,f,h=this,m=(null!==(e=this.options.config)&&void 0!==e?e:{}).documentInfo,g=null!==(t=null==m?void 0:m.isCreator)&&void 0!==t?t:c.h.isCreator,v=null!==(n=null==m?void 0:m.isEditable)&&void 0!==n?n:c.h.isEditable,_=null!==(o=null===(r=this.options.config)||void 0===r?void 0:r.fullMemberInfo)&&void 0!==o?o:c.h.fullMemberInfo,y=null!==(a=null===(i=this.options.config)||void 0===i?void 0:i.hotDocsInfo)&&void 0!==a?a:c.h.hotDocsInfo,b=null!==(d=null===(u=this.options.config)||void 0===u?void 0:u.isSplitMissTask)&&void 0!==d?d:c.h.isSplitMissTask,E=null!==(f=null===(p=this.options.config)||void 0===p?void 0:p.taskPriority)&&void 0!==f?f:c.h.taskPriority;this.messageCenter=new l.MessageCenter(this.options.baseVersion,{isCreator:g,isEditable:v,hotDocsInfo:y,fullMemberInfo:_,isSplitMissTask:b,taskPriority:E}),this.sendMessageHandler=new s(this),this.messageCenter.setGlobalVars(this.options.connectionOptions),this.messageCenter.setOptionalFunction(Object.assign(Object.assign({},this.options.collabCenterDelegate),{checkIfNeedFollow:this.options.collabCenterDelegate.shouldFollowUserChange})),this.messageCenter.eventManager.onCommitError((function(e){return h.sendMessageHandler.handleCommitError(e)})),this.messageCenter.eventManager.onCommitBlock((function(e){return h.sendMessageHandler.handleCommitBlock(e)})),this.messageCenter.start()},e.prototype.getLocalUserChanges=function(){return this.messageCenter.getLocalUserChanges()},e}()},459014:function(e,t,n){n.d(t,{CONNECTION_STATE_EVENT:function(){return a.qP},CollabCenter:function(){return r.k},LOCAL_USER_CHANGE_EVENT:function(){return a.uR},RECEIVE_MESSAGE_EVENT:function(){return a.uC},REPORT_EVENT:function(){return a.op},SEND_MESSAGE_EVENT:function(){return a.no},VERSION_EVENT:function(){return a.n7}});var r=n(616545),o=n(188758);n.o(o,"Command")&&n.d(t,{Command:function(){return o.Command}}),n.o(o,"DEFAULT_SEND_MESSAGE_TIMEOUT")&&n.d(t,{DEFAULT_SEND_MESSAGE_TIMEOUT:function(){return o.DEFAULT_SEND_MESSAGE_TIMEOUT}}),n.o(o,"MessagePriority")&&n.d(t,{MessagePriority:function(){return o.MessagePriority}}),n.o(o,"RoomWebsocketErrorCode")&&n.d(t,{RoomWebsocketErrorCode:function(){return o.RoomWebsocketErrorCode}}),n.o(o,"generateMessageTaskId")&&n.d(t,{generateMessageTaskId:function(){return o.generateMessageTaskId}});var i=n(63990);n.o(i,"Command")&&n.d(t,{Command:function(){return i.Command}}),n.o(i,"DEFAULT_SEND_MESSAGE_TIMEOUT")&&n.d(t,{DEFAULT_SEND_MESSAGE_TIMEOUT:function(){return i.DEFAULT_SEND_MESSAGE_TIMEOUT}}),n.o(i,"MessagePriority")&&n.d(t,{MessagePriority:function(){return i.MessagePriority}}),n.o(i,"RoomWebsocketErrorCode")&&n.d(t,{RoomWebsocketErrorCode:function(){return i.RoomWebsocketErrorCode}}),n.o(i,"generateMessageTaskId")&&n.d(t,{generateMessageTaskId:function(){return i.generateMessageTaskId}});var a=n(330624)},735156:function(e,t,n){var r;n.d(t,{Q:function(){return r}}),function(e){e.SEND="SEND",e.RECEIVE="RECEIVE",e.ALL="ALL"}(r||(r={}))},313649:function(e,t,n){var r=n(839461),o=n(962937),i=n(812439),a=function(){function e(){var e=this;this._onQueueChange=new o.Q,this.onQueueChange=this._onQueueChange.event,this.waitingQueue=[],this.commitingQueue=[],this.isDuplicateTaskId=function(t){return!!e.findTask(t)},this.findTask=function(t){var n=e.getCommitingQueue(),o=e.getWaitingQueue();return(0,r.__spreadArray)((0,r.__spreadArray)([],(0,r.__read)(n),!1),(0,r.__read)(o),!1).find((function(n){return e.isEqual(t,n.getTaskId())}))},i.Z.debug("LocalUserChangeManager created")}return e.prototype.has=function(e){var t=this;return(0,r.__spreadArray)((0,r.__spreadArray)([],(0,r.__read)(this.commitingQueue),!1),(0,r.__read)(this.waitingQueue),!1).some((function(n){return t.isEqual(n.getTaskId(),e.taskId)}))},e.prototype.pushToWaitingQueue=function(e){var t;(t=this.waitingQueue).push.apply(t,(0,r.__spreadArray)([],(0,r.__read)(e),!1)),this.notifyQueueChange()},e.prototype.isCommittingEmpty=function(){return 0===this.commitingQueue.length},e.prototype.isWaitingEmpty=function(){return 0===this.waitingQueue.length},e.prototype.moveWaitingToCommiting=function(){this.isWaitingEmpty()||(i.Z.debug("moveWaitingToCommiting: waitingQueue length: ".concat(this.waitingQueue.length)),this.commitingQueue.push(this.waitingQueue.shift()),this.notifyQueueChange())},e.prototype.clearUserChangeByTaskIdInQueue=function(e,t){var n=this;this.commitingQueue=this.commitingQueue.filter((function(t){return!n.isEqual(t.getTaskId(),e)})),this.waitingQueue=this.waitingQueue.filter((function(t){return!n.isEqual(t.getTaskId(),e)})),this.updateVersion(t)},e.prototype.clearAllUserChangeQueue=function(){this.commitingQueue=[],this.waitingQueue=[],this.notifyQueueChange()},e.prototype.getWaitingQueue=function(){return this.waitingQueue},e.prototype.getCommitingQueue=function(){return this.commitingQueue},e.prototype.updateVersion=function(e){(0,r.__spreadArray)((0,r.__spreadArray)([],(0,r.__read)(this.commitingQueue),!1),(0,r.__read)(this.waitingQueue),!1).forEach((function(t){t.updateBaseVersion(e)})),this.notifyQueueChange()},e.prototype.notifyQueueChange=function(){this._onQueueChange.fire({waitingQueue:this.waitingQueue.map((function(e){return e.getOriginData()})),commitingQueue:this.commitingQueue.map((function(e){return e.getOriginData()}))})},e.prototype.getLocalUserChanges=function(){return(0,r.__spreadArray)((0,r.__spreadArray)([],(0,r.__read)(this.commitingQueue.map((function(e){return e.getOriginData()}))),!1),(0,r.__read)(this.waitingQueue.map((function(e){return e.getOriginData()}))),!1)},e.prototype.dispose=function(){i.Z.debug("LocalUserChangeManager dispose"),this.waitingQueue=[],this.commitingQueue=[],this._onQueueChange.dispose()},e.prototype.isEqual=function(e,t){return void 0!==e&&void 0!==t&&"".concat(e)==="".concat(t)},e}();t.Z=a},280217:function(e,t,n){var r=n(969252),o=n(962937),i=n(812439),a=n(666410),s=function(){function e(){this.roomStatus=r.RoomState.INIT,this.errCode=null,this._onRoomOpen=new o.Q,this.onRoomOpen=this._onRoomOpen.event,this._onConnectionStatusChange=new o.Q,this.onConnectionStatusChange=this._onConnectionStatusChange.event,this._onShutdown=new o.Q,this.onShutdown=this._onShutdown.event,this._onClosed=new o.Q,this.onClosed=this._onClosed.event,this._onSwitchConnectMode=new o.Q,this.onSwitchConnectMode=this._onSwitchConnectMode.event,this._onEnterOnline=new o.Q,this.onEnterOnline=this._onEnterOnline.event,this._onEnterOffline=new o.Q,this.onEnterOffline=this._onEnterOffline.event,this._onNetReconnectedFail=new o.Q,this.onNetReconnectedFail=this._onNetReconnectedFail.event,i.Z.debug("NetworkStatusManager created")}return e.prototype.handleOnRoomOpen=function(){i.Z.info("NetworkStatusManager handleOnRoomOpen"),this.roomStatus=r.RoomState.OPENED,this.errCode=null,this._onRoomOpen.fire()},e.prototype.handleOnRoomStateChange=function(e,t){i.Z.info("NetworkStatusManager handleOnRoomStateChange, roomState=".concat(e,", description="),t),this.roomStatus=e,this._onConnectionStatusChange.fire({status:this.roomStatus,moreInfo:t})},e.prototype.handleNetReconnectedFail=function(){i.Z.info("NetworkStatusManager handleNetReconnectedFail roomStatus=".concat(this.roomStatus)),this._onNetReconnectedFail.fire()},e.prototype.handleOnRoomShutDown=function(e){return i.Z.info("NetworkStatusManager handleOnRoomShutDown, reason=",e),this.errCode=e.errCode,e.errCode===a.RoomWebsocketErrorCode.SOCKET_SWITCH_BIG_COLLAB?(this.roomStatus=r.RoomState.INIT,void this._onSwitchConnectMode.fire(a.ConnectMode.BIG_COLLAB)):e.errCode===a.RoomErrorCode.BIG_COLLAB_CONNECT_TIMEOUT?(this.roomStatus=r.RoomState.INIT,void this._onSwitchConnectMode.fire(a.ConnectMode.WEBSOCKET_FORCED)):(this.roomStatus=r.RoomState.SHUTDOWN,void this._onShutdown.fire({reason:e,status:this.roomStatus}))},e.prototype.handleOnRoomClose=function(e){i.Z.info("NetworkStatusManager handleOnRoomClose, reason=",e),this.roomStatus=r.RoomState.RECONNECTING_IN_CLOSED,this.errCode=e.errCode,e.errCode!==a.RoomWebsocketErrorCode.SOCKET_SWITCH_BIG_COLLAB?e.errCode!==a.RoomErrorCode.BIG_COLLAB_CONNECT_TIMEOUT?e.shutDown?(this.roomStatus=r.RoomState.SHUTDOWN,this._onShutdown.fire({reason:e,status:this.roomStatus})):this._onClosed.fire({reason:e,status:this.roomStatus}):this._onSwitchConnectMode.fire(a.ConnectMode.WEBSOCKET_FORCED):this._onSwitchConnectMode.fire(a.ConnectMode.BIG_COLLAB)},e.prototype.getRoomStatus=function(){return this.roomStatus},e.prototype.getErrCode=function(){return this.errCode},e.prototype.handleOnEnterOnline=function(){this._onEnterOnline.fire()},e.prototype.handleOnEnterOffline=function(){this._onEnterOffline.fire()},e.prototype.dispose=function(){i.Z.debug("NetworkStatusManager dispose"),this.roomStatus=r.RoomState.INIT,this._onConnectionStatusChange.dispose(),this._onRoomOpen.dispose(),this._onShutdown.dispose(),this._onClosed.dispose()},e}();t.Z=s},201044:function(e,t,n){n.d(t,{lS:function(){return h},ZP:function(){return v}});var r=n(839461),o=n(962937),i=n(954560),a=n(812439),s=n(227218),c=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};function l(e){void 0===e&&(e={});var t=e.minRemaining,n=void 0===t?-1:t,r=e.timeout;return new Promise((function(e){var t=performance.now(),o=function(i){var a=i.didTimeout;if(i.timeRemaining()>n||a)return e(void 0);if(void 0!==r){var s=performance.now();if(r-=s-t,t=s,r<=0)return e(void 0)}u(o,{timeout:r})};u(o,{timeout:r})}))}function u(e,t){if((0,s.t)(window.requestIdleCallback)){var n=window.requestIdleCallback(e,t);return function(){return window.cancelIdleCallback(n)}}var r=function(e,t){var n,r=performance.now(),o=r,i=function(){var a=performance.now(),s=50-(a-o),c=void 0!==(null==t?void 0:t.timeout)&&a-r>=t.timeout;if(s<=0&&!c)return o=a,void(n=setTimeout(i,1));e({didTimeout:c,timeRemaining:function(){return s}})};return n=setTimeout(i,1),function(){return n}}(e,t);return function(){return window.clearTimeout(r())}}var d=function(){function e(e,t){void 0===e&&(e=30),void 0===t&&(t=0);var n=this;this.initState=function(){window.clearTimeout(n.timer),n.timer=void 0,n.lastStartTime=void 0,n.duration=0},this.maxDuration=e,this.delay=t,this.initState()}return e.prototype.slice=function(){return c(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return this.lastStartTime&&(this.duration+=Date.now()-this.lastStartTime),this.duration>=this.maxDuration?[4,p(this.delay)]:[3,2];case 1:e.sent(),this.initState(),e.label=2;case 2:return this.timer||(this.timer=setTimeout(this.initState,this.delay)),this.lastStartTime=Date.now(),[2]}}))}))},e}();function p(e){return c(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){return[2,new Promise((function(t){setTimeout(t,e)}))]}))}))}var f,h,m=n(395979),g=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};!function(e){e.WORKING="WORKING",e.PAUSE="PAUSE",e.IDLE="IDLE",e.SHUTDOWN="SHUTDOWN"}(f||(f={})),function(e){e.IMMEDIATELY="IMMEDIATELY",e.IDLE="IDLE",e.SLICE="SLICE"}(h||(h={}));var v=function(){function e(e){void 0===e&&(e=h.IMMEDIATELY),this.priority=e,this.taskDeadloopMap=new Map,this.taskList=[],this.status=f.IDLE,this.checkTaskQueueTimer=0,this._onTaskError=new o.Q,this.onTaskError=this._onTaskError.event,this._onTaskDestroy=new o.Q,this.onTaskDestroy=this._onTaskDestroy.event,this._onTaskShutDown=new o.Q,this.onTaskShutDown=this._onTaskShutDown.event,a.Z.info("TaskQueueManager created")}return Object.defineProperty(e.prototype,"length",{get:function(){return this.taskList.length},enumerable:!1,configurable:!0}),e.prototype.getStatus=function(){return this.status},e.prototype.isEmpty=function(){return 0===this.taskList.length},e.prototype.isQueueWorking=function(){return this.status===f.WORKING},e.prototype.pause=function(){if(a.Z.info("TaskQueueManager pause, task length = ".concat(this.taskList.length,", current task = "),this.currentTask),this.switchStatus(f.PAUSE),this.currentTask){var e=this.currentTask.reset();this.currentTask=void 0,this.pushTask([e],0)}this.clearCheckTaskQueueTimer(),this.checkTaskQueueTimer=setTimeout((function(){i.Z.report(m.Yo.TASK_QUEUE_NOT_RESUME_AFTER_60_SECOND)}),6e4)},e.prototype.resume=function(){a.Z.info("TaskQueueManager resume, task length: ".concat(this.taskList.length,", status:").concat(this.status)),this.clearCheckTaskQueueTimer(),this.status!==f.SHUTDOWN&&this.switchStatus(f.WORKING)},e.prototype.forceResume=function(){a.Z.info("TaskQueueManager forceResume, task length: ".concat(this.taskList.length,", status:").concat(this.status)),this.switchStatus(f.WORKING,!0),this.clearCheckTaskQueueTimer()},e.prototype.shutDown=function(e){a.Z.warn("TaskQueueManager shutDown, error = ",null==e?void 0:e.stack,null==e?void 0:e.message),this.switchStatus(f.SHUTDOWN),this._onTaskShutDown.fire(),this.clearCheckTaskQueueTimer()},e.prototype.pushTask=function(e,t){var n;void 0===t&&(t=this.length);var o="";Array.isArray(e)?((n=this.taskList).splice.apply(n,(0,r.__spreadArray)([t,0],(0,r.__read)(e),!1)),e.length&&(o=(0,r.__read)(e,1)[0].type)):(this.taskList.splice(t,0,e),o=e.type),a.Z.info("TaskQueueManager pushTask, taskQueue length: ".concat(this.taskList.length,", index: ").concat(t,", status:").concat(this.status," type:").concat(o)),this.status===f.IDLE&&this.switchStatus(f.WORKING)},e.prototype.dispose=function(){a.Z.info("TaskQueueManager dispose"),this.status=f.SHUTDOWN,this.currentTask=void 0,this.taskList=[],this._onTaskDestroy.dispose(),this._onTaskError.dispose()},e.prototype.hasNext=function(){return!this.isEmpty()},e.prototype.work=function(){a.Z.debug("TaskQueueManager work"),this.hasNext()?this.runNext():this.switchToIdle()},e.prototype.popTask=function(){if(a.Z.debug("TaskQueueManager popTask"),0!==this.length)return this.taskList.shift()},e.prototype.runNext=function(){return g(this,void 0,void 0,(function(){var e,t,n,o,i=this;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return a.Z.debug("TaskQueueManager runNext"),(e=this.popTask())?(t=e.taskIdentify(),(n=this.taskDeadloopMap.get(t)||0)>100?(this._onTaskError.fire({error:new Error("DEADLOOP_DETECTED (".concat(e.taskId,"|").concat(e.type,")")),currentTask:e}),[2]):(this.taskDeadloopMap.set(t,n+1),this.currentTask=e,a.Z.info("TaskQueueManager runNext: run task, task=",{type:e.type,taskId:e.taskId,status:e.getCurrentStatus()}),[4,this.awaitRunByPriority()])):[3,3];case 1:return r.sent(),[4,e.run().catch((function(t){a.Z.error("TaskQueueManager runNext: run error",null==t?void 0:t.message),i.pause(),i._onTaskError.fire({error:t,currentTask:e})}))];case 2:(o=r.sent())&&(a.Z.debug("TaskQueueManager runNext: run task result, resultTask=",o.map((function(e){return{type:e.type,taskId:e.taskId,status:e.getCurrentStatus()}}))),this.pushTask(o,0)),this.destroyTaskAndCheckQueueStatus(e),r.label=3;case 3:return[2]}}))}))},e.prototype.awaitRunByPriority=function(){return g(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){switch(e.label){case 0:switch(this.priority){case h.IDLE:return[3,1];case h.SLICE:return[3,3];case h.IMMEDIATELY:return[3,5]}return[3,6];case 1:return[4,l({timeout:100,minRemaining:10})];case 2:case 4:return e.sent(),[2];case 3:return this.timeSlicer||(this.timeSlicer=new d),[4,this.timeSlicer.slice()];case 5:case 6:return[2]}}))}))},e.prototype.destroyTaskAndCheckQueueStatus=function(e){a.Z.debug("TaskQueueManager destroyTaskAndCheckQueueStatus"),this.currentTask=void 0,this._onTaskDestroy.fire(e),this.isQueueWorking()?this.work():this.switchToIdle()},e.prototype.switchStatus=function(e,t){if(void 0===t&&(t=!1),a.Z.info("TaskQueueManager switchStatus this.status:".concat(this.status,", newStatus:").concat(e,", taskQueue length: ").concat(this.taskList.length)),this.status!==f.SHUTDOWN||t){var n=!1;this.status!==f.WORKING&&e===f.WORKING&&(n=!0),this.status=e,n&&this.work()}},e.prototype.clearCheckTaskQueueTimer=function(){this.checkTaskQueueTimer&&clearTimeout(this.checkTaskQueueTimer),this.checkTaskQueueTimer=0},e.prototype.switchToIdle=function(){this.status!==f.PAUSE&&this.switchStatus(f.IDLE)},e}()},307499:function(e,t,n){var r=n(395979),o=n(962937),i=n(812439),a=n(954560),s=function(){function e(e){this._onVersionChange=new o.Q,this.onVersionChange=this._onVersionChange.event,this.currentVersion=e,i.Z.debug("VersionManager created, baseVersion=".concat(e))}return e.prototype.getCurrentVersion=function(){return this.currentVersion},e.prototype.updateVersion=function(e){i.Z.info("VersionManager updateVersion, currentVersion=".concat(this.currentVersion,", newVersion=").concat(e));var t=this.currentVersion;t>e?a.Z.report(r.Yo.UPDATE_VERSION_ERROR,{currentVersion:t,newVersion:e}):(this.currentVersion=e,this._onVersionChange.fire({newVersion:e,currentVersion:t}))},e.prototype.dispose=function(){i.Z.debug("VersionManager dispose"),this.currentVersion=0,this._onVersionChange.dispose()},e}();t.Z=s},634667:function(e,t,n){n.d(t,{CONNECTION_STATE_EVENT:function(){return i.CONNECTION_STATE_EVENT},CollabCenter:function(){return i.CollabCenter},LOCAL_USER_CHANGE_EVENT:function(){return i.LOCAL_USER_CHANGE_EVENT},LOG_TYPE:function(){return c.k},MessageCenter:function(){return a.p},PauseOrResumeType:function(){return s.Q},RECEIVE_MESSAGE_EVENT:function(){return i.RECEIVE_MESSAGE_EVENT},REPORT_EVENT:function(){return i.REPORT_EVENT},REPORT_MONITOR_TYPE:function(){return u.Yo},SEND_MESSAGE_EVENT:function(){return i.SEND_MESSAGE_EVENT},ServerUserChange:function(){return r.Z},VERSION_EVENT:function(){return i.VERSION_EVENT},getMissChange:function(){return l.Tn}}),n(307499),n(201044),n(280217),n(368206),n(313649);var r=n(883754),o=(n(326013),n(50209),n(106015),n(339322),n(944254),n(858074),n(666410));n.o(o,"CONNECTION_STATE_EVENT")&&n.d(t,{CONNECTION_STATE_EVENT:function(){return o.CONNECTION_STATE_EVENT}}),n.o(o,"CollabCenter")&&n.d(t,{CollabCenter:function(){return o.CollabCenter}}),n.o(o,"Command")&&n.d(t,{Command:function(){return o.Command}}),n.o(o,"DEFAULT_SEND_MESSAGE_TIMEOUT")&&n.d(t,{DEFAULT_SEND_MESSAGE_TIMEOUT:function(){return o.DEFAULT_SEND_MESSAGE_TIMEOUT}}),n.o(o,"LOCAL_USER_CHANGE_EVENT")&&n.d(t,{LOCAL_USER_CHANGE_EVENT:function(){return o.LOCAL_USER_CHANGE_EVENT}}),n.o(o,"MessagePriority")&&n.d(t,{MessagePriority:function(){return o.MessagePriority}}),n.o(o,"RECEIVE_MESSAGE_EVENT")&&n.d(t,{RECEIVE_MESSAGE_EVENT:function(){return o.RECEIVE_MESSAGE_EVENT}}),n.o(o,"REPORT_EVENT")&&n.d(t,{REPORT_EVENT:function(){return o.REPORT_EVENT}}),n.o(o,"RoomWebsocketErrorCode")&&n.d(t,{RoomWebsocketErrorCode:function(){return o.RoomWebsocketErrorCode}}),n.o(o,"SEND_MESSAGE_EVENT")&&n.d(t,{SEND_MESSAGE_EVENT:function(){return o.SEND_MESSAGE_EVENT}}),n.o(o,"VERSION_EVENT")&&n.d(t,{VERSION_EVENT:function(){return o.VERSION_EVENT}}),n.o(o,"generateMessageTaskId")&&n.d(t,{generateMessageTaskId:function(){return o.generateMessageTaskId}});var i=n(459014);n.o(i,"Command")&&n.d(t,{Command:function(){return i.Command}}),n.o(i,"DEFAULT_SEND_MESSAGE_TIMEOUT")&&n.d(t,{DEFAULT_SEND_MESSAGE_TIMEOUT:function(){return i.DEFAULT_SEND_MESSAGE_TIMEOUT}}),n.o(i,"MessagePriority")&&n.d(t,{MessagePriority:function(){return i.MessagePriority}}),n.o(i,"RoomWebsocketErrorCode")&&n.d(t,{RoomWebsocketErrorCode:function(){return i.RoomWebsocketErrorCode}}),n.o(i,"generateMessageTaskId")&&n.d(t,{generateMessageTaskId:function(){return i.generateMessageTaskId}});var a=n(41702),s=(n(683371),n(735156)),c=(n(100727),n(812439)),l=n(133779),u=(n(592624),n(395979));n(795901)},683371:function(e,t,n){n.d(t,{h:function(){return r}});var r={isCreator:!1,isEditable:!1,hotDocsInfo:{enable:!1,isHotDocs:!1,isQueryData:!1},fullMemberInfo:{enable:!1,isFullMember:!1},isSplitMissTask:!1,taskPriority:n(201044).lS.IMMEDIATELY}},41702:function(e,t,n){n.d(t,{p:function(){return K}});var r=n(839461),o=n(666410),i=n(812439),a=n(954560),s=n(962937),c=n(395979),l=n(106015),u=n(858074);function d(e){var t=e.result,n=0;return 0===t.errCode&&t.response||(n=p(e)),n}function p(e){var t,n,r,o,i=e.result,a=null===(n=null===(t=i.response)||void 0===t?void 0:t.onpost)||void 0===n?void 0:n.result,s=(null===(o=null===(r=i.response)||void 0===r?void 0:r.body)||void 0===o?void 0:o.data.reason)||i.errCode;return a||s}var f,h=[o.RoomErrorCode.TIMEOUT,o.RoomErrorCode.ROOM_DISCONNECT,o.RoomErrorCode.ROOM_STATE_ERR,o.RoomWebsocketErrorCode.SOCKET_SWITCH_BIG_COLLAB],m=[o.RoomWebsocketErrorCode.SOCKET_DATA_SAVE_FAIL,o.RoomWebsocketErrorCode.SOCKET_SHEET_COMMIT_MIDDLE_SERVER_ERROR,o.RoomWebsocketErrorCode.SOCKET_HACKPAD_TIMEOUT,o.RoomWebsocketErrorCode.SOCKET_SERVER_WAITTING_TOO_LONG,o.RoomWebsocketErrorCode.SOCKET_SERVER_WAITTING_TIMEOUT,o.DataEngineCodes.ERR_GetDataEngineLockErr],g=[o.RoomWebsocketErrorCode.SOCKET_CLIENT_NOT_READY_ERROR,o.RoomWebsocketErrorCode.SOCKET_COLLAB_ROOM_TIMEOUT,o.RoomWebsocketErrorCode.SOCKET_COLLAB_SERVER_TIMEOUT,o.RoomWebsocketErrorCode.SOCKET_SERVER_STORAGE_TIMEOUT,o.RoomWebsocketErrorCode.SOCKET_SERVER_CGI_TIMEOUT,o.RoomWebsocketErrorCode.SOCKET_FREQUENCY_LIMIT,o.RoomWebsocketErrorCode.SOCKET_AUTH_TIMEOUT,o.RoomWebsocketErrorCode.SOCKET_GET_PRIVILEGE_TIMEOUT];!function(e){e.INIT="INIT",e.NEED_RETRY="NEED_RETRY",e.RETRY_ING="RETRY_ING",e.BLOCK="BLOCK"}(f||(f={}));var v,_=3*o.DEFAULT_SEND_MESSAGE_TIMEOUT,y=function(){function e(e){this.retryCommitCount=0,this.retryPostCount=0,this.isPause=!1,this._onAcceptCommit=new s.Q,this.onAcceptCommit=this._onAcceptCommit.event,this._onCommitError=new s.Q,this.onCommitError=this._onCommitError.event,this._onRetryCommit=new s.Q,this.onRetryCommit=this._onRetryCommit.event,this.commitingStatus="INIT",this._onCommitBlock=new s.Q,this.onCommitBlock=this._onCommitBlock.event,this.onCommitFailEmitter=new s.Q,this.onCommitFail=this.onCommitFailEmitter.event,this._onSwitchConnectMode=new s.Q,this.onSwitchConnectMode=this._onSwitchConnectMode.event,this.lastRequestTime=0,this.dependency=e,this.loop(),i.Z.debug("SendMessageManager created")}return e.prototype.resetRetryCount=function(){this.retryCommitCount=0,this.retryPostCount=0},e.prototype.pause=function(){this.isPause=!0},e.prototype.resume=function(){this.isPause=!1,this.checkAndSend()},e.prototype.addUserChange=function(e){i.Z.debug("SendMessageManager addUserChange, userChanges taskId",e.map((function(e){return e.getTaskId()}))),this.dependency.localUserChangeManager.pushToWaitingQueue(e),this.checkAndSend()},e.prototype.sendMessage=function(e){this.isReadyToSendMessage()&&("USER_CHANGES"===e.cmd&&i.Z.info("SendMessageManager sendMessage,cmd: USER_CHANGES, taskId:".concat(e.taskId)),this.dependency.connectionController.sendMessage({cmd:e.cmd,taskId:e.taskId||(0,o.generateMessageTaskId)(),data:e.data,customParam:e.customParam,onsend:e.onsend,onsendAccept:e.onsendAccept,onError:e.onError}))},e.prototype.acceptCommit=function(e,t,n){var r;i.Z.info("SendMessageManager acceptCommit, newVersion=".concat(e,", taskId:").concat(t));var o=this.dependency.localUserChangeManager.findTask(t);if(this.dependency.localUserChangeManager.clearUserChangeByTaskIdInQueue(t,e),e>this.dependency.versionManager.getCurrentVersion()&&this.dependency.versionManager.updateVersion(e),o){this._onAcceptCommit.fire({newVersion:e,data:o.getOriginData()});var a=o.getOriginData();a.otherOptions||(a.otherOptions={}),a.otherOptions.result=n,null===(r=null==o?void 0:o.onSuccess)||void 0===r||r.call(o,e,a),this.lastRequestTime=0,this.checkAndSend()}},e.prototype.commitAfterUpdateVersionToLatest=function(e,t){var n=this;this.updateVersionToLatest({toVersion:e,index:t,onDestroy:function(){n.lastRequestTime=0,n.loop(0)}})},e.prototype.dispose=function(){i.Z.debug("SendMessageManager dispose"),this.commitingStatus="INIT",this.lastRequestTime=0,this.dependency=null,this._onAcceptCommit.dispose(),this._onCommitError.dispose(),this._onRetryCommit.dispose(),this.clearLoopTimer()},e.prototype.updateVersionToLatest=function(e){var t=e.toVersion,n=e.index,r=e.onDestroy,o=this.dependency.versionManager.getCurrentVersion();if(i.Z.debug("SendMessageManager updateVersionToLatest, currentVersion=".concat(o,", toVersion=").concat(t)),!(t&&o>=t)){var a=new u.Z({from:o+1,to:t},{missChangeDependency:this.missChangeDependency,versionManager:this.dependency.versionManager,acceptCommitDependency:this.dependency,onDestroy:r});this.dependency.taskQueueManager.pushTask(a,n)}},e.prototype.checkAndSend=function(){if(this.isReadyToSendMessage())return this.dependency.localUserChangeManager.isCommittingEmpty()&&!this.dependency.localUserChangeManager.isWaitingEmpty()?(this.dependency.localUserChangeManager.moveWaitingToCommiting(),void this.sendUserChange()):void(this.dependency.localUserChangeManager.isCommittingEmpty()||!this.checkNeedRetry()||this.retryCommit())},e.prototype.sendUserChange=function(){if(this.isReadyToSendMessage()){var e=this.dependency.localUserChangeManager.getCommitingQueue();if(0!==e.length&&1===e.length){var t=(0,r.__read)(e,1)[0];return this.sendMessage({cmd:"USER_CHANGES",taskId:t.getTaskId(),data:t.getPreparedData(),customParam:{timeout:o.DEFAULT_SEND_MESSAGE_TIMEOUT,maxRetryCount:3,waitAcceptCmd:["ACCEPT_COMMIT","COMMIT_ERROR","TASK_DUPLICATE"]},onsend:this.onSend.bind(this),onsendAccept:this.onSendAccept.bind(this),onError:this.handleError.bind(this)}),a.Z.report(c.Yo.SEND_USERCHANGE,{userChange:t.getOriginData(),isFirstCommit:"NEED_RETRY"!==this.commitingStatus}),void(this.lastRequestTime=(new Date).getTime())}}},e.prototype.checkNeedRetry=function(){return"NEED_RETRY"===this.commitingStatus||"BLOCK"!==this.commitingStatus&&(0===this.lastRequestTime?(this.lastRequestTime=Date.now(),!1):!this.isCommittingBlocked()&&this.isCommittingTimeout())},e.prototype.retryCommit=function(){var e;this.commitingStatus="RETRY_ING",this.sendUserChange();var t=this.dependency.localUserChangeManager.getCommitingQueue();this._onRetryCommit.fire(t.map((function(e){return e.getOriginData()}))),a.Z.report(c.Yo.RETRY_COMMIT,{commitingQueue:null===(e=this.dependency)||void 0===e?void 0:e.localUserChangeManager.getCommitingQueue().map((function(e){return e.getData()})),lastRequestTime:this.lastRequestTime,currentTime:(new Date).getTime()})},e.prototype.isCommittingTimeout=function(){return Date.now()-this.lastRequestTime>_&&(i.Z.info("SendMessageManager handleRetryCommit: timeout, need retry"),this.commitingStatus="NEED_RETRY",!0)},e.prototype.isCommittingBlocked=function(){var e,t;if(Date.now()-this.lastRequestTime>_&&"RETRY_ING"===this.commitingStatus){var n=this.dependency.localUserChangeManager.getCommitingQueue();return this._onCommitBlock.fire(n.map((function(e){return e.getOriginData()}))),i.Z.error("SendMessageManager handleRetryCommit: commit block， timeout multiple times"),a.Z.report(c.Yo.COMMITING_BLOCK_ERROR,{commitingQueue:null===(e=this.dependency)||void 0===e?void 0:e.localUserChangeManager.getCommitingQueue().map((function(e){return e.getOriginData()})),waitingQueue:null===(t=this.dependency)||void 0===t?void 0:t.localUserChangeManager.getWaitingQueue().map((function(e){return e.getOriginData()})),lastRequestTime:this.lastRequestTime,currentTime:(new Date).getTime()}),this.commitingStatus="BLOCK",!0}return!1},e.prototype.onSend=function(e,t,n,r){var o,s;i.Z.info("SendMessageManager onSend, taskId:".concat(e,", cmd:").concat(t)),this.handleError(e,t,n,r);var l=d({taskId:e,cmd:t,data:n,result:r});0!==l&&a.Z.report(c.Yo.COMMIT_REQUEST_FAIL,{errorCode:l,errorMessage:null===(s=null===(o=null==r?void 0:r.response)||void 0===o?void 0:o.onpost)||void 0===s?void 0:s.result})},e.prototype.handleError=function(e,t,n,r){var o=d({taskId:e,cmd:t,data:n,result:r});0!==o&&(i.Z.info("SendMessageManager handleError, errorCode=".concat(o,", taskId=").concat(e,", cmd=").concat(t,", result="),r),this.handleErrorCode(o,{cmd:t,result:r,type:"ON_ERROR"}))},e.prototype.onSendAccept=function(e,t,n,r,s){var l,u={taskId:e,cmd:t,data:n,waitCmd:r,result:s};if(i.Z.info("SendMessageManager onSendAccept, taskId=".concat(e,", cmd=").concat(t,", waitCmd=").concat(r)),r===o.MessageWaitAcceptCmd.ACCEPT_COMMIT)this.handleAcceptCommit(null===(l=u.result.response)||void 0===l?void 0:l.new_rev,e,s),a.Z.report(c.Yo.COMMIT_REQUEST_SUCCESS);else if(r===o.MessageWaitAcceptCmd.COMMIT_ERROR){var d=p(u);i.Z.error("SendMessageManager onSendAccept, commit error, code=".concat(d,", message:").concat(s.errMsg)),this.handleErrorCode(d,{cmd:t,result:s,type:"ON_SEND_ACCEPT"}),a.Z.report(c.Yo.COMMIT_REQUEST_FAIL,{errorCode:d,errorMessage:s.errMsg})}else r===o.MessageWaitAcceptCmd.TASK_DUPLICATE&&(i.Z.error("SendMessageManager onSendAccept: task duplicate"),a.Z.report(c.Yo.ACCEPT_TASK_DUPLICATE,u),this.handleDuplicateTask(u))},e.prototype.handleErrorCode=function(e,t){if(0!==e){i.Z.info("SendMessageManager handleErrorCode, errorCode:".concat(e));var n=t||{},r=n.cmd,a=n.result,s=n.type,c=void 0===s?"ON_ERROR":s;e===o.RoomWebsocketErrorCode.SOCKET_SWITCH_BIG_COLLAB&&this._onSwitchConnectMode.fire(o.ConnectMode.BIG_COLLAB);var l=this.dependency.localUserChangeManager.getCommitingQueue(),u=this.checkErrorCodeIfNeedRetry(e,a);if(u.needRetry)return this.commitingStatus="NEED_RETRY",this.loop(u.retryInterval);this._onCommitError.fire({errorCode:e,cmd:r,result:a,type:c,commitingQueue:l.map((function(e){return e.getOriginData()}))}),l.forEach((function(t){var n;null===(n=t.onFailed)||void 0===n||n.call(t,e,t.getOriginData())})),this.resetCommitingStatus(),this.resetRetryCount()}},e.prototype.handleAcceptCommit=function(e,t,n){i.Z.debug("SendMessageManager handleAcceptCommit, taskId:".concat(t,", newVersion:").concat(e));var r=new l.Z({to:e,acceptCommitDependency:this.dependency,versionManager:this.dependency.versionManager,taskId:t,missChangeDependency:this.missChangeDependency,otherOptions:n});this.dependency.taskQueueManager.pushTask(r),this.resetCommitingStatus(),this.resetRetryCount()},e.prototype.loop=function(e){var t=this;this.loopTimer&&clearTimeout(this.loopTimer),this.loopTimer=setTimeout((function(){t.checkAndSend(),t.loop()}),void 0!==e?e:1e3)},e.prototype.handleDuplicateTask=function(e){var t,n=e.result.response.body.data.lastRev,r=e.taskId,o=this.dependency.versionManager.getCurrentVersion();if(i.Z.info("SendMessageManager handleDuplicateTask, latestVersion=".concat(n,", currentVersion=").concat(o,", taskId=").concat(r)),this.resetCommitingStatus(),n<=o+1){if(!this.dependency.localUserChangeManager.findTask(r))return void i.Z.warn("SendMessageManager handleDuplicateTask, task has been handled");if(n===o+1){i.Z.warn("SendMessageManager handleDuplicateTask, task covert to accept commit");var s=new l.Z({to:n,acceptCommitDependency:this.dependency,versionManager:this.dependency.versionManager,taskId:r,missChangeDependency:this.missChangeDependency,otherOptions:e.result});return void this.dependency.taskQueueManager.pushTask(s)}null===(t=this.dependency)||void 0===t||t.shutDown(c.Yo.HANDLE_TASK_DUPLICATE_VERSION_ERROR),i.Z.error("SendMessageManager handleDuplicateTask, need to clean offline data"),a.Z.report(c.Yo.HANDLE_TASK_DUPLICATE_VERSION_ERROR,{latestVersion:n,currentVersion:o,packet:e})}else{var d=new u.Z({from:o+1,to:n},{missChangeDependency:this.missChangeDependency,versionManager:this.dependency.versionManager,acceptCommitDependency:this.dependency});this.dependency.taskQueueManager.pushTask(d,0)}},e.prototype.resetCommitingStatus=function(){this.commitingStatus="INIT"},e.prototype.isReadyToSendMessage=function(){var e=this.dependency.connectionController.isConnected();return this.updateConnectedStatus(e),e&&!this.isPause},e.prototype.updateConnectedStatus=function(e){e!==this.isConnected&&i.Z.info("SendMessageManager updateConnectedStatus, isConnected = ".concat(e)),this.isConnected=e},e.prototype.clearLoopTimer=function(){this.loopTimer&&(clearTimeout(this.loopTimer),this.loopTimer=void 0)},e.prototype.checkErrorCodeIfNeedRetry=function(e,t){var n,r,o,i,a,s,c,l=!1,u=0,d=null!==(c=null!==(i=null===(o=null===(r=null===(n=null==t?void 0:t.response)||void 0===n?void 0:n.body)||void 0===r?void 0:r.data)||void 0===o?void 0:o.retry_interval)&&void 0!==i?i:null===(s=null===(a=null==t?void 0:t.response)||void 0===a?void 0:a.onpost)||void 0===s?void 0:s.retry_interval)&&void 0!==c?c:5e3;return h.includes(e)?(l=!0,u=5e3):m.includes(e)&&this.retryCommitCount<3?(l=!0,u=d,this.retryCommitCount=this.retryCommitCount+1):g.includes(e)&&this.retryPostCount<3&&(l=!0,u=d,this.retryPostCount=this.retryPostCount+1),{needRetry:l,retryInterval:u}},Object.defineProperty(e.prototype,"missChangeDependency",{get:function(){var e,t,n;return{globalPadId:null===(t=(e=this.dependency).getGlobalVars)||void 0===t?void 0:t.call(e).serverVars.globalPadId,getMissChangesUrl:this.dependency.getMissChangesUrl,sendMissChangeRequest:this.dependency.sendMissChangeRequest,isDuplicateTaskId:null===(n=this.dependency)||void 0===n?void 0:n.localUserChangeManager.isDuplicateTaskId,isSplitMissTask:this.dependency.messageCenterOption.isSplitMissTask}},enumerable:!1,configurable:!0}),e}(),b=n(794601),E=n(339322),C=n(883754),w=n(944254),T=function(){function e(e){this._onReceiveOtherMessage=new s.Q,this.onReceiveOtherMessage=this._onReceiveOtherMessage.event,this._onReceiveMessage=new s.Q,this.onReceiveMessage=this._onReceiveMessage.event,this.dependency=e,i.Z.debug("ReceiveMessageManager created")}return e.prototype.handleReceiveMessageFromServer=function(e){if((null==e?void 0:e.type)&&(0,b.isArray)(e.data)){var t=e.type,n=e.data;if(t!==c.nn.CURSOR_MESSAGE&&i.Z.debug("ReceiveMessageManager handleReceiveMessageFromServer, type=".concat(t,", data="),n),this._onReceiveMessage.fire({type:t,data:n}),t===c.nn.NEW_CHANGES)this.handleNewChange(n);else if(t===c.nn.LAST_REVERSION){var o=(0,r.__read)(n,1)[0];this.handleLastRervesion(o)}else t===c.nn.BIG_CHANGES?this.handleBigChange(n):this._onReceiveOtherMessage.fire({type:t,data:n})}},e.prototype.handleNewChange=function(e){var t=this;i.Z.debug("ReceiveMessageManager handleNewChange"),e.forEach((function(e){var n=e.body,r=e.newRev,o=e.ts,i=n.data.commitId,s=new C.Z(Object.assign(Object.assign({userChangesOrigin:C.P.COLLAB_CHANGE,taskId:i,time:o},n.data),{newRev:r}));a.Z.report(c.Yo.HANDLE_NEW_CHANGES,e),t.handleServerUserChange(s)}))},e.prototype.handleServerUserChange=function(e){var t=new E.Z(e.getTaskId(),e,{missChangeDependency:this.missChangeDependency,versionManager:this.dependency.versionManager,acceptCommitDependency:this.dependency});return this.dependency.taskQueueManager.pushTask(t),t},e.prototype.handleLastRervesion=function(e){var t,n,r=this.dependency.versionManager.getCurrentVersion(),o=null===(n=null===(t=null==e?void 0:e.body)||void 0===t?void 0:t.notice)||void 0===n?void 0:n.lastRev;if(i.Z.info("ReceiveMessageManager handleLastRervesion, lastReversion: ".concat(o,", currentVersion: ").concat(r)),!(r>=o)){var a=new u.Z({from:r+1,to:o},{missChangeDependency:this.missChangeDependency,versionManager:this.dependency.versionManager,acceptCommitDependency:this.dependency});this.dependency.taskQueueManager.pushTask(a)}},e.prototype.applyServerUserChanges=function(e){var t,n,r=new C.Z(e);return this.dependency.localUserChangeManager.isDuplicateTaskId(r.getTaskId())?(this.dependency.acceptCommit(r.getVersion(),r.getTaskId()),null===(n=(t=this.dependency).cancelSendMessageByTaskId)||void 0===n||n.call(t,r.getTaskId()),!0):this.handleApplyServerUserChange(r)},e.prototype.dispose=function(){i.Z.debug("ReceiveMessageManager dispose"),this.dependency=null,this._onReceiveMessage.dispose(),this._onReceiveOtherMessage.dispose()},e.prototype.handleBigChange=function(e){var t=this;e.forEach((function(e){i.Z.info("ReceiveMessageManager handleBigChange, newVersion:".concat(e.newRev));var n=e.newRev,r=new w.Z({version:n,taskId:e.body.data.commitId,missChangeDependency:t.missChangeDependency,versionManager:t.dependency.versionManager,localUserChangeManager:t.dependency.localUserChangeManager,acceptCommitDependency:t.dependency});t.dependency.taskQueueManager.pushTask(r,0)}))},e.prototype.handleApplyServerUserChange=function(e){var t,n,r,o,s=this.dependency.versionManager.getCurrentVersion(),l=e.getVersion();if(l<=s)return i.Z.warn("ReceiveMessageManager handleApplyServerUserChange version error, currentVersion = ".concat(s,", newVersion = ").concat(l)),!1;try{o=this.handleFollow(e)}catch(t){return i.Z.error("ReceiveMessageManager handleApplyServerUserChange handleFollow error, error = ",null==t?void 0:t.stack,null==t?void 0:t.message),a.Z.report(c.Yo.HANDLE_FOLLOW_ERROR,e.getData()),!1}try{null===(n=(t=this.dependency.collabDependency).applyServerUserChanges)||void 0===n||n.call(t,o.getData());var u=e.getVersion();u>this.dependency.versionManager.getCurrentVersion()&&(this.dependency.versionManager.updateVersion(u),null===(r=this.dependency)||void 0===r||r.localUserChangeManager.notifyQueueChange())}catch(t){return i.Z.error("ReceiveMessageManager handleApplyServerUserChange onApplyServerUserChanges error, error = ",null==t?void 0:t.stack,null==t?void 0:t.message),a.Z.report(c.Yo.APPLY_SERVER_USER_CHANGE_ERROR,e.getData()),!1}return!0},e.prototype.handleFollow=function(e){var t,n,o,a,s,c,l;if(i.Z.debug("ReceiveMessageManager handleFollow"),!1===(null===(c=(s=this.dependency.collabDependency).checkIfNeedFollow)||void 0===c?void 0:c.call(s,e.getData())))return e;var u,d=this.dependency.localUserChangeManager.getCommitingQueue(),p=this.dependency.localUserChangeManager.getWaitingQueue(),f=(0,r.__spreadArray)((0,r.__spreadArray)([],(0,r.__read)(d),!1),(0,r.__read)(p),!1),h=e.getChangeset();u=e.getBase64Commands();var m=e.changesetType;try{for(var g=(0,r.__values)(f),v=g.next();!v.done;v=g.next()){var _,y=v.value,b=y.getChangeset(),E=y.getBase64Commands(),C=y.changesetType,w=void 0,T=void 0,A=void 0;(null===(l=this.dependency)||void 0===l?void 0:l.collabDependency.multiTypeFollow)?(w=(o=(_=this.handleMultiTypeFollow({changesetType:C,changeset:b,base64Commands:E},{changesetType:m,changeset:h,base64Commands:u})).localChangeString).changeset,T=o.base64Commands,A=o.changesetType,h=(a=_.serverChangeString).changeset,u=a.base64Commands,m=a.changesetType):(w=(_=this.handleSingleTypeFollow(b,h)).localChangeset,h=_.serverChangeset),y.setChangeset({changeset:w,base64Commands:T,changesetType:A}),y.updateBaseVersion(e.getVersion())}}catch(e){t={error:e}}finally{try{v&&!v.done&&(n=g.return)&&n.call(g)}finally{if(t)throw t.error}}return e.setChangeset({changeset:h,base64Commands:u,changesetType:m}),e},e.prototype.handleMultiTypeFollow=function(e,t){var n,r,o,i,a,s;return{localChangeString:null===(o=null===(n=this.dependency)||void 0===n?void 0:(r=n.collabDependency).multiTypeFollow)||void 0===o?void 0:o.call(r,t,e,!1),serverChangeString:null===(s=null===(i=this.dependency)||void 0===i?void 0:(a=i.collabDependency).multiTypeFollow)||void 0===s?void 0:s.call(a,e,t,!0)}},e.prototype.handleSingleTypeFollow=function(e,t){var n,r,o,i,a,s;return{localChangeset:null===(o=null===(n=this.dependency)||void 0===n?void 0:(r=n.collabDependency).follow)||void 0===o?void 0:o.call(r,t,e,!1),serverChangeset:null===(s=null===(i=this.dependency)||void 0===i?void 0:(a=i.collabDependency).follow)||void 0===s?void 0:s.call(a,e,t,!0)}},Object.defineProperty(e.prototype,"missChangeDependency",{get:function(){var e,t,n;return{globalPadId:null===(t=(e=this.dependency).getGlobalVars)||void 0===t?void 0:t.call(e).serverVars.globalPadId,getMissChangesUrl:this.dependency.getMissChangesUrl,sendMissChangeRequest:this.dependency.sendMissChangeRequest,isDuplicateTaskId:null===(n=this.dependency)||void 0===n?void 0:n.localUserChangeManager.isDuplicateTaskId,isSplitMissTask:this.dependency.messageCenterOption.isSplitMissTask}},enumerable:!1,configurable:!0}),e}(),A=n(326013),S=n(280217),I=n(313649),R=n(368206),M=function(){function e(){this._onRoomOpen=new s.Q,this.onRoomOpen=this._onRoomOpen.event,this._onConnectionStatusChange=new s.Q,this.onConnectionStatusChange=this._onConnectionStatusChange.event,this._onShutdown=new s.Q,this.onShutdown=this._onShutdown.event,this._onClosed=new s.Q,this.onClosed=this._onClosed.event,this._onEnterOnline=new s.Q,this.onEnterOnline=this._onEnterOnline.event,this._onEnterOffline=new s.Q,this.onEnterOffline=this._onEnterOffline.event,this._onNetReconnectedFail=new s.Q,this.onNetReconnectedFail=this._onNetReconnectedFail.event,this._onSwitchConnectMode=new s.Q,this.onSwitchConnectMode=this._onSwitchConnectMode.event,this._onQueueChange=new s.Q,this.onQueueChange=this._onQueueChange.event,this._onAcceptCommit=new s.Q,this.onAcceptCommit=this._onAcceptCommit.event,this._onCommitError=new s.Q,this.onCommitError=this._onCommitError.event,this._onRetryCommit=new s.Q,this.onRetryCommit=this._onRetryCommit.event,this._onCommitBlock=new s.Q,this.onCommitBlock=this._onCommitBlock.event,this.onCommitFailEmitter=new s.Q,this.onCommitFail=this.onCommitFailEmitter.event,this.onCommitSuccessEmitter=new s.Q,this.onCommitSuccess=this.onCommitSuccessEmitter.event,this._onReceiveOtherMessage=new s.Q,this.onReceiveOtherMessage=this._onReceiveOtherMessage.event,this._onReceiveMessage=new s.Q,this.onReceiveMessage=this._onReceiveMessage.event,this._onTaskError=new s.Q,this.onTaskError=this._onTaskError.event,this._onTaskDestroy=new s.Q,this.onTaskDestroy=this._onTaskDestroy.event,this._onTaskShutDown=new s.Q,this.onTaskShutDown=this._onTaskShutDown.event,this._onVersionChange=new s.Q,this.onVersionChange=this._onVersionChange.event,this.onLogEmitter=new s.Q,this.onLog=this.onLogEmitter.event,this._onTdw=new s.Q,this.onTdw=this._onTdw.event,this.onReportEmitter=new s.Q,this.onReport=this.onReportEmitter.event}return e.prototype.injectDependency=function(e){var t=e.networkStatusManager,n=e.localUserChangeManager,r=e.sendMessageManager,o=e.receiveMessageManager,i=e.taskQueueManager,a=e.versionManager;this.networkStatusManager=t,this.localUserChangeManager=n,this.sendMessageManager=r,this.receiveMessageManager=o,this.taskQueueManager=i,this.versionManager=a,this.initEventEmitter()},e.prototype.dispose=function(){this._onRoomOpen.dispose(),this._onConnectionStatusChange.dispose(),this._onShutdown.dispose(),this._onClosed.dispose(),this._onEnterOnline.dispose(),this._onEnterOffline.dispose(),this._onNetReconnectedFail.dispose(),this._onQueueChange.dispose(),this._onAcceptCommit.dispose(),this._onCommitError.dispose(),this._onReceiveMessage.dispose(),this._onReceiveOtherMessage.dispose(),this._onTaskError.dispose(),this._onTaskDestroy.dispose(),this._onTaskShutDown.dispose(),this._onVersionChange.dispose(),this.onLogEmitter.dispose(),this._onTdw.dispose(),this.onReportEmitter.dispose(),this._onRetryCommit.dispose(),this._onCommitBlock.dispose()},e.prototype.initEventEmitter=function(){var e=this;this.networkStatusManager.onRoomOpen((function(){for(var t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return(t=e._onRoomOpen).fire.apply(t,(0,r.__spreadArray)([],(0,r.__read)(n),!1))})),this.networkStatusManager.onConnectionStatusChange((function(){for(var t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return(t=e._onConnectionStatusChange).fire.apply(t,(0,r.__spreadArray)([],(0,r.__read)(n),!1))})),this.networkStatusManager.onShutdown((function(){for(var t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return(t=e._onShutdown).fire.apply(t,(0,r.__spreadArray)([],(0,r.__read)(n),!1))})),this.networkStatusManager.onClosed((function(){for(var t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return(t=e._onClosed).fire.apply(t,(0,r.__spreadArray)([],(0,r.__read)(n),!1))})),this.networkStatusManager.onEnterOnline((function(){for(var t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return(t=e._onEnterOnline).fire.apply(t,(0,r.__spreadArray)([],(0,r.__read)(n),!1))})),this.networkStatusManager.onEnterOffline((function(){for(var t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return(t=e._onEnterOffline).fire.apply(t,(0,r.__spreadArray)([],(0,r.__read)(n),!1))})),this.networkStatusManager.onNetReconnectedFail((function(){for(var t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return(t=e._onNetReconnectedFail).fire.apply(t,(0,r.__spreadArray)([],(0,r.__read)(n),!1))})),this.networkStatusManager.onSwitchConnectMode((function(){for(var t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return(t=e._onSwitchConnectMode).fire.apply(t,(0,r.__spreadArray)([],(0,r.__read)(n),!1))})),this.localUserChangeManager.onQueueChange((function(){for(var t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return(t=e._onQueueChange).fire.apply(t,(0,r.__spreadArray)([],(0,r.__read)(n),!1))})),this.sendMessageManager.onAcceptCommit((function(){for(var t,n,o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];(t=e._onAcceptCommit).fire.apply(t,(0,r.__spreadArray)([],(0,r.__read)(o),!1)),(n=e.onCommitSuccessEmitter).fire.apply(n,(0,r.__spreadArray)([],(0,r.__read)(o),!1))})),this.sendMessageManager.onCommitError((function(){for(var t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return(t=e._onCommitError).fire.apply(t,(0,r.__spreadArray)([],(0,r.__read)(n),!1))})),this.sendMessageManager.onCommitFail((function(){for(var t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return(t=e.onCommitFailEmitter).fire.apply(t,(0,r.__spreadArray)([],(0,r.__read)(n),!1))})),this.sendMessageManager.onRetryCommit((function(){for(var t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return(t=e._onRetryCommit).fire.apply(t,(0,r.__spreadArray)([],(0,r.__read)(n),!1))})),this.sendMessageManager.onCommitBlock((function(){for(var t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return(t=e._onCommitBlock).fire.apply(t,(0,r.__spreadArray)([],(0,r.__read)(n),!1))})),this.sendMessageManager.onSwitchConnectMode((function(){for(var t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return(t=e._onSwitchConnectMode).fire.apply(t,(0,r.__spreadArray)([],(0,r.__read)(n),!1))})),this.receiveMessageManager.onReceiveMessage((function(){for(var t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return(t=e._onReceiveMessage).fire.apply(t,(0,r.__spreadArray)([],(0,r.__read)(n),!1))})),this.receiveMessageManager.onReceiveOtherMessage((function(){for(var t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return(t=e._onReceiveOtherMessage).fire.apply(t,(0,r.__spreadArray)([],(0,r.__read)(n),!1))})),this.taskQueueManager.onTaskError((function(){for(var t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return(t=e._onTaskError).fire.apply(t,(0,r.__spreadArray)([],(0,r.__read)(n),!1))})),this.taskQueueManager.onTaskDestroy((function(){for(var t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return(t=e._onTaskDestroy).fire.apply(t,(0,r.__spreadArray)([],(0,r.__read)(n),!1))})),this.taskQueueManager.onTaskShutDown((function(){for(var t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return(t=e._onTaskShutDown).fire.apply(t,(0,r.__spreadArray)([],(0,r.__read)(n),!1))})),this.versionManager.onVersionChange((function(){for(var t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return(t=e._onVersionChange).fire.apply(t,(0,r.__spreadArray)([],(0,r.__read)(n),!1))})),i.Z.onLog((function(){for(var t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return(t=e.onLogEmitter).fire.apply(t,(0,r.__spreadArray)([],(0,r.__read)(n),!1))})),a.Z.onReport((function(){for(var t,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return(t=e.onReportEmitter).fire.apply(t,(0,r.__spreadArray)([],(0,r.__read)(n),!1))}))},e}(),O=M,N=n(683371),k=n(281213),L="可编辑的人数已达上限，当前仅可查看。",D=n(814808),P=10003,x="FullMemberErrorTips";!function(e){e[e.normal=1]="normal",e[e.inactive=2]="inactive"}(v||(v={}));var F=function(){function e(){}return e.hide=function(){var e;null===(e=this.snackbar)||void 0===e||e.close(),this.snackbar=null},e.showFullMemberTips=function(e,t){var n=this;t===v.inactive?this.snackbar=D.default.show({id:x,message:e,style:{zIndex:P},autoClose:!1,action:[{text:"开始编辑",onClick:this.onClickRefresh}]}):this.snackbar=D.default.show({message:e,id:x,style:{zIndex:P},autoClose:!1,closable:!0,onClose:function(){return n.snackbar=null}})},e.showServerErrorTips=function(e){var t=this;this.snackbar=D.default.show({message:e,type:"info",id:"ServerErrorTips",style:{zIndex:P},autoClose:!1,onClose:function(){return!0},action:[{text:"刷新",onClick:this.onClickRefresh},{text:"联系我们",onClick:function(){return t.onClickFeedback(),!1}}]})},e}();F.onClickRefresh=function(){window.location.reload()},F.onClickFeedback=function(){window.open("https://support.qq.com/products/28096?customInfo=".concat("N0009"),"_blank")};var B=n(972925),U=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};function H(e){return U(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){return[2,B.networkRequest.get(e)]}))}))}var W=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},j=function(){function e(e,t,n,r){void 0===r&&(r=15e3),this.getQueryDataUrl=e,this.onSuccess=t,this.onError=n,this.interval=r,this.timer=0}return e.prototype.start=function(){var e=this;clearInterval(this.timer),this.timer=setInterval((function(){return e.queryData()}),this.interval),i.Z.info("query data timer start")},e.prototype.stop=function(){clearInterval(this.timer),this.timer=0,i.Z.info("query data timer stop")},e.prototype.queryData=function(){var e,t,n;return W(this,void 0,void 0,(function(){var o,i;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,H(this.getQueryDataUrl())];case 1:return o=r.sent(),0!==(i=o.data).retcode?null===(e=this.onError)||void 0===e||e.call(this,i):null===(t=this.onSuccess)||void 0===t||t.call(this,i),[3,3];case 2:return r.sent(),null===(n=this.onError)||void 0===n||n.call(this),[3,3];case 3:return[2]}}))}))},e}(),G=function(){function e(e){var t=this;this.context=e,this.isFullMember=!1,this.onQueryDataSuccess=function(e){var n,r;if(!e.isOverConNum){var o=t.context.hotDocsManager,a=o.enableHotDocsMode&&o.isInitHotDocs;return t.existFullMemberMode(!a),a&&o.enterHotDocsMode(),void i.Z.info("full member query data success, exist full member mode, reason: isOverConNum = ".concat(e.isOverConNum,"."))}i.Z.info("full member query data success, notify update data to rev: ".concat(e.rev,".")),null===(r=(n=t.context.dependency).onReceiveQueryData)||void 0===r||r.call(n,e)},this.onQueryDataError=function(){var e;F.showServerErrorTips("服务器异常，请刷新重试。"),null===(e=t.queryDataTimer)||void 0===e||e.stop()},i.Z.info("init full member mode, enable: ".concat(this.enableFullMemberMode,"."),e.option);var n=e.option.fullMemberInfo;this.enableFullMemberMode&&(this.queryDataTimer=new j(e.dependency.getQueryDataUrl,this.onQueryDataSuccess,this.onQueryDataError),n.isFullMember&&this.enterFullMemberMode(L,v.normal))}return e.prototype.handleShutDown=function(e){var t,n,r;if(this.enableFullMemberMode){var o,a=null!==(r=null===(n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.closeReason)||void 0===n?void 0:n.errCode)&&void 0!==r?r:0,s=v.normal;k.RoomWebsocketErrorCode.SOCKET_COLLAB_ROOM_MEMBER_FULL===a||k.RoomWebsocketErrorCode.SOCKET_COLLABROOM_NOT_VIP_FULL===a?(s=v.normal,o=L):k.RoomWebsocketErrorCode.INACTIVE===a&&(s=v.inactive,o="编辑人数较多，转为只能查看。"),o&&(i.Z.info("handle room close, enter full member mode, errorCode: ".concat(a,".")),this.enterFullMemberMode(o,s))}},Object.defineProperty(e.prototype,"enableFullMemberMode",{get:function(){var e=this.context.option;return!!e.fullMemberInfo.enable&&!e.isCreator},enumerable:!1,configurable:!0}),e.prototype.enterFullMemberMode=function(e,t){var n,r=this.context,o=r.option,a=r.dependency;this.enableFullMemberMode&&(this.isFullMember||(this.isFullMember=!0,this.queryDataTimer.start(),o.isEditable&&(null===(n=a.onEditableChange)||void 0===n||n.call(a,!1),F.showFullMemberTips(e,t)),i.Z.info("enter full member mode, isEditable: ".concat(o.isEditable,"."))))},e.prototype.existFullMemberMode=function(e){var t,n,r;void 0===e&&(e=!0);var o=this.context,a=o.option,s=o.dependency;this.enableFullMemberMode&&this.isFullMember&&(F.hide(),this.isFullMember=!1,this.queryDataTimer.stop(),e&&(null===(n=(t=this.context.dependency).reconnect)||void 0===n||n.call(t)),a.isEditable&&(null===(r=s.onEditableChange)||void 0===r||r.call(s,!0)),i.Z.info("exist full member mode, isEditable: ".concat(a.isEditable,".")))},e}(),V=function(){function e(e){this.context=e,this.isHotDocs=!1,i.Z.info("init disable hot docs mode, enable: ".concat(this.enableHotDocsMode,"."),e.option);var t=e.option,n=t.hotDocsInfo,r=t.isInitFullMember;this.enableHotDocsMode&&(n.isQueryData&&(this.queryDataTimer=new j(e.dependency.getQueryDataUrl,this.onQueryDataSuccess.bind(this),this.onQueryDataError.bind(this))),this.isInitHotDocs&&!r&&this.enterHotDocsMode())}return e.prototype.handleOnRoomOpen=function(){this.enableHotDocsMode&&this.isHotDocs&&(this.existHotDocsMode(),i.Z.info("handle room open, exist hot docs mode."))},Object.defineProperty(e.prototype,"isInitHotDocs",{get:function(){return!!this.context.option.hotDocsInfo.isHotDocs},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enableHotDocsMode",{get:function(){var e=this.context.option;return!!e.hotDocsInfo.enable&&!e.isCreator},enumerable:!1,configurable:!0}),e.prototype.enterHotDocsMode=function(){var e;this.enableHotDocsMode&&(this.isHotDocs||(this.isHotDocs=!0,null===(e=this.queryDataTimer)||void 0===e||e.start(),i.Z.info("enter hot docs mode, isQueryData: ".concat(this.context.option.hotDocsInfo.isQueryData,"."))))},e.prototype.existHotDocsMode=function(){var e;this.enableHotDocsMode&&this.isHotDocs&&(this.isHotDocs=!1,null===(e=this.queryDataTimer)||void 0===e||e.stop(),F.hide(),i.Z.info("exist hot docs mode, isQueryData: ".concat(this.context.option.hotDocsInfo.isQueryData,".")))},e.prototype.onQueryDataSuccess=function(e){var t,n;i.Z.info("hot docs query data success, notify update data to rev: ".concat(e.rev,".")),null===(n=(t=this.context.dependency).onReceiveQueryData)||void 0===n||n.call(t,e)},e.prototype.onQueryDataError=function(){var e;F.showServerErrorTips("文档开小差了，刷新后更新最新内容。"),null===(e=this.queryDataTimer)||void 0===e||e.stop()},e}(),z=n(795901),Q=n(735156),Y=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Z=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},K=function(e){function t(t,n){void 0===n&&(n=N.h);var r=e.call(this,t,n)||this;return r.messageCenterOption=n,r.globalVars={},r.eventManager=new O,i.Z.info("MessageCenter created, baseVsersion = ".concat(t,", option="),n),r}return(0,r.__extends)(t,e),t.prototype.pause=function(e){var t,n=this;void 0===e&&(e=Q.Q.ALL);var r={SEND:function(){return n.sendMessageManager.pause()},RECEIVE:function(){return n.taskQueueManager.pause()},ALL:function(){n.sendMessageManager.pause(),n.taskQueueManager.pause()}};null===(t=r[e])||void 0===t||t.call(r)},t.prototype.resume=function(e){var t,n=this;void 0===e&&(e=Q.Q.ALL);var r={SEND:function(){return n.sendMessageManager.resume()},RECEIVE:function(){return n.taskQueueManager.resume()},ALL:function(){n.sendMessageManager.resume(),n.taskQueueManager.resume()}};null===(t=r[e])||void 0===t||t.call(r)},t.prototype.forceResume=function(e){var t,n=this;void 0===e&&(e=Q.Q.ALL);var r={SEND:function(){return n.sendMessageManager.resume()},RECEIVE:function(){return n.taskQueueManager.resume()},ALL:function(){n.sendMessageManager.resume(),n.taskQueueManager.forceResume()}};null===(t=r[e])||void 0===t||t.call(r)},t.prototype.setGlobalVars=function(e){i.Z.info("MessageCenter setGlobalVars, options = ".concat(e)),this.globalVars=Object.assign({},e)},t.prototype.setOptionalFunction=function(e){this.initDenpendency(e)},t.prototype.start=function(){var e=this;i.Z.info("MessageCenter start"),void 0===this.dependency&&this.initDenpendency(),this.localUserChangeManager=new I.Z,this.versionManager.onVersionChange((function(t){var n,r=t.newVersion;e.localUserChangeManager.updateVersion(r),null===(n=e.connectionController)||void 0===n||n.setVersion(r)})),this.taskQueueManager.onTaskError((function(t){var n=t.error;e.onTaskError(n)})),this.networkStatusManager=new S.Z,this.receiveMessageManager=new T({collabDependency:this.dependency.collabDependency,versionManager:this.versionManager,taskQueueManager:this.taskQueueManager,localUserChangeManager:this.localUserChangeManager,acceptCommit:this.acceptCommit.bind(this),cancelSendMessageByTaskId:this.cancelSendMessageByTaskId.bind(this),applyServerUserChanges:this.applyServerUserChanges.bind(this),composeNewChanges:this.composeNewChanges.bind(this),getGlobalVars:this.getGlobalVars.bind(this),getMissChangesUrl:this.dependency.baseConfigDependency.getMissChangesUrl,sendMissChangeRequest:this.dependency.baseConfigDependency.sendMissChangeRequest,messageCenterOption:this.messageCenterOption}),this.initConnectionController(),this.sendMessageManager=new y({collabDependency:this.dependency.collabDependency,versionManager:this.versionManager,taskQueueManager:this.taskQueueManager,localUserChangeManager:this.localUserChangeManager,connectionController:this.connectionController,acceptCommit:this.acceptCommit.bind(this),applyServerUserChanges:this.applyServerUserChanges.bind(this),composeNewChanges:this.composeNewChanges.bind(this),getGlobalVars:this.getGlobalVars.bind(this),getMissChangesUrl:this.dependency.baseConfigDependency.getMissChangesUrl,sendMissChangeRequest:this.dependency.baseConfigDependency.sendMissChangeRequest,shutDown:this.shutDown.bind(this),messageCenterOption:this.messageCenterOption}),this.eventManager.injectDependency({networkStatusManager:this.networkStatusManager,localUserChangeManager:this.localUserChangeManager,sendMessageManager:this.sendMessageManager,receiveMessageManager:this.receiveMessageManager,versionManager:this.versionManager,taskQueueManager:this.taskQueueManager});var t=this.messageCenterOption.fullMemberInfo;this.hotDocsManager=new V({option:Object.assign(Object.assign({},this.messageCenterOption),{isInitFullMember:!!t.enable&&!!t.isFullMember}),dependency:Object.assign({setVersion:function(t){return e.versionManager.updateVersion(t)}},this.dependency.queryDataDependency)}),this.fullMemberManager=new G({option:this.messageCenterOption,hotDocsManager:this.hotDocsManager,dependency:Object.assign({reconnect:function(){var t;return null===(t=e.connectionController)||void 0===t?void 0:t.reconnect()},setVersion:function(t){return e.versionManager.updateVersion(t)}},this.dependency.queryDataDependency)}),this.networkStatusManager.onSwitchConnectMode((function(t){var n;null===(n=e.connectionController)||void 0===n||n.reconnect(void 0,t)})),this.sendMessageManager.onSwitchConnectMode((function(t){var n;null===(n=e.connectionController)||void 0===n||n.reconnect(void 0,t)}))},t.prototype.addUserChange=function(e){var t,n,r,o=this.hotDocsManager.enableHotDocsMode&&this.hotDocsManager.isHotDocs;o&&!(null===(t=this.connectionController)||void 0===t?void 0:t.isConnected())&&(i.Z.warn("start connect when isHotDocs: ".concat(o)),null===(n=this.connectionController)||void 0===n||n.connect()),r=Array.isArray(e)?e.map((function(e){return new A.Z(e)})):[new A.Z(e)],this.sendMessageManager.addUserChange(r)},t.prototype.openRoom=function(e){var t,n=this.hotDocsManager.enableHotDocsMode&&this.hotDocsManager.isHotDocs,r=this.fullMemberManager.enableFullMemberMode&&this.fullMemberManager.isFullMember;n||r?i.Z.warn("skip open room, isFullMember: ".concat(r,", isHotDocs: ").concat(n)):null===(t=this.connectionController)||void 0===t||t.connect(e)},t.prototype.sendMessage=function(e){this.sendMessageManager.sendMessage(e)},t.prototype.shutDown=function(e,t,n){var r;void 0===e&&(e=""),i.Z.info("MessageCenter shutDown, info=".concat(e,", errCode=").concat(t,", description=").concat(n)),this.taskQueueManager.shutDown(),null===(r=this.connectionController)||void 0===r||r.disconnect({errCode:t,reason:JSON.stringify({info:e,description:n,errCode:t}),shutDown:!0}),this.sendMessageManager.resetRetryCount()},t.prototype.getIsOnline=function(){var e;return null===(e=this.connectionController)||void 0===e?void 0:e.isOnline()},t.prototype.clearAllUserChangeQueue=function(){this.localUserChangeManager.clearAllUserChangeQueue()},t.prototype.isConnected=function(){var e,t;return null!==(t=null===(e=this.connectionController)||void 0===e?void 0:e.isConnected())&&void 0!==t&&t},t.prototype.startGetMissChanges=function(e,t){var n=this.globalVars.serverVars.globalPadId,r=this.dependency.baseConfigDependency.getMissChangesUrl,o=this.messageCenterOption.isSplitMissTask,i=new u.Z({from:e,to:t},{missChangeDependency:{globalPadId:n,getMissChangesUrl:r,isSplitMissTask:o,isDuplicateTaskId:this.localUserChangeManager.isDuplicateTaskId},versionManager:this.versionManager,acceptCommitDependency:this.acceptCommitDependency});this.taskQueueManager.pushTask(i)},t.prototype.dispose=function(){var t;e.prototype.dispose.call(this),i.Z.debug("MessageCenter dispose"),this.taskQueueManager.dispose(),this.localUserChangeManager.dispose(),this.sendMessageManager.dispose(),this.receiveMessageManager.dispose(),this.versionManager.dispose(),null===(t=this.connectionController)||void 0===t||t.dispose(),this.networkStatusManager.dispose(),this.eventManager.dispose(),i.Z.dispose()},t.prototype.reconnect=function(e){var t;null===(t=this.connectionController)||void 0===t||t.reconnect(e)},t.prototype.reConnect=function(e){this.reconnect(e)},Object.defineProperty(t.prototype,"connectionController",{get:function(){return this.connectionControllerInstance},enumerable:!1,configurable:!0}),t.prototype.getLocalUserChanges=function(){return this.localUserChangeManager.getLocalUserChanges()},Object.defineProperty(t.prototype,"acceptCommitDependency",{get:function(){return{getMissChangesUrl:this.dependency.baseConfigDependency.getMissChangesUrl,acceptCommit:this.acceptCommit.bind(this),applyServerUserChanges:this.applyServerUserChanges.bind(this),composeNewChanges:this.composeNewChanges.bind(this),getGlobalVars:this.getGlobalVars.bind(this)}},enumerable:!1,configurable:!0}),t.prototype.initDenpendency=function(e){void 0===e&&(e={}),i.Z.debug("MessageCenter initDenpendency"),this.dependency||(this.dependency={});var t=e.follow,n=e.multiTypeFollow,r=e.applyServerUserChanges,o=e.composeNewChanges,a=e.getMissChangesUrl,s=e.sendMissChangeRequest,c=e.checkIfNeedFollow,l=Z(e,["follow","multiTypeFollow","applyServerUserChanges","composeNewChanges","getMissChangesUrl","sendMissChangeRequest","checkIfNeedFollow"]);this.setSendMissChangeRequest(s),this.setGetMissChangesUrl(a),this.setApplyServerUserChanges(r),this.setComposeNewChanges(o),this.setFollow(t),this.setMultiTypeFollow(n),this.setCheckIfNeedFollow(c),this.setFullMemberDependency(l)},t.prototype.getGlobalVars=function(){return this.globalVars},t.prototype.setFullMemberDependency=function(e){this.dependency.queryDataDependency||(this.dependency.queryDataDependency={onEditableChange:function(){},getQueryDataUrl:function(){return""},onReceiveQueryData:function(){return!1}}),this.dependency.queryDataDependency=Object.assign({},e)},t.prototype.setCheckIfNeedFollow=function(e){this.dependency.collabDependency||(this.dependency.collabDependency={}),this.dependency.collabDependency.checkIfNeedFollow=e||function(){return!0}},t.prototype.setGetMissChangesUrl=function(e){var t=this;this.dependency.baseConfigDependency||(this.dependency.baseConfigDependency={}),this.dependency.baseConfigDependency.getMissChangesUrl=e||function(){return Y(t,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){return[2,""]}))}))}},t.prototype.setSendMissChangeRequest=function(e){this.dependency.baseConfigDependency||(this.dependency.baseConfigDependency={}),this.dependency.baseConfigDependency.sendMissChangeRequest=e},t.prototype.setMultiTypeFollow=function(e){this.dependency.collabDependency||(this.dependency.collabDependency={}),this.dependency.collabDependency.multiTypeFollow=e},t.prototype.setFollow=function(e){this.dependency.collabDependency||(this.dependency.collabDependency={}),this.dependency.collabDependency.follow=e||function(e,t){return t}},t.prototype.setApplyServerUserChanges=function(e){this.dependency.collabDependency||(this.dependency.collabDependency={}),this.dependency.collabDependency.applyServerUserChanges=e||function(){}},t.prototype.setComposeNewChanges=function(e){this.dependency.collabDependency||(this.dependency.collabDependency={}),this.dependency.collabDependency.composeNewChanges=e},t.prototype.onTaskError=function(e){i.Z.debug("MessageCenter onTaskError"),this.shutDown("TASK_ERROR",z.K.TASK_ERROR,null==e?void 0:e.message)},t.prototype.initConnectionController=function(){var e=this;(0,o.initLogAndManager)({debug:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];i.Z.debug.apply(i.Z,(0,r.__spreadArray)([],(0,r.__read)(e),!1))},info:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];i.Z.info.apply(i.Z,(0,r.__spreadArray)([],(0,r.__read)(e),!1))},warn:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];i.Z.warn.apply(i.Z,(0,r.__spreadArray)([],(0,r.__read)(e),!1))},error:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];i.Z.error.apply(i.Z,(0,r.__spreadArray)([],(0,r.__read)(e),!1))}}),this.connectionControllerInstance=new o.ConnectionController(this.getGlobalVars()),this.connectionController.setVersion(this.versionManager.getCurrentVersion()),this.connectionController.onConnectionEvent((function(t){var n,r,o,i=null!==(r=null===(n=t.data)||void 0===n?void 0:n.closeReason)&&void 0!==r?r:{shutDown:!0},a=new Map([["".concat("OnRoomStateChange"),function(){var n,r,o,i,a,s;return e.networkStatusManager.handleOnRoomStateChange(null!==(o=null===(r=null===(n=t.data)||void 0===n?void 0:n.roomState)||void 0===r?void 0:r.roomState)&&void 0!==o?o:"",null!==(s=null===(a=null===(i=t.data)||void 0===i?void 0:i.roomState)||void 0===a?void 0:a.description)&&void 0!==s?s:"")}],["".concat("OnRoomOpen"),function(){e.networkStatusManager.handleOnRoomOpen(),e.hotDocsManager.handleOnRoomOpen()}],["".concat("OnRoomClose"),function(){e.networkStatusManager.handleOnRoomClose(i)}],["".concat("OnRoomShutDown"),function(){e.networkStatusManager.handleOnRoomShutDown(i),e.fullMemberManager.handleShutDown(t)}],["".concat("OnReceiveMsgFromServer"),function(){var n;return e.receiveMessageManager.handleReceiveMessageFromServer(null===(n=t.data)||void 0===n?void 0:n.serverMsg)}],["".concat("OnNetReconnectedFail"),function(){return e.networkStatusManager.handleNetReconnectedFail()}],["".concat("OnEnterOnline"),function(){return e.networkStatusManager.handleOnEnterOnline()}],["".concat("OnEnterOffline"),function(){return e.networkStatusManager.handleOnEnterOffline()}]]);null===(o=a.get(t.event))||void 0===o||o()})),i.Z.info("MessageCenter new ConnectionController() done")},t.prototype.acceptCommit=function(e,t,n){this.sendMessageManager.acceptCommit(e,t,n)},t.prototype.cancelSendMessageByTaskId=function(e){var t;null===(t=this.connectionController)||void 0===t||t.cancelSendMessageByTaskId(e)},t.prototype.applyServerUserChanges=function(e){return this.receiveMessageManager.applyServerUserChanges(e)},t.prototype.composeNewChanges=function(e){var t,n;return null===(n=(t=this.dependency.collabDependency).composeNewChanges)||void 0===n?void 0:n.call(t,e)},t}(R.Z)},974586:function(e,t,n){var r=n(244850),o=function(){function e(e){var t=e.subId,n=e.changesetType,o=e.taskId,i=e.time,a=e.changeset,s=e.commands,c=e.base64Commands;this.subId=t,this.taskId=o||(0,r.generateMessageTaskId)(),this.time=i||(new Date).getTime(),this.changeset=a,this.commands=s,this.base64Commands=c,n&&(this.changesetType=n)}return e.prototype.getTaskId=function(){return this.taskId},e.prototype.getTime=function(){return this.time},e.prototype.getChangeset=function(){return this.changeset||this.commands||""},e.prototype.getBase64Commands=function(){return this.base64Commands||""},e.prototype.setChangeset=function(e){e.base64Commands&&(this.base64Commands=e.base64Commands),this.commands?this.commands=e.changeset:this.changeset=e.changeset,e.changesetType&&(this.changesetType=e.changesetType)},e}();t.Z=o},326013:function(e,t,n){var r=n(839461),o=function(e){function t(t){var n=e.call(this,t)||this;n.head=!1,n.offlineMsg=!1;var r=t.changeSetCount,o=t.apool,i=t.keydata,a=t.oSubId,s=t.head,c=t.isWorkbook,l=t.offlineMsg,u=t.baseRev,d=t.firstCommitRev,p=t.applied,f=t.otherOptions,h=t.wordCount,m=t.onFailed,g=t.onSuccess;return n.baseRev=u,n.offlineMsg=l||!1,n.apool=o||"",n.head=s||!1,n.keydata=i,n.oSubId=a||void 0,n.isWorkbook=c,n.firstCommitRev=d,n.changeSetCount=r||1,n.applied=p,n.wordCount=h,n.otherOptions=f,n.onFailed=m,n.onSuccess=g,n}return(0,r.__extends)(t,e),t.prototype.getBaseVersion=function(){return this.baseRev},t.prototype.getOtherOptions=function(){return this.otherOptions},t.prototype.getPreparedData=function(){return this.prepareCommitMessage()},t.prototype.getData=function(){var e=this,t=e.baseRev,n=e.changeset,r=e.changeSetCount,o=e.subId,i=e.changesetType,a=e.apool,s=e.keydata,c=e.oSubId,l=e.taskId;return{baseRev:t,changeset:n,changeSetCount:r,changesetType:i,apool:a,keydata:s,subId:o,oSubId:c,head:e.head,taskId:l,firstCommitRev:e.firstCommitRev,applied:e.applied,isWorkbook:e.isWorkbook,offlineMsg:e.offlineMsg,wordCount:e.wordCount,commands:e.commands,base64Commands:e.base64Commands}},t.prototype.getOriginData=function(){var e=this;return{baseRev:e.baseRev,changeset:e.changeset,changeSetCount:e.changeSetCount,subId:e.subId,changesetType:e.changesetType,apool:e.apool,keydata:e.keydata,oSubId:e.oSubId,taskId:e.taskId,head:e.head,time:e.time,firstCommitRev:e.firstCommitRev,applied:e.applied,isWorkbook:e.isWorkbook,offlineMsg:e.offlineMsg,otherOptions:e.otherOptions,wordCount:e.wordCount,commands:e.commands,base64Commands:e.base64Commands}},t.prototype.updateBaseVersion=function(e){e>this.baseRev&&(this.baseRev=e)},t.prototype.prepareCommitMessage=function(){var e={commands:this.commands,base64Commands:this.base64Commands,wordCount:this.wordCount,baseRev:this.baseRev,changeSetCount:this.changeSetCount,changeset:this.changeset,apool:this.apool,keydata:this.keydata||!1,head:this.head,subId:this.subId,oSubId:this.oSubId||!1,taskId:this.taskId,firstCommitRev:this.firstCommitRev,offlineMsg:this.offlineMsg,applied:this.applied,isWorkbook:this.isWorkbook};return this.changesetType&&(e.changesetType=this.changesetType),e},t}(n(974586).Z);t.Z=o},883754:function(e,t,n){n.d(t,{P:function(){return r}});var r,o=n(839461),i=n(974586);!function(e){e.COLLAB_CHANGE="COLLAB_CHANGE",e.MISS_CHANG="MISS_CHANG",e.BIG_CHANG="BIG_CHANG"}(r||(r={}));var a=function(e){function t(t){var n=e.call(this,t)||this,r=t.apool,o=t.author,i=t.head,a=t.need,s=t.revert,c=t.type,l=t.uuId,u=t.uuid,d=t.subId,p=t.subid,f=t.newRev,h=t.isWorkbook,m=t.userChangesOrigin;return n.apool=r,n.author=o,n.head=i,n.need=a,n.revert=s,n.type=c,n.subId=null!=d?d:p,n.uuId=null!=l?l:u,n.newRev=f,n.isWorkbook=h,n.userChangesOrigin=m,n}return(0,o.__extends)(t,e),t.prototype.getVersion=function(){return this.newRev},t.prototype.getData=function(){var e=this,t=e.newRev,n=e.subId,r=e.taskId,o=e.type,i=e.uuId,a=e.changesetType,s=e.apool,c=e.author,l=e.head,u=e.need,d=e.revert,p=e.isWorkbook,f=e.userChangesOrigin;return{changeset:this.getChangeset(),base64Commands:this.base64Commands,newRev:t,new_rev:t,subId:n,changesetType:a,commitId:r,apool:s,author:c,head:l,need:u,revert:d,isWorkbook:p,taskId:r,type:o,uuId:i,userChangesOrigin:f}},t}(i.Z);t.Z=a},106015:function(e,t,n){var r=n(839461),o=n(50209),i=n(858074),a=n(812439),s=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},c=function(e){function t(t){var n=e.call(this,t.taskId)||this;n.type=o.U.ACCEPT_TASK;var r=t.to,i=t.missChangeDependency,a=t.versionManager,s=t.acceptCommitDependency,c=t.otherOptions;return n.to=r,n.missChangeDependency=i,n.versionManager=a,n.acceptCommitDependency=s,n.otherOptions=c,n}return(0,r.__extends)(t,e),t.prototype.reset=function(){this.destory(!1);var e=this,n=e.versionManager;return new t({to:e.to,missChangeDependency:e.missChangeDependency,versionManager:n,acceptCommitDependency:e.acceptCommitDependency,taskId:e.taskId,otherOptions:e.otherOptions})},t.prototype.onInit=function(){return s(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){return this.to<=this.versionManager.getCurrentVersion()?[2,!1]:[2,!0]}))}))},t.prototype.onStart=function(){var e=this,t=e.to,n=e.acceptCommitDependency,r=e.taskId,o=e.otherOptions,i=this.handleMissChange();if(i)return i;n.acceptCommit(t,r,o)},t.prototype.handleMissChange=function(){var e=this.to,t=this.versionManager.getCurrentVersion();if(this.to>t+1)return a.Z.info("AcceptTask handleMissChange: need to fetch miss changes. currentVersion = ".concat(t,", to = ").concat(this.to)),this.generateMissChangeTask(t+1,e-1)},t.prototype.generateMissChangeTask=function(e,n){var r=this,o=r.versionManager,a=r.missChangeDependency,s=r.to,c=r.acceptCommitDependency,l=new t({to:s,missChangeDependency:a,versionManager:o,acceptCommitDependency:c,taskId:r.taskId,otherOptions:r.otherOptions});return[new i.Z({from:e,to:n},{missChangeDependency:a,versionManager:o,acceptCommitDependency:c}),l]},t}(o.Z);t.Z=c},50209:function(e,t,n){n.d(t,{U:function(){return r}});var r,o,i=n(839461),a=n(812439),s=n(949595),c=n(227218),l=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};!function(e){e.ACCEPT_TASK="ACCEPT_TASK",e.COLLAB_TASK="COLLAB_TASK",e.MISS_CHANGE_TASK="MISS_CHANGE_TASK",e.BIG_CHANGE_TASK="BIG_CHANGE_TASK"}(r||(r={})),function(e){e.INIT="INIT",e.START="START",e.DESTORY="DESTORY"}(o||(o={}));var u=function(){function e(e){this.status=new s.X(o.INIT),this.onDestroy=function(){},this.taskId=e||this.getRandomId()}return Object.defineProperty(e.prototype,"currentStatus",{get:function(){return this.status.getValue()},set:function(e){a.Z.info("Task: ".concat(this.getDebuggerInfo(),", prev: ").concat(this.currentStatus,", current: ").concat(e)),this.status.next(e)},enumerable:!1,configurable:!0}),e.prototype.isDestroyed=function(){return this.currentStatus===o.DESTORY},e.prototype.destory=function(e,t){this.isSuccess=e,this.currentStatus=o.DESTORY,this.onDestroy(e,t)},e.prototype.run=function(){return l(this,void 0,void 0,(function(){var e,t=this;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return a.Z.info("task run: ".concat(this.getDebuggerInfo())),[4,this.init()];case 1:return n.sent()?(e=this.start())?(a.Z.info("split to new task"),(0,c.A)(e).then((function(){t.destory(!0)})).catch((function(){t.destory(!1)})),[2,e]):(this.destory(!0),[2]):(this.destory(!1),[2])}}))}))},e.prototype.break=function(e){this.destory(!1,e)},e.prototype.getCurrentStatus=function(){return this.currentStatus},e.prototype.onInit=function(){return l(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){return[2,!0]}))}))},e.prototype.onStart=function(){},e.prototype.init=function(){return l(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return this.currentStatus===o.DESTORY?[2]:(this.currentStatus=o.INIT,[4,this.onInit()]);case 1:return[2,e.sent()]}}))}))},e.prototype.start=function(){if(this.currentStatus!==o.DESTORY)return this.currentStatus=o.START,this.onStart()},e.prototype.getRandomId=function(){return Number(Date.now().toString()+(100*Math.random()).toFixed(0))},e.prototype.getDebuggerInfo=function(){var e=this,t=e.taskId,n=e.type,r=e.currentStatus;return JSON.stringify({taskId:t,type:n,currentStatus:r})},e.prototype.taskIdentify=function(){return String(this.taskId)},e}();t.Z=u},944254:function(e,t,n){var r=n(839461),o=n(50209),i=n(133779),a=n(883754),s=n(395979),c=n(339322),l=n(106015),u=n(812439),d=n(954560),p=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},f=function(e){function t(t){var n=e.call(this,t.taskId)||this;n.type=o.U.BIG_CHANGE_TASK;var r=t.version,i=t.missChangeDependency,a=t.versionManager,s=t.localUserChangeManager,c=t.acceptCommitDependency,l=t.otherOptions;return n.version=r,n.missChangeDependency=i,n.versionManager=a,n.localUserChangeManager=s,n.acceptCommitDependency=c,n.otherOptions=l,u.Z.info("new BigChangeTask: version = ".concat(r)),n}return(0,r.__extends)(t,e),t.prototype.reset=function(){this.destory(!1);var e=this,n=e.version,r=e.taskId,o=e.missChangeDependency,i=e.acceptCommitDependency,a=e.versionManager;return new t({version:n,taskId:r,missChangeDependency:o,localUserChangeManager:e.localUserChangeManager,versionManager:a,acceptCommitDependency:i,otherOptions:e.otherOptions})},t.prototype.onInit=function(){return p(this,void 0,void 0,(function(){var e,t,n,o,i;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:if(t=(e=this).version,n=e.taskId,t<=this.versionManager.getCurrentVersion())return[2,!1];if(this.isTaskDuplicate(n))return[2,!0];r.label=1;case 1:return r.trys.push([1,3,,4]),o=this,[4,this.fetchBigChangeFromServer(this.version)];case 2:return o.userChange=r.sent(),[3,4];case 3:return i=r.sent(),u.Z.error("BigChangeTask onInit error, error=",null==i?void 0:i.stack,null==i?void 0:i.message),[2,!1];case 4:return[2,!0]}}))}))},t.prototype.onStart=function(){u.Z.info("BigChangeTask onStart, taskId:".concat(this.taskId,", version:").concat(this.version));var e=this,t=e.taskId,n=e.version,r=e.missChangeDependency,o=e.userChange,i=e.versionManager,s=e.acceptCommitDependency;if(this.isTaskDuplicate(t))return[new l.Z({to:n,taskId:t,missChangeDependency:r,versionManager:i,acceptCommitDependency:s})];var d=o.commitId,p=new a.Z(Object.assign({userChangesOrigin:a.P.BIG_CHANG,taskId:d},o));return[new c.Z(p.getTaskId(),p,{missChangeDependency:r,versionManager:i,acceptCommitDependency:s})]},t.prototype.isTaskDuplicate=function(e){return this.localUserChangeManager.isDuplicateTaskId(e)},t.prototype.fetchBigChangeFromServer=function(e){return p(this,void 0,void 0,(function(){var t,n,o,a;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return[4,(0,i.Tn)({from:e,to:e,globalPadId:this.missChangeDependency.globalPadId},this.missChangeDependency.getMissChangesUrl).catch((function(t){return u.Z.error("BigChangeTask getBigChange error, error=",t),d.Z.report(s.Yo.GET_BIG_CHANGE_ERROR,{version:e}),Promise.reject(t)}))];case 1:if(t=r.sent(),n=t.filter((function(t){return t.data.newRev===e})).map((function(e){return e.data})),o=n[0].newRev,a=this.versionManager.getCurrentVersion(),1!==n.length||o!==a+1)throw u.Z.error("BigChangeTask getBigChange error, version not consequent, newRev = ".concat(o,", preNewVersion = ").concat(a)),d.Z.report(s.Yo.BIG_CHANGE_VERSION_ERROR,{version:e,changeList:t}),new Error("MissChangeTask version error");return[2,n[0]]}}))}))},t}(o.Z);t.Z=f},339322:function(e,t,n){var r=n(839461),o=n(50209),i=n(858074),a=n(812439),s=n(954560),c=n(395979),l=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},u=function(e){function t(t,n,r){var i=e.call(this,t)||this;i.type=o.U.COLLAB_TASK;var a=r.missChangeDependency,s=r.versionManager,c=r.acceptCommitDependency,l=r.otherOptions;return i.missChangeDependency=a,i.versionManager=s,i.newChange=n,i.acceptCommitDependency=c,i.otherOptions=l,i}return(0,r.__extends)(t,e),t.prototype.reset=function(){this.destory(!1);var e=this,n=e.taskId,r=e.missChangeDependency;return new t(n,e.newChange,{missChangeDependency:r,versionManager:e.versionManager,acceptCommitDependency:e.acceptCommitDependency,otherOptions:e.otherOptions})},t.prototype.onInit=function(){return l(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){return this.newChange.getVersion()<=this.versionManager.getCurrentVersion()?[2,!1]:[2,!0]}))}))},t.prototype.onStart=function(){var e=this,n=e.taskId,r=e.missChangeDependency,o=e.newChange,l=e.versionManager,u=e.acceptCommitDependency,d=e.otherOptions,p=o.getVersion(),f=this.versionManager.getCurrentVersion();if(p===f+1)this.acceptCommitDependency.applyServerUserChanges(o.getData());else{if(p>f+1)return a.Z.info("CollabTask apply new changes, need MissChange: applyChangeVersion = ".concat(p,", currentVersion = ").concat(f)),s.Z.report(c.Yo.APPLY_COLLAB_CHANGE_VERSION_BREAK,{currentVersion:f,newVersion:p}),[new i.Z({from:f+1,to:p-1},{missChangeDependency:r,versionManager:l,acceptCommitDependency:u}),new t(n,o,{missChangeDependency:r,versionManager:l,acceptCommitDependency:u,otherOptions:d})];p===f?(s.Z.report(c.Yo.APPLY_COLLAB_CHANGE_VERSION_REPEAT,{currentVersion:f,newVersion:p}),a.Z.info("CollabTask apply new changes, version not change.")):(s.Z.report(c.Yo.APPLY_COLLAB_CHANGE_VERSION_BELOW,{currentVersion:f,newVersion:p}),a.Z.info("CollabTask apply new changes, new version is lower than current version."))}},t}(o.Z);t.Z=u},858074:function(e,t,n){var r=n(839461),o=n(50209),i=n(133779),a=n(883754),s=n(395979),c=n(812439),l=n(954560),u=n(339322),d=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},p=function(e){function t(t,n){var r=e.call(this,n.taskId)||this;r.type=o.U.MISS_CHANGE_TASK;var i=t.from,a=t.to,s=n.missChangeDependency,l=n.versionManager,u=n.acceptCommitDependency,d=n.onDestroy,p=n.otherOptions;return r.from=i,r.to=a,r.missChangeDependency=s,r.versionManager=l,r.acceptCommitDependency=u,r.otherOptions=p,d&&(r.onDestroy=d),c.Z.info("new MissChangeTask: from = ".concat(i,", to = ").concat(a)),r}return(0,r.__extends)(t,e),t.prototype.reset=function(){this.destory(!1);var e=this,n=e.taskId,r=e.from,o=e.to,i=e.missChangeDependency,a=e.acceptCommitDependency;return new t({from:r,to:o},{taskId:n,missChangeDependency:i,versionManager:e.versionManager,acceptCommitDependency:a,onDestroy:e.onDestroy,otherOptions:e.otherOptions})},t.prototype.taskIdentify=function(){return"MissChangeTask_From".concat(this.from,"_To").concat(this.to)},t.prototype.onInit=function(){return d(this,void 0,void 0,(function(){var e,t,n,o,a;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:if(void 0!==this.to&&this.to<=this.versionManager.getCurrentVersion())return[2,!1];this.from<=this.versionManager.getCurrentVersion()&&(this.from=this.versionManager.getCurrentVersion()+1),r.label=1;case 1:return r.trys.push([1,3,,4]),this.initTime=Date.now(),e=this.fetchMissChangeFromServer(this.from,this.to),t=this.to?Math.ceil((this.to-this.from)/50)*i.Dq:0,n=Math.max(t,i.Dq),o=this,[4,Promise.race([e,new Promise((function(e){return setTimeout((function(){c.Z.info("fetchMissChangeFromServer timeout exceed ".concat(n,"ms")),e([])}),n)}))])];case 2:return o.missChangeList=r.sent(),[3,4];case 3:return a=r.sent(),c.Z.error("MissChangeTask onInit error, error=",null==a?void 0:a.stack,null==a?void 0:a.message),[2,Promise.reject(a)];case 4:return[2,!0]}}))}))},t.prototype.onStart=function(){var e,t,n,o=this,i=null===(n=this.missChangeList)||void 0===n?void 0:n.length;if(c.Z.info("MissChangeTask onStart, length=".concat(i)),this.missChangeList){if(this.missChangeDependency.isSplitMissTask)return this.generateCollabTasks();var u=Date.now();if(this.acceptCommitDependency.composeNewChanges){var d=this.missChangeList.find((function(e){var t,n;return null===(n=(t=o.missChangeDependency).isDuplicateTaskId)||void 0===n?void 0:n.call(t,e.commitId)}));d?(c.Z.info("MissChangeTask onStart, exist duplicate taskId, not allow composeNewChanges"),l.Z.report(s.Yo.NO_COMPOSE_DUPLICATE_TASK,{length:i})):this.missChangeList=this.acceptCommitDependency.composeNewChanges(this.missChangeList)||this.missChangeList}try{for(var p=(0,r.__values)(this.missChangeList),f=p.next();!f.done;f=p.next()){var h=f.value,m=Number(h.commitId);if(c.Z.info("MissChangeTask applyServerUserChanges start, taskId=".concat(m)),!this.acceptCommitDependency.applyServerUserChanges(Object.assign({userChangesOrigin:a.P.MISS_CHANG,taskId:m},h)))throw c.Z.error("MissChangeTask applyServerUserChanges error, taskId=".concat(m,", change="),h),new Error("MissChangeTask applyServerUserChanges error")}}catch(t){e={error:t}}finally{try{f&&!f.done&&(t=p.return)&&t.call(p)}finally{if(e)throw e.error}}var g=Date.now()-u,v=this.initTime?Date.now()-this.initTime:0;c.Z.info("MissChangeTask cost, originLength=".concat(i,", composedLength=").concat(this.missChangeList.length,", cost=").concat(g,", fullTimeCost=").concat(v)),l.Z.report(s.Yo.APPLY_SERVER_USER_CHANGE_COST,{length:i,timeCost:g,fullTimeCost:v})}},t.prototype.generateCollabTasks=function(){var e=this,t=e.missChangeDependency,n=e.versionManager,r=e.acceptCommitDependency,o=e.missChangeList,i=[];return o.forEach((function(e){var o=new a.Z(Object.assign({userChangesOrigin:a.P.MISS_CHANG,taskId:Number(e.commitId)},e));i.push(new u.Z(o.getTaskId(),o,{missChangeDependency:t,versionManager:n,acceptCommitDependency:r}))})),i},t.prototype.fetchMissChangeFromServer=function(e,t){return d(this,void 0,void 0,(function(){var n,o,a,u,d,p,f,h,m,g;return(0,r.__generator)(this,(function(v){switch(v.label){case 0:return[4,(0,i.Tn)({from:e,to:t,globalPadId:this.missChangeDependency.globalPadId,customReferUrl:this.missChangeDependency.customReferUrl},this.missChangeDependency.getMissChangesUrl,this.missChangeDependency.sendMissChangeRequest).catch((function(e){var t;return c.Z.error("MissChangeTask getMissChange error, message=",null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.message,e),Promise.reject(null==e?void 0:e.error)}))];case 1:n=v.sent(),o=this.versionManager.getCurrentVersion(),a=n.filter((function(t){return t.data.newRev>=e})),u=a.filter((function(e){return e.data.newRev>=o+1}));try{for(d=(0,r.__values)(u),p=d.next();!p.done;p=d.next()){if(f=p.value,(h=f.data.newRev)!==o+1)throw c.Z.error("MissChangeTask getMissChange error, version not consequent, newRev = ".concat(h,", preNewVersion = ").concat(o)),l.Z.report(s.Yo.MISS_CHANGE_VERSION_ERROR,{from:e,to:t,preNewVersion:o,userChange:f}),new Error("MissChangeTask version error");o=h}}catch(e){m={error:e}}finally{try{p&&!p.done&&(g=d.return)&&g.call(d)}finally{if(m)throw m.error}}return[2,u.map((function(e){return e.data}))]}}))}))},t}(o.Z);t.Z=p},795901:function(e,t,n){var r;n.d(t,{K:function(){return r}}),function(e){e[e.TASK_ERROR=51001]="TASK_ERROR",e[e.SEND_BLOCK=51002]="SEND_BLOCK"}(r||(r={}))},592624:function(e,t,n){var r=n(839461),o=n(812439),i=n(662654),a=n(949595),s=n(221352),c=n(141519),l=n(421628);!function(){function e(e){var t=this;this.options=e,this.tag="ConnectionRecoverHelper",this.maxRetryMap=new Map;var n=new i.y((function(t){var n,r,o=function(){return"visible"===document.visibilityState};window.addEventListener("visibilitychange",(function(){t.next(o())})),null===(n=e.listenVisibleChange)||void 0===n||n.call(e,(function(e){t.next(e)})),document.addEventListener("click",(function(){t.next(!0)})),window.addEventListener("pagehide",(function(){t.next(!1)})),window.addEventListener("pageshow",(function(){t.next(!0)})),null===(r=e.listenVisibleChange)||void 0===r||r.call(e,(function(e){t.next(e)})),t.next(o())})).pipe((0,c.x)());this.visibleSubject=new a.X(!0),n.subscribe((function(e){t.visibleSubject.next(e)}))}Object.defineProperty(e.prototype,"isRecovering",{get:function(){return!!this.observable},enumerable:!1,configurable:!0}),e.prototype.tryRecover=function(e,t,n,i){var a,s,c,l=this;void 0===i&&(i=0),this.timeoutId&&clearTimeout(this.timeoutId),this.timeoutId=void 0;var u=function(r){var a,s=function(){var a;null==t||t(),n&&(i>(null!==(a=null==r?void 0:r.maxRetry)&&void 0!==a?a:1024)||(o.Z.info(l.tag,"retry ".concat(e," until success, timeout: ").concat(r.retryInterval,", retryCount: ").concat(i)),l.timeoutId=setTimeout((function(){return l.tryRecover(e,void 0,n,i+1)}),r.retryInterval)))};if(r.codes.indexOf(e)>=0)return d.observable?(o.Z.info(d.tag,"retry conflict code: ".concat(e)),d.clean(),s(),{value:void 0}):r.skipFirstRecover&&0===i?(o.Z.info(d.tag,"skip first try, code: ".concat(e)),d.clean(),s(),{value:void 0}):(d.observable=(null!==(c=null==r?void 0:r.customObservable)&&void 0!==c?c:d.visibleSubject).subscribe((function(t){var i,c,u=void 0===a;if(a=t,t){var d=!u||r.retryImmeOnFirstVisible;o.Z.info(l.tag,"document visible, startRetry"),null===(i=l.cleanupRetry)||void 0===i||i.call(l),l.cleanupRetry=l.startRetry(e,Object.assign(Object.assign({},r),{retryImme:d}),s,n)}else o.Z.info(l.tag,"document invisible, cleanupRetry"),null===(c=l.cleanupRetry)||void 0===c||c.call(l)})),{value:void 0})},d=this;try{for(var p=(0,r.__values)(this.options.actions),f=p.next();!f.done;f=p.next()){var h=u(f.value);if("object"==typeof h)return h.value}}catch(e){a={error:e}}finally{try{f&&!f.done&&(s=p.return)&&s.call(p)}finally{if(a)throw a.error}}null==t||t()},e.prototype.startRetry=function(e,t,n,r){var i=this,a=t.retry,c=t.retryLimit,u=t.retryInterval,d=t.retryImme,p=t.maxRetry,f=(0,s.H)(d?0:u,u).pipe((0,l.q)(c)).subscribe((function(t){if(i.increaseRetry(e),i.reachMaxRetry(e,p||Number.MAX_SAFE_INTEGER))return o.Z.info(i.tag,"reach max retry, ".concat(JSON.stringify(i.maxRetryMap),", maxRetry: ").concat(p)),i.clean(),void n();o.Z.info(i.tag,"startRetry, count".concat(t,", retryLimit: ").concat(c)),a(e).then((function(){o.Z.info(i.tag,"retry success, count: ".concat(t)),i.clean(),null==r||r()})).catch((function(){o.Z.info(i.tag,"retry failed, count: ".concat(t)),t===c-1&&(o.Z.info(i.tag,"retry failed and fallback"),i.clean(),n())}))}));return function(){f.unsubscribe()}},e.prototype.reachMaxRetry=function(e,t){return(this.maxRetryMap.get(e)||0)>t},e.prototype.increaseRetry=function(e){var t=this.maxRetryMap.get(e)||0;this.maxRetryMap.set(e,t+1)},e.prototype.clean=function(){var e,t;o.Z.info(this.tag,"clean recovery"),null===(e=this.observable)||void 0===e||e.unsubscribe(),this.observable=void 0,null===(t=this.cleanupRetry)||void 0===t||t.call(this)}}()},395979:function(e,t,n){var r,o,i;n.d(t,{FI:function(){return s},Yo:function(){return i},iv:function(){return a},nn:function(){return o}}),function(e){e.NEW_CHANGES="NEW_CHANGES",e.BIG_CHANGES="BIG_CHANGES",e.USER_NEWINFO="USER_NEWINFO",e.USER_NEWINFOS="USER_NEWINFOS",e.USER_LEAVE="USER_LEAVE",e.RIGHT_MESSAGE="RIGHT_MESSAGE",e.REVERT_MESSAGE="REVERT_MESSAGE",e.LAST_REVERSION="LAST_REVERSION",e.CURSOR_MESSAGE="CURSOR_MESSAGE",e.CURSOR_MESSAGES="CURSOR_MESSAGES",e.CODEREV_NEW="CODEREV_NEW",e.TITLE_MESSAGE="TITLE_MESSAGE",e.HANDLE_DELETE="HANDLE_DELETE",e.COMM_NOTICE="COMM_NOTICE",e.MARK_MESSAGE="MARK_MESSAGE",e.LIVE_MESSAGE="LIVE_MESSAGE",e.PRESENT_INFO="PRESENT_INFO"}(o||(o={})),function(e){e.BATCH_COMMIT_ERROR="BATCH_COMMIT_ERROR",e.RETRY_COMMIT="RETRY_COMMIT",e.SEND_USERCHANGE="SEND_USERCHANGE",e.ACCEPT_TASK_DUPLICATE="ACCEPT_TASK_DUPLICATE",e.HANDLE_NEW_CHANGES="HANDLE_NEW_CHANGES",e.HANDLE_TASK_DUPLICATE_VERSION_ERROR="HANDLE_TASK_DUPLICATE_VERSION_ERROR",e.HANDLE_FOLLOW_ERROR="HANDLE_FOLLOW_ERROR",e.APPLY_SERVER_USER_CHANGE_ERROR="APPLY_SERVER_USER_CHANGE_ERROR",e.APPLY_COLLAB_CHANGE_VERSION_BREAK="APPLY_COLLAB_CHANGE_VERSION_BREAK",e.APPLY_COLLAB_CHANGE_VERSION_REPEAT="APPLY_COLLAB_CHANGE_VERSION_REPEAT",e.APPLY_COLLAB_CHANGE_VERSION_BELOW="APPLY_COLLAB_CHANGE_VERSION_BELOW",e.GET_MISS_CHANGE_ERROR="GET_MISS_CHANGE_ERROR",e.MISS_CHANGE_VERSION_ERROR="MISS_CHANGE_VERSION_ERROR",e.GET_BIG_CHANGE_ERROR="GET_BIG_CHANGE_ERROR",e.BIG_CHANGE_VERSION_ERROR="BIG_CHANGE_VERSION_ERROR",e.COMMITING_BLOCK_ERROR="COMMITING_BLOCK_ERROR",e.UPDATE_VERSION_ERROR="UPDATE_VERSION_ERROR",e.COMMIT_REQUEST_SUCCESS="COMMIT_REQUEST_SUCCESS",e.COMMIT_REQUEST_FAIL="COMMIT_REQUEST_FAIL",e.TASK_QUEUE_NOT_RESUME_AFTER_60_SECOND="TASK_QUEUE_NOT_RESUME_AFTER_60_SECOND",e.APPLY_SERVER_USER_CHANGE_COST="APPLY_SERVER_USER_CHANGE_COST",e.NO_COMPOSE_DUPLICATE_TASK="NO_COMPOSE_DUPLICATE_TASK"}(i||(i={}));var a,s=((r={})[i.BATCH_COMMIT_ERROR]="批量提交消息失败",r[i.RETRY_COMMIT]="重试提交消息",r[i.SEND_USERCHANGE]="提交单个消息到 Socket 侧",r[i.ACCEPT_TASK_DUPLICATE]="单个消息提交，后台返回 TASK_DUPLICATE 重复消息",r[i.HANDLE_NEW_CHANGES]="接收到新协同消息",r[i.HANDLE_TASK_DUPLICATE_VERSION_ERROR]="重复消息处理时，最新版本号小于或者等于当前版本号，版本异常",r[i.HANDLE_FOLLOW_ERROR]="冲突处理异常",r[i.APPLY_SERVER_USER_CHANGE_ERROR]="回调网络层依赖 ApplyServerUserChanges 时异常",r[i.APPLY_COLLAB_CHANGE_VERSION_BREAK]="应用协同消息时，应用版本出现断层",r[i.APPLY_COLLAB_CHANGE_VERSION_REPEAT]="应用协同消息时，应用版本重复",r[i.APPLY_COLLAB_CHANGE_VERSION_BELOW]="应用协同消息时，应用版本低于现在版本",r[i.GET_MISS_CHANGE_ERROR]="补拉版本任务 CGI 请求异常",r[i.MISS_CHANGE_VERSION_ERROR]="补拉版本任务回包数据版本不连续",r[i.COMMITING_BLOCK_ERROR]="提交任务队列阻塞（重试后依然失败）",r[i.GET_BIG_CHANGE_ERROR]="大数据版本任务 CGI 请求异常",r[i.BIG_CHANGE_VERSION_ERROR]="大数据拉取版本任务回包版本异常",r[i.UPDATE_VERSION_ERROR]="版本升级异常，当前版本大于要升的版本",r[i.COMMIT_REQUEST_SUCCESS]="用户数据提交成功",r[i.COMMIT_REQUEST_FAIL]="用户数据提交失败",r[i.TASK_QUEUE_NOT_RESUME_AFTER_60_SECOND]="任务队列被暂停，超过 1 分钟没有被恢复调度",r[i.APPLY_SERVER_USER_CHANGE_COST]="ApplyServerUserChanges耗时",r[i.NO_COMPOSE_DUPLICATE_TASK]="Changes存在重复任务，不进行compose处理",r);!function(e){e.AJAX_ERROR="AJAX_ERROR",e.RESULT_DATA_UNDEFINED="RESULT_DATA_UNDEFINED",e.RETCODE_ERROR="RETCODE_ERROR",e.RESULT_CHANGES_EMPTY="RESULT_CHANGES_EMPTY",e.FROM_BELOW_TO_ERROR="FROM_BELOW_TO_ERROR",e.FETCH_CGI_ERROR="FETCH_CGI_ERROR"}(a||(a={}))},330624:function(e,t,n){var r,o,i,a,s,c;n.d(t,{n7:function(){return a},no:function(){return o},op:function(){return c},qP:function(){return s},uC:function(){return i},uR:function(){return r}}),function(e){e.ON_QUEUE_CHANGE="onQueueChange"}(r||(r={})),function(e){e.ON_COMMIT_FAIL="onCommitFail",e.ON_COMMIT_SUCCESS="onCommitSuccess"}(o||(o={})),function(e){e.ON_RECEIVE_MESSAGE="onReceiveOtherMessage"}(i||(i={})),function(e){e.ON_VERSION_CHANGE="onVersionChange"}(a||(a={})),function(e){e.ON_ROOM_OPEN="onRoomOpen",e.ON_ROOM_CLOSE="onClosed",e.ON_ROOM_SHUTDOWN="onShutdown",e.ON_RECONNECT_FAIL="onNetReconnectedFail",e.ON_ROOM_STATE_CHANGE="onConnectionStatusChange",e.ON_ENTER_ONLINE="onEnterOnline",e.ON_ENTER_OFFLINE="onEnterOffline"}(s||(s={})),function(e){e.ON_LOG="onLog",e.ON_REPORT="onReport"}(c||(c={}))},100727:function(e,t,n){var r;!function(e){e.ON_ERROR="ON_ERROR",e.ON_SEND_ACCEPT="ON_SEND_ACCEPT"}(r||(r={}))},962937:function(e,t,n){n.d(t,{Q:function(){return s}});var r=n(839461),o=function e(t){this.element=t,this.next=e.Undefined,this.prev=e.Undefined};o.Undefined=new o(void 0);var i,a=function(){function e(){this._first=o.Undefined,this._last=o.Undefined,this._size=0}return Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),e.prototype.isEmpty=function(){return this._first===o.Undefined},e.prototype.clear=function(){this._first=o.Undefined,this._last=o.Undefined,this._size=0},e.prototype.unshift=function(e){return this._insert(e,!1)},e.prototype.push=function(e){return this._insert(e,!0)},e.prototype.shift=function(){if(this._first!==o.Undefined){var e=this._first.element;return this._remove(this._first),e}},e.prototype.pop=function(){if(this._last!==o.Undefined){var e=this._last.element;return this._remove(this._last),e}},e.prototype[Symbol.iterator]=function(){var e;return(0,r.__generator)(this,(function(t){switch(t.label){case 0:e=this._first,t.label=1;case 1:return e===o.Undefined?[3,3]:[4,e.element];case 2:return t.sent(),e=e.next,[3,1];case 3:return[2]}}))},e.prototype.toArray=function(){for(var e=[],t=this._first;t!==o.Undefined;t=t.next)e.push(t.element);return e},e.prototype._insert=function(e,t){var n=this,r=new o(e);if(this._first===o.Undefined)this._first=r,this._last=r;else if(t){var i=this._last;this._last=r,r.prev=i,i.next=r}else{var a=this._first;this._first=r,r.next=a,a.prev=r}this._size+=1;var s=!1;return function(){s||(s=!0,n._remove(r))}},e.prototype._remove=function(e){if(e.prev!==o.Undefined&&e.next!==o.Undefined){var t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===o.Undefined&&e.next===o.Undefined?(this._first=o.Undefined,this._last=o.Undefined):e.next===o.Undefined?(this._last=this._last.prev,this._last.next=o.Undefined):e.prev===o.Undefined&&(this._first=this._first.next,this._first.prev=o.Undefined);this._size-=1},e}(),s=function(){function e(e){this._disposed=!1,this._options=e}return Object.defineProperty(e.prototype,"event",{get:function(){var e=this;return this._event||(this._event=function(t,n,r){var o,i,s;e._listeners||(e._listeners=new a);var c=e._listeners.isEmpty();c&&(null===(o=e._options)||void 0===o?void 0:o.onFirstListenerAdd)&&e._options.onFirstListenerAdd(e);var l=e._listeners.push(n?[t,n]:t);c&&(null===(i=e._options)||void 0===i?void 0:i.onFirstListenerDidAdd)&&e._options.onFirstListenerDidAdd(e),(null===(s=e._options)||void 0===s?void 0:s.onListenerDidAdd)&&e._options.onListenerDidAdd(e,t,n);var u={dispose:function(){var t;e._disposed||(l(),(null===(t=e._options)||void 0===t?void 0:t.onLastListenerRemove)&&(e._listeners&&!e._listeners.isEmpty()||e._options.onLastListenerRemove(e)))}};return Array.isArray(r)&&r.push(u),u}),this._event},enumerable:!1,configurable:!0}),e.prototype.fire=function(e){var t,n;if(this._listeners){this._deliveryQueue||(this._deliveryQueue=new a);try{for(var o=(0,r.__values)(this._listeners),i=o.next();!i.done;i=o.next()){var s=i.value;this._deliveryQueue.push([s,e])}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}for(;this._deliveryQueue.size>0;){var c=(0,r.__read)(this._deliveryQueue.shift(),2),l=(s=c[0],c[1]);try{"function"==typeof s?s.call(void 0,l):s[0].call(s[1],l)}catch(e){console.error(e)}}}},e.prototype.dispose=function(){this._listeners&&this._listeners.clear(),this._deliveryQueue&&this._deliveryQueue.clear(),this._disposed=!0},e}();!function(e){function t(e){return function(t,n,r){void 0===n&&(n=null);var o=!1,i=e((function(e){if(!o)return i?i.dispose():o=!0,t.call(n,e)}),null,r);return o&&i.dispose(),i}}e.once=t,e.signal=function(e){return e},e.buffer=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=[]);var r=n.slice(),o=e((function(e){r?r.push(e):a.fire(e)})),i=function(){r&&r.forEach((function(e){return a.fire(e)})),r=null},a=new s({onFirstListenerAdd:function(){o||(o=e((function(e){return a.fire(e)})))},onFirstListenerDidAdd:function(){r&&(t?setTimeout(i):i())},onLastListenerRemove:function(){o&&o.dispose(),o=null}});return a.event},e.fromPromise=function(e){var t=new s,n=!1;return e.then(void 0,(function(){return null})).then((function(){n?t.fire(void 0):setTimeout((function(){return t.fire(void 0)}),0)})),n=!0,t.event},e.toPromise=function(e){return new Promise((function(n){return t(e)(n)}))}}(i||(i={}))},227218:function(e,t,n){n.d(t,{A:function(){return s},t:function(){return a}});var r=n(839461),o=n(812439),i=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};function a(e){return"function"==typeof e&&e.toString().includes("[native code]")}function s(e){return i(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){return[2,new Promise((function(t){if(0===e.length)return t();var n=e.map((function(i){return i.status.subscribe((function(){var i,a,s=!0;try{for(var c=(0,r.__values)(e),l=c.next();!l.done;l=c.next()){var u=l.value;s=s&&u.isDestroyed()}}catch(e){i={error:e}}finally{try{l&&!l.done&&(a=c.return)&&a.call(c)}finally{if(i)throw i.error}}s&&(o.Z.info("task all done"),n.forEach((function(e){return e.unsubscribe()})),t())}))}))}))]}))}))}},133779:function(e,t,n){n.d(t,{Dq:function(){return d},Tn:function(){return _}});var r=n(839461),o=n(666410),i=n(790483),a=n.n(i),s=n(395979),c=n(812439),l=n(954560),u=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},d=o.DEFAULT_SEND_MESSAGE_TIMEOUT;function p(e,t){return u(this,void 0,void 0,(function(){var n;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),n=void 0,t?[4,f(e,t)]:[3,2];case 1:return n=r.sent(),[3,4];case 2:return[4,h(e)];case 3:n=r.sent(),r.label=4;case 4:return[2,n];case 5:return[2,{isSuccess:!1,error:r.sent(),data:void 0,errorDescription:s.iv.AJAX_ERROR}];case 6:return[2]}}))}))}function f(e,t){return u(this,void 0,void 0,(function(){var n;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return[4,fetch(e,{method:"GET",headers:{"Content-Type":"application/json"},referrer:t})];case 1:return[4,r.sent().json()];case 2:return n=r.sent(),[2,{isSuccess:!0,data:Object.assign({data:n},n)}]}}))}))}function h(e){return u(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){switch(t.label){case 0:return[4,a()({method:"get",url:e,responseType:"json",timeout:d})];case 1:return[2,{isSuccess:!0,data:t.sent()}]}}))}))}function m(e){var t=e.url,n=e.maxRetryCount,o=void 0===n?2:n,i=e.customReferUrl,a=e.retryInterval;return u(this,void 0,void 0,(function(){var e,n,s,c;return(0,r.__generator)(this,(function(l){switch(l.label){case 0:e={isSuccess:!1,data:void 0},n=0,s=function(){var o;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return[4,p(t,i)];case 1:if((e=r.sent()).isSuccess){if(!(null==e?void 0:e.data))return[2,{value:e}];if(g(e.data).isSuccess)return[2,{value:e}]}return n+=1,o=null!=a?a:10*n*1e3,[4,new Promise((function(e){return setTimeout(e,o)}))];case 2:return r.sent(),[2]}}))},l.label=1;case 1:return n<=o?[5,s()]:[3,3];case 2:return"object"==typeof(c=l.sent())?[2,c.value]:[3,1];case 3:return[2,e]}}))}))}function g(e){var t,n,r=e.data,o=!0,i=void 0,a=void 0;return void 0===r?(o=!1,i=s.iv.RESULT_DATA_UNDEFINED):0!==(null==r?void 0:r.retcode)?(o=!1,i=s.iv.RETCODE_ERROR,a=null==r?void 0:r.retcode):0===(null===(n=null===(t=null==r?void 0:r.result)||void 0===t?void 0:t.changes)||void 0===n?void 0:n.length)&&(o=!1,i=s.iv.RESULT_CHANGES_EMPTY),{isSuccess:o,errorDescription:i,retcode:a}}function v(e,t,n){return u(this,void 0,void 0,(function(){var o,i,a,l,u,d,p;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return function(e){return!(void 0!==e.to&&e.to<e.from)}(e)?[4,t(e)]:[2,{isSuccess:!1,data:void 0,errorDescription:s.iv.FROM_BELOW_TO_ERROR}];case 1:return o=r.sent(),[4,(n||m)({url:o,customReferUrl:e.customReferUrl,retryInterval:e.retryInterval})];case 2:return i=r.sent(),a=i.data,i.isSuccess?(l=g(a),u=l.isSuccess,d=l.errorDescription,p=l.retcode,c.Z.info("getMissChangeUrl, isSuccess: ".concat(u," retcode: ").concat(p,", errorDescription: ").concat(d)),[2,{data:null==a?void 0:a.data.result,isSuccess:u,errorDescription:d,retcode:p,error:new Error(JSON.stringify({retcode:p,errorDescription:d}))}]):[2,{isSuccess:!1,data:void 0,error:i.error,errorDescription:s.iv.FETCH_CGI_ERROR}]}}))}))}function _(e,t,n){return u(this,void 0,void 0,(function(){var o,i,a,c;return(0,r.__generator)(this,(function(u){switch(u.label){case 0:o=[],i=Object.assign({},e),u.label=1;case 1:return[4,v(i,t,n)];case 2:return(a=u.sent()).isSuccess?(o.push.apply(o,(0,r.__spreadArray)([],(0,r.__read)(a.data.changes),!1)),d=e.to,p=a.data.to,f=a.data.rev,(c=void 0===d&&f>p?{isFinish:!1,from:p+1,to:f}:void 0!==d&&d>p&&d<=f?{isFinish:!1,from:p+1,to:d}:{isFinish:!0}).isFinish?[2,o]:(i=Object.assign(e,{from:c.from,to:c.to}),[3,1])):(l.Z.report(s.Yo.GET_MISS_CHANGE_ERROR,{options:e,result:a}),[2,Promise.reject(a)]);case 3:return[2]}var d,p,f}))}))}},812439:function(e,t,n){n.d(t,{k:function(){return r}});var r,o=n(962937);!function(e){e.INFO="INFO",e.ERROR="ERROR",e.WARN="WARN",e.DEBUG="DEBUG"}(r||(r={}));var i=function(){function e(){this.onLogEmitter=new o.Q,this.onLog=this.onLogEmitter.event,this.initLogger()}return e.prototype.dispose=function(){this.onLogEmitter.dispose()},e.prototype.initLogger=function(){var e=this;this.info=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.onLogEmitter.fire({type:"INFO",data:t})},this.debug=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.onLogEmitter.fire({type:"DEBUG",data:t})},this.warn=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.onLogEmitter.fire({type:"WARN",data:t})},this.error=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.onLogEmitter.fire({type:"ERROR",data:t})}},e}();t.Z=new i},954560:function(e,t,n){var r=n(962937),o=n(395979),i=function(){function e(){this.onReportEmitter=new r.Q,this.onReport=this.onReportEmitter.event,this.initReporter()}return e.prototype.dispose=function(){this.onReportEmitter.dispose()},e.prototype.initReporter=function(){var e=this;this.report=function(t,n){e.onReportEmitter.fire({type:t,remark:o.FI[t],data:n})}},e}();t.Z=new i},869263:function(e,t,n){var r,o,i,a,s,c,l,u,d,p;window,e.exports=(r=n(679624),o=n(765274),i=n(645177),a=n(556256),s=n(947750),c=n(324423),l=n(285485),u=n(492787),d=n(691525),p=n(595764),function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=10)}([function(e,t){e.exports=r},function(e,t){e.exports=o},function(e,t){e.exports=i},function(e,t){e.exports=a},function(e,t){e.exports=s},function(e,t){e.exports=c},function(e,t){e.exports=l},function(e,t){e.exports=u},function(e,t){e.exports=d},function(e,t){e.exports=p},function(e,t,n){n.r(t),n.d(t,"ErrorCode",(function(){return S})),n.d(t,"ErrorMsg",(function(){return I})),n.d(t,"UID",(function(){return M})),n.d(t,"UID_KEY",(function(){return O}));var r=n(3),o=n.n(r),i=n(4),a=n.n(i),s=n(7),c=n.n(s),l=n(8),u=n.n(l),d=n(5),p=n.n(d),f=n(1),h=n.n(f),m=n(0),g=n(2),v=function(){function e(t){o()(this,e),this.channelName="".concat(t,"Channel"),this.storageName="".concat(t,"Storage"),this.cookieName="".concat(t,"Cookie"),this.init(),this.nowUid=Object(m.getCookie)("uid");var n="".concat(Math.floor(1e9*Math.random()),"_").concat(+new Date);window.messageCenterTabKey||(window.messageCenterTabKey=n),this.tabKey=window.messageCenterTabKey||n}return a()(e,[{key:"init",value:function(){window&&window.BroadcastChannel&&(this.msgCenter=new BroadcastChannel(this.channelName))}},{key:"postMessage",value:function(e){var t,n;e.key=this.tabKey,null===(t=null===window||void 0===window?void 0:window.log)||void 0===t||t.log("message center get message:, ".concat(JSON.stringify(e)," time: ").concat(+new Date)),this.msgCenter&&this.msgCenter.postMessage(e);try{localStorage.setItem(this.storageName,JSON.stringify(e))}catch(t){null===(n=null===window||void 0===window?void 0:window.log)||void 0===n||n.log("message center set message fail:, ".concat(JSON.stringify(e)," time: ").concat(+new Date))}}},{key:"initListener",value:function(){var e=this;this.msgCenter&&(this.msgCenter.onmessage=function(t){t&&(null==e||e.channelHandler(t))}),window.addEventListener("storage",(function(t){t.key===e.storageName&&(null==e||e.storageHandler(t))})),document.addEventListener("visibilitychange",(function(){setTimeout((function(){null==e||e.visibilityHandle()}),100)}))}},{key:"listenerHandleFun",value:function(e){var t=e.channelHandler,n=e.storageHandler,r=e.visibilityHandle;t&&(this.channelHandler=t),r&&(this.visibilityHandle=r),this.storageHandler=n,this.initListener()}},{key:"messageHandleFun",value:function(e){}}]),e}(),_=n(6);function y(e,t,n){if(!n){var r=new RegExp("(\\?|&)"+t+"=[^&]*(&)?","g"),o=e.replace(r,(function(e,t,n){return"?"===t||n?t:""}));return"?"===o[o.length-1]?o.substr(0,o.length-1):o}var i=new RegExp("([?&])"+t+"=.*?(&|$)","i"),a=-1!==e.indexOf("?")?"&":"?";return e.match(i)?e.replace(i,"$1"+t+"="+n+"$2"):e+a+t+"="+n}function b(e,t){var n,r=new RegExp("(?:^|;+|\\s+)".concat(e,"=([^;]*)"));return void 0===t&&(t="undefined"!=typeof document?document.cookie:""),null===(n=t.match(r))||void 0===n?void 0:n[1]}var E=n(9),C=n.n(E),w=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};function T(){return w(this,void 0,void 0,h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat("/session/api/multiacc/account_list","?xrsf=").concat(b("TOK")),e.abrupt("return",C.a.get(t));case 2:case"end":return e.stop()}}),e)})))}function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return u()(this,n)}}var S,I,R=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};!function(e){e[e.switchLogin=1e4]="switchLogin",e[e.logoutLogin=10001]="logoutLogin"}(S||(S={})),function(e){e.switchLogin="user switch login in other tab",e.logoutLogin="user logout login in other tab"}(I||(I={}));var M="uid",O="uid_key",N=new(function(e){c()(n,e);var t=A(n);function n(e){var r;return o()(this,n),(r=t.call(this,e)).hadSendMsg=!1,r.nowUsesId=Object(g.getNowUserId)(),r.isMulti=Object(g.isMultiLoginGray)(),r.listenerHandleFun({channelHandler:r.channelFun,storageHandler:r.storageFun,visibilityHandle:r.visibilityFun}),r}return a()(n,[{key:"checkIsSame",value:function(e){return!this.isMulti||e===Object(g.getNowUserId)()}},{key:"getCookieValue",value:function(){var e=(Object(m.getCookie)(this.cookieName)||"").split("_");return{type:e[0],userIndex:e[1]}}},{key:"dispatchMsg",value:function(e){this.isMulti&&("logoutLogin"!==e&&"logout"!==e||document.dispatchEvent(new CustomEvent("logoutAccount")))}},{key:"checkSameUser",value:function(){return Object(g.getUid)()===this.nowUid}},{key:"checkNoNeedVisibility",value:function(){var e=window.clientVars,t="101520907"===(null==e?void 0:e.ownerAppid);return this.hadSendMsg||"visible"!==document.visibilityState||this.isMulti||!t}},{key:"visibilityFun",value:function(){var e;this.checkNoNeedVisibility()||this.checkSameUser()||null===(e=this.messageHandleFun)||void 0===e||e.call(this,this.getErrorMsg("switch"))}},{key:"channelFun",value:function(e){var t=this;if(e){var n=e.data;n.key!==this.tabKey&&this.checkNeedLogin(n,(function(e){var r,o;null===(r=t.messageHandleFun)||void 0===r||r.call(t,t.getErrorMsg(e)),null===(o=null===window||void 0===window?void 0:window.log)||void 0===o||o.log("channel Event:".concat(e,", source tab:").concat(n.key,"， now tabKey:").concat(t.tabKey,"， :").concat((new Date).getTime())),t.dispatchMsg(e),t.hadSendMsg=!0}))}}},{key:"storageFun",value:function(e){var t=this,n=e.newValue;if(n){var r=JSON.parse(n);r.key!==this.tabKey&&this.checkNeedLogin(r,(function(e){setTimeout((function(){var n,o;t.hadSendMsg||(null===(n=t.messageHandleFun)||void 0===n||n.call(t,t.getErrorMsg(e)),null===(o=null===window||void 0===window?void 0:window.log)||void 0===o||o.log("storage Event:".concat(e,", source tab:").concat(r.key,"， now tabKey:").concat(t.tabKey,"， :").concat((new Date).getTime())),t.dispatchMsg(e),t.hadSendMsg=!0)}),100)}))}}},{key:"getErrorMsg",value:function(e){return"switchLogin"===e||"switch"===e?{code:S.switchLogin,msg:I.switchLogin}:"logoutLogin"===e||"logout"===e?{code:S.logoutLogin,msg:I.logoutLogin}:void 0}},{key:"checkNeedLogin",value:function(e,t){var n=this;if("true"===Object(m.getCookie)("gray_user"))return"switch"===e.type&&t("switchLogin"),"login"===e.type&&t("login"),"logout"===e.type&&t("logoutLogin"),void document.addEventListener("visibilitychange",(function(){return R(n,void 0,void 0,h.a.mark((function e(){var t,n,r,o,i,a,s,c,l,u;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,null===(o=null===(r=null===(n=null===(t=null===window||void 0===window?void 0:window.__ARK_EXTENSION_SERVICE__)||void 0===t?void 0:t.dependentServiceCombinder)||void 0===n?void 0:n.accountApplication)||void 0===r?void 0:r.getAccountProfileList)||void 0===o?void 0:o.call(r);case 3:i=e.sent,e.next=11;break;case 6:return e.prev=6,e.t0=e.catch(0),e.next=10,T();case 10:i=e.sent;case 11:a=Object(m.getCookie)(M),s=Object(m.getCookie)(O),a&&s&&i?(c=i.find((function(e){return e.uid===a})),l=y(location.href,"u",c.userIndex),Object(_.tencentDocOpenUrlForAll)({replace:!0,url:l})):(u=y(location.href,"u",""),Object(_.tencentDocOpenUrlForAll)({replace:!0,url:u,noUserIndex:!0}));case 14:case"end":return e.stop()}}),e,null,[[0,6]])})))}));this.checkIsSame(e.data)&&("switch"===e.type?t("switchLogin"):"logout"===e.type&&t("logoutLogin"))}},{key:"setCallback",value:function(e){this.messageHandleFun=e}}]),n}(v))("docMessageCenter");t.default=N}]))},768352:function(e,t,n){n(469594),n(579829),n(259356)},588955:function(e,t,n){n.d(t,{$:function(){return u}});var r=n(338104),o=n(826973),i=n(579829),a=n(867024),s=n(216179),c=n(996965),l=n(166595),u=function(e){function t(){var t=e.call(this)||this;t.instanceMap=new Map;var n=new i.Vj;return t.instanceMap.set("default",n),t}return(0,r.__extends)(t,e),t.prototype.$forceUpdate=function(){},t.prototype.onUpdate=function(){var e=this;this.configs.getAllKeys().forEach((function(t){e.syncToKeybindingService(t)}))},t.prototype.syncToKeybindingService=function(e){var t=this.getMergedConfig(e),n=this.instanceMap.get("default");if((null==t?void 0:t.node)&&(this.instanceMap.get(t.node)?n=this.instanceMap.get(t.node):(n=new i.Vj(t.node),this.instanceMap.set(t.node,n))),t){var r=Object.assign(Object.assign({},t),{weight:t.priority,when:function(e){return(0,l.Mf)(t.shouldDisabled,e),!(0,c.k)(t.shouldDisabled,!1)},handler:function(e){var n=t.onPress;(0,l.Mf)(n,e),n()}}),o=n.get(t.keyBindings).find((function(e){return e.name===t.name}));o?Object.assign(o,r):n.register(r)}},t}(a.V);u=(0,r.__decorate)([(0,o.t)({overridable:!0,scope:"ui:service",name:s.v.KEYMAP}),(0,r.__metadata)("design:paramtypes",[])],u)},469594:function(e,t,n){(0,n(678464).Z)("* {\n  margin: 0;\n  padding: 0;\n}\nhtml {\n  height: 100%;\n}\nbody {\n  margin: 0;\n  font-size: 13px;\n  color: black;\n  font-weight: normal;\n  height: 100%;\n  overflow: hidden;\n  -webkit-text-size-adjust: 100%;\n}\n:focus {\n  outline: none;\n}\n")},507919:function(e,t){t.Z="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAATgAAAA8CAYAAADymabIAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAABOKADAAQAAAABAAAAPAAAAAAXhXhyAAABlElEQVR4Ae3SsQ2AMAwEQBsxCA01c2ccaho2gQliIaABXcp8bCmnj3AIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgTuC+Q0L8eV8X1bs3pnD5+qH/pT6UTweebTmx56gXsCBAh8XWDMjPbGJ+ypFfnwqQXqVH9qHykBAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgACBnwmcnSxPYwMlQBIAAAAASUVORK5CYII="},198568:function(e,t){t.Z="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAATgAAAA8CAYAAADymabIAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAABOKADAAQAAAABAAAAPAAAAAAXhXhyAAAB7klEQVR4Ae3QMQrCQBQE0I14EBtrz+1xrG28iWK5MAsZQVB46fbvZH7yxvAQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAh8LrCdzpfn56+P8bjftvT+qrfNp+40a3vbfNqZZm1vm08706ztbfNpZ5q1vW0+7UyztrfNp51p1va2+bQzzdreNp92plnbu8qn7vfssLowJ0CAwL8LHLdtXL/xE21vm9/7zW1vm/cdewXmXOvc5udt61Pb2+bXm+ebtrfNz9vWp7a3za83zzff6p23OBEgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBD4WYEX4LxUDliNrhsAAAAASUVORK5CYII="},837755:function(e,t){t.Z="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAATgAAAA8CAYAAADymabIAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAABOKADAAQAAAABAAAAPAAAAAAXhXhyAAAB00lEQVR4Ae3TsQ3CQAwF0DvEIDTUzM041DRsAgWNFRnFh9yAHpXlmG/nSRnDjwABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBA4HuBeTpfnit/f9xvM5vf5nTPZTtjr3tfNS/ekNXVnO657JbY695XzYs3ZHU1p3suuyX2uvdV8+INWV3N6Z7Lbom97n2f8uLOrD5kTT0CBAj8g8BxznHteJFqTvfc3u3d+6p57noL8Fpz4LXmtfedeU6AAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIEDgRwVeqc5wED9H7DcAAAAASUVORK5CYII="},946191:function(e,t){t.Z="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAATgAAAA8CAYAAADymabIAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAABOKADAAQAAAABAAAAPAAAAAAXhXhyAAAEhUlEQVR4Ae3WT4hVZRjH8fd5zxknXWj/3CTkncm5jgTeixeiAYOBgtok6MagNgW1KrCNQW0SalNQm1rUpiA3SunCKAmM6Q/hqFfvHcX5c+/MvUY4hiYpac2dc87b85y5x5ZCq4zv2Zz3/s77vs85n3kZHue4EEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEE/r2AlEYqwZaLuAOdueYzNi6VK1+44HaJyHJnrrHKsuHN1WezLOy3sY+ipxdmTn85Nja2evHKzZuW6Q6fdFuNF2yk67/W9U+Jk2udVuNuy4bK1RdDCB/bOPLR4/Ozp78dHX3kvr/SpSuWifgPOnNnXrHxULnyfQjuMQ0vducaGyzT+nu0/vs2di5+tNuqTw4/XHsw6yUXLPFO3lloNV6zsdY6pbVqWr+t9Uf62euavW1jH8VbF2bqZ8vl2mgvJNOWaa03tdY+G5bK1fMuhC36/VP6/RXLhjZX3wpZeMPG8WC8qX2uPr9pS21bkiR1y7TWXq31ro21fldrbdTh8W6rOWaZ7vme7vmqjVfH8QPT0/XF4XJtexaSHyzTWi9rrQ9trOsv6/r79W9yTP8mT/SzjzR7ycbxvXeta09OXi+NbnvSpelRyyInz8+3Gp/auDRSveFcWCPOHem0mjss0z0/0/XP5c833DMwMTGRPFSu7EyDO2SZeLe7M9s8mD/nTHAm7oAzYWf1dpe/3QSeI4AAAneqQGydm718CP6n4iP0v96PQdyydmFJkWk30C3meu2sLO/1ekmRaQdyopjrnf8uSHZNu7B+d6ddk/j5zKV5LYnSX21uFK1Zkmwpz3wIeSdkeXByTCRc1PVX7bddEmRWs5W5A+E3y1al0Y0lSfJMW7imZXZpS/qNvldbgru0kliH585n/W+V2P9uuUh2Xb8rXy9ezhVzxYWvtCWb0vUXikx3nSq+NXXxH5bHIb2a9vd03s/8M1eO6Luu17aoVWTa4Z3Rj8hrDQ6mf1oeRC4X9Z0Pt+bqo8Naa61OOFus1/tJzdbZ7/XeL7f1ru+3qO+Z75l66dgzu3Te53ob1PW3TPX3cc0H7Pn4+HimHZw5/1KYalf9sz2zS+fle3ImOBMrJ+K/eSaKd+OOAAIIIIAAAggggAACCCCAAAIIIIAAAggggAACCCCAAAIIIIAAAggggAACCCCAAAIIIIAAAggggAACCCCAAAIIIIAAAggggAACCCCAAAIIIIAAAggggAACCCCAAAIIIIAAAggggAACCCCAAAIIIIAAAggggAACCCCAAAIIIIAAAggggAACCCCAAAIIIIAAAggggAACCCCAAAIIIIAAAggggMD/UOBvC1eljMHEfLIAAAAASUVORK5CYII="},669872:function(e,t){t.Z="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAATgAAAA8CAYAAADymabIAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAABOKADAAQAAAABAAAAPAAAAAAXhXhyAAABhUlEQVR4Ae3YsQ3AIAwEQJxJ0lCz/xipabIJzIBkGutcv176K92aI0CAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAIHaAvH2sWpPtI4AgSoC//ziZMtzEpYlQIAAAQIECBAgQIAAAQL3BPzg7tlqJkAgWcAPLhlUHQECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECOQIbBCoIBwpi8g4AAAAASUVORK5CYII="},110898:function(e,t){t.Z="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAATgAAAA8CAYAAADymabIAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAABOKADAAQAAAABAAAAPAAAAAAXhXhyAAABhElEQVR4Ae3QsQ3AIAwEQDvKIDSpMzfjpE6TTWAGKJCIzvW//LoIR4AAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgMC+Q5brbfF2TAAEC6wS+98mRb8dIWJYAAQI7CZyZUXcabCsBAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIEPi5QAfSVASzWtdIIwAAAABJRU5ErkJggg=="},399450:function(e,t){t.Z="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAATgAAAA8CAYAAADymabIAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAABOKADAAQAAAABAAAAPAAAAAAXhXhyAAAD+ElEQVR4Ae3avW8URxQA8Nk7RzLgSEThU1GUCJxQECHcIaigpKGnp8l/EYl/ISUNTQo6epImiiKlQOKjiAQSpQUCg2RsCdt3sL5MuJvbfd7YjuQ4PzdzO2/eu73fvZ077TklfwQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECCwvwWq6OWdOXPp03dp+WYaVteGaTjoDau7h2bnfnj48NelKK8tph6/tt5omtcv+qWpL/7JXOsGN7+wcHRjefDzMKXvJgtWj2fmqstP7t9/MTkfH6mXffhliWjUL1lnb/TL6XMXjw1W397brf0gqtc/cPDK0we/Pc8COxl7Tcl1c60vD38ZvZjqcUozF2b6vYsp1Y+HZ+tYvaYpt2lOPX76penKGM3t9euj3ow2Vlf++rKz8/1gq3r1c9Vr2sW6R6a+wWXseiOrN7Tx3bSMdfkmF+VEsbaXEOVEMfVGApFRFOPHr94Pxq/5f7tfxveetv7ban5igytPuOkJyjXjL7h8si5ru6zJdbus7bJGvdGHV9N7x6/99ksXmy5r9N/u9F92jMa/N7jyjWna3HKhcq0LJaUuJvx2p7G7WHdZ4/34774f+b3batzc4MpmiDa3XLDMGd/koljOL8coJ4qVdfJxlBPFcn45RjlRrKyTj6OcKJbzyzHKiWJlnXwc5USxnF+OUU4UK+vk4ygniuX8coxyolhZJx9HOVEs55djlBPFyjr5OMqJYjm/HKOcKFbWycfbycm542OVb/jle27jG9X4wqbHU7n96sb6Rm+Q0sYt9ZrEJuf46Zf9dL1NbUo73A+m6m3jvzeqr785/2g7m1G+VCdPIs9+uB2Z0qP+XO/Kdv6dpP6VdnRO6vH72ANNj/TfSOX/cb1N/sjR1A/lXP/w58d/LH8dKRdFx68WF1e+/GL+p/X1tdlhVZ2oqupN1Uu3D37y2fU/H/z+OsptiqnHr6kv2ub0y/7vlyNfnbwzeJeubn7pWUvPll4u/tHWD1Pzp749/339KTgVMEGAAIE9IlDfzqn3qj1yOk6DAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQSOk9xKpKDjCzJAoAAAAASUVORK5CYII="}},function(e){e.O(0,[8487,1315,6649,6922,5049,1626,9250,9111,661,9140,3974,5997,2340,9700,5949,8681,8040,1146,8957,3058,6521],(function(){return t=508303,e(e.s=t);var t})),e.O()}]),"object"==typeof globalThis&&(globalThis.jsExecEndTimeStamp=Date.now(),globalThis.cachedPerformanceEntries||(globalThis.cachedPerformanceEntries=[]),globalThis.cachedPerformanceEntries.push({name:"jsExec: js/public-doc-pc-cd5131dc.js",entryType:"jsExec",startTime:globalThis.jsExecStartTimeStamp,endTime:globalThis.jsExecEndTimeStamp}));
//# sourceMappingURL=public-doc-pc-cd5131dc.js.map