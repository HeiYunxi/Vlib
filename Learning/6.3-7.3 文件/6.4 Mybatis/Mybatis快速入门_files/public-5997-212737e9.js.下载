"object"==typeof globalThis&&(globalThis.jsExecStartTimeStamp=Date.now()),(self.webpackChunkuni=self.webpackChunkuni||[]).push([[5997],{185997:function(e,t,o){o.r(t),o.d(t,{getModules:function(){return c}});var n=o(573595),r=o(911681),i=o(100586),a=o(181060),l=o(723841),s=o(48739);function c(){var e;return(e={})[n.rli]=i.hy,e[n.ybB]=a.Wg,e[r.h9f]=a.Lb,e}l.rX.syncLoad(s.RenderType.Canvas,c)},181060:function(e,t,o){o.d(t,{Lb:function(){return wt},az:function(){return co},xT:function(){return Ve},Wg:function(){return so}});var n=o(839461),r=o(87363),i=o.n(r),a=o(470828),l=o(911681),s="HIDE_SCROLLBAR",c=2;function d(e,t){return e-t>0}var p=function(e){return function(t){function o(e){var o=t.call(this,e)||this;o.mousedownInner=!1,o.scrollerRef=i().createRef(),o.onSelectionChange=function(e){var t,n=o.props.cbKey;(null===(t=o.props)||void 0===t?void 0:t.onSelectionChange)&&o.props.onSelectionChange(e,o.scrollerRef,n,(function(e,t){o.onUpdateRenderInfo(n,e,t)}))},o.onSelectionEnd=function(e){var t,n=e.viewRange,r=n.start,i=n.end;r.gcp===i.gcp&&(null===(t=o.props)||void 0===t?void 0:t.onSelectionEnd)&&o.props.onSelectionEnd(r,o.scrollerRef,(function(e,t,n){o.onUpdateRenderInfo(e,t,n)}))},o.onScroll=function(){o.scrollerRef&&o.scrollerRef.current&&o.onUpdateRenderInfo(o.props.cbKey,o.scrollerRef.current.scrollLeft,o.scrollerRef.current.scrollTop),o.props.onScroll&&o.props.onScroll(o.scrollerRef),o.hideTableBubbleReminder()},o.onMousedownOuter=function(e){o.mousedownInner||e.stopPropagation(),o.mousedownInner=!1,o.hideTableBubbleReminder()},o.onMouseMoveOnWrapper=function(e){o.props.isTable&&(-1!==e.nativeEvent.srcElement.className.indexOf("scroller-default-wrapper")?o.showTableBubbleReminder(e.clientX):o.hideTableBubbleReminder())},o.showTableBubbleReminder=function(e){var t=o.getBubbleReminderPosInfo(e);t&&o.state.enableHScroll&&o.props.context.fire(new l.PvE(t.left,t.top,t.scrollerWidth))},o.hideTableBubbleReminder=function(){o.props.isTable&&o.props.context.fire(new l.ajJ)},o.onMouseMoveLeave=function(){o.hideTableBubbleReminder()},o.onMousedownInner=function(){o.mousedownInner=!0},o.getBubbleReminderPosInfo=function(e){var t;if(!(null===(t=o.scrollerRef)||void 0===t?void 0:t.current))return null;var n=o.props.context,r=n.zoom,i=n.view,a=o.scrollerRef.current.scrollLeft,s=o.scrollerRef.current.getBoundingClientRect(),c=o.props,d=c.rectSize,p=c.contentSize,h=d.width/p.width*d.width,u=a/p.width*d.width,f=(e-s.x)/r;if(f<u||f>u+h)return null;var g=d.height-l.AOE-l.qv2,y=i.getExtendedDom();if(!y)return null;var v=y.getBoundingClientRect();return{scrollerWidth:h,left:(s.left-v.left)/r+u,top:(s.top-v.top)/r+g}};var n=e.scrollLeft,r=e.scrollTop,a=e.hiddenVScroll,s=e.hiddenHScroll;return o.state={left:n,top:r,enableVScroll:!a&&d(o.props.contentSize.height,o.props.rectSize.height),enableHScroll:!s&&d(o.props.contentSize.width,o.props.rectSize.width)},o}return(0,n.__extends)(o,t),o.prototype.onUpdateRenderInfo=function(e,t,o){var n=this.props,r=n.rectSize,i=n.contentSize,a=this.props.shares.renderState,s=a.getScrollerInfo(this.props.cbKey)||{left:0,top:0};s.left=Math.max(Math.min(t,Math.ceil(i.width-r.width)+c),0),s.top=Math.min(o,Math.ceil(i.height-r.height)+c),a.setScrollerInfo(e,s),this.props.context.fire(new l.kv7(!1)),this.props.onWheel&&this.props.onWheel(this.props.cbKey,t,o)},o.getDerivedStateFromProps=function(e){var t=e.scrollLeft,o=e.scrollTop,n=e.hiddenHScroll;return{left:t,top:o,enableVScroll:!e.hiddenVScroll&&d(e.contentSize.height,e.rectSize.height),enableHScroll:!n&&d(e.contentSize.width,e.rectSize.width)}},o.prototype.componentDidUpdate=function(){this.updateScrollInfo()},o.prototype.componentDidMount=function(){this.updateScrollInfo(),this.props.onDidMount&&this.props.onDidMount(this.scrollerRef),this.props.context.on(l.kgn.SELECTION_CHANGE,this.onSelectionChange),this.props.context.on(l.kgn.SELECTION_END,this.onSelectionEnd)},o.prototype.componentWillUnmount=function(){this.props.context.removeCallBack(l.kgn.SELECTION_CHANGE,this.onSelectionChange),this.props.context.removeCallBack(l.kgn.SELECTION_END,this.onSelectionEnd)},o.prototype.updateScrollInfo=function(){this.scrollerRef&&this.scrollerRef.current&&(this.scrollerRef.current.scrollLeft=(0,a.FJ)(this.props.scrollLeft),this.scrollerRef.current.scrollTop=(0,a.FJ)(this.props.scrollTop))},o.prototype.render=function(){var t=this.props,o=t.rectSize,r=t.contentSize,s=t.layoutBox,d=(0,a.FJ)(s.edge.border.width.left),p=(0,a.FJ)(s.edge.border.width.top),h=this.getScrollOverflowStyle(),u={overflowX:h.overflowX,overflowY:h.overflowY,width:"".concat(o.width+d+(this.state.enableVScroll?8:0),"px"),height:"".concat(o.height+p+(this.state.enableHScroll?8:0),"px")},f=r.width+(this.state.enableHScroll?c:0),g=r.height+(this.state.enableVScroll?c:0);return i().createElement("div",{key:"".concat(this.props.cbKey,"-wrapper"),style:u,className:"".concat(l.F51.scrollerDefaultWrapper," ").concat(this.sideClassName()," ").concat(this.scrollbarClassName()),onMouseDown:this.onMousedownOuter,onMouseMove:this.onMouseMoveOnWrapper,onMouseLeave:this.onMouseMoveLeave,onScroll:this.onScroll,ref:this.scrollerRef},i().createElement("div",{onMouseDown:this.onMousedownInner},i().createElement(e,(0,n.__assign)({},this.props,{contentSize:{width:f,height:g},scrollLeft:this.state.left,scrollTop:this.state.top}))))},o.prototype.getScrollOverflowStyle=function(){var e={overflowX:"hidden",overflowY:"hidden"};return this.state.enableHScroll&&(e.overflowX="auto"),this.state.enableVScroll&&(e.overflowY="auto"),e},o.prototype.scrollbarClassName=function(){var e="";return this.props.isTable&&!this.props.isTableActivited&&(e=s),e},o.prototype.sideClassName=function(){var e="",t=this.props,o=t.rectSize,n=t.contentSize;if(!this.state.enableHScroll||!this.props.isTable)return e;var r=Math.round((0,a.FJ)(this.props.scrollLeft));return Math.round(n.width-o.width)-r>0&&(e="".concat(l.F51.tableScrollerRightShadow," ").concat(e)),0!==r&&(e="".concat(l.F51.tableScrollerLeftShadow," ").concat(e)),e},o}(i().Component)},h=o(573595),u=o(48739),f=o(60538);function g(e,t){for(var o=Object.keys(t),n=0;n<o.length;n++)e=e.replace(new RegExp("\\{".concat(o[n],"\\}"),"gi"),t[o[n]]);return e}function y(e){if(!e)throw new Error("cannot create a random attribute name for an undefined object");var t="ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",o="";do{o="";for(var n=0;n<12;n++)o+=t[Math.floor(51*Math.random())]}while(e[o]);return o}function v(e){var t={alphabetic:"alphabetic",hanging:"hanging",top:"text-before-edge",bottom:"text-after-edge",middle:"central"};return t[e]||t.alphabetic}function x(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]);return[e[0]/t,e[1]/t]}var m=function(e,t){var o={},n=e.split(",");t=t||10;for(var r=0;r<n.length;r+=2){var i="&".concat(n[r+1],";"),a=parseInt(n[r],t);o[i]="&#".concat(a,";")}return o["\\xa0"]="&#160;",o}("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32),w={strokeStyle:{svgAttr:"stroke",canvas:"#000000",svg:"none",apply:"stroke"},fillStyle:{svgAttr:"fill",canvas:"#000000",svg:null,apply:"fill"},lineCap:{svgAttr:"stroke-linecap",canvas:"butt",svg:"butt",apply:"stroke"},lineJoin:{svgAttr:"stroke-linejoin",canvas:"miter",svg:"miter",apply:"stroke"},miterLimit:{svgAttr:"stroke-miterlimit",canvas:10,svg:4,apply:"stroke"},lineWidth:{svgAttr:"stroke-width",canvas:1,svg:1,apply:"stroke"},globalAlpha:{svgAttr:"opacity",canvas:1,svg:1,apply:"fill stroke"},font:{canvas:"10px sans-serif"},shadowColor:{canvas:"#000000"},shadowOffsetX:{canvas:0},shadowOffsetY:{canvas:0},shadowBlur:{canvas:0},textAlign:{canvas:"start"},textBaseline:{canvas:"alphabetic"},lineDash:{svgAttr:"stroke-dasharray",canvas:"",svg:null,apply:"stroke"}},S=function(){function e(e,t){this.root=e,this.ctx=t}return e.prototype.setTransform=function(e){},e}(),C=function(){function e(e,t){this.root=e,this.ctx=t}return e.prototype.addColorStop=function(e,t){},e}(),b=function(){function e(e,t,o,n){var r=500,i=500;this.width=t||r,this.height=o||i,this._document=n||document,this.canvas=this._document.createElement("canvas"),this._ctx=this.canvas.getContext("2d"),this._setDefaultStyles(),this._stack=[this._getStyleState()],this._groupStack=[],e?this._root=e:(this._root=this._document.createElementNS("http://www.w3.org/2000/svg","svg"),this._root.setAttribute("version","1.1"),this._root.setAttribute("xmlns","http://www.w3.org/2000/svg"),this._root.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),this._root.setAttribute("width","".concat(this.width)),this._root.setAttribute("height","".concat(this.height))),this._ids={},this._defs=this._document.createElementNS("http://www.w3.org/2000/svg","defs"),this._root.appendChild(this._defs),this._currentElement=this._document.createElementNS("http://www.w3.org/2000/svg","g"),this._root.appendChild(this._currentElement),this._clipPathMap=new Map}return Object.defineProperty(e.prototype,"fontProp",{get:function(){return(0,n.__assign)({},this._fontProp)},set:function(e){this._fontProp=(0,n.__assign)({},e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"strokeStyle",{get:function(){return this._strokeStyle},set:function(e){this._strokeStyle="auto"!==e?e:"rgb(0, 0, 0)"},enumerable:!1,configurable:!0}),e.prototype.ellipse=function(e,t,o,n,r,i,a,l){throw new Error("Method not implemented.")},e.prototype.getTransform=function(){throw new Error("Method not implemented.")},e.prototype.resetTransform=function(){throw new Error("Method not implemented.")},e.prototype.setTransform=function(e,t,o,n,r,i){throw new Error("Method not implemented.")},e.prototype.drawFocusIfNeeded=function(e,t){throw new Error("Method not implemented.")},e.prototype.scrollPathIntoView=function(e){throw new Error("Method not implemented.")},e.prototype._createElement=function(e,t,o){void 0===t&&(t={});var n=this._document.createElementNS("http://www.w3.org/2000/svg",e),r=Object.keys(t);o&&(n.setAttribute("fill","none"),n.setAttribute("stroke","none"));for(var i=0;i<r.length;i++){var a=r[i];n.setAttribute(a,t[a])}return n},e.prototype._setDefaultStyles=function(){for(var e=Object.keys(w),t=0;t<e.length;t++){var o=e[t];this[o]=w[o].canvas}},e.prototype._applyStyleState=function(e){for(var t=Object.keys(e),o=0;o<t.length;o++){var n=t[o];this[n]=e[n]}},e.prototype._getStyleState=function(){for(var e={},t=Object.keys(w),o=0;o<t.length;o++){var n=t[o];e[n]=this[n]}return e},e.prototype._applyStyleToCurrentElement=function(e){var t=this._currentElement,o=this._currentElementsToStyle;if(o&&(null==t||t.setAttribute(e,""),t=o.element,o.children.forEach((function(t){t.setAttribute(e,"")}))),t)for(var n=Object.keys(w),r=0;r<n.length;r++){var i=w[n[r]],a=this[n[r]];if(i.apply)if(a instanceof S){if(a.ctx)for(;a.ctx._defs.childNodes.length;){var l=a.ctx._defs.childNodes[0].getAttribute("id");l&&(this._ids[l]=l,this._defs.appendChild(a.ctx._defs.childNodes[0]),a.ctx._defs.removeChild(a.ctx._defs.childNodes[0]))}t.setAttribute(i.apply,g("url(#{id})",{id:a.root.getAttribute("id")}))}else if(a instanceof C)t.setAttribute(i.apply,g("url(#{id})",{id:a.root.getAttribute("id")}));else if(-1!==i.apply.indexOf(e)&&i.svg!==a)if("stroke"!==i.svgAttr&&"fill"!==i.svgAttr||-1===a.indexOf("rgba")){var s=i.svgAttr;if("globalAlpha"===n[r]&&(s="".concat(e,"-").concat(i.svgAttr),t.getAttribute(s)))continue;t.setAttribute(s,a)}else{var c=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi.exec(a);if(c){t.setAttribute(i.svgAttr,g("rgb({r},{g},{b})",{r:c[1],g:c[2],b:c[3]}));var d=parseFloat(c[4]),p=this.globalAlpha;null!==p&&(d*=p),t.setAttribute("".concat(i.svgAttr,"-opacity"),"".concat(d))}}}},e.prototype._closestGroupOrSvg=function(e){return"g"===(null==(e=e||this._currentElement)?void 0:e.nodeName)||"svg"===(null==e?void 0:e.nodeName)?e:this._closestGroupOrSvg(null==e?void 0:e.parentNode)},e.prototype.getSerializedSvg=function(e){var t=(new XMLSerializer).serializeToString(this._root);if(/xmlns="http:\/\/www\.w3\.org\/2000\/svg".+xmlns="http:\/\/www\.w3\.org\/2000\/svg/gi.test(t)&&(t=t.replace('xmlns="http://www.w3.org/2000/svg','xmlns:xlink="http://www.w3.org/1999/xlink')),e)for(var o=Object.keys(m),n=0;n<o.length;n++){var r=o[n],i=m[r],a=new RegExp(r,"gi");a.test(t)&&(t=t.replace(a,i))}return t},e.prototype.getSvg=function(){return this._root},e.prototype.save=function(){var e=this._createElement("g"),t=this._closestGroupOrSvg();this._groupStack.push(t),t.appendChild(e),this._currentElement=e,this._stack.push(this._getStyleState())},e.prototype.restore=function(){this._currentElement=this._groupStack.pop(),this._currentElementsToStyle=null,this._currentElement||(this._currentElement=this._root.childNodes[1]);var e=this._stack.pop();this._applyStyleState(e)},e.prototype._addTransform=function(e){var t,o,n,r=this._closestGroupOrSvg();if(r.childNodes.length>0){"path"===(null===(t=this._currentElement)||void 0===t?void 0:t.nodeName)&&(this._currentElementsToStyle||(this._currentElementsToStyle={element:r,children:[]}),this._currentElementsToStyle.children.push(this._currentElement),this._applyCurrentDefaultPath());var i=this._createElement("g");r.appendChild(i),this._currentElement=i}var a=null===(o=this._currentElement)||void 0===o?void 0:o.getAttribute("transform");a?a+=" ":a="",a+=e,null===(n=this._currentElement)||void 0===n||n.setAttribute("transform",a)},e.prototype.scale=function(e,t){void 0===t&&(t=e),this._addTransform(g("scale({x},{y})",{x:e,y:t}))},e.prototype.rotate=function(e){if(0!==e){var t=180*e/Math.PI;this._addTransform(g("rotate({angle},{cx},{cy})",{angle:t,cx:0,cy:0}))}},e.prototype.translate=function(e,t){0===e&&0===t||this._addTransform(g("translate({x},{y})",{x:e,y:t}))},e.prototype.transform=function(e,t,o,n,r,i){this._addTransform(g("matrix({a},{b},{c},{d},{e},{f})",{a:e,b:t,c:o,d:n,e:r,f:i}))},e.prototype.beginPath=function(){this._currentDefaultPath="",this._currentPosition={x:0,y:0};var e=this._createElement("path",{},!0);this._closestGroupOrSvg().appendChild(e),this._currentElement=e},e.prototype._applyCurrentDefaultPath=function(){var e=this._currentElement;"path"===(null==e?void 0:e.nodeName)?e.setAttribute("d",this._currentDefaultPath):console.error("Attempted to apply path command to node",null==e?void 0:e.nodeName)},e.prototype._addPathCommand=function(e){this._currentDefaultPath+=" ",this._currentDefaultPath+=e},e.prototype.moveTo=function(e,t){var o;"path"!==(null===(o=this._currentElement)||void 0===o?void 0:o.nodeName)&&this.beginPath(),this._currentPosition={x:e,y:t},this._addPathCommand(g("M {x} {y}",{x:e,y:t}))},e.prototype.closePath=function(){this._currentDefaultPath&&this._addPathCommand("Z")},e.prototype.lineTo=function(e,t){this._currentPosition={x:e,y:t},this._currentDefaultPath.indexOf("M")>-1?this._addPathCommand(g("L {x} {y}",{x:e,y:t})):this._addPathCommand(g("M {x} {y}",{x:e,y:t}))},e.prototype.bezierCurveTo=function(e,t,o,n,r,i){this._currentPosition={x:r,y:i},this._addPathCommand(g("C {cp1x} {cp1y} {cp2x} {cp2y} {x} {y}",{cp1x:e,cp1y:t,cp2x:o,cp2y:n,x:r,y:i}))},e.prototype.quadraticCurveTo=function(e,t,o,n){this._currentPosition={x:o,y:n},this._addPathCommand(g("Q {cpx} {cpy} {x} {y}",{cpx:e,cpy:t,x:o,y:n}))},e.prototype.arcTo=function(e,t,o,r,i){var a=this._currentPosition&&this._currentPosition.x,l=this._currentPosition&&this._currentPosition.y;if(void 0!==a&&void 0!==l){if(i<0)throw new Error("IndexSizeError: The radius provided (".concat(i,") is negative."));if(a===e&&l===t||e===o&&t===r||0===i)this.lineTo(e,t);else{var s=x([a-e,l-t]),c=x([o-e,r-t]);if(s[0]*c[1]!=s[1]*c[0]){var d=s[0]*c[0]+s[1]*c[1],p=Math.acos(Math.abs(d)),h=x([s[0]+c[0],s[1]+c[1]]),u=i/Math.sin(p/2),f=e+u*h[0],g=t+u*h[1],y=[-s[1],s[0]],v=[c[1],-c[0]],m=S(y),w=S(v);this.lineTo(f+y[0]*i,g+y[1]*i),this.arc(f,g,i,m,w)}else this.lineTo(e,t)}}function S(e){var t=(0,n.__read)(e,2),o=t[0];return t[1]>=0?Math.acos(o):-Math.acos(o)}},e.prototype.stroke=function(){var e;"path"===(null===(e=this._currentElement)||void 0===e?void 0:e.nodeName)&&this._currentElement.setAttribute("paint-order","fill stroke markers"),this._applyCurrentDefaultPath(),this._applyStyleToCurrentElement("stroke")},e.prototype.fill=function(){var e;"path"===(null===(e=this._currentElement)||void 0===e?void 0:e.nodeName)&&this._currentElement.setAttribute("paint-order","stroke fill markers"),this._applyCurrentDefaultPath(),this._applyStyleToCurrentElement("fill")},e.prototype.rect=function(e,t,o,n){var r;"path"!==(null===(r=this._currentElement)||void 0===r?void 0:r.nodeName)&&this.beginPath(),this.moveTo(e,t),this.lineTo(e+o,t),this.lineTo(e+o,t+n),this.lineTo(e,t+n),this.lineTo(e,t),this.closePath()},e.prototype.fillRect=function(e,t,o,n){var r=this._createElement("rect",{x:e,y:t,width:o,height:n},!0);this._closestGroupOrSvg().appendChild(r),this._currentElement=r,this._applyStyleToCurrentElement("fill")},e.prototype.strokeRect=function(e,t,o,n){var r=this._createElement("rect",{x:e,y:t,width:o,height:n},!0);this._closestGroupOrSvg().appendChild(r),this._currentElement=r,this._applyStyleToCurrentElement("stroke")},e.prototype._clearCanvas=function(){for(var e=this._closestGroupOrSvg().getAttribute("transform"),t=this._root.childNodes[1],o=t.childNodes,n=o.length-1;n>=0;n--)o[n]&&t.removeChild(o[n]);this._currentElement=t,this._groupStack=[],e&&this._addTransform(e)},e.prototype.clearRect=function(e,t,o,n){if(0!==e||0!==t||o!==this.width||n!==this.height){var r=this._closestGroupOrSvg(),i=this._createElement("rect",{x:e,y:t,width:o,height:n,fill:"#FFFFFF"},!0);r.appendChild(i)}else this._clearCanvas()},e.prototype.createLinearGradient=function(e,t,o,n){var r=this._createElement("linearGradient",{id:y(this._ids),x1:"".concat(e,"px"),x2:"".concat(o,"px"),y1:"".concat(t,"px"),y2:"".concat(n,"px"),gradientUnits:"userSpaceOnUse"},!1);return this._defs.appendChild(r),new C(r,this)},e.prototype.createRadialGradient=function(e,t,o,n,r,i){var a=this._createElement("radialGradient",{id:y(this._ids),cx:"".concat(n,"px"),cy:"".concat(r,"px"),r:"".concat(i,"px"),fx:"".concat(e,"px"),fy:"".concat(t,"px"),gradientUnits:"userSpaceOnUse"},!1);return this._defs.appendChild(a),new C(a,this)},e.prototype._applyText=function(e,t,o,n){var r,i,a=this._closestGroupOrSvg(),l=this._createElement("text",{"font-family":this.fontProp.fontFamily,"font-size":this.fontProp.fontSize,"font-style":this.fontProp.fontStyle,"font-weight":this.fontProp.fontWeight,"letter-spacing":this.fontProp.letterSpacing,"font-scaling":this.fontProp.fontScaling,x:t,y:o,"text-anchor":(r=this.textAlign,i={left:"start",right:"end",center:"middle",start:"start",end:"end"},i[r]||i.start),"dominant-baseline":v(this.textBaseline)},!0);l.innerHTML=this.replaceText(e),this._currentElement=l,this._applyStyleToCurrentElement(n),a.appendChild(l)},e.prototype.replaceText=function(e){return(0,a.r)(e).replace(/\s/g,"&nbsp;")},e.prototype.fillText=function(e,t,o){this._applyText(e,t,o,"fill")},e.prototype.strokeText=function(e,t,o){this._applyText(e,t,o,"stroke")},e.prototype.measureText=function(e){return this._ctx.font=this.font,this._ctx.measureText(e)},e.prototype.arc=function(e,t,o,n,r,i){if(n!==r){(n%=2*Math.PI)==(r%=2*Math.PI)&&(r=(r+2*Math.PI-.001*(i?-1:1))%(2*Math.PI));var a=e+o*Math.cos(r),l=t+o*Math.sin(r),s=e+o*Math.cos(n),c=t+o*Math.sin(n),d=i?0:1,p=0,h=r-n;h<0&&(h+=2*Math.PI),p=i?h>Math.PI?0:1:h>Math.PI?1:0,this.lineTo(s,c),this._addPathCommand(g("A {rx} {ry} {xAxisRotation} {largeArcFlag} {sweepFlag} {endX} {endY}",{rx:o,ry:o,xAxisRotation:0,largeArcFlag:p,sweepFlag:d,endX:a,endY:l})),this._currentPosition={x:a,y:l}}},e.prototype.clip=function(){if(this._currentElement&&"path"===this._currentElement.nodeName){this._applyCurrentDefaultPath();var e=this._closestGroupOrSvg();e.removeChild(this._currentElement);var t=this._clipPathMap.get(this._currentElement.outerHTML);if(!t){var o=this._createElement("clipPath");t=y(this._ids),o.setAttribute("id",t),o.appendChild(this._currentElement),this._defs.appendChild(o),this._clipPathMap.set(o.innerHTML,t)}e.setAttribute("clip-path",g("url(#{id})",{id:t}));var n=this._createElement("g");e.appendChild(n),this._currentElement=n}},e.prototype.drawImage=function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];var r,i,a,l,s,c,d=(0,n.__read)(t,1)[0],p=0,h=0;if(3===t.length)r=t[1],i=t[2],a=s=d.width,l=c=d.height;else if(5===t.length)r=t[1],i=t[2],a=t[3],l=t[4],s=d.width,c=d.height;else{if(9!==t.length)throw new Error("Invalid number of arguments passed to drawImage: ".concat(arguments.length));p=t[1],h=t[2],s=t[3],c=t[4],r=t[5],i=t[6],a=t[7],l=t[8]}var u=this._closestGroupOrSvg(),f="translate(".concat(r,", ").concat(i,")");if(d instanceof e){var g=d.getSvg().cloneNode(!0);if(g.childNodes&&g.childNodes.length>1){for(var y=g.childNodes[0];y.childNodes.length;){var v=y.childNodes[0],x=v.getAttribute("id");x&&(this._ids[x]=x),this._defs.appendChild(v)}var m=g.childNodes[1];if(m){var w=m.getAttribute("transform"),S=void 0;S=w?"".concat(w," ").concat(f):f,m.setAttribute("transform",S),u.appendChild(m)}}}else if("CANVAS"===d.nodeName||"IMG"===d.nodeName){var C=this._createElement("image");if(C.setAttribute("width","".concat(a)),C.setAttribute("height","".concat(l)),C.setAttribute("preserveAspectRatio","none"),p||h||s!==d.width||c!==d.height){var b=this._document.createElement("canvas");if(b){b.width=a,b.height=l;var _=b.getContext("2d");_&&_.drawImage(d,p,h,s,c,0,0,a,l),d=b}}C.setAttribute("transform",f),C.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","CANVAS"===d.nodeName?d.toDataURL():d.getAttribute("src")),u.appendChild(C)}else"image"===d.nodeName&&(d.setAttribute("transform",f),u.appendChild(d))},e.prototype.createPattern=function(t,o){var n,r=this._document.createElementNS("http://www.w3.org/2000/svg","pattern"),i=y(this._ids);return r.setAttribute("id",i),r.setAttribute("width","".concat(t.width)),r.setAttribute("height","".concat(t.height)),"CANVAS"===t.nodeName&&"IMG"===t.nodeName?((n=this._document.createElementNS("http://www.w3.org/2000/svg","image")).setAttribute("width","".concat(t.width)),n.setAttribute("height","".concat(t.height)),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","CANVAS"===t.nodeName?t.toDataURL():t.getAttribute("src")),r.appendChild(n),this._defs.appendChild(r)):t instanceof e&&(r.appendChild(t._root.childNodes[1]),this._defs.appendChild(r)),new S(r,this)},Object.defineProperty(e.prototype,"lineDash",{get:function(){var e;return(null===(e=this._lineDash)||void 0===e?void 0:e.length)>0?this._lineDash.join(","):""},set:function(e){e&&(this._lineDash=e.split(",").map((function(e){return Number(e)})))},enumerable:!1,configurable:!0}),e.prototype.getLineDash=function(){return(0,n.__spreadArray)([],(0,n.__read)(this._lineDash),!1)},e.prototype.setLineDash=function(e){this._lineDash=(0,n.__spreadArray)([],(0,n.__read)(e),!1)},e}(),_=function(){function e(e){this.renderCtx=e}return e.canvasContext=function(e,t){if(!e)return null;if(t===h.LgD.Canvas)return e.getContext("2d");if(t===h.LgD.Svg){var o=e.__context__;return o||(o=new b(e),e.__context__=o),o}return null},e.prototype.clearRenderer=function(e,t,o,n){},e.prototype.render=function(e){var t=this,o=e.collector,n=e.priority,r=e.context;if(this.renderCtx.darkMode=r.docEnv.darkMode,o.hasRenderInfo(n)){var i=this.renderingContext2D;if(i){var a=o.renderInfos(n);Object.keys(a).sort().forEach((function(e){var o,n=a[e];0!==n.length&&(t.setContextClipInfo(i,null===(o=n[0].contextState)||void 0===o?void 0:o.clipInfo),t.startRenderViews(i,n),n.forEach((function(e){t.renderView(i,e,r),e.recycle()})),t.finishRenderViews(i,n))}))}}},e.prototype.resetRenderContext=function(e,t){void 0===t&&(t={}),e.fillStyle=t.defultFillStyle||"rgb(0, 0, 0)",e.strokeStyle="rgb(0, 0, 0)",t.defaultFont&&e.font!==t.defaultFont&&(e.font=t.defaultFont),e.lineWidth=1,e.globalAlpha=1},e.prototype.startRenderViews=function(e,t){this.resetRenderContext(e)},e.prototype.finishRenderViews=function(e,t){},e.prototype.setContextClipInfo=function(e,t){var o=this.lastClipInfo;this.needClip(t,o)&&(o&&e.restore(),e.save(),this.lastClipInfo=t,t&&(e.beginPath(),e.rect(Math.floor((0,a.FJ)(t.x)),Math.floor((0,a.FJ)(t.y)),Math.ceil((0,a.FJ)(t.width)),Math.ceil((0,a.FJ)(t.height))),e.clip())),!t&&o&&(this.lastClipInfo=void 0,e.restore())},e.prototype.needClip=function(e,t){return!(!e||t===e||t&&(0,l.B8I)(e,t))},Object.defineProperty(e.prototype,"renderingContext2D",{get:function(){return e.canvasContext(this.renderCtx.mainView,this.renderCtx.renderDevice)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"renderingMainView",{get:function(){return this.renderCtx.mainView},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"contextState",{get:function(){return this.renderCtx.mainCtxState},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastClipInfo",{get:function(){return this.contextState.clipInfo},set:function(e){this.contextState.clipInfo=e},enumerable:!1,configurable:!0}),e}(),P=_,R=o(100586),T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),t.prototype.computeClippedStyles=function(e,t,o,n){var r,i,l=this.getClipPath(e,o),s=this.props.zoom||1,c=(0,a.FJ)(o?o.width:e.width),d=(0,a.FJ)(e.height),p={overflow:l?"hidden":"visible",top:(0,a.FJ)(e.y+t.y),left:(0,a.FJ)((o?o.x:e.x)+t.x),width:"".concat(c,"px"),height:"".concat(d,"px"),clipPath:l};return"MENTION_QQ"===(null===(i=null===(r=null==n?void 0:n.props)||void 0===r?void 0:r.layoutBox)||void 0===i?void 0:i.subType)&&(p.overflow="visible"),{style:p,marginStyle:{marginTop:0,marginLeft:o?-(0,a.FJ)(Math.abs(o.x-e.x))*s:0}}},t.prototype.updateViewMap=function(e){this.setState({viewMap:new Map((0,n.__spreadArray)([],(0,n.__read)(e),!1).sort((function(e,t){return e[0]-t[0]})))})},t.prototype.getViewMap=function(){var e;return new Map(null===(e=this.state)||void 0===e?void 0:e.viewMap)},t.prototype.render=function(){var e;return i().createElement("div",null,this.componentElements(null===(e=this.state)||void 0===e?void 0:e.viewMap))},t.prototype.getClipPath=function(e,t){if(!t)return"";var o=(0,a.FJ)(t.y-e.y),n=(0,a.FJ)(e.height-t.height),r=(0,a.FJ)(t.x-e.x),i=(0,a.FJ)(e.width-t.width),l="inset(".concat(o,"px 0 ").concat(n-o,"px 0)");return o<.01&&n<.01&&r<.01&&i<.01?void 0:l},t.prototype.componentElement=function(e){var t=e.frame,o=e.content,r=e.offset,a=e.key,s=e.style,c=e.contextState,d=this.computeClippedStyles(t,r,null==c?void 0:c.clipInfo,o),p=d.style,h=d.marginStyle;return i().createElement("div",{key:a,style:(0,n.__assign)((0,n.__assign)({position:"absolute",pointerEvents:this.props.disabled?"none":"auto"},l.vW8.cssPropsToStyle(s)),p)},i().createElement("div",{style:(0,n.__assign)((0,n.__assign)({},h),{height:"100%"})},o))},t.prototype.componentElementLayer=function(e,t){var o=this,r=(0,n.__spreadArray)([],(0,n.__read)(e.values()),!1).map((function(e){return o.componentElement(e)}));return i().createElement("div",{className:"render-priority-".concat(t),key:t},r)},t.prototype.componentElements=function(e){var t=this;if(!e)return[];var o=[];return e.forEach((function(e,n){o.push(t.componentElementLayer(e,n))})),o},t}(i().Component),E=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),t.prototype.updateAddonViewOffset=function(e){var t,o,r;if(null===(r=this.state)||void 0===r?void 0:r.viewMap){var i=this.state.viewMap,a=i.get(l._AL.componentElement);if(a){try{for(var s=(0,n.__values)(a),c=s.next();!c.done;c=s.next()){var d=(0,n.__read)(c.value,2),p=d[0],u=d[1],f=u.content.props.layoutBox,g=f.edge.margin,y=f.getAncestorOf(h.uOS.Page);if(y&&e.includes(y.getSiblingIndex())){var v=R.MM.getOffsetPoint(f,h.uOS.Document),x=v.x,m=v.y;x+=g.left,m+=g.top,u.frame.x=x,u.frame.y=m,a.set(p,u)}}}catch(e){t={error:e}}finally{try{c&&!c.done&&(o=s.return)&&o.call(s)}finally{if(t)throw t.error}}i.set(l._AL.componentElement,a),this.setState({viewMap:i})}}},t.prototype.render=function(){var e,t;return i().createElement("div",null,(null===(e=this.state)||void 0===e?void 0:e.viewMap)?this.addonComponentElements(null===(t=this.state)||void 0===t?void 0:t.viewMap):"")},t.prototype.addonComponentElements=function(e){var t=this,o=e.get(l._AL.componentElement);return o?(0,n.__spreadArray)([],(0,n.__read)(o.values()),!1).map((function(e){return t.componentElement(e)})):[]},t}(T),B=function(e){function t(t){var o=e.call(this,t)||this;return o.pageComponentViewMap=new Map,o.addonViewMap=new Map,o.pageAddonViewMap=new Map,o}return(0,n.__extends)(t,e),t.prototype.render=function(e){var t,o,n=e.collector,r=e.priority,i=e.pageIndex,a=e.lastPageIndex,l=e.isLastRenderPage,s=e.isSubPageRender,c=e.collectRect;if(this.needUpdate=this.updateComponentElement({collector:n,priority:r,pageIndex:i,isSubPageRender:s,collectRect:c})||this.needUpdate,f.nU.getHighestPrioritys()===r){var d=null===(t=this.renderCtx.containerLayer)||void 0===t?void 0:t.rootElements[i],p=null===(o=this.renderCtx.addonViewLayer)||void 0===o?void 0:o.rootElements[0];if(!this.needUpdate)return;if(d instanceof T){var h=this.pageComponentViewMap.get(i);d.updateViewMap(new Map(h))}p instanceof T&&l&&(this.mergeAddonViewMap(a||0),p.updateViewMap(new Map(this.addonViewMap))),this.needUpdate=!1}},t.prototype.updateComponentElement=function(e){var t,o=e.collector,n=e.priority,r=e.behind,i=e.pageIndex,a=e.isSubPageRender,s=e.collectRect,c=o.renderInfos(n),d=Object.keys(c),p=d&&d.length>0?c[d[0]]:[];p=this.getFilteredComponentViews({componentViews:p,behind:r});var h=new Map;if(n===l._AL.componentElement){this.filterAddonComponentViews(p).forEach((function(e){h.has(e.key)||h.set(e.key,e)}));var u=new Map;if(a&&s){var f=null===(t=this.pageAddonViewMap.get(i))||void 0===t?void 0:t.get(n);this.saveReusedViews(h,s,f)}u.set(n,h),this.pageAddonViewMap.set(i,u)}var g=new Map,y=this.getContainerViews({priority:n,pageIndex:i});return null==y||y.forEach((function(e){g.set(e.key,e)})),p.forEach((function(e){h.has(e.key)||g.set(e.key,e)})),this.setContainerViews({priority:n,views:g,pageIndex:i,behind:r}),!0},t.prototype.clearRenderer=function(e,t,o,n){var r=new Map;if(n&&o){var i=this.getContainerViews({pageIndex:t,priority:e});this.saveReusedViews(r,o,i)}this.setContainerViews({priority:e,pageIndex:t,views:r})},t.prototype.getContainerViews=function(e){var t,o=e.priority,n=e.pageIndex;return null===(t=this.pageComponentViewMap.get(n))||void 0===t?void 0:t.get(o)},t.prototype.setContainerViews=function(e){var t,o=e.priority,n=e.views,r=e.pageIndex;if(this.pageComponentViewMap.has(r))null===(t=this.pageComponentViewMap.get(r))||void 0===t||t.set(o,n);else{var i=new Map;i.set(o,n),this.pageComponentViewMap.set(r,i)}},t.prototype.getFilteredComponentViews=function(e){return e.componentViews},t.prototype.saveReusedViews=function(e,t,o){null==o||o.forEach((function(o){var n,r=null===(n=null==o?void 0:o.contextState)||void 0===n?void 0:n.clipInfo,i={x:(r?r.x:o.frame.x)+o.offset.x,y:(r?r.y:o.frame.y)+o.offset.y,width:r?r.width:o.frame.width,height:r?r.height:o.frame.height};(0,l.UHV)((0,l.Aa5)(t,i))||e.set(o.key,o)}))},t.prototype.filterAddonComponentViews=function(e){return e.filter((function(e){var t,o=null===(t=e.content.props)||void 0===t?void 0:t.layoutBox;return(0,h.eJq)(o)&&o.independentRender}))},t.prototype.mergeAddonViewMap=function(e){var t,o,r=new Map;try{for(var i=(0,n.__values)(this.pageAddonViewMap),a=i.next();!a.done;a=i.next()){var s=(0,n.__read)(a.value,2),c=s[0],d=s[1];if(c>e)this.pageAddonViewMap.delete(c);else{var p=d.get(l._AL.componentElement);p&&p.forEach((function(e){r.has(e.key)||r.set(e.key,e)}))}}}catch(e){t={error:e}}finally{try{a&&!a.done&&(o=i.return)&&o.call(i)}finally{if(t)throw t.error}}this.setAddonViews({priority:l._AL.componentElement,views:r})},t.prototype.setAddonViews=function(e){var t=e.priority,o=e.views;this.addonViewMap.set(t,o)},t.prototype.renderView=function(e,t){throw new Error("Method not implemented.")},t}(P),I=B,F=o(234272),M=o.n(F),L=function(e){var t=e.views,o=e.componentElement,r=(0,n.__spreadArray)([],(0,n.__read)(t.values()),!1)[0];if(!r||!r.pagesInfo)return i().createElement(i().Fragment,null);var a=r.pagesInfo,l=a.pageSize,s=a.pageIndex,c=[];t.forEach((function(e){var t=o(e);c.push(t)}));var d=function(e,t,o){return i().createElement("div",{key:o,style:{width:"".concat(t.width,"px"),height:"".concat(t.height,"px"),background:"rgba(0, 0, 0, 0)",position:"relative",pointerEvents:"none"}},e)}(c,l,"page-container-".concat(s));return i().createElement("div",{style:{position:"absolute",pointerEvents:"none"}},d)};L.propTypes={views:M().instanceOf(Map).isRequired,componentElement:M().func.isRequired};var O,k=L,A=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),t.prototype.componentElementLayer=function(e){return i().createElement(k,{views:e,componentElement:this.componentElement.bind(this)})},t.prototype.render=function(){var e;return i().createElement(i().Fragment,null,i().createElement("div",null,this.componentElements(null===(e=this.state)||void 0===e?void 0:e.viewMap)))},t}(T),D=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.pageUpperViewMap=new Map,t.pageLowerViewMap=new Map,t}return(0,n.__extends)(t,e),t.prototype.getContainerViews=function(e){var t,o,n=e.priority,r=e.behind,i=e.pageIndex;return r?null===(t=this.pageLowerViewMap.get(i))||void 0===t?void 0:t.get(n):null===(o=this.pageUpperViewMap.get(i))||void 0===o?void 0:o.get(n)},t.prototype.setContainerViews=function(e){var t,o=e.priority,n=e.views,r=e.behind,i=e.pageIndex,a=r?this.pageLowerViewMap:this.pageUpperViewMap;if(a.has(i))null===(t=a.get(i))||void 0===t||t.set(o,n);else{var l=new Map;l.set(o,n),a.set(i,l)}},t.prototype.getFilteredComponentViews=function(e){var t=e.componentViews,o=e.behind;return t.filter((function(e){return Boolean(e.behindDoc)===Boolean(o)}))},t.prototype.updateComponentElement=function(t){return t.priority===l.Ypk.UpperDefault&&e.prototype.updateComponentElement.call(this,t)},t.prototype.render=function(e){var t,o,n=e.collector,r=e.priority,i=e.pageIndex;this.needUpdateUpper=this.updateComponentElement({pageIndex:i,collector:n,priority:r})||this.needUpdateUpper,this.needUpdateLower=this.updateComponentElement({pageIndex:i,collector:n,priority:r,behind:!0})||this.needUpdateLower;var a=null===(t=this.renderCtx.upperAnchorLayer)||void 0===t?void 0:t.rootElements[i],l=null===(o=this.renderCtx.lowerAnchorLayer)||void 0===o?void 0:o.rootElements[i];if(a instanceof A&&this.needUpdateUpper){var s=this.pageUpperViewMap.get(i);a.updateViewMap(new Map(s)),this.needUpdateUpper=!1}if(l instanceof A&&this.needUpdateLower){var c=this.pageLowerViewMap.get(i);l.updateViewMap(new Map(c)),this.needUpdateLower=!1}},t}(I),V=D,z=function(){function e(){}return e.canvasScaleRatio=function(e){return(window.devicePixelRatio||1)/(e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1)},e}(),W=h.LgD.Canvas;!function(e){e[e.BehindView=1]="BehindView",e[e.LowerAnchorView=11]="LowerAnchorView",e[e.MainView=21]="MainView",e[e.GapView=22]="GapView",e[e.ContainerView=31]="ContainerView",e[e.UpperAnchorView=41]="UpperAnchorView",e[e.FrontView=51]="FrontView",e[e.PrintCover=61]="PrintCover"}(O||(O={}));var H,j,N="invert(1) hue-rotate(180deg)",U=function(){function e(e,t,o,n){void 0===n&&(n=1),this.width=e,this.style=t,this.color=o,this.opacity=n}return e.newInstance=function(t){var o=t.style,n=t.width,r=t.color,i=t.opacity,a=this.pool.shift(),l="";return(null==r?void 0:r.hex)?l=r.hex:(null==r?void 0:r.rgba)&&(l="rgba(".concat(null==r?void 0:r.rgba.red,",").concat(null==r?void 0:r.rgba.green,",").concat(null==r?void 0:r.rgba.blue,",").concat(null==r?void 0:r.rgba.alpha,")")),a?(a.width=n,a.style=o,a.color=l,a.opacity=i||1):a=new e(n,o,l,i),a},e.destroyInstance=function(e){this.pool.push(e)},e.prototype.getDashSegments=function(e){var t;switch(this.style){case h.TD4.dotted:t=[1,1];break;case h.TD4.dashed:t=[3.75,3.75];break;case h.TD4.dotDash:t=[6,2,2,2];break;case h.TD4.dotDotDash:t=[5,2,1.5,2,1.5,2];break;case h.TD4.dashSmallGap:t=[4,1];break;default:t=[]}var o=[];return t.forEach((function(t){o.push(t*e)})),o},e.prototype.getStyle=function(){return this.style},e.prototype.getWidth=function(){return this.width},e.prototype.getColor=function(){return this.color},e.prototype.getOpacity=function(){return this.opacity},e.pool=[],e}(),J=function(){function e(){}return e.prototype.renderLine=function(e,t,o){var n,r=U.newInstance(o),i=o.style;if(i!==h.TD4.none)switch(i){case h.TD4.double:this.drawLine({ctx:e,line:t,lineProp:r,nOffsetY:-1}),this.drawLine({ctx:e,line:t,lineProp:r,nOffsetY:2});break;case h.TD4.triple:this.drawLine({ctx:e,line:t,lineProp:r,nOffsetY:-2}),this.drawLine({ctx:e,line:t,lineProp:r}),this.drawLine({ctx:e,line:t,lineProp:r,nOffsetY:2});break;case h.TD4.wave:this.drawWave({ctx:e,line:t,lineProp:r,yPx:(0,a.FJ)(t.start.y),yOffset:-1});break;case h.TD4.uWave:this.drawWave({ctx:e,line:t,lineProp:r,yPx:(0,a.FJ)(t.start.y),waveHeight:2,waveWidth:6});break;case h.TD4.doubleWave:this.drawWave({ctx:e,line:t,lineProp:r,yPx:(0,a.FJ)(t.start.y),yOffset:-3,waveHeight:3,waveWidth:12,nWidth:1.33}),this.drawWave({ctx:e,line:t,lineProp:r,yPx:(0,a.FJ)(t.start.y),yOffset:2.75,waveHeight:3,waveWidth:12,nWidth:1.33});break;case h.TD4.waveDouble:this.drawWave({ctx:e,line:t,lineProp:r,yPx:(0,a.FJ)(t.start.y),yOffset:0,waveHeight:3}),this.drawWave({ctx:e,line:t,lineProp:r,yPx:(0,a.FJ)(t.start.y),yOffset:5,waveHeight:3});break;case h.TD4.wavyHeavy:this.drawWave({ctx:e,line:t,lineProp:r,yPx:(0,a.FJ)(t.start.y),yOffset:2.75,nWidth:1.33});break;case h.TD4.thinThickSmallGap:this.drawLine({ctx:e,line:t,lineProp:r,nOffsetY:-1,nWidth:2}),this.drawLine({ctx:e,line:t,lineProp:r,nOffsetY:1.35,nWidth:.7});break;case h.TD4.thickThinSmallGap:this.drawLine({ctx:e,line:t,lineProp:r,nOffsetY:-1,nWidth:.7}),this.drawLine({ctx:e,line:t,lineProp:r,nOffsetY:1.35,nWidth:2});break;case h.TD4.thinThickThinSmallGap:this.drawLine({ctx:e,line:t,lineProp:r,nWidth:.7,nOffsetY:-2}),this.drawLine({ctx:e,line:t,lineProp:r,nWidth:2,nOffsetY:.35}),this.drawLine({ctx:e,line:t,lineProp:r,nWidth:.7,nOffsetY:2.7});break;case h.TD4.thinThickMediumGap:this.drawLine({ctx:e,line:t,lineProp:r,nWidth:1.33,nOffsetY:-1}),this.drawLine({ctx:e,line:t,lineProp:r,nWidth:.7,nOffsetY:1});break;case h.TD4.thickThinMediumGap:this.drawLine({ctx:e,line:t,lineProp:r,nWidth:.7,nOffsetY:-1}),this.drawLine({ctx:e,line:t,lineProp:r,nWidth:1.33,nOffsetY:1});break;case h.TD4.thinThickThinMediumGap:this.drawLine({ctx:e,line:t,lineProp:r,nWidth:.7,nOffsetY:-2}),this.drawLine({ctx:e,line:t,lineProp:r,nWidth:1.33}),this.drawLine({ctx:e,line:t,lineProp:r,nWidth:.7,nOffsetY:2});break;case h.TD4.thinThickLargeGap:this.drawLine({ctx:e,line:t,lineProp:r,nOffsetY:-1.5,nWidth:1.75}),this.drawLine({ctx:e,line:t,lineProp:r,nOffsetY:1.85});break;case h.TD4.thickThinLargeGap:this.drawLine({ctx:e,line:t,lineProp:r,nOffsetY:-1.5}),this.drawLine({ctx:e,line:t,lineProp:r,nWidth:1.75,nOffsetY:1.85});break;case h.TD4.thinThickThinLargeGap:this.drawLine({ctx:e,line:t,lineProp:r,nOffsetY:-3}),this.drawLine({ctx:e,line:t,lineProp:r,nWidth:1.75,nOffsetY:.35}),this.drawLine({ctx:e,line:t,lineProp:r,nOffsetY:3.7});break;case h.TD4.inset:this.drawLine({ctx:e,line:t,lineProp:r,nWidth:1.33});break;case h.TD4.threeDEmboss:n=this.getThreeStepColor(r.getColor()),this.drawLine({ctx:e,line:t,lineProp:r,nWidth:1,nOffsetY:-1.5,color:n[0]}),this.drawLine({ctx:e,line:t,lineProp:r,nWidth:2,color:n[1]}),this.drawLine({ctx:e,line:t,lineProp:r,nWidth:1,nOffsetY:1.5,color:n[2]});break;case h.TD4.threeDEngrave:n=this.getThreeStepColor(r.getColor()),this.drawLine({ctx:e,line:t,lineProp:r,nWidth:1,nOffsetY:-1.5,color:n[2]}),this.drawLine({ctx:e,line:t,lineProp:r,nWidth:2,color:n[1]}),this.drawLine({ctx:e,line:t,lineProp:r,nWidth:1,nOffsetY:1.5,color:n[0]});break;case h.TD4.dashDotStroked:this.drawDashDotStrokeLine({ctx:e,line:t,lineProp:r});break;case h.TD4.thick:this.drawLine({ctx:e,line:t,lineProp:r,nWidth:2.66});break;default:this.drawLine({ctx:e,line:t,lineProp:r,nWidth:1.33})}},e.prototype.drawLine=function(e){var t=e.ctx,o=e.line,n=e.lineProp,r=e.nOffsetY,i=void 0===r?0:r,l=e.nWidth,s=void 0===l?1:l,c=e.color,d=.75*(0,a.FJ)(n.getWidth());t.save(),t.beginPath(),t.lineWidth=d*s,t.setLineDash(n.getDashSegments(t.lineWidth));var p=o.start,h=o.end,u=(0,a.FJ)(p.x),f=(0,a.FJ)(p.y)+i*d,g=(0,a.FJ)(h.x),y=(0,a.FJ)(h.y)+i*d;t.strokeStyle=null!=c?c:n.getColor(),t.moveTo(u,f),t.lineTo(g,y);var v=n.getStyle();!a.wV.isSafari()&&this.shouldApplyClosePathForCertainStyle(v)&&t.closePath(),t.stroke(),t.restore()},e.prototype.shouldApplyClosePathForCertainStyle=function(e){switch(e){default:return!0;case h.TD4.dotted:case h.TD4.dotDash:case h.TD4.dashed:case h.TD4.dotDotDash:return!1}},e.prototype.getThreeStepColor=function(e){var t=function(e,t){var o=e;"#"===o[0]&&(o=o.slice(1));var n=parseInt(o,16),r=function(e){var t=Math.floor(e),o=Math.min(Math.max(t,0),255).toString(16);return 1===o.length?"0".concat(o):o},i=r((n>>16)*(3-t)/3),a=r((n>>8&255)*(3-t)/3),l=r((255&n)*(3-t)/3);return"#".concat(i).concat(a).concat(l)},o=e;return function(e){var t=e;"#"===t[0]&&(t=t.slice(1));var o=parseInt(t,16);return o>>16<50&&(o>>8&255)<50&&(255&o)<50}(o)&&(o="#c0c0c0"),[t(o,0),t(o,1),t(o,2)]},e.prototype.drawWave=function(e){var t=e.ctx,o=e.line,n=e.lineProp,r=e.yPx,i=e.waveWidth,l=void 0===i?10:i,s=e.waveHeight,c=void 0===s?5:s,d=e.yOffset,p=void 0===d?0:d,h=e.nWidth,u=void 0===h?1:h;t.save(),t.beginPath(),t.lineCap="round",t.strokeStyle=n.getColor(),t.lineWidth=u;for(var f=(0,a.FJ)(o.end.x),g=(0,a.FJ)(o.start.x)-1;g<f;g+=.5){var y=c*Math.sin(g*(2*Math.PI)/l-0/l)+p;t.lineTo(g,r+y)}t.stroke(),t.closePath(),t.restore()},e.prototype.drawDashDotStrokeLine=function(e){var t=e.ctx,o=e.line,n=e.lineProp,r=(0,a.FJ)(n.getWidth()),i=(0,a.FJ)(o.start.x),l=(0,a.FJ)(o.end.x),s=(0,a.FJ)(o.start.y);t.save();var c=document.createElement("canvas"),d=c.getContext("2d");c.width=6*r,c.height=4*r,d.fillStyle=n.getColor(),d.fillRect(0,0,4*c.width/6,c.height),d.lineWidth=r,d.strokeStyle=n.getColor(),d.moveTo(5*r,0),d.lineTo(5*r,c.height),d.stroke();var p=t.createPattern(c,"repeat");p.setTransform(new DOMMatrix([1,1,-.7,1,0,0])),t.fillStyle=p,t.fillRect(i,s-c.height/2,l-i,c.height),t.restore()},e}(),G=new J,Y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),t.prototype.startRenderViews=function(t,o){var n;e.prototype.startRenderViews.call(this,t,o),t.globalAlpha=null!==(n=o[0].lineProp.opacity)&&void 0!==n?n:1,this.renderCtx.darkMode&&(t.filter=N)},t.prototype.renderView=function(e,t){var o=t.line,n=t.lineProp;G.renderLine(e,o,n)},t}(P),X=Y,K=100,q=function(e){function t(t,o){var n=e.call(this)||this;return n.frame=t,n.contextState=o,n}return(0,n.__extends)(t,e),t.prototype.hash=function(){var e,t=this.constructor.name,o=null===(e=this.contextState)||void 0===e?void 0:e.clipInfo;return o&&(t+="-clipInfo-".concat(o.x,"-").concat(o.y,"-").concat(o.width,"-").concat(o.height)),t},Object.defineProperty(t.prototype,"offset",{get:function(){return this._offset?this._offset:{x:0,y:0}},set:function(e){this._offset=e},enumerable:!1,configurable:!0}),t}(a.wo),Q=function(e){function t(t,o,n,r,i){var a=e.call(this,t,i)||this;return a.frame=t,a.text=o,a.textInfo=n,a.textProps=r,a.contextState=i,a}var o,r,i,s,c;return(0,n.__extends)(t,e),o=t,t.prototype.hash=function(){var t,o="".concat(e.prototype.hash.call(this),"-").concat(l.vW8.styleHash(this.textProps)||e.prototype.hash.call(this)),n=null===(t=this.contextState)||void 0===t?void 0:t.textTransform;return n&&(o+="-transform-".concat(n.scaleX,"-").concat(n.rotateX,"-").concat(n.rotateY,"-").concat(n.scaleY,"-").concat(n.translateX,"-").concat(n.translateY)),o},t.obtain=function(e,t,n,r,i){var a=o.sPool.obtain();return a?(a.frame=e,a.text=t,a.textInfo=n,a.textProps=r,a.contextState=i):a=new o(e,t,n,r,i),a},t.prototype.recycle=function(){o.sPool.recycle(this)},t.percentToPoint=function(e){var t=e.replace("%","");return Number(t)/100},t.sPool=new a.L7(K),t=o=(0,n.__decorate)([(0,f.B7)(h.muA),(0,n.__metadata)("design:paramtypes",["function"==typeof(r=void 0!==h.IRect&&h.IRect)?r:Object,String,"function"==typeof(i=void 0!==h.ITextInfo&&h.ITextInfo)?i:Object,"function"==typeof(s=void 0!==l.CssProperties&&l.CssProperties)?s:Object,"function"==typeof(c=void 0!==h.IContextState&&h.IContextState)?c:Object])],t)}(q),Z=o(179664),$=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),t.prototype.renderView=function(e,t){var o,r=this,i=t.textProps,l="string"==typeof i.letterSpacing?Number.parseFloat(i.letterSpacing):i.letterSpacing,s=Q.percentToPoint(null!==(o=t.textProps.fontScaling)&&void 0!==o?o:"".concat(100,"%"));if(l&&0!==(0,a.pL)(l)){var c=t.frame.x;new Z.UnicodeString(t.text).getAllGraphemes().forEach((function(o){var i=o.toString(),d=(0,a.Ej)(e.measureText(i).width*s)+(0,a.pL)(l),p=Q.obtain((0,n.__assign)((0,n.__assign)({},t.frame),{x:c,width:d}),i,t.textInfo,t.textProps,t.contextState);r.renderTextAll(e,p),c+=d>0?d:0}))}else this.renderTextAll(e,t)},t.prototype.startRenderViews=function(e,t){var o,n,r,i,l,s=t[0].textProps;this.resetRenderContext(e,{defaultFont:"".concat(s.fontStyle," ").concat(s.fontWeight," ").concat(s.fontSize," ").concat(u.Defaults.fontFamily)}),s.color&&(e.fillStyle=s.color,e.strokeStyle=s.color);var c="".concat(s.fontStyle," ").concat(s.fontWeight," ").concat(s.fontSize," ").concat(null!==(n=null===(o=s.fontFamily)||void 0===o?void 0:o.stringValue)&&void 0!==n?n:"");e.font!==c&&(e.font=c),this.renderCtx.darkMode&&(e.filter=N),e instanceof b&&(e.fontProp={fontStyle:s.fontStyle,fontWeight:s.fontWeight,fontSize:s.fontSize,fontFamily:null!==(i=null===(r=s.fontFamily)||void 0===r?void 0:r.stringValue)&&void 0!==i?i:"",letterSpacing:s.letterSpacing,fontScaling:s.fontScaling});var d=this.getLineWidth(parseInt("".concat(s.fontSize),10));d&&(e.lineWidth=Math.max(1,d)),void 0!==s.opacity&&(e.globalAlpha=s.opacity);var p=null===(l=t[0].contextState)||void 0===l?void 0:l.textTransform;p&&(e.save(),e.transform(p.scaleX,p.rotateY,p.rotateX,p.scaleY,(0,a.FJ)(p.translateX),(0,a.FJ)(p.translateY)))},t.prototype.finishRenderViews=function(e,t){var o;(null===(o=t[0].contextState)||void 0===o?void 0:o.textTransform)&&e.restore()},t.prototype.getLineWidth=function(e){return e?Math.round(e/15):0},t.prototype.renderTextAll=function(e,t){this.renderText(e,t),this.renderUnderlineAndStrikethrough(e,t)},t.prototype.renderText=function(e,t){var o,n=Q.percentToPoint(null!==(o=t.textProps.fontScaling)&&void 0!==o?o:"".concat(100,"%"));1===n?e.fillText(t.text,(0,a.FJ)(t.frame.x),(0,a.FJ)(t.frame.y)):(e.save(),e.transform(n,0,0,1,(0,a.FJ)(t.frame.x)*(1-n),0),e.fillText(t.text,(0,a.FJ)(t.frame.x),(0,a.FJ)(t.frame.y)),e.restore())},t.prototype.renderUnderlineAndStrikethrough=function(e,t){var o=t.textProps,n=t.textInfo,r=t.frame,i=this.getStrikeThroughInfo(o,n);(null==i?void 0:i.show)&&this.renderStrikethroughline(e,r,null==i?void 0:i.color);var a=this.getDoubleStrikeThroughInfo(o,n);(null==a?void 0:a.show)&&this.renderDoubleStrikethroughline(e,r,null==a?void 0:a.color)},t.prototype.renderStrikethroughline=function(e,t,o){var n=Math.round(t.height/4),r={line:(0,l.L9X)(t.x,t.y-n,t.x+t.width,t.y-n),color:o};this.renderLine(e,r)},t.prototype.renderDoubleStrikethroughline=function(e,t,o){var n=Math.round(t.height/4),r=(0,a.Ej)(e.lineWidth),i=t.y-n,s={line:(0,l.L9X)(t.x,i-r,t.x+t.width,i-r),color:o};this.renderLine(e,s),s={line:(0,l.L9X)(t.x,i+r,t.x+t.width,i+r),color:o},this.renderLine(e,s)},t.prototype.renderLine=function(e,t){t.color&&(e.strokeStyle=t.color),e.beginPath(),e.moveTo((0,a.FJ)(t.line.start.x),(0,a.FJ)(t.line.start.y)),e.lineTo((0,a.FJ)(t.line.end.x),(0,a.FJ)(t.line.end.y)),e.stroke()},t.prototype.getStrikeThroughInfo=function(e,t){var o=t.diffThrough,n=t.isTaskDone,r=t.delRevisionMarkup,i=(!e.textDecoration||e.textDecoration.indexOf(l.$L5.DoubleStrike)<0)&&r;if(e.textDecoration&&e.textDecoration.indexOf(l.$L5.LineThrough)>=0||o||n||i){var a=e.color;return r?a=f.u$.revisionColor:n&&(a="rgba(0,0,0,0.3)"),{show:!0,color:a}}},t.prototype.getDoubleStrikeThroughInfo=function(e,t){var o=t.delRevisionMarkup;if(e.textDecoration&&e.textDecoration.indexOf(l.$L5.DoubleStrike)>=0){var n=e.color;return o&&(n="red"),{show:!0,color:n}}},t}(P),ee=$,te=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),t.prototype.resetRenderContext=function(t){e.prototype.resetRenderContext.call(this,t,{defultFillStyle:"rgba(0, 0, 0, 0)"})},t.prototype.renderView=function(e,t){var o=t.path,r=t.frame,i=t.color,l=t.isFill;if(o.points.length>0){var s=(0,n.__read)(o.points,1)[0];e.beginPath(),e.moveTo((0,a.FJ)(s.x+r.x),(0,a.FJ)(s.y+r.y));for(var c=1;c<o.points.length;c++){var d=o.points[c];e.lineTo((0,a.FJ)(d.x+r.x),(0,a.FJ)(d.y+r.y))}l?(e.fillStyle=i,e.fill()):(e.strokeStyle=i,e.stroke()),e.closePath()}},t.prototype.startRenderViews=function(t,o){e.prototype.startRenderViews.call(this,t,o);var n=o[0].color;t.fillStyle=n&&"initial"!==n?n:"rgba(0, 0, 0, 0)",this.renderCtx.darkMode&&(t.filter=N)},t}(P),oe=te,ne=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),t.prototype.renderView=function(e,t){void 0!==t.dstSize&&void 0!==t.srcPos&&void 0!==t.srcSize?e.drawImage(t.image,(0,a.FJ)(t.dstPos.x),(0,a.FJ)(t.dstPos.y),(0,a.FJ)(t.dstSize.width),(0,a.FJ)(t.dstSize.height),(0,a.FJ)(t.srcPos.x),(0,a.FJ)(t.srcPos.y),(0,a.FJ)(t.srcSize.width),(0,a.FJ)(t.srcSize.height)):void 0!==t.dstSize?e.drawImage(t.image,(0,a.FJ)(t.dstPos.x),(0,a.FJ)(t.dstPos.y),(0,a.FJ)(t.dstSize.width),(0,a.FJ)(t.dstSize.height)):e.drawImage(t.image,(0,a.FJ)(t.dstPos.x),(0,a.FJ)(t.dstPos.y))},t}(P),re=ne,ie=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),t.prototype.startRenderViews=function(t,o){e.prototype.startRenderViews.call(this,t,o);var n=o[0].roundRectProp;t.lineWidth=n.borderWidth||1,n.fillColor&&(t.fillStyle=n.fillColor),n.strokeColor&&(t.strokeStyle=n.strokeColor),void 0!==n.opacity&&(t.globalAlpha=n.opacity)},t.prototype.renderView=function(e,t){var o=t.frame,n=t.roundRectProp,r=t.isBorderCrossNextPage,i=t.isBorderCrossPrePage,l=n.radius,s=[(0,a.FJ)(o.x)+l,(0,a.FJ)(o.y)],c=[(0,a.FJ)(o.x+o.width),(0,a.FJ)(o.y)],d=[(0,a.FJ)(o.x+o.width),(0,a.FJ)(o.y+o.height)],p=[(0,a.FJ)(o.x),(0,a.FJ)(o.y+o.height)],h=[(0,a.FJ)(o.x),(0,a.FJ)(o.y)];if(e.beginPath(),e.moveTo(s[0],s[1]),n.mergeMultiLine&&(i||t.preLineView))if(t.preLineView){var u=[(0,a.FJ)(t.preLineView.frame.x),(0,a.FJ)(o.y)],f=[(0,a.FJ)(t.preLineView.frame.x+t.preLineView.frame.width),(0,a.FJ)(o.y)];u[0]>c[0]?(e.moveTo(u[0],u[1]),e.lineTo(f[0],f[1]),e.moveTo(s[0],s[1])):(e.lineTo(u[0],u[1]),n.strokeColor?e.moveTo(f[0],f[1]):n.fillColor&&e.lineTo(f[0],f[1]),e.lineTo(c[0],c[1]))}else i&&e.moveTo(c[0],c[1]);e.arcTo(c[0],c[1],d[0],d[1],l),e.arcTo(d[0],d[1],p[0],p[1],l),n.mergeMultiLine&&(r||t.nextLineView)&&(n.strokeColor?e.moveTo(p[0],p[1]):n.fillColor&&e.lineTo(p[0],p[1])),e.arcTo(p[0],p[1],h[0],h[1],l),e.arcTo(h[0],h[1],s[0],s[1],l),this.strokeIfNeed(e,n),n.shadowInfo&&(n.shadowInfo.shadowColor&&(e.shadowColor=n.shadowInfo.shadowColor),n.shadowInfo.shadowOffsetX&&(e.shadowOffsetX=n.shadowInfo.shadowOffsetX),n.shadowInfo.shadowOffsetY&&(e.shadowOffsetY=n.shadowInfo.shadowOffsetY),n.shadowInfo.shadowBlur&&(e.shadowBlur=n.shadowInfo.shadowBlur),e.stroke(),e.shadowColor="",e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowBlur=0);var g=n.image;if(g&&this.isUsableImage(g))try{e.drawImage(g,(0,a.FJ)(o.x),(0,a.FJ)(o.y),(0,a.FJ)(o.width),(0,a.FJ)(o.height))}catch(e){a.Yd.error(e)}else n.fillColor&&e.fill()},t.prototype.strokeIfNeed=function(e,t){t.strokeColor&&e.stroke()},t.prototype.isUsableImage=function(e){return!(e instanceof HTMLImageElement)||Boolean(e.complete&&e.naturalHeight&&e.naturalWidth)},t}(P),ae=ie,le=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),t.prototype.resetRenderContext=function(t){e.prototype.resetRenderContext.call(this,t,{defultFillStyle:"rgba(0, 0, 0, 0)"})},t.prototype.startRenderViews=function(t,o){var n;e.prototype.startRenderViews.call(this,t,o);var r=o[0].roundRectProp.fillColor;t.fillStyle=r&&"initial"!==r?r:"rgba(0, 0, 0, 0)",this.renderCtx.darkMode&&(t.filter=N);var i=null===(n=o[0].contextState)||void 0===n?void 0:n.textTransform;i&&(t.save(),t.transform(i.scaleX,i.rotateY,i.rotateX,i.scaleY,(0,a.FJ)(i.translateX),(0,a.FJ)(i.translateY)))},t.prototype.finishRenderViews=function(e,t){var o;(null===(o=t[0].contextState)||void 0===o?void 0:o.textTransform)&&e.restore()},t}(ae),se=le;!function(e){e[e.GraphicsRender=0]="GraphicsRender",e[e.DrawingRender=1]="DrawingRender",e[e.RoundRectRenderer=2]="RoundRectRenderer",e[e.LineRenderer=3]="LineRenderer",e[e.TextRenderer=4]="TextRenderer",e[e.BitmapRenderer=5]="BitmapRenderer",e[e.ComponentRenderer=6]="ComponentRenderer",e[e.AnchorRenderer=7]="AnchorRenderer",e[e.OverlayRenderer=8]="OverlayRenderer"}(j||(j={}));var ce,de=((H={})[j.GraphicsRender]=0,H[j.DrawingRender]=0,H[j.RoundRectRenderer]=10,H[j.OverlayRenderer]=20,H[j.TextRenderer]=30,H[j.LineRenderer]=40,H[j.BitmapRenderer]=50,H[j.ComponentRenderer]=60,H);!function(e){e[e.Line=0]="Line",e[e.Text=1]="Text",e[e.Graphics=2]="Graphics",e[e.Drawing=3]="Drawing",e[e.Container=4]="Container",e[e.Bitmap=5]="Bitmap",e[e.RoundRect=6]="RoundRect",e[e.Overlay=7]="Overlay",e[e.Component=8]="Component",e[e.Anchor=9]="Anchor"}(ce||(ce={}));var pe,he=o(100882),ue=o(563696),fe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),t.prototype.renderObjectType=function(){return ce.Graphics},t.prototype.renderView=function(e,t,o){var r,i;return(0,n.__awaiter)(this,void 0,void 0,(function(){var l,s,c,d,p,h,u,f,g,y,v,x,m,w,S,C,_,P,R,T,E;return(0,n.__generator)(this,(function(B){switch(B.label){case 0:l=t.path,s=t.drawingFrame,c=t.fillStyle,d=t.strokeStyle,p=t.filter,h=t.effectExtent,u=t.placeholderImageSrc,f=t.chartInfo,g=t.textFill,y=t.headerFooterStyle,v=t.onRenderFinish,x=t.containerWidth,m=t.containerHeight,w=window.devicePixelRatio;try{w=e.getTransform().a}catch(e){}return S=w/Math.ceil(window.devicePixelRatio),C={frame:(0,n.__assign)((0,n.__assign)({},s),{left:Math.floor((0,a.FJ)(s.left)*S),top:Math.floor((0,a.FJ)(s.top)*S),width:Math.floor((0,a.FJ)(s.width)*S),height:Math.floor((0,a.FJ)(s.height)*S)}),path:l,fillStyle:c,strokeStyle:d,filter:p},x=(0,a.FJ)(null!=x?x:s.width)*S,m=(0,a.FJ)(null!=m?m:s.height)*S,f?(this.renderChart(e,t,o,(0,n.__assign)((0,n.__assign)({},C),{containerWidth:x,containerHeight:m,zoomScale:S})),[2]):(g&&this.renderTextFill(e,g,y||{},s),e instanceof b?(this.renderDrawingSvg(C,e,h,x,m,S),[3,3]):[3,1]);case 1:return(_=new he.TC(C)).isImageLoaded?(e.save(),_.syncRender(e),e.restore(),null==v||v(_,S),[2]):(u?(P=(0,a.I8)(C),(null==(T=null===(r=P.fillStyle)||void 0===r?void 0:r.imageFill)?void 0:T.src)&&(T.src=u,E=new he.TC(P),this.renderGraphics(e,E,o),null==v||v(_,S))):(R=(0,a.I8)(C),(null==(T=null===(i=R.fillStyle)||void 0===i?void 0:i.imageFill)?void 0:T.src)&&!T.src.startsWith("data:")&&(T.src=this.getLoadingImage(C.frame.width,C.frame.height),E=new he.TC(R),this.renderGraphics(e,E,o),null==v||v(_,S))),[4,this.renderGraphics(e,_,o)]);case 2:B.sent(),B.label=3;case 3:return[2]}}))}))},t.prototype.renderTextFill=function(e,t,o,n){var r=t.text||"",i=Math.floor((0,a.FJ)(n.left)),l=Math.floor((0,a.FJ)(n.top)),s=Math.floor((0,a.FJ)(n.width)),c=Math.floor((0,a.FJ)(n.height));e.save();var d=[t.fontStyle||"","".concat(24,"px"),t.fontFamily||""].join(" ");e.font=d,t.color&&("number"==typeof o.opacity&&(e.globalAlpha=o.opacity),e.fillStyle=t.color),"number"==typeof t.fillOpacity&&(e.globalAlpha=e.globalAlpha*t.fillOpacity);var p=e.measureText(r),h=p.actualBoundingBoxRight+p.actualBoundingBoxLeft,u=24,f=a.gS.productsRight(a.gS.translate2d(-(i+h/2),-(l+u/2)),a.gS.scale2d(s/h,c/u),t.matrix||a.gS.identity2d(),a.gS.translate2d(i+s/2,l+c/2)),g=a.gS.toMatrix2D(f);e.transform(g.scaleX,g.rotateY,g.rotateX,g.scaleY,g.translateX,g.translateY),e.fillText(r,i+p.actualBoundingBoxLeft,l+24-p.fontBoundingBoxDescent),e.restore()},t.prototype.getLoadingImage=function(e,t){var o=window.$t;return(0,f.vx)({width:e,height:t,loadingText:o("...")})},t.prototype.renderChart=function(e,t,o,r){try{var i=t.chartInfo,s=i.chartId,c=i.chartConfig,d=t.effectExtent,p=r.containerWidth,h=r.containerHeight,g=r.zoomScale,y=(0,n.__rest)(r,["containerWidth","containerHeight","zoomScale"]),v=(0,a.I8)(y),x=(0,f.U9)({width:r.frame.width,height:r.frame.height}),m=u.DrawingCurrentChartWps.chartMap.get(s)||"";if(s&&c?u.DrawingCurrentChartWps.chartMap.has(s)||this.renderChartToImage(t,x).then((function(){o.fire(new l.kv7(!1))})):(m=x,a.Yd.error("render chart: ".concat(s," no chart config"))),m||(m=this.getLoadingImage(r.frame.width,r.frame.height)),v.fillStyle=(0,n.__assign)((0,n.__assign)({},v.fillStyle),{imageFill:{src:m,alpha:1}}),e instanceof b)this.renderDrawingSvg(v,e,d,p,h,g);else{var w=new he.TC(v);this.renderGraphics(e,w,o)}}catch(e){a.Yd.error("render chart: ",e)}},t.prototype.renderChartToImage=function(e,t){return new Promise((function(o){var n=e.chartInfo,r=n.chartId,i=n.chartConfig,l=e.drawingFrame,s=Math.floor((0,a.FJ)(l.width)),c=Math.floor((0,a.FJ)(l.height)),d=document.createElement("div"),p=document.createElement("canvas");p.width=s,p.height=c;var h=p.toDataURL("image/png"),f={chartBox:{top:0,left:0,width:s,height:c}},g=new ue.m2(f),y=new ue.kL({canvas:p,container:d,chartLayout:g,width:s,height:c});y.getAntVChart().animate(!1);var v=function(){var e=p.toDataURL("image/png");e!==h&&u.DrawingCurrentChartWps.chartMap.set(r,e),o(e)};u.DrawingCurrentChartWps.chartMap.set(r,""),y.on("afterrender",(function(){return setTimeout(v,100)})),y.draw(i),setTimeout((function(){u.DrawingCurrentChartWps.chartMap.get(r)||(u.DrawingCurrentChartWps.chartMap.set(r,t),o(t))}),2e3)}))},t.prototype.renderDrawingSvg=function(e,t,o,r,i,l){var s=null!=o?o:{},c=s.l,d=void 0===c?0:c,p=s.r,h=void 0===p?0:p,u=s.t,f=void 0===u?0:u,g=s.b,y=void 0===g?0:g;d=Math.max(d,0),h=Math.max(h,0),f=Math.max(f,0),y=Math.max(y,0);var v=2*(0,a.Cb)(f),x=2*(0,a.Cb)(d),m=2*(0,a.Cb)(y),w=2*(0,a.Cb)(h),S=(0,n.__assign)((0,n.__assign)({},e.frame),{left:(r-e.frame.width)/2+x,top:(i-e.frame.height)/2+v}),C=(0,n.__assign)((0,n.__assign)({},e),{frame:S}),b=e.frame,_=b.left,P=b.top,R=new he.TC(C),T=document.createElement("canvas"),E=T.getContext("2d");T.width=(r+x+w)*window.devicePixelRatio/l,T.height=(i+v+m)*window.devicePixelRatio/l,document.body.appendChild(T),E&&(R.syncRender(E),t.drawImage(T,(_-(r-e.frame.width)/2-x)/l,(P-(i-e.frame.height)/2-v)/l,T.width/window.devicePixelRatio,T.height/window.devicePixelRatio))},t.prototype.renderGraphics=function(e,t,o){return(0,n.__awaiter)(this,void 0,void 0,(function(){return(0,n.__generator)(this,(function(n){switch(n.label){case 0:return e.save(),t.syncRender(e),e.restore(),t.isImageLoaded?[3,2]:[4,t.promiseImageLoaded()];case 1:n.sent(),o.fire(new l.kv7(!1)),n.label=2;case 2:return[2]}}))}))},t}(P),ge=fe,ye=function(){function e(e){this.renders=new Map,this._renderCtx=e,this.renders.set(ce.Line,new X(this._renderCtx)),this.renders.set(ce.Text,new ee(this._renderCtx)),this.renders.set(ce.Graphics,new oe(this._renderCtx)),this.renders.set(ce.Drawing,new ge(this._renderCtx)),this.renders.set(ce.Bitmap,new re(this._renderCtx)),this.renders.set(ce.RoundRect,new ae(this._renderCtx)),this.renders.set(ce.Component,new I(this._renderCtx)),this.renders.set(ce.Overlay,new se(this._renderCtx)),this.renders.set(ce.Anchor,new V(this._renderCtx))}return e.prototype.resetCanvasNode=function(e){this._renderCtx.mainView=e},e.prototype.render=function(e,t){var o=this;f.nU.getRenderPrioritys().forEach((function(n){o.renderOnPriority(e,n,t)})),this.resetContextState()},e.prototype.clearComponentView=function(e){var t=f.nU.getRenderPrioritys(),o=this.renders.get(ce.Component),n=this.renders.get(ce.Anchor);t.forEach((function(t){null==o||o.clearRenderer(t,e),null==n||n.clearRenderer(t,e)}))},e.prototype.renderOnPriority=function(e,t,o){var n=this,r=o.subPageIndex,i=o.options,a=o.pageIndex,l=o.collectRect,s=o.lastPageIndex,c=o.isLastRenderPage,d=o.context,p=void 0!==r;e.forEach((function(e){var o=n.renders.get(e.renderObjectType());i.documentUpdated&&(null==o||o.clearRenderer(t,a,l,p)),null==o||o.render({collector:e,priority:t,context:d,pageIndex:a,lastPageIndex:s,isLastRenderPage:c,isSubPageRender:p,collectRect:l})}))},e.prototype.resetContextState=function(){if(this._renderCtx.mainCtxState.clipInfo||this._renderCtx.mainCtxState.textTransform){var e=P.canvasContext(this._renderCtx.mainView,this._renderCtx.renderDevice);e&&e.restore(),this._renderCtx.mainCtxState.clipInfo=void 0,this._renderCtx.mainCtxState.textTransform=void 0}},e}(),ve=function(){function e(e){this.level=e,this.renderInfoMap=new Map}return Object.defineProperty(e.prototype,"infoMap",{get:function(){return this.renderInfoMap},enumerable:!1,configurable:!0}),e.prototype.compare=function(e){return this.level>e.level?1:-1},e.prototype.hasRenderInfo=function(e){var t=this.renderInfoMap.get(e);return!!t&&Object.keys(t).length>0},e.prototype.renderInfos=function(e){var t=this.renderInfoMap.get(e);return t||(t={},this.renderInfoMap.set(e,t)),t},e.prototype.collect=function(e,t){void 0===t&&(t=l.Ypk.UpperDefault);var o=this.renderInfos(t),n=e.hash();Object.prototype.hasOwnProperty.call(o,n)||(o[n]=[]),o[n].push(e)},e.prototype.clear=function(){this.renderInfoMap.clear()},e}(),xe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),t.prototype.collect=function(e,t){void 0===t&&(t=l._AL.mainText);var o=this.renderInfos(t),n=e.hash();Object.prototype.hasOwnProperty.call(o,n)||(o[n]=[]),o[n].push(e)},t.prototype.renderObjectType=function(){return ce.Text},t}(ve),me=xe,we=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),t.prototype.collect=function(t,o){t.lineProp.style!==h.TD4.none&&e.prototype.collect.call(this,t,o)},t.prototype.renderObjectType=function(){return ce.Line},t}(ve),Se=we,Ce=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),t.prototype.collect=function(t,o){e.prototype.collect.call(this,t,o)},t.prototype.renderObjectType=function(){return ce.Graphics},t}(ve),be=Ce,_e=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),t.prototype.collect=function(t,o){e.prototype.collect.call(this,t,o)},t.prototype.renderObjectType=function(){return ce.Bitmap},t}(ve),Pe=_e,Re=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),t.prototype.collect=function(t,o){e.prototype.collect.call(this,t,o)},t.prototype.renderObjectType=function(){return ce.RoundRect},t}(ve),Te=Re,Ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),t.prototype.collect=function(t,o){e.prototype.collect.call(this,t,o)},t.prototype.renderObjectType=function(){return ce.Component},t}(ve),Be=Ee,Ie=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),t.prototype.collect=function(t,o){e.prototype.collect.call(this,t,o)},t.prototype.renderObjectType=function(){return ce.Overlay},t}(ve),Fe=Ie,Me=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),t.prototype.renderObjectType=function(){return ce.Anchor},t.prototype.collect=function(t,o){e.prototype.collect.call(this,t,o)},t}(ve),Le=Me,Oe=function(e){function t(t,o,n,r,i,a){var l=e.call(this,{x:o.x,y:o.y,width:(null==n?void 0:n.width)||0,height:(null==n?void 0:n.height)||0},a)||this;return l.image=t,l.dstPos=o,l.dstSize=n,l.srcPos=r,l.srcSize=i,l.contextState=a,l}var o,r,i,l,s,c,d;return(0,n.__extends)(t,e),o=t,t.obtain=function(e,t,n,r,i,a){var l=o.sPool.obtain();return l?(l.image=e,l.dstPos=t,l.dstSize=n,l.srcPos=r,l.srcSize=i,l.contextState=a):l=new o(e,t,n,r,i,a),l},t.prototype.recycle=function(){o.sPool.recycle(this)},t.sPool=new a.L7(K),t=o=(0,n.__decorate)([(0,f.B7)(h.To1),(0,n.__metadata)("design:paramtypes",["function"==typeof(r="undefined"!=typeof CanvasImageSource&&CanvasImageSource)?r:Object,"function"==typeof(i=void 0!==h.IPoint&&h.IPoint)?i:Object,"function"==typeof(l=void 0!==h.ISize&&h.ISize)?l:Object,"function"==typeof(s=void 0!==h.IPoint&&h.IPoint)?s:Object,"function"==typeof(c=void 0!==h.ISize&&h.ISize)?c:Object,"function"==typeof(d=void 0!==h.IContextState&&h.IContextState)?d:Object])],t)}(q),ke=function(e){function t(t,o,n,r){var i=e.call(this,o,r)||this;return i.key=t,i.frame=o,i.contentSize=n,i.contextState=r,i._subViews=[],i}var o,r,i;return(0,n.__extends)(t,e),t.prototype.addSubview=function(e){this._subViews.push(e)},Object.defineProperty(t.prototype,"subViews",{get:function(){return this._subViews},enumerable:!1,configurable:!0}),t.prototype.recycle=function(){},t=(0,n.__decorate)([(0,f.B7)(h.Sy9),(0,n.__metadata)("design:paramtypes",[String,"function"==typeof(o=void 0!==h.IRect&&h.IRect)?o:Object,"function"==typeof(r=void 0!==h.ISize&&h.ISize)?r:Object,"function"==typeof(i=void 0!==h.IContextState&&h.IContextState)?i:Object])],t)}(q),Ae=(function(e){function t(t,o,n,r){var i=e.call(this,t,o,r.contentSize)||this;return i.key=t,i.frame=o,i.componentClass=n,i.props=r,i}var o,r;(0,n.__extends)(t,e),o=t,t.obtain=function(e,t,n,r){var i=o.sPool.obtain();return i?(i.key=e,i.frame=t,i.componentClass=n,i.props=r):i=new o(e,t,n,r),i},t.prototype.recycle=function(){o.sPool.recycle(this)},t.sPool=new a.L7(K),t=o=(0,n.__decorate)([(0,f.B7)(h.foL),(0,n.__metadata)("design:paramtypes",[String,"function"==typeof(r=void 0!==h.IRect&&h.IRect)?r:Object,Object,Object])],t)}(ke),function(e){function t(t,o,n,r,i){var a=e.call(this,t,r)||this;return a.frame=t,a.color=o,a.path=n,a.contextState=r,a.isFill=i,a}var o,r,i,l;return(0,n.__extends)(t,e),o=t,t.prototype.hash=function(){return"".concat(e.prototype.hash.call(this),"-").concat(this.color)},t.obtain=function(e,t,n,r,i){var a=o.sPool.obtain();return a?(a.frame=e,a.color=t,a.path=n,a.contextState=r,a.isFill=i):a=new o(e,t,n,r),a},t.prototype.recycle=function(){o.sPool.recycle(this)},t.sPool=new a.L7(K),t=o=(0,n.__decorate)([(0,f.B7)(h.ZiQ),(0,n.__metadata)("design:paramtypes",["function"==typeof(r=void 0!==h.IRect&&h.IRect)?r:Object,String,"function"==typeof(i=void 0!==h.IPath&&h.IPath)?i:Object,"function"==typeof(l=void 0!==h.IContextState&&h.IContextState)?l:Object,Boolean])],t)}(q)),De=function(e){function t(t,o,n){var r=e.call(this,h.rGZ,n)||this;return r.line=t,r.lineProp=o,r.contextState=n,r}var o,r,i,l;return(0,n.__extends)(t,e),o=t,t.prototype.hash=function(){var t=this.lineProp,o=t.style,n=t.width,r=t.color;return"".concat(e.prototype.hash.call(this),"-").concat(o,"-").concat(n,"-").concat(r?r.hex:"#000000")},t.obtain=function(e,t,n){var r=o.sPool.obtain();return r?(r.line=e,r.lineProp=t,r.contextState=n):r=new o(e,t,n),r},t.prototype.recycle=function(){o.sPool.recycle(this)},t.sPool=new a.L7(K),t=o=(0,n.__decorate)([(0,f.B7)(h.bJ_),(0,n.__metadata)("design:paramtypes",["function"==typeof(r=void 0!==h.ILine&&h.ILine)?r:Object,"function"==typeof(i=void 0!==h.ILineProp&&h.ILineProp)?i:Object,"function"==typeof(l=void 0!==h.IContextState&&h.IContextState)?l:Object])],t)}(q),Ve=function(e){function t(t,o,n){var r=e.call(this,t,n)||this;return r.frame=t,r.roundRectProp=o,r.contextState=n,r}var o,r,i,l;return(0,n.__extends)(t,e),o=t,t.prototype.computePaintHash=function(){var e=this.roundRectProp,t=e.shadowInfo,o=e.fillColor,n=e.strokeColor,r=e.radius,i=e.borderWidth,a="fill:".concat(o||"rgba(0,0,0,0)",";radius:").concat(r,";");if(t){var l=t.shadowOffsetY,s=t.shadowOffsetX,c=t.shadowColor,d=t.shadowBlur;a+="shadow:".concat(s," ").concat(l," ").concat(d," ").concat(c,";")}return n&&i&&(a+="stroke:".concat(n,";")),i&&(a+="border:".concat(i)),a},t.prototype.hash=function(){var t=this.frame,o=t.x,n=t.y,r=t.width,i=t.height,a="".concat(o,"-").concat(n,"-").concat(r,"-").concat(i),l=this.computePaintHash();return"".concat(e.prototype.hash.call(this),"-").concat(a,"-").concat(l)},t.obtain=function(e,t,n){var r,i=o.sPool.obtain();return r=t&&"string"!=typeof t?t:{fillColor:t,radius:0},i?(i.frame=e,i.roundRectProp=r,i.contextState=n,i.preLineView=null,i.nextLineView=null):i=new o(e,r,n),i},t.prototype.recycle=function(){o.sPool.recycle(this)},t.sPool=new a.L7(K),t=o=(0,n.__decorate)([(0,f.B7)(h.iWk),(0,n.__metadata)("design:paramtypes",["function"==typeof(r=void 0!==h.IRect&&h.IRect)?r:Object,"function"==typeof(i=void 0!==h.IRoundRectProp&&h.IRoundRectProp)?i:Object,"function"==typeof(l=void 0!==h.IContextState&&h.IContextState)?l:Object])],t)}(q),ze=function(e){function t(t,o,n,r){var i=e.call(this,t,r)||this;return i.frame=t,i.type=o,i.roundRectProp=n,i.contextState=r,i}var o,r,i,l;return(0,n.__extends)(t,e),o=t,t.prototype.hash=function(){var t=this.roundRectProp,o=t.shadowInfo,n=t.fillColor,r=t.strokeColor,i=t.image,a=i instanceof SVGImageElement?i.href.baseVal:null==i?void 0:i.src;return"".concat(e.prototype.hash.call(this),"-").concat(this.type,"-").concat(n,"-").concat(r,"-").concat(null==o?void 0:o.shadowBlur,"-").concat(null==o?void 0:o.shadowColor,"-").concat(null==o?void 0:o.shadowOffsetX,"-").concat(null==o?void 0:o.shadowOffsetY,"-").concat(a)},t.obtain=function(e,t,n,r){var i=o.sPool.obtain();return i?(i.frame=e,i.type=t,i.roundRectProp=n,i.contextState=r):i=new o(e,t,n,r),i},t.prototype.recycle=function(){o.sPool.recycle(this)},t.sPool=new a.L7(K),t=o=(0,n.__decorate)([(0,f.B7)(h.fpH),(0,n.__metadata)("design:paramtypes",["function"==typeof(r=void 0!==h.IRect&&h.IRect)?r:Object,String,"function"==typeof(i=void 0!==h.IRoundRectProp&&h.IRoundRectProp)?i:Object,"function"==typeof(l=void 0!==h.IContextState&&h.IContextState)?l:Object])],t)}(q),We=function(e){function t(t,o,n,r,i){var a=e.call(this,o,i)||this;return a.key=t,a.frame=o,a.content=n,a.style=r,a.contextState=i,a}var o,r,i,s,c;return(0,n.__extends)(t,e),o=t,t.computeContainerStyles=function(e,t,o,n,r){return l.vW8.computeContainerStyles(e,t,o,n,r)},t.obtain=function(e,t,n,r,i){var a=o.sPool.obtain();return a?(a.key=e,a.frame=t,a.content=n,a.style=r,a.contextState=i):a=new o(e,t,n,r,i),a},t.prototype.recycle=function(){o.sPool.recycle(this)},t.prototype.hash=function(){return this.constructor.name},t.sPool=new a.L7(K),t=o=(0,n.__decorate)([(0,f.B7)(h.MJe),(0,n.__metadata)("design:paramtypes",[String,"function"==typeof(r=void 0!==h.IRect&&h.IRect)?r:Object,"function"==typeof(i="undefined"!=typeof JSX&&JSX.Element)?i:Object,"function"==typeof(s=void 0!==l.CssProperties&&l.CssProperties)?s:Object,"function"==typeof(c=void 0!==h.IContextState&&h.IContextState)?c:Object])],t)}(q),He=function(e){function t(t,o,n,r,i,a,l){var s=e.call(this,t,o,n,r,i)||this;return s.behindDoc=a,s.pagesInfo=l,s}var o,r,i,s,c;return(0,n.__extends)(t,e),o=t,t.obtain=function(e,t,n,r,i,a,l){var s=o.anchorPool.obtain();return s?(s.key=e,s.frame=t,s.content=n,s.style=r,s.contextState=i,s.behindDoc=a,s.pagesInfo=l):s=new o(e,t,n,r,i,a,l),s},t.prototype.recycle=function(){o.anchorPool.recycle(this)},t.anchorPool=new a.L7(K),t=o=(0,n.__decorate)([(0,f.B7)(h.lcA),(0,n.__metadata)("design:paramtypes",[String,"function"==typeof(r=void 0!==h.IRect&&h.IRect)?r:Object,"function"==typeof(i="undefined"!=typeof JSX&&JSX.Element)?i:Object,"function"==typeof(s=void 0!==l.CssProperties&&l.CssProperties)?s:Object,"function"==typeof(c=void 0!==h.IContextState&&h.IContextState)?c:Object,Boolean,Object])],t)}(We),je=function(e){function t(t,o,n,r,i,a,l,s,c,d,p,h,u,f){var g=e.call(this,{x:t.left,y:t.top,width:t.width,height:t.height})||this;return g.drawingFrame=t,g.path=o,g.effectExtent=n,g.fillStyle=r,g.strokeStyle=i,g.filter=a,g.contextState=l,g.placeholderImageSrc=s,g.containerWidth=c,g.containerHeight=d,g.chartInfo=p,g.textFill=h,g.headerFooterStyle=u,g.onRenderFinish=f,g}var o,r,i,s,c,d,p,g,y,v;return(0,n.__extends)(t,e),o=t,t.obtain=function(e){var t=e.frame,n=e.path,r=e.effectExtent,i=e.fillStyle,a=e.strokeStyle,l=e.filter,s=e.contextState,c=e.placeholderImageSrc,d=e.containerWidth,p=e.containerHeight,h=e.chartInfo,u=e.textFill,f=e.headerFooterStyle,g=e.onRenderFinish,y=o.sPool.obtain();return y?(y.drawingFrame=t,y.path=n,y.effectExtent=r,y.fillStyle=i,y.strokeStyle=a,y.filter=l,y.contextState=s,y.placeholderImageSrc=c,y.containerWidth=d,y.containerHeight=p,y.chartInfo=h,y.textFill=u,y.headerFooterStyle=f,y.onRenderFinish=g):y=new o(t,n,r,i,a,l,s,c,d,p,h,u,f,g),y},t.prototype.recycle=function(){o.sPool.recycle(this)},t.sPool=new a.L7(K),t=o=(0,n.__decorate)([(0,f.B7)(h.SeO),(0,n.__metadata)("design:paramtypes",["function"==typeof(r=void 0!==he.IFrame&&he.IFrame)?r:Object,"function"==typeof(i=void 0!==h.DrawingPath&&h.DrawingPath)?i:Object,"function"==typeof(s=void 0!==u.CTEffectExtent&&u.CTEffectExtent)?s:Object,"function"==typeof(c=void 0!==he.IFillStyle&&he.IFillStyle)?c:Object,"function"==typeof(d=void 0!==he.IStrokeStyle&&he.IStrokeStyle)?d:Object,"function"==typeof(p=void 0!==he.IFilter&&he.IFilter)?p:Object,"function"==typeof(g=void 0!==h.IContextState&&h.IContextState)?g:Object,String,Number,Number,Object,"function"==typeof(y=void 0!==u.DrawingTextFill&&u.DrawingTextFill)?y:Object,"function"==typeof(v=void 0!==l.CssProperties&&l.CssProperties)?v:Object,Function])],t)}(q),Ne=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),t.prototype.collect=function(t,o){e.prototype.collect.call(this,t,o)},t.prototype.renderObjectType=function(){return ce.Drawing},t}(ve),Ue=Ne,Je=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),t.prototype.collect=function(t,o){e.prototype.collect.call(this,t,o)},t.prototype.renderObjectType=function(){return ce.Container},t}(ve),Ge=Je;!function(e){e.Text="DefaultText",e.Line="DefaultLine",e.Graphics="DefaultGraphics",e.Drawing="DefaultDrawing",e.Container="DefaultContainer",e.Bitmap="DefaultBitmap",e.RoundRect="DefaultRoundRect",e.Component="DefaultComponent",e.Anchor="DefaultAnchor",e.Overlay="DefaultOverlay"}(pe||(pe={}));var Ye,Xe=function(){function e(){this._viewCount=0,this._collectorVector=[],this._collectorMap=new Map,this.zIndex=f.aP,this._textCollector=new me(de[j.TextRenderer]),this._lineCollector=new Se(de[j.LineRenderer]),this._graphicsCollector=new be(de[j.GraphicsRender]),this.drawingCollector=new Ue(de[j.DrawingRender]),this.containerCollector=new Ge(de[j.DrawingRender]),this._bitmapCollector=new Pe(de[j.BitmapRenderer]),this._roundRectCollector=new Te(de[j.RoundRectRenderer]),this._componentCollector=new Be(de[j.ComponentRenderer]),this._anchorCollector=new Le(de[j.AnchorRenderer]),this._overlayCollector=new Fe(de[j.OverlayRenderer]),this._collectorVector=[this._textCollector,this._lineCollector,this._graphicsCollector,this.drawingCollector,this.containerCollector,this._bitmapCollector,this._roundRectCollector,this._componentCollector,this._overlayCollector,this._anchorCollector],this._sort(),this._collectorMap.set(pe.Text,this._textCollector),this._collectorMap.set(pe.Line,this._lineCollector),this._collectorMap.set(pe.Graphics,this._graphicsCollector),this._collectorMap.set(pe.Drawing,this.drawingCollector),this._collectorMap.set(pe.Container,this.containerCollector),this._collectorMap.set(pe.Bitmap,this._bitmapCollector),this._collectorMap.set(pe.RoundRect,this._roundRectCollector),this._collectorMap.set(pe.Component,this._componentCollector),this._collectorMap.set(pe.Anchor,this._anchorCollector),this._collectorMap.set(pe.Overlay,this._overlayCollector)}return e.prototype._sort=function(){this._collectorVector.sort((function(e,t){return e.compare(t)}))},e.prototype.collect=function(e,t){var o="";e instanceof Q?o=pe.Text:e instanceof De?o=pe.Line:e instanceof Ae?o=pe.Graphics:e instanceof je?o=pe.Drawing:e instanceof ke?o=pe.Container:e instanceof Oe?o=pe.Bitmap:e instanceof ze?o=pe.RoundRect:e instanceof We?o=e instanceof He?pe.Anchor:pe.Component:e instanceof Ve&&(o=pe.Overlay),this.collectCustomView(o,e,t)},e.prototype.collectCustomView=function(e,t,o){if(!(e.length<=0)){var n=this.get(e);if(n){var r=f.nU.generatePriority(null!=o?o:l.Ypk.UpperDefault,this.zIndex);n.collect(t,r),this._viewCount=this._viewCount+1}}},Object.defineProperty(e.prototype,"collectors",{get:function(){return this._collectorVector},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewCount",{get:function(){return this._viewCount},enumerable:!1,configurable:!0}),e.prototype.add=function(e,t){if(this._collectorMap.has(e))throw new Error("");this._collectorMap.set(e,t),this._collectorVector.push(t),this._sort()},e.prototype.get=function(e){return this._collectorMap.get(e)},e.prototype.clear=function(){this._collectorVector.forEach((function(e){e.clear()})),this._viewCount=0},e.prototype.generateCollector=function(e,t){switch(e){case j.LineRenderer:return new Se(t);case j.TextRenderer:return new me(t);case j.BitmapRenderer:return new Pe(t);case j.GraphicsRender:return new be(t);case j.DrawingRender:return new Ue(t);case j.RoundRectRenderer:return new Te(t);case j.ComponentRenderer:return new Be(t);case j.OverlayRenderer:return new Fe(t);default:throw new Error("Error-RenderCollector: generateCollector")}},e}(),Ke=function(){function e(){this.collectEngine=new Xe,this.zoom=1,this.addonViewLayer=null,this.containerLayer=null,this.upperAnchorLayer=null,this.lowerAnchorLayer=null}return Object.defineProperty(e.prototype,"renderContext",{get:function(){return{renderDevice:this.renderDevice,mainView:this.mainRenderView,mainCtxState:{},addonViewLayer:this.addonViewLayer,containerLayer:this.containerLayer,upperAnchorLayer:this.upperAnchorLayer,lowerAnchorLayer:this.lowerAnchorLayer}},enumerable:!1,configurable:!0}),e.prototype.doRender=function(e){var t=this.collectEngine.collectors;this.renderEngine.render(t,e),this.collectEngine.clear()},e.prototype.initRenderViews=function(e,t,o,n){this.addonViewLayer={rootElements:e},this.containerLayer={rootElements:t},this.upperAnchorLayer={rootElements:o},this.lowerAnchorLayer={rootElements:n},this.renderEngine=new ye(this.renderContext)},e}(),qe=(0,a.FJ)(16830),Qe=function(e){function t(t,o){var n=e.call(this)||this;return n.mainCanvasRefs=[],n.currentMainCanvasRef=i().createRef(),n.prevPagesInRenderRect=[],n.prevPagesOutside=[],n.subCanvasCache=new Map,n.prevRenderedSubCanvasCache=new Map,n.layoutController=t,n.context=o,n}return(0,n.__extends)(t,e),Object.defineProperty(t.prototype,"mainRenderView",{get:function(){return this.getCanvasRenderRef().current},enumerable:!1,configurable:!0}),t.prototype.getRenderViewComponent=function(e,t,o,n){return this.createMainCanvasComponent(e,t,o,n)},t.prototype.render=function(e){var t,o=this,n=e.options,r=e.zoom,i=e.layoutBox,a=e.renderPages,l=e.doCollect,s=e.context,c=n.documentUpdated,d=n.dirtyPageIndexes;this.zoom=r,this.lastPageIndex=(null===(t=null==i?void 0:i.lastChild)||void 0===t?void 0:t.getSiblingIndex())||0,this.limitSubCanvasHeight=this.calcLimitSubCanvasHeight(r);var p=a.pagesInRenderRect,h=a.pagesOutside,u=this.calcToRenderPages(p,n);this.prevPagesInRenderRect=p,this.prevPagesOutside=h||[],Array.isArray(h)&&h.forEach((function(e){o.releaseCanvas(e),o.prevRenderedSubCanvasCache.delete(e)})),c&&d&&d.forEach((function(e){o.renderEngine.clearComponentView(e)})),this.clearSubCanvasCache(u),this.renderPages(u,i,l,n,s),c&&this.updateAddonViewInRenderRect(u,p)},Object.defineProperty(t.prototype,"renderDevice",{get:function(){return h.LgD.Canvas},enumerable:!1,configurable:!0}),t.prototype.renderPages=function(e,t,o,n,r){var i=this,s=n.renderWithReused;e.forEach((function(c,d){var p=a.Qr.now(),h=d===e.length-1,u=t.children[c];if(u){var f=i.subCanvasCache.get(c);if(!f){o({collectEngine:i.collectEngine,pageIndex:c});var g=a.Qr.now();i.renderByPage({pageBox:u,pageIndex:c,options:n,isLastRenderPage:h,context:r});var y=a.Qr.now();return r.fire(new l.kGF({render:y-p,collect:g-p,paint:y-g})),void i.prevRenderedSubCanvasCache.delete(c)}var v=i.prevRenderedSubCanvasCache.get(c),x=[],m=i.generateSubIndexes(f),w=m.inRenderRectSubIndexes;m.outRenderRectSubIndexes.forEach((function(e){i.releaseCanvas(c,e)}));var S=w.length;w.forEach((function(e,t){var a=h&&t===S-1;if(x.push(e),!s||!i.canSubCanvasReuse(v,e)){var l=o({pageIndex:c,subPageIndex:e,collectEngine:i.collectEngine,limitSubCanvasHeight:i.limitSubCanvasHeight});i.renderByPage({pageBox:u,pageIndex:c,options:n,context:r,collectRect:l,subPageIndex:e,isLastRenderPage:a})}})),i.prevRenderedSubCanvasCache.set(c,x),r.fire(new l.kGF({render:a.Qr.now()-p,containSubPage:!0}))}}))},t.prototype.generateSubIndexes=function(e){var t=[],o=[];return e.isInRenderRectList.forEach((function(e,n){e?t.push(n):o.push(n)})),{inRenderRectSubIndexes:t,outRenderRectSubIndexes:o}},t.prototype.canSubCanvasReuse=function(e,t){return e&&e.includes(t)},t.prototype.renderByPage=function(e){var t=e.pageBox,o=e.pageIndex,r=e.subPageIndex,i=e.context;this.resetPageCanvas(t,o,r),this.doRender((0,n.__assign)((0,n.__assign)({},e),{lastPageIndex:this.lastPageIndex,context:i}))},t.prototype.calcToRenderPages=function(e,t){var o=this,r=t.renderWithReused,i=t.dirtyPageIndexes,a=e.filter((function(e){return!o.prevPagesInRenderRect.includes(e)||o.subCanvasCache.has(e)}));if(i&&i.length>0){var l=i.filter((function(t){return e.includes(t)}));return Array.from(new Set((0,n.__spreadArray)((0,n.__spreadArray)([],(0,n.__read)(l),!1),(0,n.__read)(a),!1)))}return r?Array.from(new Set((0,n.__spreadArray)([],(0,n.__read)(a),!1))):(0,n.__spreadArray)([],(0,n.__read)(e),!1)},t.prototype.updateAddonViewInRenderRect=function(e,t){var o=this,n=t.filter((function(t){return!e.includes(t)}));window.requestAnimationFrame((function(){var e,t,r=null===(t=null===(e=o.renderContext)||void 0===e?void 0:e.addonViewLayer)||void 0===t?void 0:t.rootElements[0];r&&r.updateAddonViewOffset(n)}))},t.prototype.releaseCanvas=function(e,t){var o,n=this.mainCanvasRefs[e];(o=Array.isArray(n)&&void 0!==t&&n[t]?n[t].current:n.current)&&(o.width=1,o.height=1,o.style.width="1px",o.style.height="1px")},t.prototype.resetPageCanvas=function(e,t,o){var n=this.mainCanvasRefs[t];if(Array.isArray(n)&&void 0!==o&&n[o]?this.currentMainCanvasRef=n[o]:this.currentMainCanvasRef=n,this.currentMainCanvasRef){var r=this.getPageBoxPaddingBoxSize(e),i=r.width,l=r.height,s=(0,a.FJ)(i*this.zoom),c=(0,a.FJ)(l*this.zoom),d=Math.round(this.devicePixelRatio*s),p=Math.round(this.devicePixelRatio*c),h=0;if(void 0!==o){var u=this.calcSubCanvasVerticalInfo(o,l).subCanvasRectHeight,f=this.zoom*this.devicePixelRatio;h=Math.round((0,a.FJ)(this.limitSubCanvasHeight)*f)*o,p=Math.round((0,a.FJ)(u)*f)}this.reflashCurrentCanvasView(d,p,h),this.renderEngine.resetCanvasNode(this.mainRenderView)}},t.prototype.getCanvasRenderRef=function(){return this.currentMainCanvasRef},Object.defineProperty(t.prototype,"devicePixelRatio",{get:function(){var e=this.currentMainCanvasRef.current,t=null==e?void 0:e.getContext("2d");return t?Math.max(this.layoutController.docEnv.minCanvasScaleRatio,z.canvasScaleRatio(t)):window.devicePixelRatio||1},enumerable:!1,configurable:!0}),t.prototype.reflashCurrentCanvasView=function(e,t,o){var n=this.devicePixelRatio*this.zoom,r=e/this.devicePixelRatio,i=t/this.devicePixelRatio,a=o/this.devicePixelRatio,l=this.currentMainCanvasRef.current;if(l){var s=l.getContext("2d");s&&(s.clearRect(0,0,l.width,l.height),l.style.top="".concat(a,"px"),l.style.width="".concat(r,"px"),l.style.height="".concat(i,"px"),l.width=e,l.height=t,s.imageSmoothingEnabled=!0,s.setTransform(n,0,0,n,0,0))}},t.prototype.createMainCanvasComponent=function(e,t,o,n){return void 0===n&&(n=1),t.height<=0?null:(this.mainCanvasRefs[e]||(this.mainCanvasRefs[e]=i().createRef()),this.subCanvasCache.delete(e),this.exceedLimitCanvasHeight(o,n)?(this.limitSubCanvasHeight=this.calcLimitSubCanvasHeight(n),this.updateSubCanvasCache(e,t,o),this.generateSubCanvasElements(e)):this.generateCanvasElement(e,this.mainCanvasRefs[e]))},t.prototype.exceedLimitCanvasHeight=function(e,t){var o=this.context.docEnv.layoutType;return!(0,u.isPagedLayout)(o)&&!(0,u.isContinuousPagedLayout)(o)&&this.devicePixelRatio*(0,a.FJ)(e.totalBoxSize.height*t)/qe>4},t.prototype.calcLimitSubCanvasHeight=function(e){return 16830/e/this.devicePixelRatio},t.prototype.updateSubCanvasCache=function(e,t,o){for(var n=this.getPageBoxPaddingBoxSize(o),r=n.width,i=n.height,l=Math.ceil(i/this.limitSubCanvasHeight),s=[],c=0;c<l;c++){var d=this.calcSubCanvasVerticalInfo(c,i),p=d.subCanvasRectHeight,h=d.subCanvasRectTop,u=new a.HL({x:0,y:o.getOuterPoint().y+h,width:r,height:p});s.push(null==t?void 0:t.intersect(u))}this.subCanvasCache.set(e,{isInRenderRectList:s})},t.prototype.calcSubCanvasVerticalInfo=function(e,t){return{subCanvasRectHeight:Math.min(this.limitSubCanvasHeight,t-this.limitSubCanvasHeight*e),subCanvasRectTop:this.limitSubCanvasHeight*e}},t.prototype.generateSubCanvasElements=function(e){var t=this,o=this.subCanvasCache.get(e),n=null==o?void 0:o.isInRenderRectList;return Array.isArray(n)?(this.mainCanvasRefs[e]=[],n.map((function(o,n){var r=i().createRef();return t.mainCanvasRefs[e].push(r),t.generateCanvasElement(e,r,n)}))):null},t.prototype.generateCanvasElement=function(e,t,o){var n=void 0!==o?"".concat(e,"-").concat(o):"".concat(e),r="page-".concat(n);return i().createElement("canvas",{className:"melo-page-main-view ".concat(r),key:n,style:{position:"absolute"},ref:t})},t.prototype.clearSubCanvasCache=function(e){var t,o;try{for(var r=(0,n.__values)(this.prevRenderedSubCanvasCache.keys()),i=r.next();!i.done;i=r.next()){var a=i.value;e.includes(a)||this.prevRenderedSubCanvasCache.delete(a)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(t)throw t.error}}},t.prototype.getPageBoxPaddingBoxSize=function(e){return e.paddingBoxSize},t}(Ke),Ze=function(e){function t(){var t=e.call(this)||this;return t.mainSvgRefs=[],t.currentMainSvgRef=i().createRef(),t}return(0,n.__extends)(t,e),t.prototype.updateSVGView=function(e,t,o){this.currentMainSvgRef=this.mainSvgRefs[t];var n=new a.i2({width:e.totalBoxSize.width*o,height:e.totalBoxSize.height*o});this.initViewNode(this.currentMainSvgRef,n),this.renderEngine.resetCanvasNode(this.mainRenderView)},t.prototype.initViewNode=function(e,t){var o=e.current;o&&(o.style.width="".concat((0,a.FJ)(t.width),"px"),o.style.height="".concat((0,a.FJ)(t.height),"px"),o.innerHTML="",o.__context__=void 0)},t.prototype.mainSvgViewComponent=function(e){return this.mainSvgRefs[e]||(this.mainSvgRefs[e]=i().createRef()),i().createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",className:"melo-page-main-view",style:{position:"absolute"},ref:this.mainSvgRefs[e]})},Object.defineProperty(t.prototype,"renderDevice",{get:function(){return h.LgD.Svg},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mainRenderView",{get:function(){return this.currentMainSvgRef.current},enumerable:!1,configurable:!0}),t.prototype.getRenderViewComponent=function(e){return i().createElement(i().Fragment,null,this.mainSvgViewComponent(e))},t.prototype.render=function(e){var t,o=this,r=e.options,i=e.zoom,a=e.layoutBox,l=e.renderPages,s=e.doCollect,c=e.context,d=l.pagesNewRender,p=l.pagesInRenderRect;this.zoom=i;var h=(0,n.__spreadArray)([],(0,n.__read)(p),!1);Array.isArray(d)&&d.length>0&&(h=(0,n.__spreadArray)([],(0,n.__read)(d),!1));var u=h.length,f=(null===(t=null==a?void 0:a.lastChild)||void 0===t?void 0:t.getSiblingIndex())||0;h.forEach((function(e,t){var n=a.children[e],l=t===u-1;o.updateSVGView(n,e,i),s({collectEngine:o.collectEngine,pageIndex:e}),o.doRender({pageBox:n,options:r,pageIndex:e,context:c,lastPageIndex:f,isLastRenderPage:l})}))},t}(Ke),$e=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rootRef=i().createRef(),t}return(0,n.__extends)(t,e),t.prototype.componentDidMount=function(){this.attachBox(),this.lastBoxId=this.props.layoutBox.uuid},t.prototype.componentWillUnmount=function(){this.detachBox()},t.prototype.componentDidUpdate=function(){this.attachBox(),this.lastBoxId=this.props.layoutBox.uuid},t.prototype.attachBox=function(){var e=this.rootRef.current;if(e){var t=this.props.layoutBox;t.__node__&&(t.__node__.__vm__=null),e.__vm__&&(e.__vm__.__node__=null),e.__vm__=t,e.__type__=t.constructor.name,t.__node__=e}},t.prototype.detachBox=function(){var e=this.rootRef.current;if(e){var t=this.props.layoutBox;e.__vm__=null,e.__type__=null,t.__node__=null}},t}(r.Component),et=o(801134),tt=o.n(et),ot=function(e){var t,o,s,c=e.pageBox,d=e.layoutType,p=e.zoom,h=e.context,f=c.nextSibling,g=c.edge,y=(0,n.__read)((0,r.useMemo)((function(){if(!f)return[0,0];var e=f.edge,t=g.margin.bottom,o=e.padding.top,n=g.padding.bottom,r=function(e,t){return e.getOuterPoint().y+e.totalHeight-t}(c,t),i=(0,u.isContinuousPagedLayout)(d)?o+n:t,l=(0,a.FJ)(i)*p,s=(0,u.isContinuousPagedLayout)(d)?-l/2:0;return[l,(0,a.FJ)(r)*p+s]}),[g.margin.bottom,g.padding.bottom,d,f,c,p]),2),v=y[0],x=y[1],m=(o=h.layoutTypeManager.isWebLayoutInGray,s=d,(0,u.isPagedLayout)(s)?"hide-margin-cursor":o?(0,u.isContinuousPagedLayout)(s)?"show-margin-cursor":"":(0,u.isScrollLayout)(s)?"show-margin-cursor":""),w=tt()(l.F51.meloPageGap,((t={})[m]=h.isEditable(),t));return f?i().createElement("div",{className:w,style:{backgroundColor:"transparent",opacity:.3,width:"100%",height:"".concat(v,"px"),pointerEvents:"auto",top:"".concat(x,"px"),zIndex:O.GapView},onMouseDown:function(e){return e.stopPropagation()},onMouseUp:function(e){return e.stopPropagation()},onMouseMove:function(e){h.isEditable()&&(h.fire(new l.G5c({clientX:e.clientX,clientY:e.clientY})),e.stopPropagation())},onMouseLeave:function(e){h.isEditable()&&(h.fire(new l.G_J),e.stopPropagation())},onDoubleClick:function(e){h.isEditable()&&(h.fire(new l.YDw),e.stopPropagation())}}):null};!function(e){e[e.Ignore=0]="Ignore",e[e.Render=1]="Render",e[e.Break=2]="Break"}(Ye||(Ye={}));var nt=function(){function e(){this._viewRegion={x:0,y:0,width:0,height:0},this._incRegion={x:0,y:0,width:0,height:0}}return Object.defineProperty(e.prototype,"viewRegion",{get:function(){return this._viewRegion},set:function(e){this._viewRegion=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"incRegion",{get:function(){return this._incRegion},set:function(e){this._incRegion=e},enumerable:!1,configurable:!0}),e.prototype.shouldRender=function(e){var t={start:this._incRegion.y,end:this._incRegion.y+this._incRegion.height},o=f.bV.relationBetween(t,e);return o===f.cR.DESC?Ye.Ignore:o===f.cR.ASC?Ye.Break:Ye.Render},e}(),rt=function(){function e(e,t){this.context=e,this.shares=t}return e.prototype.skipRender=function(e){return e.layoutBox.isHiddenByRevision||!e.onlyAnchors&&(0,h.vvs)(e.layoutBox)},e.prototype.skipDrawingRender=function(e){var t,o=!!(null===(t=e.flags)||void 0===t?void 0:t.isCollectFloatingBoxes);if((0,h.vvs)(e.layoutBox)){if(!o)return!0}else if(o)return!0;return!1},e.prototype.renderRectBorder=function(e,t,o,n){var r=ze.obtain((0,l.SsA)(e.x,e.y-o.incRegion.y,e.width,e.height),"preview-diff",{radius:0},null==n?void 0:n.contextState);t.collect(r)},e}(),it=o(94130),at=o(723841),lt=o(259356),st=o(947229),ct=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),t.prototype.render=function(){return i().createElement("table",{style:{width:this.props.contentSize.width,height:this.props.contentSize.height},className:l.F51.scrollerDefaultContent,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave,onMouseMove:this.props.onMouseMove,onTouchEnd:this.props.onTouchEnd})},t}(i().Component),dt=236,pt=(0,a.Ej)(3.5),ht=(0,a.Ej)(1),ut=function(){function e(e){this.tableBox=e}return e.prototype.autoAdjustCol=function(e,t){var o=this.locateBoxOfDistance(e),n=o.matchCellBoxes,r=o.acrossCellBoxes;if(0!==n.length){var i=n[0].getRangeBegin();if(-1!==i){var a=this.resolveExpandWidth(n);if(0!==a)if(a<0)t(i,a=Math.max(a,-this.maxShrinkWidth(r)));else{var l=this.getRightSpaceOfTable();l<dt||t(i,a=Math.min(l,a))}}}},e.prototype.autoAdjustAllCols=function(e){var t=this.computeRegularCols();t&&e(t)},e.prototype.locateBoxOfDistance=function(e){var t,o,r,i,a=[],l=[],s=e-pt,c=e+pt;try{for(var d=(0,n.__values)(this.tableBox.children),p=d.next();!p.done;p=d.next()){var h=p.value,u=0;try{for(var f=(r=void 0,(0,n.__values)(h.children)),g=f.next();!g.done;g=f.next()){var y=g.value,v=u+y.totalWidth;if(v>s&&v<c){a.push(y);break}if(e>u&&e<v){l.push(y);break}u=v}}catch(e){r={error:e}}finally{try{g&&!g.done&&(i=f.return)&&i.call(f)}finally{if(r)throw r.error}}}}catch(e){t={error:e}}finally{try{p&&!p.done&&(o=d.return)&&o.call(d)}finally{if(t)throw t.error}}return{matchCellBoxes:a,acrossCellBoxes:l}},e.prototype.resolveExpandWidth=function(e){var t=this;return e.reduce((function(e,o){var n=t.maxContentWidth(o);return n?Math.max(e,t.straightenContentWidth(o)-n):e}),Number.MIN_SAFE_INTEGER)},e.prototype.maxContentWidth=function(e){var t=e.firstChild;if(!t)return 0;var o=t.edge.padding;return o?t.paddingBoxSize.width-o.left-o.right:0},e.prototype.maxShrinkWidth=function(e){var t=this;return e.reduce((function(e,o){var n=t.maxContentWidth(o)-dt;return Math.min(n,e)}),Number.MAX_SAFE_INTEGER)},e.prototype.straightenContentWidth=function(e){var t,o=this,n=null===(t=e.firstChild)||void 0===t?void 0:t.children;return n&&0!==n.length?n.reduce((function(e,t){return Math.max(e,o.getParaContentWidth(t))}),0):0},e.prototype.computeRegularCols=function(){var e=this.getColCount();if(e){for(var t=new Map,o=new Map,n=new Map,r=new Map,i=this.tableBox.totalWidth,a=0,l=0;l<e;l++){var s=this.colInfo(this.getColCells(l));s.isBlankCol?(t.set(l,s.width),r.set(l,s.minWidth),i-=s.width,a+=s.width-s.minWidth):s.canAccommodate?(o.set(l,s.flatContentWidth),o[l]=s.flatContentWidth,i-=s.flatContentWidth):(n.set(l,s.flatContentWidth),i-=s.flatContentWidth)}var c=this.getRightSpaceOfTable();if(!(n.size>0?a+c<=ht:Math.abs(i-c)<=ht)){if(i>=0)return this.toCols([o,t,n]);var d=a+i;return this.apportionWidth(d>0?r:n,d),this.toCols([o,r,n])}}},e.prototype.getColCells=function(e){var t,o,r=[];try{for(var i=(0,n.__values)(this.tableBox.children),a=i.next();!a.done;a=i.next()){var l=a.value;l.children[e]&&r.push(l.children[e])}}catch(e){t={error:e}}finally{try{a&&!a.done&&(o=i.return)&&o.call(i)}finally{if(t)throw t.error}}return r},e.prototype.apportionWidth=function(e,t){var o,r,i,a;if(0!==e.size){var l=0;try{for(var s=(0,n.__values)(e),c=s.next();!c.done;c=s.next())l+=f=(0,n.__read)(c.value,2)[1]}catch(e){o={error:e}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(o)throw o.error}}try{for(var d=(0,n.__values)(e),p=d.next();!p.done;p=d.next()){var h=(0,n.__read)(p.value,2),u=h[0],f=h[1];e.set(u,f+Math.floor(f/l*t))}}catch(e){i={error:e}}finally{try{p&&!p.done&&(a=d.return)&&a.call(d)}finally{if(i)throw i.error}}}},e.prototype.toCols=function(e){var t,o,r,i,a=[];try{for(var l=(0,n.__values)(e),s=l.next();!s.done;s=l.next()){var c=s.value;try{for(var d=(r=void 0,(0,n.__values)(c)),p=d.next();!p.done;p=d.next()){var h=(0,n.__read)(p.value,2),u=h[0],f=h[1];a[u]=f}}catch(e){r={error:e}}finally{try{p&&!p.done&&(i=d.return)&&i.call(d)}finally{if(r)throw r.error}}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(o=l.return)&&o.call(l)}finally{if(t)throw t.error}}return a},e.prototype.colInfo=function(e){var t=this,o=!0,n=0,r=0,i=dt,a=!0;e.forEach((function(e){var l;if(void 0===e.mergedType){o=o&&t.isBlankCell(e);var s=null===(l=e.firstChild)||void 0===l?void 0:l.edge.padding,c=((null==s?void 0:s.left)||0)+((null==s?void 0:s.right)||0);n=Math.max(t.straightenContentWidth(e)+c,n),r=Math.max(e.totalWidth,r),i=Math.max(c+dt,i),a=a&&e.totalWidth>=n}}));var l=Math.max(this.maxContentWidth(e[0])-n,0);return{flatContentWidth:n,isBlankCol:o,minWidth:i,width:r,canAccommodate:a,remainingSpace:l}},e.prototype.getColCount=function(){return this.tableBox.children.reduce((function(e,t){return Math.max(e,t.children.length)}),0)},e.prototype.getParaContentWidth=function(e){var t;return(0,h.YPi)(e)?e.contentSize.width:e.children.reduce((function(e,t,o){var n,r,i,a,l,s=t.totalWidth-(null!==(r=null===(n=t.edge)||void 0===n?void 0:n.width)&&void 0!==r?r:0);return 0===o&&(s+=null!==(a=null===(i=t.edge.margin)||void 0===i?void 0:i.left)&&void 0!==a?a:0),t instanceof R.vm&&(s+=(null===(l=t.listMark)||void 0===l?void 0:l.totalWidth)||0),Math.ceil(s)+e}),null!==(t=e.edge.width)&&void 0!==t?t:0)},e.prototype.isBlankCell=function(e){var t,o=null===(t=e.firstChild)||void 0===t?void 0:t.children;return!o||0===o.length||o.every((function(e){var t=e.getFirstDescendantOf(h.uOS.Text);return!t||t instanceof R.w8}))},e.prototype.getRightSpaceOfTable=function(){for(var e=this.getColCount(),t=0,o=0;o<e;o++)t+=this.colInfo(this.getColCells(o)).remainingSpace;var n=0;return this.tableBox.parentBox&&(n=Math.max(this.tableBox.parentBox.totalWidth-this.tableBox.totalWidth,0)),t+n},e}();function ft(e,t){var o=t.children.findIndex((function(t){return t===e}));return-1===o?0:t.children.slice(0,o).reduce((function(e,t){return e+t.totalWidth}),0)}var gt,yt=p(ct),vt=(0,a.Ej)(4),xt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={draggerInfo:{scrollLeft:0,edge:"none",top:0,left:0,width:0,height:0,colDraggerShow:!1,rowDraggerShow:!1},colGuiderShow:!1,rowGuiderShow:!1,colGuiderLeftPos:0,rowGuiderTopPos:0,showTableHeader:!1,showColAddIcon:!1,showRowAddIcon:!1,isTableActivited:!1,selectedRange:null,selectedCellRanges:[],hasRestrictEditPermission:!0},t.refTable=i().createRef(),t.tableScrollLeft=0,t.tableScrollWidth=Number.MAX_SAFE_INTEGER,t.selectionChange=function(e){if(!t.isSelectionInCurrentTable(e.range.begin())||!t.state.hasRestrictEditPermission)return t.resetHeader(),void t.hideIcon(R.s9.getFirstTableBox(t.props.layoutBox));t.showIcon(R.s9.getFirstTableBox(t.props.layoutBox),!0);var o=e.cellRange,n=e.range,r=t.props.shares.state.selection.tableSelectionArea;t.setState({isTableActivited:!0,showTableHeader:t.isEnableTableShortCuts,selectedRange:n,selectedCellRanges:(null==o?void 0:o.cellRanges)||(null==r?void 0:r.cellRanges)}),t.lastNotification=e},t.onMouseEnter=function(){t.setState({isTableActivited:!0})},t.onMouseLeave=function(){t.setState({isTableActivited:!1})},t.onApplyDrag=function(e,o,n){var r=e.getRangeBegin();if(-1!==r){var i=t.state.draggerInfo,l=i.edge,s=i.rowHeight,c=i.colWidth,d=(0,a.Ej)(o);"top"===l||"bottom"===l?t.modifyRowHeight(r,s,d,l):"left"!==l&&"right"!==l||t.modifyColWidth(r,c,d,l,e.getSiblingIndex(),n)}},t.onFinishDrag=function(e,o){var n=t.state.draggerInfo,r=n.box,i=n.rowHeight,a=n.colWidth;r&&0!==e&&r&&i&&a&&t.onApplyDrag(r,e,o)},t.onFinishResizeDrag=function(e,o){var n=(0,a.Ej)(e),r=(0,a.Ej)(o);if(n||r){var i=t.props.layoutBox,s=i.firstChild,c=i.children;if(s){var d=c.reduce((function(e,t){return e+t.totalHeight}),0),p=(d+r)/d,h=(t.props.layoutBox.totalWidth+n)/t.props.layoutBox.totalWidth,u=[];1!==p&&(u=c.map((function(e){return p*e.totalHeight}))),t.props.context.fire(new l.LB5(h,u,t.props.layoutBox.getRangeBegin(),s.getRangeBegin(),t.props.layoutBox.nestingLevel))}}},t.onMouseMove=function(e){var o;if(t.refTable.current){var n=e.clientX,r=e.clientY,i=null===(o=t.refTable.current)||void 0===o?void 0:o.getBoundingClientRect(),l=(0,a.Ej)(n-i.left)/t.zoom+t.props.scrollLeft,s=(0,a.Ej)(r-i.top)/t.zoom,c=t.findCellBoxForPos(t.props.layoutBox,{x:l,y:s}),d=c.box,p=c.offset,h=c.edge;d&&t.moveDraggerToBox(d,p,h)}},t.handleColAdjust=function(e){var o=t.getDistanceToTableLeft(e);void 0!==o&&(o>-pt&&o<pt?t.adjustAllColsWidth():t.adjustColWidth(o))},t.handleColSelect=function(e){var o;if(t.refTable.current)for(var n=e.clientX,r=e.clientY,i=null===(o=t.refTable.current)||void 0===o?void 0:o.getBoundingClientRect(),s=(0,a.Ej)(n-i.left)/t.zoom+t.props.scrollLeft,c=(0,a.Ej)(r-i.top)/t.zoom,d=l.d_x.createAllTableCellPointIterator(t.props.layoutBox,{x:0,y:0}),p={x:s,y:c},h=d.next();!h.done;){var u=h.value,f=u.layoutBox,g=u.offset;if(t.isPosInCellBox(p,g,f))return void t.props.context.fire(new l.IjZ(f.getRanges()));h=d.next()}},t.adjustColWidth=function(e){new ut(t.props.layoutBox).autoAdjustCol(e,(function(e,o){t.props.context.fire(new l.jcg(e,Math.floor(o),t.nestingLevel))}))},t.adjustAllColsWidth=function(){new ut(t.props.layoutBox).autoAdjustAllCols((function(e){t.props.context.fire(new l.XNP(t.props.layoutBox.getRangeBegin(),e,t.nestingLevel))}))},t.handleEnterColOrRowDragger=function(e){t.setState({draggerInfo:(0,n.__assign)((0,n.__assign)({},t.state.draggerInfo),{colDraggerShow:e===l.n0j.Col,rowDraggerShow:e===l.n0j.Row})})},t.handleLeaveColOrRowDragger=function(){t.setState({draggerInfo:(0,n.__assign)((0,n.__assign)({},t.state.draggerInfo),{colDraggerShow:!1,rowDraggerShow:!1})})},t}var o;return(0,n.__extends)(t,e),Object.defineProperty(t.prototype,"isEnableTableShortCuts",{get:function(){return this.props.layoutBox.isRootNesting},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nestingLevel",{get:function(){return this.props.layoutBox.nestingLevel},enumerable:!1,configurable:!0}),t.prototype.renderIconLayer=function(){var e=this;return i().createElement("div",{style:{position:"absolute",top:0,left:"-97px",width:"calc(100% + 194px)",height:"100%",zIndex:-1},onMouseEnter:function(t){var o=R.s9.getFirstTableBox(e.props.layoutBox);e.showIcon(o);var n=t.currentTarget.getBoundingClientRect(),r=n.left,i=n.top,l=n.width,s=n.height,c=(0,a.P2)((function(t){var n=t.clientX,a=t.clientY;(n<Math.floor(r)||n>Math.ceil(r+l)||a<Math.floor(i)||a>Math.ceil(i+s))&&(e.hideIcon(o),window.removeEventListener("mousemove",c))}),50);window.removeEventListener("mousemove",c),window.addEventListener("mousemove",c)}})},t.prototype.componentDidMount=function(){var e,t,o=this;this.initHeaderState(),this.selectionChangeFn=this.selectionChange.bind(this),this.isEnableTableShortCuts&&this.props.context.on(at.at.CoreSelectionChange,this.selectionChangeFn,this),this.restrictProtectSubscription=this.eventEmitter.listen("$onRestrictProtectChange",(function(e){var t,n,r;if(e){var i=null===(t=o.props.layoutBox)||void 0===t?void 0:t.getRange();i&&o.props.context instanceof it.zq&&!(null===(r=null===(n=o.props.context.state)||void 0===n?void 0:n.getRestrictEdit())||void 0===r?void 0:r.checkPermissionRangeByGcpRange(i))&&o.setState({hasRestrictEditPermission:!1})}else o.setState({hasRestrictEditPermission:!0})}));var n=null===(e=this.props.layoutBox)||void 0===e?void 0:e.getRange();if(n&&this.props.context instanceof it.zq&&this.props.context.isRestrictProtectOn){var r=!!(null===(t=this.props.context.state)||void 0===t?void 0:t.getRestrictEdit().checkPermissionRangeByGcpRange(n));this.setState({hasRestrictEditPermission:r})}else this.setState({hasRestrictEditPermission:!0})},t.prototype.componentWillUnmount=function(){var e;this.props.context.removeCallBack(at.at.CoreSelectionChange,this.selectionChangeFn),null===(e=this.restrictProtectSubscription)||void 0===e||e.unsubscribe()},t.prototype.shouldComponentUpdate=function(e,t){return this.shouldTableElementUpdate(t)||t.colGuiderLeftPos!==this.state.colGuiderLeftPos||t.rowGuiderTopPos!==this.state.rowGuiderTopPos||!(0,f.vZ)(t.draggerInfo,this.state.draggerInfo)||!(0,f.vZ)(t.selectedRange,this.state.selectedRange)||!(0,f.vZ)(t.selectedCellRanges,this.state.selectedCellRanges)||!(0,f.vZ)(this.props,e)},t.prototype.onScroll=function(e){var t;this.tableScrollLeft=(null===(t=null==e?void 0:e.current)||void 0===t?void 0:t.scrollLeft)||0,this.props.context.fire(new l.Vpn(this.props.layoutBox.getRangeBegin()))},t.prototype.render=function(){return i().createElement("div",{style:{position:"relative",overflow:"visible",width:"100%"},className:"".concat(l.F51.meloTableWrapper," ").concat(this.props.cbKey),onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,ref:this.refTable},this.renderColRowDragger(),this.props.layoutBox.isRootNesting?i().createElement(yt,(0,n.__assign)({},this.props,{onDidMount:this.onScrollerDidMount.bind(this),onSelectionEnd:this.onSelectionEnd.bind(this),onScroll:this.onScroll.bind(this),onMouseMove:this.onMouseMove.bind(this),isTableActivited:this.state.isTableActivited,isTable:!0,hasRestrictEditPermission:this.state.hasRestrictEditPermission})):i().createElement("div",{style:{width:this.props.rectSize.width,height:this.props.rectSize.height},onMouseMove:this.onMouseMove}),this.isLastTableBox()?this.renderTableScaleDragger():"",this.renderTableHeader())},t.prototype.renderColRowDragger=function(){return this.props.shares.isEditable()?i().createElement(l.Oy7,(0,n.__assign)({},(0,n.__assign)((0,n.__assign)({},this.state.draggerInfo),{context:this.props.context,layoutBox:this.props.layoutBox,cbKey:this.props.cbKey,colGuiderShow:this.state.colGuiderShow,rowGuiderShow:this.state.rowGuiderShow,showTableHeader:this.state.showTableHeader,colGuiderLeftPos:this.state.colGuiderLeftPos,rowGuiderTopPos:this.state.rowGuiderTopPos,onFinish:this.onFinishDrag,zoom:this.zoom,width:this.props.rectSize.width,height:this.props.rectSize.height,onColAdjust:this.handleColAdjust,scrollLeft:-(0,a.FJ)(this.props.scrollLeft)*this.zoom,onEnterDragger:this.handleEnterColOrRowDragger.bind(this),onLeaveDragger:this.handleLeaveColOrRowDragger.bind(this),onColSelect:this.handleColSelect.bind(this),hasRestrictEditPermission:this.state.hasRestrictEditPermission}))):null},t.prototype.renderTableScaleDragger=function(){var e=this.props.context;if((null==e?void 0:e.isInBlockState())||!this.isMobileWebView())return null;var t=this.props.layoutBox.edge,o=(0,a.FJ)(t.border.width.left);return this.props.shares.isEditable()&&(this.state.isTableActivited||this.state.showTableHeader)&&this.isEnableTableShortCuts?i().createElement(l.M5B,(0,n.__assign)({},{onFinish:this.onFinishResizeDrag,selTable:this.selTable.bind(this),zoom:this.zoom,width:this.props.rectSize.width+o,height:this.props.rectSize.height,nestingLevel:this.props.layoutBox.nestingLevel,editor:this.props.context,layoutBox:this.props.layoutBox,hasRestrictEditPermission:this.state.hasRestrictEditPermission})):null},t.prototype.handleBlur=function(){this.setState({showTableHeader:!1,isTableActivited:!1})},t.prototype.isMobileWebView=function(){return!!this.props.context},t.prototype.handleFocus=function(){this.lastNotification&&this.selectionChange(this.lastNotification)},t.prototype.onSelectionEnd=function(e,t,o){var n=this.getRelativeBoxesOnSelectionEnd(e),r=function(e){var t=e.getRoot();if(!t)return null;var o=t.getElementsByClassName(l.F51.meloDocView);return 0===o.length?null:o[0]}(this.props.context);if(n&&(null==t?void 0:t.current)&&r){var i=n.cellBox,s=n.rowBox,c=t.current.getBoundingClientRect(),d=r.getBoundingClientRect(),p=c.left-d.left,h=e.clone().getDocumentOffset().x*this.zoom,u=this.tableScrollLeft+h-p,f=void 0;if(h<p){var g=u-this.props.rectSize.width+5;f=Math.max((0,a.FJ)(ft(i,s)),g)}else{if(!(h>p+c.width))return;var y=ft(i,s)+i.totalWidth;f=Math.min((0,a.FJ)(y)-this.props.rectSize.width,u-5)}o(this.props.cbKey,f,t.current.scrollTop),this.handleAutoHorizonScroll(f),this.props.context.fire(new l.Vy7)}return null},t.prototype.renderTableHeader=function(){var e,t=this.props.context;if((null==t?void 0:t.isInBlockState())||!this.isMobileWebView()||!this.state.hasRestrictEditPermission)return null;if(this.props.shares.isEditable()&&this.state.showTableHeader&&this.isEnableTableShortCuts){var o=null===(e=this.refTable.current)||void 0===e?void 0:e.getBoundingClientRect(),r=o?o.top:0;return i().createElement(l.xDH,(0,n.__assign)({},{cbKey:this.props.cbKey,rectSize:this.props.rectSize,contentSize:this.props.contentSize,layoutBox:this.props.layoutBox,context:this.props.context,shares:this.props.shares,zoom:this.zoom,scrollLeft:-(0,a.FJ)(this.props.scrollLeft),selectedRange:this.state.selectedRange,selectedCellRanges:this.state.selectedCellRanges,draggerInfo:this.state.draggerInfo,showColAddIcon:this.state.showColAddIcon,showRowAddIcon:this.state.showRowAddIcon,tableScrollLeft:this.tableScrollLeft,tableScrollWidth:this.tableScrollWidth,tableRelativePos:this.props.tableRelativePos,tableRectTop:r},{nestingLevel:this.props.layoutBox.nestingLevel,onEnterAddColIcon:this.handleEnterAddColIcon.bind(this),onLeaveAddColIcon:this.handleLeaveAddColIcon.bind(this),onEnterAddRowIcon:this.handleEnterAddRowIcon.bind(this),onLeaveAddRowIcon:this.handleLeaveAddRowIcon.bind(this),showColsOrRowsMoveInstruction:this.showColsOrRowsMoveInstruction.bind(this),hideColsOrRowsMoveInstruction:this.hideColsOrRowsMoveInstruction.bind(this),selTable:this.selTable.bind(this),hasRestrictEditPermission:this.state.hasRestrictEditPermission}))}return null},t.prototype.getCellBoxFromLeafBox=function(e){for(var t=e;t;){if((0,h.$5m)(t)&&t.isRootNesting)return t;if((0,h.t$M)(t))return null;t=t.parentBox}return null},t.prototype.shouldTableElementUpdate=function(e){return e.showTableHeader!==this.state.showTableHeader||e.isTableActivited!==this.state.isTableActivited||e.colGuiderShow!==this.state.colGuiderShow||e.rowGuiderShow!==this.state.rowGuiderShow},t.prototype.isLastTableBox=function(){return R.s9.getLastTableBox(this.props.layoutBox)===this.props.layoutBox},t.prototype.onScrollerDidMount=function(e){var t,o;this.tableScrollLeft=(null===(t=null==e?void 0:e.current)||void 0===t?void 0:t.scrollLeft)||0,this.tableScrollWidth=(null===(o=null==e?void 0:e.current)||void 0===o?void 0:o.clientWidth)||Number.MAX_SAFE_INTEGER},t.prototype.handleEnterAddColIcon=function(e){this.setState({colGuiderShow:!0,showColAddIcon:!0,colGuiderLeftPos:(e+this.tableScrollLeft+l.LV0/2)*this.zoom})},t.prototype.showColsOrRowsMoveInstruction=function(e,t){e!==l.n0j.Row?this.setState({colGuiderShow:!0,colGuiderLeftPos:t*this.zoom}):this.setState({rowGuiderShow:!0,rowGuiderTopPos:t*this.zoom})},t.prototype.hideColsOrRowsMoveInstruction=function(){this.setState({colGuiderShow:!1,rowGuiderShow:!1})},t.prototype.handleLeaveAddColIcon=function(){this.setState({colGuiderShow:!1,showColAddIcon:!1})},t.prototype.handleEnterAddRowIcon=function(e,t){this.setState({rowGuiderShow:!0,showRowAddIcon:!0,rowGuiderTopPos:(t+l.LV0/2)*this.zoom})},t.prototype.handleLeaveAddRowIcon=function(){this.setState({rowGuiderShow:!1,showRowAddIcon:!1})},t.prototype.isSelectionInCurrentTable=function(e){return this.props.shares.selectionOverlay.checkIfTable(this.props.layoutBox,e)},t.prototype.handleAutoHorizonScroll=function(e){0!==e&&this.onScroll&&this.onScroll()},t.prototype.initHeaderState=function(){if(this.isSelectionInCurrentTable()){var e=this.props.shares.state.selection.tableSelectionArea;if(e){var t=e.cellRanges,o=e.selectedRange;this.setState({selectedRange:o,isTableActivited:!0,showTableHeader:this.isEnableTableShortCuts,selectedCellRanges:t})}}},t.prototype.resetHeader=function(){this.setState({isTableActivited:!1,showTableHeader:!1,showColAddIcon:!1,showRowAddIcon:!1,colGuiderShow:!1,rowGuiderShow:!1,selectedRange:null,selectedCellRanges:[]})},t.prototype.getRelativeBoxesOnSelectionEnd=function(e){var t=this.getCellBoxFromLeafBox(e.leafBox);if(!t)return null;var o=t.parentBox;return o&&o.parentBox===this.props.layoutBox?{cellBox:t,rowBox:o}:null},t.prototype.showIcon=function(e,t){this.props.context.fire(new l.fyQ(e.getRangeBegin(),!0,t))},t.prototype.hideIcon=function(e){this.props.context.fire(new l.fyQ(e.getRangeBegin(),!1))},t.prototype.selTable=function(){var e=this.props,t=e.layoutBox;e.context.fire(new l.p1Y(t.getRangeBegin()))},t.prototype.modifyRowHeight=function(e,t,o,n){var r=t+o;this.props.context.fire(new l.LNB(e,r,n,this.nestingLevel))},t.prototype.modifyColWidth=function(e,t,o,n,r,i){var s,c,d;if(d="left"===n&&0===r?t-o:t+o,null===(c=null===(s=this.refTable.current)||void 0===s?void 0:s.parentElement)||void 0===c?void 0:c.parentElement){var p=this.refTable.current.parentElement.parentElement.getBoundingClientRect(),h=(0,a.Ej)(i-p.left/this.zoom),u=(0,a.Ej)(i-p.right/this.zoom+4);return this.props.context.fire(new l.LNB(e,d,n,this.nestingLevel,h,u)),void("left"===n&&o<0&&this.setState({draggerInfo:{edge:"none"}}))}this.props.context.fire(new l.LNB(e,d,n,this.nestingLevel))},t.prototype.advanceToBreakingTailBox=function(e){for(var t=0,o=e;o.prevPartial;)o=o.prevPartial;for(var n=o;n;){var r=n.parentBox;t+=r?r.rect.height:0,o=n,n=n.nextPartial}return{box:o,sumRowHeight:t}},t.prototype.getRenderRowHeightOfBox=function(e,t){var o=e;if("top"===t){var n=e.parentBox,r=e.logicIndex,i=n.prevSibling;i&&(o=i.children[r]||e)}var a=this.advanceToBreakingTailBox(o),l=a.box;if(void 0!==(null==l?void 0:l.mergedType)){var s=this.lastMergedBox(l);if(s&&s.parentBox)return s.parentBox.rect.height}return a.sumRowHeight},t.prototype.lastMergedBox=function(e){var t,o;if(!e.isMergeBegin)return null;var n=e;do{n=null===(o=null===(t=n.parentBox)||void 0===t?void 0:t.nextSibling)||void 0===o?void 0:o.children.find((function(t){return t.colBegin===e.colBegin}))}while(n&&void 0!==n.mergedType&&!n.isLastMerged);return n||null},t.prototype.getRenderColWidthOfBox=function(e){return e.paddingBoxSize.width},t.prototype.moveDraggerToBox=function(e,t,o){var n=this.props.layoutBox.edge.border.width,r=n.left,i=n.top,l=t.x+("right"===o?e.totalWidth:0);l-="right"===o?e.edge.border.width.right:r;var s=t.y+e.totalHeight-i,c=this.getValueRange(e,o),d=this.getRenderRowHeightOfBox(e,o),p=this.getRenderColWidthOfBox(e);this.setState({draggerInfo:{box:e,edge:o,valueRange:c,rowHeight:d,colWidth:p,left:(0,a.FJ)(l)*this.zoom,top:(0,a.FJ)(s)*this.zoom},isTableActivited:!0})},t.prototype.findCellBoxForPos=function(e,t){for(var o=l.d_x.createAllTableCellPointIterator(e,{x:0,y:0}),n=o.next();!n.done;){var r=n.value,i=r.layoutBox,a=r.offset;if(this.isPosInCellBox(t,a,i)){var s=this.findPosIfInCellBox(t,a,i);if(s)return s}n=o.next()}return{box:null,edge:"none",offset:{x:0,y:0}}},t.prototype.isPosInCellBox=function(e,t,o){var n=o.borderBoxSize,r=o.totalHeight;return e.x>t.x&&e.x<t.x+n.width&&e.y>t.y&&e.y<t.y+r},t.prototype.findPosIfInCellBox=function(e,t,o){var n=o.borderBoxSize,r=o.totalHeight;return 0===o.getSiblingIndex()&&Math.abs(e.x-t.x)<=vt?{box:o,edge:"left",offset:t}:Math.abs(n.width+t.x-e.x)<=vt?{box:o,edge:"right",offset:t}:void 0===o.mergedType&&Math.abs(r+t.y-e.y)<=vt?{box:o,edge:"bottom",offset:t}:null},t.prototype.getValueRange=function(e,t){var o=0;if("top"===t||"bottom"===t)o=e.totalHeight;else if("left"===t||"right"===t){var n=this.getRenderColWidthOfBox(e);if("left"===t&&0===e.getSiblingIndex()){var r=R.MM.getOffsetPoint(e,h.uOS.Page).x;return[(0,a.FJ)(r)+l.MYZ,(0,a.FJ)(r+n)]}o=n}return[(0,a.FJ)(o)]},t.prototype.getDistanceToTableLeft=function(e){var t;if(this.refTable.current){var o=e.clientX,n=null===(t=this.refTable.current)||void 0===t?void 0:t.getBoundingClientRect();return(0,a.Ej)(o-n.left)/this.zoom+this.props.scrollLeft}},Object.defineProperty(t.prototype,"zoom",{get:function(){return this.props.shares.scrollHandler.zoom()},enumerable:!1,configurable:!0}),(0,n.__decorate)([(0,lt.tB)(),(0,n.__metadata)("design:type","function"==typeof(o=void 0!==st.v&&st.v)?o:Object)],t.prototype,"eventEmitter",void 0),t}(i().Component),mt=function(){function e(){this.renderers=[]}return e.prototype.addExtendRenderer=function(e){this.renderers.push(e)},e.prototype.removeAll=function(){this.renderers=[]},e.prototype.draw=function(e,t){this.renderers.map((function(o){return o.draw(e,t)}))},e.prototype.rendererCount=function(){return this.renderers.length},e}(),wt=function(){function e(){this.map=new Map,this.map.set(l.Rli.Text,new mt),this.map.set(l.Rli.Paragraph,new mt),this.map.set(l.Rli.Page,new mt),this.map.set(l.Rli.Textframe,new mt),this.map.set(l.Rli.LeafContainer,new mt),this.map.set(l.Rli.TextLineFragment,new mt),this.map.set(l.Rli.TextLine,new mt),this.map.set(l.Rli.OverlayParagraph,new mt),this.map.set(l.Rli.OverlayTaskCheckbox,new mt),this.map.set(l.Rli.OverlayTable,new mt),this.map.set(l.Rli.Image,new mt)}return e.prototype.getExtendRenderer=function(e){return this.map.get(e)},e.prototype.addExtendRenderer=function(e,t){var o=this.map.get(e);o&&o.addExtendRenderer(t)},e.prototype.removeAll=function(){this.map.forEach((function(e){e.removeAll()}))},e}(),St=new Map,Ct=function(e){function t(t,o,n,r,i,a){var l=e.call(this)||this;return l.shares=t,l.collectEngine=o,l.offset=n,l.viewRegion=r,l.contextState=i,l.isInHeaderFooter=a,l.disableClipInfo=!1,l.offset=n,l}return(0,n.__extends)(t,e),t.prototype.setDisableClipInfo=function(e){this.disableClipInfo=e},t.prototype.getCurrentState=function(){return{offset:this.offset,viewRegion:this.viewRegion,zIndex:this.collectEngine.zIndex,contextState:this.contextState,docViewType:this.shares.docEnv.docViewType,isFocusHeaderFooter:this.shares.isFocusHeaderFooter,isInHeaderFooter:this.isInHeaderFooter}},t.prototype.isInFoucs=function(){return this.isInHeaderFooter&&this.shares.isFocusHeaderFooter||!this.isInHeaderFooter&&!this.shares.isFocusHeaderFooter},t.prototype.addView=function(e,t,o){void 0===t&&(t=l._AL.extend),void 0===o&&(o={clipOffsetX:0,clipOffsetWidth:0}),e instanceof We?this.addComponentView(e,t,o):this.addOtherView(e,t,o)},t.prototype.addComponentView=function(e,t,o){var n=e,r=this.getCustomViewData(o),i=r.clipOffsetX,a=r.clipOffsetWidth,s=r.offset,c=r.viewRegion,d=r.contextState,p=r.zIndex,h=(0,l.SsA)(e.frame.x+s.x,e.frame.y+s.y,e.frame.width,e.frame.height),u=h;if(null==d?void 0:d.clipInfo){var f=o.independentRender?0:c.y,g=(0,l.SsA)((null==d?void 0:d.clipInfo.x)+i,(null==d?void 0:d.clipInfo.y)+f,(null==d?void 0:d.clipInfo.width)+a,null==d?void 0:d.clipInfo.height);u=(0,l.Aa5)(h,g)}u.width<0||u.height<0||(n.frame=h,n.contextState=(0,l.jVi)((null==d?void 0:d.clipInfo)&&!o.disableClip?u:void 0),this.collectEngine.zIndex=p,this.collectEngine.collect(n,t))},t.prototype.addOtherView=function(e,t,o){var n=e,r=this.getCustomViewData(o),i=r.clipOffsetX,a=r.clipOffsetWidth,s=r.offset,c=r.viewRegion,d=r.contextState,p=r.zIndex;n.frame=(0,l.SsA)(e.frame.x+s.x,e.frame.y+s.y-c.y,e.frame.width,e.frame.height),o.disableClip?n.contextState=d?(0,l.jVi)(void 0,d.textTransform):d:(null==d?void 0:d.clipInfo)?n.contextState=(0,l.jVi)((0,l.SsA)((null==d?void 0:d.clipInfo.x)+i,null==d?void 0:d.clipInfo.y,(null==d?void 0:d.clipInfo.width)+a,null==d?void 0:d.clipInfo.height)):n.contextState=d,this.collectEngine.zIndex=p,this.collectEngine.collect(n,t)},t.prototype.createScrollElement=function(e){var t=this.shares.renderState.getScrollerInfo(e.props.cbKey)||{left:0,top:0},o=St.get(e.componentClass);return o||(o=p(e.componentClass),St.set(e.componentClass,o)),i().createElement(o,(0,n.__assign)({},e.props,{contentSize:{width:(0,a.FJ)(e.contentSize.width),height:(0,a.FJ)(e.contentSize.height)},rectSize:{width:(0,a.FJ)(e.frame.width),height:(0,a.FJ)(e.frame.height)},shares:this.shares,scrollLeft:(0,a.Ej)(t.left),scrollTop:(0,a.Ej)(t.top)}))},t.prototype.freezeWithClips=function(e){var t,o=null===(t=this.contextState)||void 0===t?void 0:t.clipInfo;if(o)return e?(0,a.FJ)((null==o?void 0:o.x)-this.offset.x):(0,a.FJ)((null==o?void 0:o.y)-this.offset.y)},t.obtain=function(e,o,n,r,i){var a=t.sPool.obtain();return a?(a.shares=e,a.collectEngine=o,a.offset=n,a.viewRegion=r,a.contextState=null==i?void 0:i.contextState,a.isInHeaderFooter=null==i?void 0:i.isInHeaderFooter):a=new t(e,o,n,r,null==i?void 0:i.contextState,null==i?void 0:i.isInHeaderFooter),a},Object.defineProperty(t.prototype,"containerFocus",{get:function(){return this.shares.containerFocus},enumerable:!1,configurable:!0}),t.prototype.recycle=function(){t.sPool.recycle(this)},t.prototype.getCustomViewData=function(e){var t,o,r,i,a,l,s;return{clipOffsetX:null!==(t=null==e?void 0:e.clipOffsetX)&&void 0!==t?t:0,clipOffsetWidth:null!==(o=null==e?void 0:e.clipOffsetWidth)&&void 0!==o?o:0,offset:null!==(r=null==e?void 0:e.offset)&&void 0!==r?r:this.offset,viewRegion:null!==(i=null==e?void 0:e.viewRegion)&&void 0!==i?i:this.viewRegion,contextState:null!==(a=null==e?void 0:e.contextState)&&void 0!==a?a:(0,n.__assign)((0,n.__assign)({},this.contextState),{clipInfo:this.disableClipInfo||null===(l=this.contextState)||void 0===l?void 0:l.clipInfo}),zIndex:null!==(s=null==e?void 0:e.zIndex)&&void 0!==s?s:this.collectEngine.zIndex}},t.sPool=new a.L7(100),t}(a.wo),bt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),t.prototype.getScrollLeft=function(e){var t=e.layoutBox,o=e.shares,n=t.contentSize,r=t.rectSize;if(n.width>r.width){var i=o.renderState.getScrollerInfo((0,l.NQT)(t.tableId))||{left:0};return Math.min(Math.ceil(n.width-r.width)+(0,a.Ej)(c),(0,a.Ej)(i.left))}return o.renderState.setScrollerInfo((0,l.NQT)(t.tableId),{left:0,top:0}),0},t.prototype.getClipInfo=function(e){var t,o=e.layoutBox,n=e.offset,r=e.flags,i=e.checker,a=null===(t=null==r?void 0:r.contextState)||void 0===t?void 0:t.clipInfo;if(!o.isRootNesting)return a;var s=o.contentSize,c=o.rectSize;if(s.width>c.width){var d=Math.ceil(c.width+15),p=Math.ceil(c.height+15),h=(0,l.SsA)(n.x,n.y-i.incRegion.y,d,p);return a?(0,l.Aa5)(h,a):h}return a},t.prototype.render=function(e){var t,o=e.layoutBox,r=e.offset,i=e.appendBox,a=e.traversalRange,s=e.flags;if(!this.skipRender(e)){this.renderWrapper(e);var c=this.getScrollLeft(e),d=this.getClipInfo(e),p=(0,l.jVi)(d,null===(t=null==s?void 0:s.contextState)||void 0===t?void 0:t.textTransform);i({layoutBox:o,offset:{x:r.x-c,y:r.y},traversalRange:a,flags:(0,n.__assign)((0,n.__assign)({},s),{contextState:p})}),this.invokeExtendRenderer(l.Rli.OverlayTable,e)}},t.prototype.renderWrapper=function(e){var t=e.offset,o=e.collector,n=e.shares,r=e.layoutBox,s=e.context,c=r.contentSize,d=this.getScrollLeft(e),p=this.createTableFrame(e);if((0,l.UHV)(p)){var h=We.obtain("table-".concat(r.uuid),p,i().createElement(xt,{scrollLeft:r.isRootNesting?d:p.x-t.x,scrollTop:0,cbKey:(0,l.NQT)(r.tableId),context:s,shares:n,layoutBox:r,tableRelativePos:{left:(0,a.FJ)(p.x),top:(0,a.FJ)(p.y)},contentSize:{width:(0,a.FJ)(c.width),height:(0,a.FJ)(c.height)},rectSize:{width:(0,a.FJ)(p.width),height:(0,a.FJ)(p.height)}}));o.collect(h,l._AL.tableWrapper)}},t.prototype.createTableFrame=function(e){var t,o,r,i=e.layoutBox,a=e.offset,s=e.checker,c=i.contentSize,d=i.edge,p=i.rectSize;if(i.isRootNesting||!(null===(o=null===(t=e.flags)||void 0===t?void 0:t.contextState)||void 0===o?void 0:o.clipInfo))return(0,l.SsA)(a.x+d.border.width.left/2,a.y+d.border.width.top/2,p.width+d.border.width.left,p.height+d.border.width.top);var h=null===(r=e.flags.contextState)||void 0===r?void 0:r.clipInfo;return(0,l.Aa5)((0,n.__assign)((0,n.__assign)({},h),{y:h.y+s.incRegion.y}),(0,l.SsA)(a.x,a.y,c.width,c.height))},t.prototype.invokeExtendRenderer=function(e,t){var o=t.layoutBox,n=t.shares,r=t.offset,i=t.collector,a=t.flags,l=t.checker,s=this.shares.extRendererManager.getExtendRenderer(e);if(null==s?void 0:s.rendererCount()){var c=Ct.obtain(n,i,r,l.incRegion,a);s.draw(c,o),c.recycle()}},t}(rt),_t=function(e){var t=(0,a.FJ)(e);return(0,a.Ej)(Math.round(t)+.5)},Pt=function(e,t){return(0,l.vQ7)(u.PropertyColorUtil.parseHexColor(e.color[t]))},Rt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),t.prototype.calClipRect=function(e,t,o,n){if(n){var r=(0,l.SsA)(t.x,t.y-o.incRegion.y,e.totalWidth,e.totalHeight),i=(0,l.Aa5)(r,n);return i.width<=0&&i.height<=0?{needCollect:!1,needClip:!1}:(0,l.bqj)(r,i)?{needCollect:!0,needClip:!1}:{needCollect:!0,needClip:!0}}return{needCollect:!0,needClip:!1}},t.prototype.render=function(e){var t,o,r,i=e.layoutBox,a=e.offset,s=e.traversalRange,c=e.appendBox,d=e.flags,p=e.checker;if(i.display!==h.gyg.None){var u=this.calClipRect(i,a,p,null===(t=null==d?void 0:d.contextState)||void 0===t?void 0:t.clipInfo);if(u.needCollect){var f=u.needClip?null===(o=null==d?void 0:d.contextState)||void 0===o?void 0:o.clipInfo:void 0,g=this.renderOverlay(e,f);this.renderCellBackgroundColor(e,f);var y=this.createContentClip(e),v=(0,l.jVi)(y,null===(r=null==d?void 0:d.contextState)||void 0===r?void 0:r.textTransform);c({layoutBox:i,offset:a,traversalRange:s,flags:(0,n.__assign)((0,n.__assign)({},d),{contextState:v,disableSelection:g})}),this.renderTableBorder(e,f)}}},t.prototype.collectMergedBorderRenderStyles=function(e){return R.s9.collectMergedBoxes(e).map((function(e){var t,o,n=function(e){var t=h.Sff.none,o=e.left,n=e.right,r=e.top,i=e.bottom;return t.color.left=o.color,t.color.right=n.color,t.color.top=r.color,t.color.bottom=i.color,t.style.left=o.val,t.style.right=n.val,t.style.top=r.val,t.style.bottom=i.val,t.lineSz.left=(0,a.pL)(o.sz/8),t.lineSz.right=(0,a.pL)(n.sz/8),t.lineSz.top=(0,a.pL)(r.sz/8),t.lineSz.bottom=(0,a.pL)(i.sz/8),t}(e.property.tcBorders);return n.distance=null!==(o=null===(t=e.parentBox)||void 0===t?void 0:t.totalHeight)&&void 0!==o?o:0,n}))},t.prototype.renderTableBorder=function(e,t){var o,n,r=e.collector,i=e.layoutBox,a=e.flags;if(i.display){var l=this.ensureSharp(e),s=i.edge.border,c=i.cellPos,d=c.isLastCell,p=c.isLastRow,u=c.isLastMergedRow,f=c.cellIndex,g=c.rowIndex,y=this.collectMergedBorderRenderStyles(i);if(0!==y.length){var v=i.parentBox,x=null==v?void 0:v.parentBox;s&&(0,h.$5m)(i)&&v&&x&&(this.drawLeftRightBordersByCells(s,y,r,l,0===f,d,a,t),this.drawTopBorder(s,y[0],r,l,0===g||i.parentBox===(null===(o=i.parentBox.parentBox)||void 0===o?void 0:o.firstChild),a,t),this.drawBottomBorder(s,y[y.length-1],r,l,!(!p&&!u)||i.parentBox===(null===(n=i.parentBox.parentBox)||void 0===n?void 0:n.lastChild),a,t),this.drawLoseTopBorder(i,s,y[0],r,l,a,t))}}},t.prototype.renderCellBackgroundColor=function(e,t){var o=e.layoutBox,n=e.collector,r=e.offset,i=e.checker,a=e.flags,s=o.bgColor;if(s&&!["auto","PBDEFAULT","STHexColorAuto_auto","STHexColorAuto_undefined"].includes(s)){var c=(0,l.SsA)(r.x,r.y-i.incRegion.y,o.totalWidth,o.totalHeight),d=l.vW8.computeHeaderFooterFocusStyles(this.shares.docEnv.docViewType,this.shares.isFocusHeaderFooter,null==a?void 0:a.isInHeaderFooter),p=Ve.obtain(c,{fillColor:u.PropertyColorUtil.parseHexColor(s,u.Defaults.bgColor),radius:0,opacity:d.opacity},(0,l.jVi)(t));n.collect(p,l._AL.tableCellBackground)}},t.prototype.renderOverlay=function(e,t){var o=e.collector,n=e.layoutBox,r=e.offset,i=e.shares,a=e.checker;if(n.mergedType===h.Wlw.Hidden)return!1;var s=i.selectionOverlay.checkCellOverlay(n);if(!s)return!1;var c=s.meta(),d=(0,l.SsA)(r.x,r.y-a.incRegion.y,n.totalWidth,n.totalHeight),p=Ve.obtain(d,c.backgroundColor,(0,l.jVi)(t));return o.collect(p,c.priority),n.edge.recycle(),!0},t.prototype.drawTopBorder=function(e,t,o,n,r,i,a,s){if(!this.isInvisibleBorder(t.style.top)){var c=n.leftLineX,d=n.topLineY,p=n.rightLineX,u=l.vW8.computeHeaderFooterFocusStyles(this.shares.docEnv.docViewType,this.shares.isFocusHeaderFooter,null==i?void 0:i.isInHeaderFooter),f=s||e.width.top,g=t.lineSz.top,y=De.obtain((0,l.L9X)(c+(r?-t.lineSz.left/2:e.width.left/2),d+(r?-g/2:f/2),p-(r?-t.lineSz.right/2:e.width.right/2),d+(r?-g/2:f/2)),{color:Pt(t,"top"),width:r?g:f,style:h.N4n[t.style.top]||h.TD4.single,opacity:u.opacity},(0,l.jVi)(a));o.collect(y)}},t.prototype.drawLeftRightBordersByCells=function(e,t,o,n,r,i,a,s){for(var c=n.leftLineX,d=n.rightLineX,p=n.topLineY,u=n.bottomLineY,f=l.vW8.computeHeaderFooterFocusStyles(this.shares.docEnv.docViewType,this.shares.isFocusHeaderFooter,null==a?void 0:a.isInHeaderFooter),g=p,y=0;y<t.length;y++){var v=t[y],x=y===t.length-1,m=g+v.distance;if(!this.isInvisibleBorder(v.style.left)){var w=e.width.left,S=De.obtain((0,l.L9X)(c+(r?0:w/2),g,c+(r?0:w/2),x?u:m),{color:Pt(v,"left"),width:r?v.lineSz.left:w,style:h.N4n[v.style.left]||h.TD4.single,opacity:f.opacity},(0,l.jVi)(s));o.collect(S)}this.isInvisibleBorder(v.style.right)||(w=e.width.right,S=De.obtain((0,l.L9X)(d-(i?0:w/2),g,d-(i?0:w/2),x?u:m),{color:Pt(v,"right"),width:i?v.lineSz.right:w,style:h.N4n[v.style.right]||h.TD4.single,opacity:f.opacity},(0,l.jVi)(s)),o.collect(S)),g=m}},t.prototype.drawBottomBorder=function(e,t,o,n,r,i,a,s){if(!this.isInvisibleBorder(t.style.bottom)){var c=n.rightLineX,d=n.leftLineX,p=n.bottomLineY,u=s||e.width.bottom,f=t.lineSz.bottom,g=l.vW8.computeHeaderFooterFocusStyles(this.shares.docEnv.docViewType,this.shares.isFocusHeaderFooter,null==i?void 0:i.isInHeaderFooter),y=De.obtain((0,l.L9X)(d+(r?-t.lineSz.left/2:e.width.left/2),p-(r?-f/2:u/2),c-(r?-t.lineSz.right/2:e.width.right/2),p-(r?-f/2:u/2)),{color:Pt(t,"bottom"),width:r?f:u,style:h.N4n[t.style.bottom]||h.TD4.single,opacity:g.opacity},(0,l.jVi)(a));o.collect(y)}},t.prototype.drawLoseTopBorder=function(e,t,o,r,i,a,l){var s,c=null===(s=e.parentBox)||void 0===s?void 0:s.prevSibling;if(c&&c.firstChild&&c.lastChild){var d=c.lastChild.colBegin+c.lastChild.totalWidth,p=c.firstChild.colBegin,h=e.colBegin+e.totalWidth,f=e.cellPos.rowIndex;(h>d||e.colBegin<p)&&(e.colBegin>d||h<p||e.colBegin<p&&h>d?this.drawTopBorder(t,o,r,i,0===f,a,l,u.Defaults.tableBorderWidth):this.drawTopBorder(t,o,r,(0,n.__assign)((0,n.__assign)({},i),{leftLineX:d<h?i.leftLineX+(d-e.colBegin):i.leftLineX-u.Defaults.tableBorderWidth/2,rightLineX:e.colBegin<p?i.rightLineX-(h-p):i.rightLineX}),0===f,a,l,u.Defaults.tableBorderWidth))}},t.prototype.isInvisibleBorder=function(e){return e===u.STBorder.none||e===u.STBorder.nil||e===u.STBorder.PBDEFAULT},t.prototype.ensureSharp=function(e){var t=e.layoutBox,o=e.offset,n=e.checker,r=t.totalWidth,i=t.totalHeight;return{leftLineX:_t(o.x),topLineY:_t(o.y-n.incRegion.y),rightLineX:_t(o.x+r),bottomLineY:_t(o.y+i-n.incRegion.y)}},t.prototype.createContentClip=function(e){var t,o=e.layoutBox,n=e.offset,r=e.flags,i=e.checker,a=(0,l.SsA)(n.x,n.y-i.incRegion.y,o.paddingBoxSize.width,o.paddingBoxSize.height);return(null===(t=null==r?void 0:r.contextState)||void 0===t?void 0:t.clipInfo)?(0,l.Aa5)(r.contextState.clipInfo,a):a},t}(rt),Tt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),t.prototype.render=function(e){var t,o=e.offset,n=e.layoutBox,r=e.collector,i=e.flags,a=e.checker,s=this.generateViewFrame(e),c=s.frame,d=s.clipFrame;if((0,l.UHV)(c)||(0,h.qMb)(n)){this.collectContainerView(e,c,d);var p=this.shares.extRendererManager.getExtendRenderer(l.Rli.LeafContainer);if(null==p?void 0:p.rendererCount()){(null==i?void 0:i.contextState)&&(0,h.eJq)(n)&&n.independentRender&&(i.contextState=(0,l.jVi)((null===(t=null==i?void 0:i.contextState)||void 0===t?void 0:t.clipInfo)?d:void 0));var f=Ct.obtain(this.shares,r,{x:c.x,y:c.y},a.incRegion,i);p.draw(f,n),f.recycle()}if(!this.skipRender(e)&&(0,h.qMb)(n)&&u.PropertyImageUtil.shouldUseCanvasRender(n.property)){var g=this.shares.extRendererManager.getExtendRenderer(l.Rli.Image);(null==g?void 0:g.rendererCount())&&(f=Ct.obtain(this.shares,r,o,a.incRegion,i),g.draw(f,n),f.recycle())}}},t.prototype.generateViewFrame=function(e){var t=e.offset,o=e.layoutBox,n=e.flags,r=e.checker,i=((0,h.vvs)(o)?o.getOriginSizeBox():o).positionBoxSize,a=t.x,s=t.y,c=(0,l.SsA)(a,s,i.width,i.height),d=this.checkClipInfoAndModifyFrame(c,n,r);if((0,h.eJq)(o)&&o.independentRender){var p=o.getAncestorOf(h.uOS.Page);if(p){var u=R.MM.getOffsetPoint(p,h.uOS.Document),f=u.x,g=u.y;c.x+=f,c.y+=g,d.x+=f,d.y+=g}}return{frame:c,clipFrame:d}},t.prototype.collectContainerView=function(e,t,o){if(!this.skipRender(e)){var n=e.shares,r=e.layoutBox,i=e.collector,a=n.containerRenderManager.renderContainerBox(r,n.containerFocus);if(a){var s=this.generateContainerOrAnchorView(e,t,o,a);if(null===s)return;i.collect(s,l._AL.componentElement)}}},t.prototype.generateContainerOrAnchorView=function(e,t,o,n){var r=e.layoutBox,i=e.flags,a=e.renderRootBox,s=e.pageIndex,c=e.shares;if(!a)return null;var d,p=i||{},f=p.isInHeaderFooter,g=p.contextState,y=c.isFocusHeaderFooter,v=c.docEnv;if((0,h.vvs)(r)){var x=a.children[s||0],m=this.getRenderPageSize(x),w=x.getOuterPoint().y;d=He.computeContainerStyles(r,o,v.docViewType,y,f);var S=!1;return r.property instanceof u.PropertyFactory.getPropertyClass(u.PropertyType.DrawingProperty)&&(S=r.property.anchor.behindDoc&&!r.property.anchor.isEmpty(r.property.anchor.tKeys.wrapNone)),He.obtain(r.key,t,n,d,(0,l.jVi)((null==g?void 0:g.clipInfo)?o:void 0),S,{pageSize:m,pageOffsetY:w,pageIndex:s||0})}return d=We.computeContainerStyles(r,o,v.docViewType,y,f),We.obtain(r.key,t,n,d,(0,l.jVi)((null==g?void 0:g.clipInfo)?o:void 0))},t.prototype.getRenderPageSize=function(e){if(!e)return{width:0,height:0,marginBottom:0};var t=(0,a.FJ)(e.edge.margin.bottom);return{width:(0,a.FJ)(e.rect.width),height:(0,a.FJ)(e.rect.height),marginBottom:t}},t.prototype.checkClipInfoAndModifyFrame=function(e,t,o){var n,r=(0,l.VI0)(e),i=null===(n=null==t?void 0:t.contextState)||void 0===n?void 0:n.clipInfo;if(i){var a=(0,l.SsA)(i.x,i.y+o.incRegion.y,i.width,i.height);r=(0,l.Aa5)(e,a)}return r},t}(rt),Et=function(){function e(){}return e.getComputeStyles=function(e){if(this.cssCache.has(e.uuid))return this.cssCache.get(e.uuid);var t=l.vW8.computeStyles(e);return this.cssCache.set(e.uuid,t),t},e.getComputeStyleOriginal=function(t){if(!(0,h.NFz)(t))return e.getComputeStyles(t);var o="before_".concat(t.uuid);if(this.cssCache.has(o))return this.cssCache.get(o);if(t.textStyle.rPrChange.isEmpty())return e.getComputeStyles(t);var n=t.textStyle.create(t.textStyle.rPrChange.rPr),r=l.vW8.computeStyles(n);return this.cssCache.set(o,r),r},e.clear=function(){this.cssCache.clear()},e.cssCache=new l.cUw(1e4),e}(),Bt=[],It=u.STUnderline.none,Ft=0,Mt=u.Defaults.fontSize,Lt=0,Ot=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),t.prototype.render=function(e){var t=e.layoutBox;(0,h.Pq8)(t)&&t.parentBox&&!(0,h.tqe)(t.parentBox)?this.extendRenderDraw(e):t.parentBox&&(0,h.tqe)(t.parentBox)||this.renderText(e)},t.prototype.colorAdapter=function(e,t){var o=e,r=t.layoutBox,i=t.flags,a=r.textStyle,s={textColor:e,diffThrough:!1,delRevisionMarkup:!1};if(!(r instanceof R.w8)){var c=r.revisionInfo||{},d=c.hasInsertMarkup,p=void 0!==d&&d,h=c.hasDeleteMarkup,g=void 0!==h&&h;(p||g)&&(o=f.u$.revisionColor,s.delRevisionMarkup=g)}var y=f.u$.rgb2hex(o);return(null==i?void 0:i.isTaskDone)?s.textColor=f.u$.hex2rgbaStr("".concat(y||o,"4C")):(null==i?void 0:i.isQuote)&&(s.textColor=f.u$.hex2rgbaStr("".concat(y||o,"C0"))),r instanceof R.w8||![u.DiffType.Minus,u.DiffType.Plus].includes(a.diff)?s:(0,n.__assign)((0,n.__assign)({},s),{textColor:l.vW8.getDiffColorStyle(a.author).color,diffThrough:a.diff===u.DiffType.Minus})},t.prototype.renderText=function(e){var o,n,r,i=e.collector,a=e.layoutBox,s=e.offset,c=e.flags,d=e.checker,p=(0,u.getPrintableText)(a.getRenderString());if(p){var h=this.calcTextCSSPropsAndThrough(e),f=h.textProps,g=h.diffThrough,y=h.delRevisionMarkup,v=s.y+a.textBaseline-d.incRegion.y,x=s.x;void 0!==(null===(o=a.renderGlyph)||void 0===o?void 0:o.indent)&&(x=(null===(n=a.renderGlyph)||void 0===n?void 0:n.indent)?s.x+(null===(r=a.renderGlyph)||void 0===r?void 0:r.indent):s.x);var m=(0,l.SsA)(x,v,a.totalWidth,a.rect.height),w=Q.obtain(m,p,{uuid:a.uuid,diffThrough:g,isTaskDone:null==c?void 0:c.isTaskDone,delRevisionMarkup:y},f,null==c?void 0:c.contextState);i.collect(w),t.lastTextBoxInfo={textBox:a,textProps:f,diffThrough:g,delRevisionMarkup:y},this.collectUnderLineView(e),this.extendRenderDraw(e)}},t.prototype.collectUnderLineView=function(e){var t=e.collector,o=e.layoutBox,r=e.offset,i=e.flags,s=e.checker,c=o.textStyle,d=o.glyph,p=c||{},f=p.u,g=p.color,y=Number((null==f?void 0:f.val)||u.STUnderline.none),v=r.x+o.totalWidth;if(It===u.STUnderline.none||It===y&&Ft===Math.ceil(r.x)||this.renderUnderline(t,Lt,Mt,null==i?void 0:i.contextState),y!==u.STUnderline.none&&y!==u.STUnderline.PBDEFAULT&&!(o instanceof R.Mi)){var x=r.y+o.textBottomLine-s.incRegion.y,m=l.vW8.computeHeaderFooterFocusStyles(this.shares.docEnv.docViewType,this.shares.isFocusHeaderFooter,null==i?void 0:i.isInHeaderFooter);Bt.push((0,n.__assign)((0,n.__assign)({},m),{start:{x:r.x,y:x},end:{x:v,y:x},width:(0,a.Ej)(1),style:h.Svk[y],color:{hex:u.PropertyColorUtil.parseHexColor(g.val)},fontSize:(null==d?void 0:d.fontSize)||u.Defaults.fontSize})),Mt=Math.max(Mt,(null==d?void 0:d.fontSize)||u.Defaults.fontSize),Lt=Math.max(Lt,x),Ft=Math.ceil(v)}this.isLastTextBoxHasUnderline(o)&&this.renderUnderline(t,Lt,Mt,null==i?void 0:i.contextState),It=y},t.prototype.calcTextCSSPropsAndThrough=function(e){var t=e.layoutBox,o=e.flags,r=t.renderGlyph,i=Et.getComputeStyles(t).cssProperties,a=l.vW8.computeHeaderFooterFocusStyles(this.shares.docEnv.docViewType,this.shares.isFocusHeaderFooter,null==o?void 0:o.isInHeaderFooter);i=(0,n.__assign)((0,n.__assign)({},i),a),void 0!==(null==r?void 0:r.scaleX)&&(i=(0,n.__assign)((0,n.__assign)({},i),{fontScaling:"".concat(null==r?void 0:r.scaleX)}));var s=this.colorAdapter(i.color,e),c=s.textColor,d=s.diffThrough,p=s.delRevisionMarkup;return{diffThrough:d,textProps:i=(0,n.__assign)((0,n.__assign)({},i),{color:c}),delRevisionMarkup:p}},t.prototype.renderUnderline=function(e,t,o,r){var i,s=(null==r?void 0:r.contentClipInfo)&&(null==r?void 0:r.clipInfo)?(0,l.Aa5)(null==r?void 0:r.contentClipInfo,null==r?void 0:r.clipInfo):null!==(i=null==r?void 0:r.contentClipInfo)&&void 0!==i?i:null==r?void 0:r.clipInfo,c=s?{clipInfo:(0,n.__assign)((0,n.__assign)({},s),{height:s.height+5*o}),textTransform:null==r?void 0:r.textTransform}:void 0;Bt.forEach((function(n){var r=n.start,i=n.end,s=n.style,d=n.color,p=n.opacity;e.collect(De.obtain((0,l.L9X)(r.x,t||r.y,i.x,t||i.y),{width:(0,a.Ej)(Math.round((o||u.Defaults.fontSize)/(2*u.Defaults.fontSize))),style:s,color:d,opacity:p},c))})),Bt=[],Mt=u.Defaults.fontSize,Lt=0},t.prototype.extendRenderDraw=function(e){var t=e.collector,o=e.layoutBox,n=e.offset,r=e.flags,i=e.checker,a=this.shares.extRendererManager.getExtendRenderer(l.Rli.Text);if(null==a?void 0:a.rendererCount()){var s=Ct.obtain(this.shares,t,n,i.incRegion,r);a.draw(s,o),s.recycle()}},t.prototype.isLastTextBoxHasUnderline=function(e){var t,o;if(!(null===(t=e.parentBox)||void 0===t?void 0:t.children.length))return!1;var n=null===(o=e.textStyle)||void 0===o?void 0:o.u.val;if(void 0===n||n===u.STUnderline.none||n===u.STUnderline.PBDEFAULT)return!1;for(var r=e.parentBox.children.length-1;r>=0;r--){var i=e.parentBox.children[r];if(i instanceof R.zC&&!(i instanceof R.w8)&&!(i instanceof R.oH))return e.uuid===i.uuid}return!1},t}(rt),kt=function(e,t){this.width=e,this.height=t},At=function(e){function t(t,o,n){void 0===n&&(n={points:[]});var r=e.call(this,t,o)||this;return r.path=n,r}return(0,n.__extends)(t,e),t.prototype.getGraphicType=function(){return l.ddz.WaveLine},t.prototype.getPath=function(){for(var e=[],t=(0,a.Ej)(2),o=this.height-t,n=0;n<this.width/t;n++)e.push({x:n*t,y:(n%2==0?t:0)+o});return{points:e}},t}(kt),Dt=function(e){function t(t,o,n){void 0===n&&(n={points:[]});var r=e.call(this,t,o)||this;return r.path=n,r}return(0,n.__extends)(t,e),t.prototype.getPath=function(){return this.path},t.prototype.getGraphicType=function(){return l.ddz.Customize},t}(kt),Vt=function(){function e(){}return e.getGraphicComponent=function(e,t,o,n){return e===l.ddz.WaveLine?new At(t,o):new Dt(t,o,n)},e.getPath=function(t,o,n){return e.getGraphicComponent(t,o,n).getPath()},e}(),zt=function(e){function t(t,o,n){var r=e.call(this,t,o)||this;return r.textBoxRender=n,r}return(0,n.__extends)(t,e),t.prototype.render=function(e){var t,o,r=e.layoutBox,i=e.offset,a=e.appendBox,s=e.traversalRange,c=e.flags;r.children.length&&(0,h.JtM)(r.children[0])||this.renderOverlay(e);var d=this.getClipInfo(e),p=(0,l.jVi)(d,null===(t=null==c?void 0:c.contextState)||void 0===t?void 0:t.textTransform,null===(o=null==c?void 0:c.contextState)||void 0===o?void 0:o.contentClipInfo);a({layoutBox:r,offset:i,traversalRange:s,flags:(0,n.__assign)((0,n.__assign)({},c),{contextState:p})}),r instanceof R.vm&&r.listMark&&this.renderListMark((0,n.__assign)((0,n.__assign)({},e),{layoutBox:r.listMark})),this.shouldShowPlaceholder(r)&&this.renderPlaceholder(e)},t.prototype.renderListMark=function(e){var t=e.layoutBox,o=t.lineBox,r=t.getOuterPoint(),i={x:e.offset.x+r.x,y:e.offset.y+r.y},s=e.flags;if(s&&(s=(0,n.__assign)({isTaskDone:!1},e.flags)),this.textBoxRender.renderText((0,n.__assign)((0,n.__assign)({},e),{offset:i,flags:s})),o&&o instanceof R.vm){var c=(0,a.Ej)(1);this.invokeExtendRenderer(l.Rli.OverlayTaskCheckbox,(0,n.__assign)((0,n.__assign)({},e),{offset:i,flags:s}),{x:c,y:c})}},t.prototype.renderPlaceholder=function(e,t){this.invokeExtendRenderer(l.Rli.TextLine,e,t)},t.prototype.invokeExtendRenderer=function(e,t,o){var n=t.layoutBox,r=t.shares,i=t.offset,l=t.collector,s=t.flags,c=t.checker,d=o?{x:(0,a.Ej)(Math.ceil((0,a.FJ)(i.x)))+o.x,y:(0,a.Ej)(Math.ceil((0,a.FJ)(i.y)))+o.y}:i,p=this.shares.extRendererManager.getExtendRenderer(e);if(null==p?void 0:p.rendererCount()){var h=Ct.obtain(r,l,d,c.incRegion,s);p.draw(h,n),h.recycle()}},t.prototype.renderOverlay=function(e){var t,o,n,r=this,i=e.layoutBox,a=e.collector,s=e.offset,c=e.parentOffset,d=e.shares,p=e.flags,h=e.checker,u=i.edge,f=d.overlays.buildCanvasOverlay(i),g=!1;f.forEach((function(e){var t=e.meta();if(!(null==p?void 0:p.disableSelection)||!t.isTextSelection){var o=r.getOverlayFrame(i,e,h,s,c),n=l.vW8.computeHeaderFooterFocusStyles(r.shares.docEnv.docViewType,r.shares.isFocusHeaderFooter,null==p?void 0:p.isInHeaderFooter);if(t.overlayType===l.iz9.OverlayView){var u=r.getOverlayView(o,t,n.opacity,null==p?void 0:p.contextState);t.mergeMultiLine&&(r.mergeMultiLineOverlay(u,d,e),g=!0,r.handleBorderCrossPages(u,d,i,e.totalRange)),a.collect(u,t.priority)}else if(t.overlayType===l.iz9.GraphicView){var f=Vt.getPath(t.graphicType,t.width,o.height),y=Ae.obtain(o,t.backgroundColor,f,null==p?void 0:p.contextState,!1);a.collect(y,t.priority)}}}));var y=d.renderState.getPrevLineOverlayViews(),v=i===(null===(t=i.parentBox)||void 0===t?void 0:t.lastChild)&&i.parentBox===(null===(n=null===(o=i.parentBox)||void 0===o?void 0:o.parentBox)||void 0===n?void 0:n.lastChild);(!g&&y||v)&&d.renderState.setPrevLineOverlayViews(void 0),u.recycle()},t.prototype.getOverlayFrame=function(e,t,o,n,r){var i,s=t.meta(),c=e.edge,d=e.totalHeight,p=d,h=e.rect.height,u=n.y,f=n.x;switch(s.heightType){case l.YQK.Source:u+=e.heightMetrics.baseline-e.heightMetrics.ascent,p=e.heightMetrics.ascent+e.heightMetrics.descent;break;case l.YQK.Total:p=d;break;case l.YQK.StrokeUnderLine:p=(null==s?void 0:s.height)||(0,a.Ej)(1),u+=c.padding.top+h+(0,a.Ej)(2)-p}var g=e.parentBox;return g&&t.meta().marginType===l.W4y.Paragraph?(g.firstChild===e&&(u-=g.edge.top,p+=g.edge.top),g.lastChild===e&&(p+=g.edge.bottom),f-=g.edge.left):g&&t.meta().marginType===l.W4y.Sdt&&(g.firstChild===e&&(u-=g.edge.top,p+=g.edge.top),g.lastChild===e&&(p+=g.edge.bottom),g.firstChild!==e&&(f=null!==(i=null==r?void 0:r.x)&&void 0!==i?i:f)),(0,l.SsA)(f+s.left,u-o.incRegion.y,s.width,p)},t.prototype.getOverlayView=function(e,t,o,n){var r;return Ve.obtain(e,{fillColor:t.backgroundColor,radius:null!==(r=t.radius)&&void 0!==r?r:0,strokeColor:t.strokeColor,mergeMultiLine:t.mergeMultiLine,opacity:o},n)},t.prototype.mergeMultiLineOverlay=function(e,t,o){var n,r=o.totalRange,i=o.overlayType,a=void 0===i?"":i;if(r){var l=null!==(n=t.renderState.getPrevLineOverlayViews())&&void 0!==n?n:new Map,s=a+r.toString(),c=l.get(s);c&&(c.nextLineView=Ve.obtain(e.frame,e.roundRectProp,e.contextState),e.preLineView=Ve.obtain(c.frame,c.roundRectProp,c.contextState)),l.set(s,e),t.renderState.setPrevLineOverlayViews(l)}},t.prototype.handleBorderCrossPages=function(e,t,o,n){var r,i,a,l,s,c;if(n&&!(0,u.isPagedLayout)(t.docEnv.layoutType)){var d=n.toString(),p=o===(null===(r=o.parentBox)||void 0===r?void 0:r.firstChild)&&o.parentBox===(null===(a=null===(i=o.parentBox)||void 0===i?void 0:i.parentBox)||void 0===a?void 0:a.firstChild);if(o===(null===(l=o.parentBox)||void 0===l?void 0:l.lastChild)&&o.parentBox===(null===(c=null===(s=o.parentBox)||void 0===s?void 0:s.parentBox)||void 0===c?void 0:c.lastChild)&&n.end()>o.getRangeEnd()?(t.renderState.setCrossPageOverlayBorderFrame(d,e.frame),e.isBorderCrossNextPage=!0):e.isBorderCrossNextPage=!1,p&&n.begin()<o.getRangeBegin()){var h=t.renderState.getCrossPageOverlayBorderFrame(d);h&&(e.preLineView=Ve.obtain(h),t.renderState.setCrossPageOverlayBorderFrame(d,void 0)),e.isBorderCrossPrePage=!0}else e.isBorderCrossPrePage=!1}},t.prototype.getClipInfo=function(e){var t,o,n,r,i=e.layoutBox,a=e.offset,s=e.flags,c=e.checker;if(null===(t=null==s?void 0:s.contextState)||void 0===t?void 0:t.textTransform)return s.contextState.clipInfo;var d=this.calcAllowOverflowEdge(e),p=i.getAncestorOf(h.uOS.Page),u=(0,l.SsA)(0,-c.incRegion.y+a.y-d.top,null!==(o=null==p?void 0:p.totalWidth)&&void 0!==o?o:99999,i.totalHeight+d.bottom+d.top);return(null===(n=null==s?void 0:s.contextState)||void 0===n?void 0:n.clipInfo)?(0,l.Aa5)(null===(r=null==s?void 0:s.contextState)||void 0===r?void 0:r.clipInfo,u):u},t.prototype.calcAllowOverflowEdge=function(e){var t=e.layoutBox,o=t.getAncestorOf(h.uOS.Paragraph);if(!o)return h.WhV.getNone(0);var n=o.children[0]===t,r=o.children[o.children.length-1]===t;return new h.WhV({top:n?o.edge.margin.top:0,bottom:r?o.edge.margin.bottom:0,left:o.edge.margin.left,right:o.edge.margin.right})},t.prototype.renderAuxiliaryLine=function(e){var t=e.layoutBox,o=e.collector,n=e.offset,r=e.flags,i=e.checker,l=t.edge,s=new a.HL({x:n.x-l.margin.left,y:n.y-l.margin.top,width:t.totalWidth,height:t.totalHeight});this.renderRectBorder(s,o,i,r),s=new a.HL({x:n.x+l.padding.left,y:n.y+l.padding.top,width:t.rect.width,height:t.rect.height}),this.renderRectBorder(s,o,i,r),s=new a.HL({x:n.x+l.padding.left,y:n.y+l.padding.top,width:t.rect.width,height:t.rect.height}),this.renderRectBorder(s,o,i,r),l.recycle()},t.prototype.shouldShowPlaceholder=function(e){var t=e.parentBox;if(!(0,h.o70)(e)||!t)return!1;if((0,h.wSK)(t)&&e.isFirst&&l.d_x.isFirstParaOfDoc(t)&&l.d_x.isEmpytPara(t)&&(0,h.LeV)(e.lastChild))return!0;var o=t.prevSibling;return!!((0,h.wSK)(o)&&e.isFirst&&l.d_x.isFirstParaOfDoc(o)&&l.d_x.isEmpytPara(t)&&(0,h.LeV)(e.lastChild))},t}(rt),Wt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),t.prototype.render=function(e){var t=e.layoutBox,o=e.offset,n=e.appendBox,r=e.traversalRange,i=e.flags;(0,h.EbP)(t)&&n({layoutBox:t,offset:o,traversalRange:r,flags:i})},t}(rt),Ht=u.PropertyFactory.getPropertyClass(u.PropertyType.CTPBdr).tKeys,jt=function(e){function t(t,o){return e.call(this,t,o)||this}return(0,n.__extends)(t,e),t.prototype.render=function(e){var t,o,r=e.layoutBox,i=e.offset,a=e.traversalRange,s=e.appendBox,c=e.flags,d=this.isTaskDone(r),p=r.property.blockQuote||this.isParagraphQuoteByBorder(r.property.pBdr),h=this.getClipContentInfo(e),f=(0,l.jVi)(null===(t=null==c?void 0:c.contextState)||void 0===t?void 0:t.clipInfo,null===(o=null==c?void 0:c.contextState)||void 0===o?void 0:o.textTransform,h);s({layoutBox:r,offset:i,traversalRange:a,flags:(0,n.__assign)((0,n.__assign)({},c),{isTaskDone:d,isQuote:p,contextState:f})}),this.invokeExtendRenderer(l.Rli.OverlayParagraph,e),this.renderBorder(e),this.isHintPara(r)&&this.invokeExtendRenderer(l.Rli.Paragraph,e),c&&c.storyType===u.STStoryType.textboxContent&&this.invokeExtendRenderer(l.Rli.Paragraph,e)},t.prototype.getClipContentInfo=function(e){var t,o,n,r,i=e.layoutBox,a=e.offset,s=e.flags,c=(0,l.SsA)(a.x,a.y,null!==(t=i.rect.width)&&void 0!==t?t:99999,null!==(o=i.rect.height)&&void 0!==o?o:99999);return(null===(n=null==s?void 0:s.contextState)||void 0===n?void 0:n.contentClipInfo)?(0,l.Aa5)(null===(r=null==s?void 0:s.contextState)||void 0===r?void 0:r.contentClipInfo,c):c},t.prototype.isHintPara=function(e){return e.property.hintType},t.prototype.isTaskDone=function(e){var t=e.property;return t instanceof u.ListInfo&&t.isTask&&t.taskPr.taskState===u.STTaskState.done},t.prototype.collectBorderRenderStyle=function(e){var t=h.vWx.none,o=e.property.pBdr;if(o.has(Ht.left)){var n=o.left;t.color.left=n.color,t.style.left=n.val,t.lineSz.left=this.getBorderLineSz(n)}if(o.has(Ht.right)){var r=o.right;t.color.right=r.color,t.style.right=r.val,t.lineSz.right=this.getBorderLineSz(r)}if(o.has(Ht.top)){var i=o.top;t.color.top=i.color,t.style.top=i.val,t.lineSz.top=this.getBorderLineSz(i)}if(o.has(Ht.bottom)){var a=o.bottom;t.color.bottom=a.color,t.style.bottom=a.val,t.lineSz.bottom=this.getBorderLineSz(a)}if(o.has(u.PropertyFactory.getPropertyClass(u.PropertyType.CTPBdr).tKeys.between)){var l=o.between;t.color.bottom=l.color,t.style.bottom=l.val,t.lineSz.bottom=this.getBorderLineSz(l)}return t},t.prototype.getBorderLineSz=function(e){return[u.STBorder.PBDEFAULT,u.STBorder.nil,u.STBorder.none].includes(e.val)?0:(0,a.pL)(e.sz/8)},t.prototype.renderBorder=function(e){var t,o,n,r=e.layoutBox,i=e.offset,a=e.checker,s=r.edge,c=s.border,d=this.collectBorderRenderStyle(r);if(this.shouldRenderQuoteBorder(r)){var p=this.getQuoteBorderStyle(e);c=p.border,d=p.renderStyle}var h,u=i.y-(null===(t=s.margin)||void 0===t?void 0:t.top)-d.lineSz.top/2,f=u+r.borderBoxSize.height+(null===(o=s.margin)||void 0===o?void 0:o.top)+(null===(n=s.margin)||void 0===n?void 0:n.bottom);if(c.width.left>0&&d.lineSz.left>0){var g=h=i.x+d.lineSz.left/2,y=(0,l.L9X)(h,u-a.incRegion.y,g,f-a.incRegion.y);this.collectBorderLine(e,d.lineSz.left,d.color.left,d.style.left,y)}c.width.right>0&&d.lineSz.right>0&&(g=h=i.x+r.borderBoxSize.width-d.lineSz.right/2,y=(0,l.L9X)(h,u-a.incRegion.y,g,f-a.incRegion.y),this.collectBorderLine(e,d.lineSz.right,d.color.right,d.style.right,y));var v,x=i.x,m=i.x+r.borderBoxSize.width;if(c.width.top>0&&d.lineSz.top>0){var w=v=i.y-s.margin.top;y=(0,l.L9X)(x,v-a.incRegion.y,m,w-a.incRegion.y),this.collectBorderLine(e,d.lineSz.top,d.color.top,d.style.top,y)}c.width.bottom>0&&d.lineSz.bottom>0&&(w=v=i.y+r.borderBoxSize.height+(this.isOnlyBorderBottom(c,d)?-c.width.bottom/2:s.margin.bottom),y=(0,l.L9X)(x,v-a.incRegion.y,m,w-a.incRegion.y),this.collectBorderLine(e,d.lineSz.bottom,d.color.bottom,d.style.bottom,y));s.recycle()},t.prototype.isOnlyBorderBottom=function(e,t){return e.width.left<=0&&t.lineSz.left<=0&&e.width.right<=0&&t.lineSz.right<=0&&e.width.top<=0&&t.lineSz.top<=0},t.prototype.collectBorderLine=function(e,t,o,n,r){var i,a,s=h.TD4.none;Object.keys(h.TD4).includes(u.STBorder[n])?s=u.STBorder[n]:[u.STBorder.PBDEFAULT,u.STBorder.nil,u.STBorder.none].includes(n)||(s=h.TD4.single);var c=e.collector,d=e.flags,p=e.layoutBox,f=e.offset,g=e.checker,y=null===(i=null==d?void 0:d.contextState)||void 0===i?void 0:i.clipInfo;if(n===u.STBorder.wave||n===u.STBorder.doubleWave){var v=(0,l.SsA)(f.x,f.y-g.incRegion.y,p.borderBoxSize.width,p.borderBoxSize.height);y=y?(0,l.Aa5)(y,v):v}var x=l.vW8.computeHeaderFooterFocusStyles(this.shares.docEnv.docViewType,this.shares.isFocusHeaderFooter,null==d?void 0:d.isInHeaderFooter),m=De.obtain(r,{color:(0,l.vQ7)(u.PropertyColorUtil.parseHexColor(o)),width:t,style:s,opacity:x.opacity},(0,l.jVi)(y,null===(a=null==d?void 0:d.contextState)||void 0===a?void 0:a.textTransform));c.collect(m)},t.prototype.invokeExtendRenderer=function(e,t){var o=t.layoutBox,n=t.shares,r=t.offset,i=t.collector,a=t.flags,l=t.checker,s=this.shares.extRendererManager.getExtendRenderer(e);if(null==s?void 0:s.rendererCount()){var c=Ct.obtain(n,i,r,l.incRegion,a);s.draw(c,o),c.recycle()}},t.prototype.renderTextframeParagraph=function(e){this.invokeExtendRenderer(l.Rli.Paragraph,e)},t.prototype.isParagraphQuoteByBorder=function(e){var t;return(null===(t=null==e?void 0:e.left)||void 0===t?void 0:t.color)===u.QUOTE_LINE_COLOR.substring(1)&&e.left.sz===u.QUOTE_LINE_SZ2PT},t.prototype.shouldRenderQuoteBorder=function(e){if(!(0,h.wSK)(e))return!1;if(e.hidden)return!1;if(e.property.blockQuote){var t=e.property.pBdr;if(!t.has(Ht.left))return!0;if(t.left.color!==u.QUOTE_LINE_COLOR.substring(1))return!0}return!1},t.prototype.getQuoteBorderStyle=function(e){var t,o,n=e.layoutBox,r=null==n?void 0:n.prevSibling,i=null==n?void 0:n.nextSibling,l=(0,h.wSK)(r)&&r.property.blockQuote,s=(0,h.wSK)(i)&&i.property.blockQuote,c=l?(0,a.FJ)(null!==(t=null==n?void 0:n.property.spacing.before)&&void 0!==t?t:0):0,d=s?(0,a.FJ)(null!==(o=null==n?void 0:n.property.spacing.after)&&void 0!==o?o:0):0,p=h.vWx.none,f=h.u8c.none;return f.width.left=u.QUOTE_LINE_SZ,f.width.top=-(0,a.Ej)(c),f.width.bottom=-(0,a.Ej)(d),p.color.left=u.QUOTE_LINE_COLOR,p.style.left=u.STBorder.single,p.lineSz.left=u.QUOTE_LINE_SZ,{renderStyle:p,border:f}},t}(rt),Nt=o(61654),Ut=function(){function e(){}return e.collectSingleShape=function(e){var t=e.layoutBox,o=e.collector,n=e.offset,r=e.checker,i=e.shares,a=t.getOriginSizeBox(),s=a.property,c=a.positionBoxSize,d=a.positionOutset,p=a.textboxProperty;if(s&&!s.isVML()&&[u.DrawingType.WordprocessingShape,u.DrawingType.WordprocessingGroupShape].includes(s.drawingType)&&(!p||![u.TextFrameType.CodeBlock,u.TextFrameType.LightBlock].includes(p.textBoxType))){var h=(0,l.SsA)(n.x+d.left,n.y+d.top-r.incRegion.y,c.width,c.height),f=s.clone(),g=t.drawingCurrent,y=i.state.dataEngine.getDataManager().getThemeManager(),v=f.drawing.effectExtent,x=this.generateSingleGraphicView(g,h,v,y);o.collect(x,l._AL.drawingOverlay)}},e.generateSingleGraphicView=function(e,t,o,n){var r=e.dCurrent.spPr,i=this.generateDrawingFrame(r,t),a=this.getPath(e,r),l=this.getShapeFillStyle(e.dCurrent,n),s=this.getStrokeStyle(e.dCurrent,n),c=this.getFilter(e.dCurrent,n);return je.obtain({frame:i,path:a,effectExtent:o,fillStyle:l,strokeStyle:s,filter:c,onRenderFinish:function(t,o){void 0===o&&(o=1),e.graphics=t,e.zoomScale=o}})},e.generateDrawingFrame=function(e,t){var o=e.xfrm,n=o.ext,r=o.rot,i=o.flipH,l=o.flipV,s=u.PropertyDrawingUtil.angleToDegree(r),c=t.x,d=t.y,p=t.width,h=t.height;return 0!==s&&(p=(0,a._i)(n.cx),h=(0,a._i)(n.cy),d+=(t.height-h)/2,c+=(t.width-p)/2),{left:c,top:d,width:p,height:h,rotate:s,flipH:i,flipV:l}},e.getPath=function(e,t){return{type:this.getGraphicType(t),controlValues:this.getControlValues(t.prstGeom.avLst),pathList:this.getPathList(e,t)}},e.getStrokeStyle=function(e,t){var o,n=e.spPr,r=this.getLineFillStyle(e,t),i=n.readOnly((function(){return n.ln.w}));if(i){var l=u.PropertyDrawingUtil.emuToPt(i);(o=(0,a.zL)(l))<=1.5&&o>=.5&&(o=1)}var s=this.getLineDashPrstType(n.ln.egLineDashProperties.prstDash.val),c=this.getLineCap(this.getLineCapPrstType(n.ln.cap)),d=this.getLineJoin(n.ln.egLineJoinProperties),p=this.getCompoundType(n),h=this.getLineEndPrstType(n.ln.headEnd.type),f=this.getLineEndPrstType(n.ln.tailEnd.type);return{fillStyle:r,type:s||he.nZ.SOLID,compoundType:p,lineWidth:o,lineCap:c,lineJoin:d,headEnd:{lineEndType:h},tailEnd:{lineEndType:f}}},e.getCompoundType=function(e){if(!e.isEmpty(e.tKeys.ln)){var t=e.ln;if(!t.isEmpty(t.tKeys.cmpd)&&t.cmpd!==u.STCompoundLine.PBDEFAULT)return u.STCompoundLine[t.cmpd]}},e.getGraphicType=function(e){return this.getShapePrstType(e.prstGeom.prst)||he.wf.CUSTOM},e.getPathList=function(e,t){var o=this,n=[];return t.isEmpty("custGeom")?[]:(t.custGeom.pathLst.path.forEach((function(t){n.push({pathString:o.parsePathString(e,t.egPath2D),width:u.PropertyDrawingUtil.emuToPt(t.w),height:u.PropertyDrawingUtil.emuToPt(t.h)})})),n)},e.parsePathString=function(e,t){var o=this,n="",r=!1;return t.forEach((function(t){if(!r){if(t.readOnly((function(){return t.close})))return n="".concat(n," Z"),void(r=!0);switch(t.Choice.propertyType){case u.PropertyType.CTPath2DMoveTo:n="".concat(n," ").concat(o.moveTo(e,t));break;case u.PropertyType.CTPath2DLineTo:n="".concat(n," ").concat(o.lineTo(e,t));break;case u.PropertyType.CTPath2DArcTo:n="".concat(n," ").concat(o.arcTo(t));break;case u.PropertyType.CTPath2DQuadBezierTo:n="".concat(n," ").concat(o.quadBezierTo(t));break;case u.PropertyType.CTPath2DCubicBezierTo:n="".concat(n," ").concat(o.cubicBezierTo(t))}}})),n},e.moveTo=function(e,t){var o=t.moveTo.pt,n=o.x.isEmpty(o.x.tKeys.geomGuideName)?o.x.coordinate:e.fmlaEval(o.x.geomGuideName),r=o.y.isEmpty(o.y.tKeys.geomGuideName)?o.y.coordinate:e.fmlaEval(o.x.geomGuideName);return g("M {x} {y}",{x:u.PropertyDrawingUtil.emuToPt(n),y:u.PropertyDrawingUtil.emuToPt(r)})},e.lineTo=function(e,t){var o=t.lnTo.pt,n=o.x.isEmpty(o.x.tKeys.geomGuideName)?o.x.coordinate:e.fmlaEval(o.x.geomGuideName),r=o.y.isEmpty(o.y.tKeys.geomGuideName)?o.y.coordinate:e.fmlaEval(o.x.geomGuideName);return g("L {x} {y}",{x:u.PropertyDrawingUtil.emuToPt(n),y:u.PropertyDrawingUtil.emuToPt(r)})},e.arcTo=function(e){var t=e.arcTo,o=t.wR,n=t.hR,r=t.stAng,i=t.swAng,a=u.PropertyDrawingUtil.emuToPt(o.coordinate),l=u.PropertyDrawingUtil.emuToPt(n.coordinate),s=r.angle%(2*Math.PI),c=i.angle%(2*Math.PI);return g("A {rx} {ry} {xAxisRotation} {largeArcFlag} {sweepFlag} {endX} {endY}",{rx:a,ry:l,xAxisRotation:s,largeArcFlag:0,sweepFlag:1,endX:a*Math.cos(c),endY:l*Math.sin(c)})},e.quadBezierTo=function(e){var t,o,n,r,i=e.quadBezTo.pt;return g("Q {cpx} {cpy} {x} {y}",{cpx:u.PropertyDrawingUtil.emuToPt((null===(t=i.getProperty(0))||void 0===t?void 0:t.x.coordinate)||0),cpy:u.PropertyDrawingUtil.emuToPt((null===(o=i.getProperty(0))||void 0===o?void 0:o.y.coordinate)||0),x:u.PropertyDrawingUtil.emuToPt((null===(n=i.getProperty(1))||void 0===n?void 0:n.x.coordinate)||0),y:u.PropertyDrawingUtil.emuToPt((null===(r=i.getProperty(1))||void 0===r?void 0:r.y.coordinate)||0)})},e.cubicBezierTo=function(e){var t,o,n,r,i,a,l=e.cubicBezTo.pt;return g("C {cp1x} {cp1y} {cp2x} {cp2y} {x} {y}",{cp1x:u.PropertyDrawingUtil.emuToPt((null===(t=l.getProperty(0))||void 0===t?void 0:t.x.coordinate)||0),cp1y:u.PropertyDrawingUtil.emuToPt((null===(o=l.getProperty(0))||void 0===o?void 0:o.y.coordinate)||0),cp2x:u.PropertyDrawingUtil.emuToPt((null===(n=l.getProperty(1))||void 0===n?void 0:n.x.coordinate)||0),cp2y:u.PropertyDrawingUtil.emuToPt((null===(r=l.getProperty(1))||void 0===r?void 0:r.y.coordinate)||0),x:u.PropertyDrawingUtil.emuToPt((null===(i=l.getProperty(2))||void 0===i?void 0:i.x.coordinate)||0),y:u.PropertyDrawingUtil.emuToPt((null===(a=l.getProperty(2))||void 0===a?void 0:a.y.coordinate)||0)})},e.getControlValues=function(e){var t=[];return e.gd.forEach((function(e){var o=Number(e.fmla.split(" ")[1])/1e5;t.push(o)})),t},e.getLineCap=function(e){return{flat:Nt.uq.Butt,rnd:Nt.uq.Round,sq:Nt.uq.Square}[e]||Nt.uq.Butt},e.getLineJoin=function(e){var t={round:Nt.Y3.Round,bevel:Nt.Y3.Bevel};return t[Object.keys(t).find((function(t){return e[t]}))||""]||Nt.Y3.Miter},e.getShapeFillStyle=function(e,t){var o=this.calcFillStyle(e.spPr,t.themeColorManager),n=e.readOnly((function(){return e.style}));if(!o&&n){var r=t.themeFormatManager.getFillProperties(n.fillRef);r&&(o=this.calcFillStyle(r,t.themeColorManager,e.style.fillRef.egColorChoice))}return o},e.calcFillStyle=function(e,t,o){var n;if(this.isShapeSolidFill(e))return{solidFill:{color:t.parseColorObjToHexColor(e.solidFill.egColorChoice,o)}};if(this.isShapeGradFill(e)){var r=[];e.gradFill.gsLst.gs.forEach((function(e){r.push({pos:u.PropertyDrawingUtil.percentageDecimalToPercentage(e.pos),color:t.parseColorObjToHexColor(e.egColorChoice,o)})}));var i=this.getGradientType(e.gradFill.egShadeProperties),a=void 0;return(null==i?void 0:i.path)===he.GL.Linear&&(a={ang:u.PropertyDrawingUtil.angleToDegree(e.gradFill.egShadeProperties.lin.ang),scaled:e.gradFill.egShadeProperties.lin.scaled}),{gradFill:{gsList:r,lin:a,pathGradient:i,rotateWithShape:e.gradFill.rotWithShape}}}if(this.isShapeBlipFill(e)){var l=e.blipFill,s=void 0;if(!l.egFillModeProperties.isEmpty(l.egFillModeProperties.tKeys.tile)){var c={undefined:Nt.A4.None,none:Nt.A4.None,x:Nt.A4.Horizontal,y:Nt.A4.Vertical,xy:Nt.A4.Both},d=l.egFillModeProperties.tile,p=d.tx,h=d.ty,f=d.sx,g=d.sy,y=d.flip,v=d.algn,x=c[this.getTileFlipPrstType(y)]||Nt.A4.None;x!==Nt.A4.None&&(s={tx:u.PropertyDrawingUtil.emuToPt(p),ty:u.PropertyDrawingUtil.emuToPt(h),sx:u.PropertyDrawingUtil.percentageDecimalToPercentage(f),sy:u.PropertyDrawingUtil.percentageDecimalToPercentage(g),flip:x,algn:this.getAlignmentPrstType(v)})}var m=void 0;if(!l.egFillModeProperties.isEmpty(l.egFillModeProperties.tKeys.stretch)){var w=l.egFillModeProperties.stretch;if(!w.isEmpty(w.tKeys.fillRect)){var S=w.fillRect,C=S.b,b=S.t,_=S.l,P=S.r;m={fillRect:{b:-u.PropertyDrawingUtil.percentageDecimalToPercentage(C)/100,t:-u.PropertyDrawingUtil.percentageDecimalToPercentage(b)/100,l:-u.PropertyDrawingUtil.percentageDecimalToPercentage(_)/100,r:-u.PropertyDrawingUtil.percentageDecimalToPercentage(P)/100}}}}var R=((null===(n=l.blip.alphaModFix.getProperty(0))||void 0===n?void 0:n.amt)||0)/1e5||1,T=document.createElement("canvas");return T.width=1,T.height=1,{imageFill:{src:T.toDataURL(),alpha:R,rotateWithShape:l.rotWithShape,tile:s,stretch:m}}}if(this.isShapePatternFill(e)){var E=e.pattFill,B=window.devicePixelRatio;return{patternFill:{preset:this.getPatternPrstType(E.prst),fgColor:t.parseColorObjToHexColor(E.fgClr,o),bgColor:t.parseColorObjToHexColor(E.bgClr,o),pageScale:Math.max(B,2)/B*Math.ceil(B)}}}return e.isEmpty(e.tKeys.noFill)?void 0:{noFill:!0}},e.isShapeSolidFill=function(e){return!e.isEmpty(e.tKeys.solidFill)},e.isShapeGradFill=function(e){return!e.isEmpty(e.tKeys.gradFill)},e.isShapeBlipFill=function(e){return!(e instanceof u.PropertyFactory.getPropertyClass(u.PropertyType.EGLineFillProperties)||e.isEmpty(e.tKeys.blipFill))},e.isShapePatternFill=function(e){return!e.isEmpty(e.tKeys.pattFill)},e.getLineFillStyle=function(e,t){var o=this.calcFillStyle(e.spPr.ln.egLineFillProperties,t.themeColorManager),n=e.readOnly((function(){return e.style}));if(!o&&n){var r=t.themeFormatManager.getLineProperties(n.lnRef);r&&(o=this.calcFillStyle(r.egLineFillProperties,t.themeColorManager,e.style.lnRef.egColorChoice))}return null!=o?o:{noFill:!0}},e.getGradientType=function(e){return e.isEmpty(e.tKeys.path)?{path:he.GL.Linear}:{path:he.GL.Radial,fillToRect:{b:u.PropertyDrawingUtil.percentageDecimalToPercentage(e.path.fillToRect.b),l:u.PropertyDrawingUtil.percentageDecimalToPercentage(e.path.fillToRect.l),r:u.PropertyDrawingUtil.percentageDecimalToPercentage(e.path.fillToRect.r),t:u.PropertyDrawingUtil.percentageDecimalToPercentage(e.path.fillToRect.t)}}},e.getFilter=function(e,t){var o=this.getEffectLst(e,t),n=this.hasEffectRef(e)?e.style.effectRef.egColorChoice:void 0;return{effect:{shadow:this.getShadow(o,t.themeColorManager,n),reflection:this.getReflection(o),glow:this.getGlow(o,t.themeColorManager,n),softEdge:this.getSoftEdge(o)},forbidWebgl:this.checkFilterSupport()}},e.hasEffectRef=function(e){return!e.isEmpty(e.tKeys.style)&&!e.style.isEmpty(e.style.tKeys.effectRef)},e.getEffectLst=function(e,t){if(!e.spPr.isEmpty(e.spPr.tKeys.effectLst))return e.spPr.effectLst;if(!this.hasEffectRef(e))return new(u.PropertyFactory.getPropertyClass(u.PropertyType.CTEffectList));var o=t.themeFormatManager.getEffectProperties(e.style.effectRef);return o?o.effectLst:new(u.PropertyFactory.getPropertyClass(u.PropertyType.CTEffectList))},e.getShadow=function(e,t,o){var r,i=!1;return e.isEmpty(e.tKeys.outerShdw)?e.isEmpty(e.tKeys.prstShdw)?e.isEmpty(e.tKeys.innerShdw)||(r=this.getShadowInfo(e.innerShdw,t,o)):(i=!0,r=this.getShadowInfo(e.prstShdw,t,o)):(i=!0,r=this.getShadowInfo(e.outerShdw,t,o)),(0,n.__assign)({isOuter:i},r)},e.getShadowInfo=function(e,t,o){var n,r,i,a,l;if(e.propertyType===u.PropertyType.CTOuterShadowEffect){var s=e,c=s.sx,d=s.sy,p=s.kx,h=s.ky,g=s.algn;e.isEmpty(e.tKeys.sx)||(n=u.PropertyDrawingUtil.percentageDecimalToPercentage(c)),e.isEmpty(e.tKeys.sy)||(r=u.PropertyDrawingUtil.percentageDecimalToPercentage(d)),i=u.PropertyDrawingUtil.angleToDegree(p),a=u.PropertyDrawingUtil.angleToDegree(h),l=this.getAlignmentPrstType(g)}var y=t.parseColorObjToRGBAColor(e.egColorChoice,o),v=u.PropertyFactory.getPropertyClass(u.PropertyType.CTPresetShadowEffect);return{blur:u.PropertyDrawingUtil.emuToPt(e instanceof v?0:e.blurRad),angle:u.PropertyDrawingUtil.angleToDegree(e.dir),distance:u.PropertyDrawingUtil.emuToPt(e.dist),color:y?f.u$.rgbColor2hex(y,!0):"",opacity:this.rgbaAlphaToOpacity(null==y?void 0:y.alpha),size:100,scaleX:n,scaleY:r,skewX:i,skewY:a,algn:l}},e.getReflection=function(e){if(!e.isEmpty(e.tKeys.reflection)){var t=e.reflection;return{blur:u.PropertyDrawingUtil.emuToPt(t.blurRad),angle:u.PropertyDrawingUtil.angleToDegree(t.dir),distance:u.PropertyDrawingUtil.emuToPt(t.dist),startOpacity:u.PropertyDrawingUtil.alphaToOpacity(t.stA),endOpacity:u.PropertyDrawingUtil.alphaToOpacity(t.endA),rotateWithShape:t.rotWithShape,size:u.PropertyDrawingUtil.percentageDecimalToPercentage(t.endPos)}}},e.getGlow=function(e,t,o){var n=e.glow,r=t.parseColorObjToRGBAColor(n.egColorChoice,o);return{color:r?f.u$.rgbColor2hex(r,!0):"",opacity:void 0!==(null==r?void 0:r.alpha)?100*(1-r.alpha):0,size:u.PropertyDrawingUtil.emuToPt(n.rad)}},e.getSoftEdge=function(e){var t=e.softEdge;return{size:u.PropertyDrawingUtil.emuToPt(t.rad)}},e.rgbaAlphaToOpacity=function(e){return void 0!==e?100*(1-e):0},e.getPrstType=function(e){var t=e.split("_")[1];return"undefined"!==t?t:""},e.getLineDashPrstType=function(e){return e===u.STPresetLineDashVal.PBDEFAULT?"":u.STPresetLineDashVal[e]},e.getLineCapPrstType=function(e){return e===u.STLineCap.PBDEFAULT?"":u.STLineCap[e]},e.getTileFlipPrstType=function(e){return e===u.STTileFlipMode.PBDEFAULT?"":u.STTileFlipMode[e]},e.getAlignmentPrstType=function(e){return e===u.STRectAlignment.PBDEFAULT?"":u.STRectAlignment[e]},e.getPatternPrstType=function(e){return e===u.STPresetPatternVal.PBDEFAULT?"":u.STPresetPatternVal[e]},e.getLineEndPrstType=function(e){return e===u.STLineEndType.PBDEFAULT?"":u.STLineEndType[e]},e.getShapePrstType=function(e){return e===u.STShapeType.PBDEFAULT?"":u.STShapeType[e]},e.checkFilterSupport=function(){var e,t=document.createElement("canvas").getContext("2d");return!!t&&(null===(e=t.filter)||void 0===e?void 0:e.length)>0},e}(),Jt=function(){function e(){}return e.collectSingleShape=function(e){var t=e.layoutBox,o=e.collector,n=e.offset,r=e.checker,i=e.shares,a=t.getOriginSizeBox(),s=a.property,c=a.positionBoxSize,d=a.positionOutset,p=(0,l.SsA)(n.x+d.left,n.y+d.top-r.incRegion.y,c.width,c.height);if(null==s?void 0:s.isVML()){var h=i.state.dataEngine.getDataManager().getThemeManager(),u=this.getHeaderFooterStyle(e),f=this.createDrawingView(t.drawingCurrent,p,u,h);o.collect(f,l._AL.drawingOverlay)}},e.getHeaderFooterStyle=function(e){var t=e.shares,o=e.flags;return l.vW8.computeHeaderFooterFocusStyles(t.docEnv.docViewType,t.isFocusHeaderFooter,null==o?void 0:o.isInHeaderFooter)},e.createDrawingView=function(e,t,o,n){var r=this.getDrawingFrame(e,t),i=this.getPath(e,r),a=this.getShapeFillStyle(e,o.opacity),l=this.getStrokeStyle(e,n),s=this.getFilter(e),c=e.getTextFill();return!(null==a?void 0:a.imageFill)&&(null==c?void 0:c.hiddenShape)&&(i={type:he.wf.CUSTOM,pathList:[],controlValues:[]}),je.obtain({frame:r,path:i,effectExtent:{l:0,t:0,r:0,b:0},fillStyle:a,strokeStyle:l,filter:s,textFill:c,headerFooterStyle:o})},e.getDrawingFrame=function(e,t){if(e.dCurrent instanceof u.PropertyFactory.getPropertyClass(u.PropertyType.CTLine)){var o=(0,u.parseTwipsPair)(e.dCurrent.from),n=(0,u.parseTwipsPair)(e.dCurrent.to);return{left:t.x+o.x,top:t.y+o.y,width:Math.abs(n.x-o.x),height:Math.abs(n.y-o.y),rotate:0}}return{left:t.x,top:t.y,width:t.width,height:t.height,rotate:0}},e.getPath=function(e,t){var o,r,i,a=this.getGraphicType(e),l=[];if(e.dCurrent instanceof u.PropertyFactory.getPropertyClass(u.PropertyType.CTShapeVmlM)){var s=e.dCurrent,c=u.CTShapeTypeMap.get(s.type.substring(2));if(c){var d=null!==(r=s.readOnly((function(){return s.pathAttr})))&&void 0!==r?r:c.readOnly((function(){return c.pathAttr})),p=null!==(i=s.readOnly((function(){return s.coordsize})))&&void 0!==i?i:c.readOnly((function(){return c.coordsize}));if(d&&p){e.fmlaVM.initFromVML(s,c),e.fmlaVM.forEach((function(e,t){d=d.replace(e,"".concat(t))}));var h=(0,n.__read)((0,u.parseNumberPair)(p),2),f=h[0],g=h[1],y={pathString:this.pathAttrToSvgCommand(d,t.width/f,t.height/g),width:t.width,height:t.height};l.push(y)}}else l.push({pathString:this.convertConnectlocsToSVG((null===(o=s.path.getProperty(0))||void 0===o?void 0:o.connectlocs)||""),width:parseFloat(e.parsedStyle._style.width||"0"),height:parseFloat(e.parsedStyle._style.height||"0")})}return{type:a,controlValues:[],pathList:l}},e.getShapeFillStyle=function(e,t){void 0===t&&(t=1);var o=e.dCurrent;if(!(o instanceof u.PropertyFactory.getPropertyClass(u.PropertyType.CTPath))){var n=o.fillcolor;if(n)return{solidFill:{color:(0,u.parseStrokeColorToColorHex)(n.split(" ")[0])}};if(o instanceof u.PropertyFactory.getPropertyClass(u.PropertyType.CTShapeVmlM)&&o.has("imagedata")){var r=o.readOnly((function(){var e;return null===(e=o.imagedata)||void 0===e?void 0:e.getProperty(0)})),i=(null==r?void 0:r.readOnly((function(){return null==r?void 0:r.id})))||"";if(i)return{imageFill:{src:i,alpha:1,outerAlpha:t,stretch:{srcRect:{t:(0,u.parseFraction)((null==r?void 0:r.readOnly((function(){return null==r?void 0:r.croptop})))||""),b:(0,u.parseFraction)((null==r?void 0:r.readOnly((function(){return null==r?void 0:r.cropbottom})))||""),l:(0,u.parseFraction)((null==r?void 0:r.readOnly((function(){return null==r?void 0:r.cropleft})))||""),r:(0,u.parseFraction)((null==r?void 0:r.readOnly((function(){return null==r?void 0:r.cropright})))||"")}}}}}}},e.getGraphicType=function(e){return e.dCurrent instanceof u.PropertyFactory.getPropertyClass(u.PropertyType.CTLine)?he.wf.LINE:e.dCurrent instanceof u.PropertyFactory.getPropertyClass(u.PropertyType.CTOval)?he.wf.ELLIPSE:e.dCurrent instanceof u.PropertyFactory.getPropertyClass(u.PropertyType.CTRect)||e.dCurrent instanceof u.PropertyFactory.getPropertyClass(u.PropertyType.CTShapeVmlM)&&e.dCurrent.has("imagedata")?he.wf.RECT:he.wf.CUSTOM},e.getStrokeStyle=function(e,t){var o,n,r=Nt.uq.Butt,i=Nt.Y3.Miter;if(e.dCurrent instanceof u.PropertyFactory.getPropertyClass(u.PropertyType.CTShapeVmlM)){var a=u.CTShapeTypeMap.get(e.dCurrent.type.substring(2));if(!a||a.stroked===u.STTrueFalse.f)return;var l=32===a.spt?1:void 0;return{fillStyle:this.getLineFillStyle(e,t),type:he.nZ.SOLID,lineWidth:null!==(o=this.getLineWidth(e,t))&&void 0!==o?o:l,lineCap:r,lineJoin:i,headEnd:{lineEndType:"none"},tailEnd:{lineEndType:"none"}}}return e.dCurrent instanceof u.PropertyFactory.getPropertyClass(u.PropertyType.CTLine)?{fillStyle:this.getLineFillStyle(e,t),type:he.nZ.SOLID,lineWidth:this.getLineWidth(e,t),lineCap:r,lineJoin:i,headEnd:{lineEndType:"none"},tailEnd:{lineEndType:"none"}}:{fillStyle:this.getLineFillStyle(e,t),type:he.nZ.SOLID,lineWidth:null!==(n=this.getLineWidth(e,t))&&void 0!==n?n:1,lineCap:r,lineJoin:i,headEnd:{lineEndType:"none"},tailEnd:{lineEndType:"none"}}},e.getFilter=function(e){var t=e.dCurrent;if(t instanceof u.PropertyFactory.getPropertyClass(u.PropertyType.CTShapeVmlM)){var o=t.readOnly((function(){return t.imagedata.getProperty(0)}))||{},n=o.gain,r=o.blacklevel;if(n&&r)return{imageFilter:{brightness:0,colorTemperature:6500,contrast:0,saturate:100,sharpenSoften:0,grayscl:!1,luminance:{brightness:70,contrast:-70}}}}},e.getLineFillStyle=function(e,t){return e.dCurrent instanceof u.PropertyFactory.getPropertyClass(u.PropertyType.CTLine)||e.dCurrent instanceof u.PropertyFactory.getPropertyClass(u.PropertyType.CTShapeVmlM)||e.dCurrent instanceof u.PropertyFactory.getPropertyClass(u.PropertyType.CTOval)?{solidFill:{color:(0,u.parseStrokeColorToColorHex)(e.dCurrent.strokecolor.split(" ")[0])}}:e.dCurrent instanceof u.PropertyFactory.getPropertyClass(u.PropertyType.CTRect)?{solidFill:{color:"#000000"}}:{noFill:!0}},e.getLineWidth=function(e,t){return e.dCurrent instanceof u.PropertyFactory.getPropertyClass(u.PropertyType.CTLine)||e.dCurrent instanceof u.PropertyFactory.getPropertyClass(u.PropertyType.CTShapeVmlM)?parseFloat(e.dCurrent.strokeweight)||void 0:e.dCurrent instanceof u.PropertyFactory.getPropertyClass(u.PropertyType.CTOval)&&parseFloat(e.dCurrent.strokeweight)||void 0},e.convertConnectlocsToSVG=function(e){for(var t=e.split(";"),o=[],n=0;n<t.length;n++)if(t[n]){var r=t[n].trim().split(","),i=u.PropertyDrawingUtil.emuToPt(parseFloat(r[0].trim())),a=u.PropertyDrawingUtil.emuToPt(parseFloat(r[1].trim()));0===n?o.push("M ".concat(i," ").concat(a)):o.push("L ".concat(i," ").concat(a))}return o.join(" ")},e.pathAttrToSvgCommand=function(e,t,o){return void 0===t&&(t=1),void 0===o&&(o=1),(0,u.vmlPathParser)(e).map((function(e){return"Z"===e.type?"Z":"".concat(e.type," ").concat(e.x*t," ").concat(e.y*o)})).join(" ")},e}(),Gt=o(783504),Yt=o(252677),Xt=o(970980),Kt=function(){function e(){}return e.collect=function(e){var t,o=e.collector,n=e.layoutBox,r=e.flags,i=e.checker,a=e.offset,s=(r||{}).contextState,c=n.drawingCurrent.dCurrent,d=n.getOriginSizeBox().positionBoxSize,p=d.width,h=d.height,u=c.readOnly((function(){var e;return null===(e=null==c?void 0:c.chartSpace)||void 0===e?void 0:e.chartId})),f=this.getChartConfig(c),g=je.obtain({effectExtent:{l:0,t:0,r:0,b:0},frame:{left:a.x,top:a.y-i.incRegion.y,width:p,height:h,flipH:!1,flipV:!1,rotate:0},path:{type:he.wf.RECT},fillStyle:{solidFill:{color:"#f9fafb"}},contextState:s,chartInfo:{chartId:u&&"".concat(null===(t=window.clientVars)||void 0===t?void 0:t.padId,"-").concat(u),chartConfig:f}});o.collect(g,l._AL.mainText)},e.getChartConfig=function(e){var t,o;if(e){var n=(0,Yt.K4)({chart:null===(t=e.chartSpace)||void 0===t?void 0:t.toJsonRecursion(),msChartEx:null===(o=e.chartSpaceEx)||void 0===o?void 0:o.toJsonRecursion()}),r=(0,Xt.f6)(n),i=Gt.ZP.t("chart:default-title"),a=r.commonConfig,l=r.chartRendererConfig;return a&&(a.title="object"==typeof a.title?a.title:{},a.title.text=a.title.text||i),l&&(l.title="object"==typeof l.title?l.title:{},l.title.text=l.title.text||i),r}return null},e}(),qt=function(e){function t(t,o){return e.call(this,t,o)||this}return(0,n.__extends)(t,e),t.prototype.render=function(e){if(!this.skipDrawingRender(e)){var t=e.layoutBox,o=e.offset,r=e.traversalRange,i=e.flags,a=e.appendBox,s=e.checker,c=this.calcTextTransform(e),d=this.getClipInfo(o,t,s),p=(0,l.jVi)(d,c),h=this.getScrollInfo(e),f=h.scrollLeft,g=h.scrollTop;a({layoutBox:t,offset:{x:o.x-f,y:o.y-g},traversalRange:r,flags:(0,n.__assign)((0,n.__assign)({},i),{contextState:p,storyType:u.STStoryType.textboxContent})}),this.renderRealShape(e)}},t.prototype.getClipInfo=function(e,t,o){var n=t.getOriginSizeBox(),r=n.contentSize,i=n.rect,a=n.edge,s=a.padding,c=a.border,d=e.x+c.width.left+s.left,p=i.width,h=e.y+c.width.top+s.top,u=i.height;if(r.width!==i.width||r.height!==i.height){var f=(0,l.SsA)(d,h,p,u);if(f.width>0&&f.height>0)return(0,l.SsA)(f.x,f.y-o.incRegion.y,f.width,f.height)}},t.prototype.getScrollInfo=function(e){var t=e.layoutBox,o=e.shares;if(!t.textboxProperty||t.textboxProperty.textBoxType===u.TextFrameType.TextFrame)return{scrollLeft:0,scrollTop:0};var n="RealShape-".concat(t.textboxProperty.id),r=t.getOriginSizeBox(),i=r.contentSize,l=r.positionBoxSize,s=o.renderState.getScrollerInfo(n)||{left:0,top:0};return{scrollLeft:Math.min(i.width-l.width,(0,a.Ej)(s.left)),scrollTop:Math.min(i.height-l.height,(0,a.Ej)(s.top))}},t.prototype.renderRealShape=function(e){var t,o=e.collector,n=e.layoutBox,r=e.offset,i=e.flags,a=e.shares,s=e.checker;if(n.drawingCurrent instanceof u.DrawingCurrentChartWps)Kt.collect(e);else{if((null===(t=n.property)||void 0===t?void 0:t.propertyType)!==u.PropertyType.DrawingProperty)return void Jt.collectSingleShape(e);Ut.collectSingleShape(e)}var c=this.shares.extRendererManager.getExtendRenderer(l.Rli.Textframe);if((null==c?void 0:c.rendererCount())&&n.drawingCurrent.isRoot){var d=Ct.obtain(a,o,r,s.incRegion,i);c.draw(d,n),d.recycle()}},t.prototype.calcTextTransform=function(e){var t,o,n=e.layoutBox,r=e.offset,i=e.checker,l=e.shares,s=n.property;if(s&&s.isDML()){var c=null==s?void 0:s.drawing.graphic.graphicData.wsp;if(c&&!c.bodyPr.isEmpty(c.bodyPr.tKeys.prstTxWarp)){var d=c.bodyPr.prstTxWarp.prst;if(d&&d!==u.STTextShapeType.textNoShape){var p=l.renderState.getTextFrameActiveInfo();if(!(null===(t=null==p?void 0:p.box.property)||void 0===t?void 0:t.anchorId)||(null===(o=null==p?void 0:p.box.property)||void 0===o?void 0:o.anchorId)!==(null==s?void 0:s.anchorId)||!(null==p?void 0:p.contentActive)){var h=this.getClipInfo(r,n,i);if(h){var f=this.calcTextOriginRect(e,h),g=h.width/f.width,y=h.height/f.height,v=a.gS.productsRight(a.gS.translate2d(-(f.x+f.width/2),-(f.y+f.height/2)),a.gS.scale2d(g,y),a.gS.translate2d(h.x+h.width/2,h.y+h.height/2));return a.gS.toMatrix2D(v)}}}}}},t.prototype.calcTextOriginRect=function(e,t){var o=this,n=t.x+t.width,r=t.x,i=t.y+t.height,a=t.y;return l.d_x.layoutBoxTraversal({layoutBox:e.layoutBox,offset:e.offset},(function(e){var s,c=e.childBoxItem,d=e.appendBox,p=c.layoutBox,u=c.offset,f=c.traversalRange;if(u.y>=t.y+t.height)return l.xt0.Break;if((0,h.o70)(p)&&u.y>=t.y&&u.y<t.y+t.height&&(i=Math.min(i,u.y),a=Math.max(a,u.y+p.borderBoxSize.height)),((0,h.o70)(p)||(0,h.tqe)(p)||(0,h.JtM)(p))&&(0,h.Dyp)(p.firstChild)){var g=o.findFirstOrLastVisibleLeafChild(p,!0);if(g){var y=o.calcChildOffset(u,g),v=o.findFirstOrLastVisibleLeafChild(p,!1),x=o.calcChildOffset(u,v);n=Math.min(n,y.x),r=Math.max(r,x.x+(null!==(s=null==v?void 0:v.borderBoxSize.width)&&void 0!==s?s:0))}return l.xt0.Continue}return d({layoutBox:p,offset:u,traversalRange:f}),l.xt0.Continue})),(0,l.SsA)(n,i,r-n,a-i)},t.prototype.calcChildOffset=function(e,t){if(!t)return e;var o=t.edge.margin,n=t.getOuterPoint();return{x:e.x+n.x+o.left,y:e.y+n.y+o.top}},t.prototype.findFirstOrLastVisibleLeafChild=function(e,t){var o,r;if((0,h.Dyp)(e.firstChild)){var i=t?e.children:e.children.slice().reverse();try{for(var a=(0,n.__values)(i),l=a.next();!l.done;l=a.next()){var s=l.value;if((0,h.Dyp)(s)&&this.isVisibleLeaf(s))return s}}catch(e){o={error:e}}finally{try{l&&!l.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}}},t.prototype.isVisibleLeaf=function(e){return!(e.totalWidth<=0||(0,h.NFz)(e)&&0===e.text.trim().length)},t}(rt),Qt=function(e){function t(t,o){return e.call(this,t,o)||this}return(0,n.__extends)(t,e),t.prototype.render=function(e){if(!this.skipDrawingRender(e)){var t=e.layoutBox,o=e.offset,r=e.traversalRange,i=e.flags,a=e.appendBox,s=e.checker,c=this.getClipInfo(o,t,s),d=(0,l.jVi)(c,void 0);a({layoutBox:t,offset:{x:o.x,y:o.y},traversalRange:r,flags:(0,n.__assign)((0,n.__assign)({},i),{contextState:d,storyType:u.STStoryType.textboxContent})}),this.renderRealShapeGroup(e)}},t.prototype.getClipInfo=function(e,t,o){var n=t.getOriginSizeBox(),r=n.contentSize,i=n.rect,a=n.edge,s=a.padding,c=a.border,d=e.x+c.width.left+s.left,p=i.width,h=e.y+c.width.top+s.top,u=i.height;if(r.width!==i.width||r.height!==i.height){var f=(0,l.SsA)(d,h,p,u);if(f.width>0&&f.height>0)return(0,l.SsA)(f.x,f.y-o.incRegion.y,f.width,f.height)}},t.prototype.renderRealShapeGroup=function(e){var t=e.collector,o=e.layoutBox,n=e.offset,r=e.flags,i=e.shares,a=e.checker,s=this.shares.extRendererManager.getExtendRenderer(l.Rli.Textframe);if((null==s?void 0:s.rendererCount())&&o.drawingCurrent.isRoot){var c=Ct.obtain(i,t,n,a.incRegion,r);s.draw(c,o),c.recycle()}},t}(rt),Zt=function(e){function t(t,o,n){var r=e.call(this,t,o)||this;return r.textBoxRender=n,r}return(0,n.__extends)(t,e),t.prototype.render=function(e){var t=e.layoutBox,o=e.offset,r=e.appendBox,i=e.traversalRange,l=e.flags,s=(0,n.__assign)({},o);u.FieldName.MENTION_QQ===t.subType&&(s.x+=(0,a.Ej)(5)),u.FieldName.MENTION_WXWORK===t.subType&&(s.x+=(0,a.Ej)(5)),r({layoutBox:t,offset:s,traversalRange:i,flags:l}),this.renderTextLineFragment(e)},t.prototype.renderTextLineFragment=function(e){var t=e.collector,o=e.layoutBox,n=e.offset,r=e.flags,i=e.checker,a=this.shares.extRendererManager.getExtendRenderer(l.Rli.TextLineFragment);if(null==a?void 0:a.rendererCount()){var s=Ct.obtain(this.shares,t,n,i.incRegion,r);a.draw(s,o),s.recycle()}},t.prototype.renderAuxiliaryLine=function(e){var t=e.layoutBox,o=e.collector,n=e.offset,r=e.flags,i=e.checker,l=t.edge,s=new a.HL({x:n.x-l.margin.left,y:n.y-l.margin.top,width:t.totalWidth,height:t.totalHeight});this.renderRectBorder(s,o,i,r),s=new a.HL({x:n.x+l.padding.left,y:n.y+l.padding.top,width:t.rect.width,height:t.rect.height}),this.renderRectBorder(s,o,i,r),s=new a.HL({x:n.x+l.padding.left,y:n.y+l.padding.top,width:t.rect.width,height:t.rect.width}),this.renderRectBorder(s,o,i,r),l.recycle()},t}(rt),$t=function(){function e(e,t){var o=this;this.context=e,this.shares=t,this.onDoubleClick=function(e,t,n,r,i){var a=t===u.STStoryType.headerContent,s=t===u.STStoryType.footerContent;if(o.shares.isEditable()){var c=o.shares.selectionOverlay.mouseSelector,d=e.clientX,p=e.clientY,h=e.target,f=o.context.root,g=(0,l.FZR)(f,p)-1;o.shares.selectionOverlay.updatePageIndexByCount(g);var y=o.calMouseEventHitPoint(e),v=y.totalHitPtX,x=y.totalHitPtY;a||s?o.actionToHeaderFooter(i,v,x,t,n):(o.updateFocusHeaderFooter(!1),o.context.fire(new l.kv7),o.context.fire(new l.x7H),c.updateBoth({clientX:d,clientY:p,element:h},{x:v,y:x}),c.selectionCallback&&c.selectionCallback(c,l.bL4.DEFAULT)),e.stopPropagation()}}}return e.prototype.actionToHeaderFooter=function(e,t,o,n,r){var i=this.shares.selectionOverlay.mouseSelector,a=n===u.STStoryType.headerContent,s=null;e||(s=this.getRangeFromHitPoint(t,o)),i.getSelection()&&this.context.fire(new l.EuV(a,r,e,i.getSelection().viewRange.getGCPRange(),s))},e.prototype.getRangeFromHitPoint=function(e,t){var o=null,n=this.shares.selectionOverlay.mouseSelector.findHitViewPoint(!0,!1,!1,{x:e,y:t});return n&&(o=new l.rOq(n,n.clone())),o},e.prototype.updateFocusHeaderFooter=function(e){this.shares.renderState.setFocusOnInfo({isFocusHeaderFooter:e})},e.prototype.calMouseEventHitPoint=function(e){var t=this.getEditorZoom(),o=this.context.root.getBoundingClientRect(),n=f.$w.getElementZoomValue(document.body);return{totalHitPtX:((0,a.Ej)(e.clientX/n)-(0,a.Ej)(o.left))/t,totalHitPtY:((0,a.Ej)(e.clientY/n)-(0,a.Ej)(o.top))/t}},e.prototype.getEditorZoom=function(){return(this.shares.renderState.getEditorInfo()||{zoom:1}).zoom},e.prototype.isFocusOn=function(e){var t=this.shares.isFocusHeaderFooter;return t&&this.isHeaderOrFooter(e)||!t&&!this.isHeaderOrFooter(e)},e.prototype.isHeaderOrFooter=function(e){return e===u.STStoryType.headerContent||e===u.STStoryType.footerContent},e.prototype.renderMask=function(e){var t=this,o=e.layoutBox,n=e.offset,r=e.collector,s=e.shares,c=this.isFocusOn(o.storyType),d=(0,l.SsA)(n.x,n.y,o.totalWidth,o.totalHeight);if((0,l.UHV)(d))if(c){if(this.isHeaderOrFooter(o.storyType)){var p=s.decoratorManager.getDecorator(l.cip.HeaderFooter).decorate(o),f=p.components,g=p.overrideStyle,y=We.obtain(o.uuid,d,i().createElement("div",{style:{width:"".concat((0,a.FJ)(o.totalWidth),"px"),height:"".concat((0,a.FJ)(o.totalHeight),"px")}},f),g);r.collect(y,l._AL.headerFooter)}}else y=We.obtain(o.uuid,d,i().createElement("div",{style:{width:"".concat((0,a.FJ)(o.totalWidth),"px"),height:"".concat((0,a.FJ)(o.totalHeight),"px")},onMouseDown:function(e){c||e.stopPropagation()},onMouseMove:function(e){c||e.stopPropagation()},onMouseUp:function(e){c||e.stopPropagation()},onContextMenu:function(e){c||e.stopPropagation()},onDoubleClick:function(e){var n=!o.isValid(),r=(0,h.DeV)(o)?o.parity:u.STHdrFtr.PBDEFAULT;t.onDoubleClick(e,o.storyType,r,c,n)}}),{backgroundColor:"#FFFFFF",opacity:0}),r.collect(y,l._AL.containerPage)},e}();!function(e){e.MarginColor="#d18f526f",e.BorderColor="#ff616e6f",e.PaddingColor="#8cc2656f",e.ContentColor="#4cd1e06f",e.RedColor="#FF0000"}(gt||(gt={}));var eo=function(){function e(){}return e.renderInspect=function(e){globalThis.docDevToolSelectBoxId&&Number(globalThis.docDevToolSelectBoxId)===Number(e.layoutBox.uuid)&&((0,h.$o4)(e.layoutBox),this.renderInspectCommon(e))},e.getPrority=function(){return l.Ypk.UpperImages},e.renderRectInspect=function(e,t,o,n,r){var i=ze.obtain((0,l.SsA)(e.x,e.y-o.incRegion.y,e.width,e.height),"preview-diff",{radius:0,fillColor:n},null==r?void 0:r.contextState);t.collect(i,this.getPrority())},e.renderCenterRedCross=function(e,t,o,n){t.collect(ze.obtain((0,l.SsA)(0,e.y-o.incRegion.y+Math.floor(e.height/2)-6,1e5,12),"preview-diff",{radius:0,fillColor:gt.RedColor},null==n?void 0:n.contextState),this.getPrority()),t.collect(ze.obtain((0,l.SsA)(e.x+Math.floor(e.width/2)-6,0,12,1e5),"preview-diff",{radius:0,fillColor:gt.RedColor},null==n?void 0:n.contextState),this.getPrority())},e.renderRectText=function(e,t,o){var n="".concat(o,"(").concat(e.x.toFixed(1),", ").concat(e.y.toFixed(1),", ").concat(e.width.toFixed(1),", ").concat(e.height.toFixed(1),")");t.collect(Q.obtain((0,l.SsA)(e.x,e.y<180?180:e.y,0,0),n,{uuid:"red-cross-coodinate"},{}),this.getPrority())},e.renderInspectText=function(e){var t=e.layoutBox,o=e.collector,n=e.checker,r=e.offset,i=e.flags,l=t.edge,s=new a.HL({x:r.x,y:r.y,width:t.totalWidth,height:t.totalHeight});this.renderRectInspect(s,o,n,gt.ContentColor,i),l.recycle()},e.renderInspectContainer=function(e){var t=e.layoutBox,o=e.collector,n=e.checker,r=e.offset,i=e.flags,l=t.edge,s=t.parentBox?t.parentBox.ascent-t.ascent:0,c=new a.HL({x:r.x,y:r.y+s,width:t.totalBoxSize.width,height:t.totalBoxSize.height});this.renderRectInspect(c,o,n,gt.ContentColor,i),l.recycle()},e.renderInspectCommon=function(e){var t,o=e.layoutBox,n=e.collector,r=e.checker,i=e.offset,l=e.flags,s=o.edge;t=(0,h.vvs)(o)&&o.floatingSpace?this.getFloatingRect(e):new a.HL({x:i.x-s.margin.left,y:i.y-s.margin.top,width:o.totalWidth,height:o.totalHeight}),this.renderRectInspect(t,n,r,gt.MarginColor,l),this.renderCenterRedCross(t,n,r,l),this.renderRectText(t,n,(0,h.WVV)(o.constructor.kind)),t=new a.HL({x:i.x,y:i.y,width:o.borderBoxSize.width,height:o.borderBoxSize.height}),this.renderRectInspect(t,n,r,gt.BorderColor,l),t=new a.HL({x:i.x+s.border.width.left,y:i.y+s.border.width.top,width:o.paddingBoxSize.width,height:o.paddingBoxSize.height}),this.renderRectInspect(t,n,r,gt.PaddingColor,l),t=new a.HL({x:i.x+s.border.width.left+s.padding.left,y:i.y+s.border.width.top+s.padding.top,width:o.rect.width,height:o.rect.height}),this.renderRectInspect(t,n,r,gt.ContentColor,l),s.recycle()},e.getFloatingRect=function(e){var t=e.layoutBox,o=e.offset,n=e.checker,r=0,i=0,l=0,s=0;if((0,h.vvs)(t)){var c=t.getOriginSizeBox();r=c.positionOutset.left,i=c.positionOutset.top,l=c.positionBoxSize.width,s=c.positionBoxSize.height}return new a.HL({x:o.x+r,y:o.y+i-n.incRegion.y,width:l,height:s})},e}(),to=function(e){function t(t,o,n){var r=e.call(this,t,o)||this;return r.renderPageMask=n,r}return(0,n.__extends)(t,e),t.prototype.render=function(e){var t,o=e.layoutBox,r=e.offset,i=e.traversalRange,a=e.appendBox,s=e.flags,c=e.shares,d=e.checker;c.docEnv.docViewType!==u.DocViewType.SnapPreview&&(o.children.length>0&&o.totalHeight<o.children[0].totalHeight+o.edge.top&&(t=(0,l.SsA)(r.x,r.y-d.incRegion.y,o.totalWidth,o.totalHeight)),a({layoutBox:o,offset:r,traversalRange:i,flags:(0,n.__assign)((0,n.__assign)({},s),{isInHeaderFooter:!0,contextState:(0,l.jVi)(t)})}),this.renderPageMask.renderMask(e))},t}(rt),oo=function(e){function t(t,o,n){var r=e.call(this,t,o)||this;return r.renderPageMask=n,r}return(0,n.__extends)(t,e),t.prototype.render=function(e){var t=e.layoutBox,o=e.offset,r=e.traversalRange,i=e.appendBox,a=e.flags,s=e.checker,c=this.getClipInfo(o,t,s),d=(0,l.jVi)(c);i({layoutBox:t,offset:o,traversalRange:r,flags:(0,n.__assign)((0,n.__assign)({},a),{contextState:d})}),this.renderPageMask.renderMask(e)},t.prototype.getClipInfo=function(e,t,o){var n,r,i=null===(n=t.parentBox)||void 0===n?void 0:n.borderBoxSize.width,a=null===(r=t.parentBox)||void 0===r?void 0:r.borderBoxSize.height;if(i&&a){var s=(0,l.SsA)(0,0,i,a);return s.width>0&&s.height>0?(0,l.SsA)(0,-o.incRegion.y,s.width,s.height):void 0}},t}(rt),no=function(e){function t(t,o){return e.call(this,t,o)||this}return(0,n.__extends)(t,e),t.prototype.render=function(e){var t=e.layoutBox,o=e.offset,n=e.appendBox,r=e.traversalRange,i=e.flags;(0,h.EbP)(t)&&n({layoutBox:t,offset:o,traversalRange:r,flags:i}),this.invokeExtendRenderer(l.Rli.Page,e)},t.prototype.invokeExtendRenderer=function(e,t){var o=t.layoutBox,n=t.shares,r=t.offset,i=t.collector,a=t.flags,l=t.checker,s=this.shares.extRendererManager.getExtendRenderer(e);if(null==s?void 0:s.rendererCount()){var c=Ct.obtain(n,i,r,l.incRegion,a);s.draw(c,o),c.recycle()}},t}(rt),ro=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),t.prototype.render=function(e){var t=e.layoutBox,o=e.offset,n=e.appendBox,r=e.traversalRange,i=e.flags;this.renderSdtOverlay(e),n({layoutBox:t,offset:o,traversalRange:r,flags:i})},t.prototype.renderSdtOverlay=function(e){var t=this,o=e.context;o.selection.sdt.activeSdts.forEach((function(n){var r;if(!o.getRevisionsManger().isAllContentRevisionHidden([new u.GCPRange(n.range.begin(),1),new u.GCPRange(n.range.end()-1,1)])){var i=null===(r=e.layoutBox.getAncestorOf(h.uOS.Table))||void 0===r?void 0:r.getRange();!n.property.isRow&&i&&n.range.begin()<i.begin()&&n.range.end()>i.begin()?t.addSdtOverlayView(e,n.range):n.property.isRow&&e.layoutBox.getRange().intersect(n.range)&&t.addSdtRowOverlayView(e)}}))},t.prototype.addSdtRowOverlayView=function(e){var t,o,n,r=this.getScrollLeft(e),i=e.layoutBox,a=e.offset,s=e.collector,c=(0,l.SsA)(a.x+r,a.y,null!==(n=null===(o=null===(t=i.parentBox)||void 0===t?void 0:t.rectSize)||void 0===o?void 0:o.width)&&void 0!==n?n:i.rect.width,i.rect.height),d=Ve.obtain(c,{strokeColor:"#1e6fff",radius:0});d.preLineView=void 0,d.nextLineView=void 0,s.collect(d,l._AL.sdtOverlay)},t.prototype.addSdtOverlayView=function(e,t){var o,n,r,i=this.getScrollLeft(e),a=e.layoutBox,s=e.offset,c=e.collector,d=e.shares,p=(0,l.SsA)(s.x+i,s.y,null!==(r=null===(n=null===(o=a.parentBox)||void 0===o?void 0:o.rectSize)||void 0===n?void 0:n.width)&&void 0!==r?r:a.rect.width,a.rect.height),h=Ve.obtain(p,{strokeColor:"#1e6fff",radius:0,mergeMultiLine:!0});this.mergeMultiLineOverlay(h,d,t),this.handleBorderCrossPages(h,d,a,t),c.collect(h,l._AL.sdtOverlay)},t.prototype.mergeMultiLineOverlay=function(e,t,o){var n;if(o){var r=null!==(n=t.renderState.getPrevLineOverlayViews())&&void 0!==n?n:new Map,i=o.toString(),a=r.get(i);a&&(a.nextLineView=Ve.obtain(e.frame,e.roundRectProp,e.contextState),e.preLineView=Ve.obtain(a.frame,a.roundRectProp,a.contextState)),r.set(i,e),t.renderState.setPrevLineOverlayViews(r)}},t.prototype.handleBorderCrossPages=function(e,t,o,n){n&&((0,u.isPagedLayout)(t.docEnv.layoutType)||(e.isBorderCrossNextPage=!1,e.isBorderCrossPrePage=!1))},t.prototype.getScrollLeft=function(e){var t=e.layoutBox,o=e.shares,n=t.parentBox;if(!n)return 0;var r=n.contentSize,i=n.rectSize;if(r.width>i.width){var s=o.renderState.getScrollerInfo((0,l.NQT)(n.tableId))||{left:0};return(0,a.Ej)(s.left)}return 0},t}(rt),io=function(){function e(e,t){this._pluginsMap=new Map,this._defaultPlugin=new Wt(e,t);var o=new $t(e,t);this._pluginsMap.set(h.uOS.Page,new no(e,t)),this._pluginsMap.set(h.uOS.Body,new oo(e,t,o)),this._pluginsMap.set(h.uOS.HeaderFooter,new to(e,t,o)),this._pluginsMap.set(h.uOS.Table,new bt(e,t)),this._pluginsMap.set(h.uOS.TableRow,new ro(e,t)),this._pluginsMap.set(h.uOS.TableCell,new Rt(e,t)),this._pluginsMap.set(h.uOS.LeafContainer,new Tt(e,t)),this._pluginsMap.set(h.uOS.Image,new Tt(e,t)),this._pluginsMap.set(h.uOS.FieldContainer,new Tt(e,t)),this._pluginsMap.set(h.uOS.EmbeddedObject,new Tt(e,t)),this._pluginsMap.set(h.uOS.Text,new Ot(e,t)),this._pluginsMap.set(h.uOS.Line,new zt(e,t,this._pluginsMap.get(h.uOS.Text))),this._pluginsMap.set(h.uOS.Paragraph,new jt(e,t)),this._pluginsMap.set(h.uOS.RealShape,new qt(e,t)),this._pluginsMap.set(h.uOS.RealShapeGroup,new Qt(e,t)),this._pluginsMap.set(h.uOS.Field,new Zt(e,t,this._pluginsMap.get(h.uOS.Text))),this._pluginsMap.set(h.uOS.SubLine,new zt(e,t,this._pluginsMap.get(h.uOS.Text)))}return e.prototype.render=function(e){this._pluginsMap.has((0,h.$o4)(e.layoutBox))?this._pluginsMap.get((0,h.$o4)(e.layoutBox)).render(e):this._defaultPlugin.render(e),eo.renderInspect(e)},e}(),ao=function(){function e(e,t,o){this.context=e,this.layoutController=t,this.shares=o,this.checker=new nt,this.plugins=new io(e,o)}return e.prototype.findTableTraversalRange=function(e,t,o,n){var r=n.renderState.getScrollerInfo("table-".concat(e.tableId)),i=(0,a.Ej)(r?r.left:0),s=e.borderBoxSize,c=(0,l.SsA)(t.x+i,t.y,s.width,s.height),d=(0,l.Aa5)(o,c),p=l.d_x.findBoxTraversalIndex(e.rowHeights,t.y,d.y,d.y+d.height),h=l.d_x.findBoxTraversalIndex(e.colWidths,t.x,d.x,d.x+d.width);return{start:{hIndex:h.start,vIndex:p.start},end:{hIndex:h.end,vIndex:p.end}}},e.prototype.findBlockTraversalRange=function(e,t,o,n){if(e.children.length>0){var r=l.d_x.getBlockViewPortIndexRange(e.children,{firstPos:o.y,lastPos:o.y+o.height},t);return{start:{vIndex:r.first,hIndex:0},end:{vIndex:r.last,hIndex:0}}}},e.prototype.collectForRenderer=function(e,t,o,n){var r=e.pageIndex,i=e.subPageIndex,a=e.limitSubCanvasHeight,l=e.collectEngine,s=0,c=t.totalHeight;void 0!==i&&void 0!==a&&(s=i*a,c=Math.min(a,t.totalHeight-i*a)),this.checker.incRegion={x:0,y:s,width:t.totalWidth,height:c},this.collectSubtreeForRender({layoutBox:t,offset:{x:0,y:0}},l,o,r,!1,n);var d=(0,u.isPrintLayout)(this.shares.docEnv.layoutType)?t:t.parentBox;d&&this.collectFloatingBoxes(l,o,d,r)},e.prototype.getCollectIncRegion=function(){return this.checker.incRegion},e.prototype.collectSubtreeForRender=function(e,t,o,r,i,a){var s=this,c=this.layoutController.getLayoutBox(),d=e.layoutBox;t.zIndex=(0,h.vvs)(d)&&(0,h.EbP)(d)?d.floatingSpace.zIndex:f.aP,l.d_x.layoutBoxTraversal(e,(function(e){var d=e.parentBoxItem,p=e.childBoxItem,u=e.appendBox,f=null==d?void 0:d.flags,g=p.layoutBox,y=p.offset,v=p.traversalRange,x=p.flags;if(g.display===h.gyg.Block){var m=(0,h.vvs)(g)?g.floatingSpace.size.extent:g.totalHeight,w=s.checker.shouldRender({start:y.y,end:y.y+m});if((0,h.sJD)(g)&&w!==Ye.Break&&(w=Ye.Render),w===Ye.Break)return l.xt0.Break;if(w===Ye.Ignore)return l.xt0.Continue}return null==a||a(g),s.plugins.render({checker:s.checker,shares:o,collector:t,context:s.context,layoutController:s.layoutController,offset:y,parentOffset:null==d?void 0:d.offset,layoutBox:g,appendBox:u,traversalRange:v,onlyAnchors:!d&&i,flags:(0,n.__assign)((0,n.__assign)({},f),x),renderRootBox:c,pageIndex:r}),l.xt0.Continue})),t.zIndex=f.aP},e.prototype.collectFloatingBoxes=function(e,t,o,n){var r=this,i=o.constraintSpace;i&&i.getAllFloatingInfo().forEach((function(o){var i=o.isAdditional;i&&!(0,u.isPagedLayout)(r.shares.docEnv.layoutType)||r.collectSubtreeForRender({layoutBox:o.box,offset:o.offset,flags:{isInHeaderFooter:i,isCollectFloatingBoxes:!(0,h.YPi)(o.box)}},e,t,n,!0)}))},e}(),lo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,n.__extends)(t,e),t.prototype.shouldComponentUpdate=function(e){return this.props.layoutBox.uuid!==e.layoutBox.uuid||this.props.overlayNode!==e.overlayNode||this.props.subStoryInfo.subStoryProp.id!==e.subStoryInfo.subStoryProp.id||this.props.zoom!==e.zoom||this.props.renderRect!==e.renderRect||this.props.force!==e.force},t.prototype.render=function(){var e=this.props,t=e.layoutBox,o=e.children,r=e.shares,s=e.context,c=t.edge,d=r.docEnv.layoutType,p=t.getSiblingIndex()+1,h=this.zoom(),u=t.getOuterPoint(),f=(0,n.__assign)((0,n.__assign)({},l.vW8.boxSize(t,h)),{left:"".concat((0,a.FJ)(u.x)*h,"px"),top:"".concat((0,a.FJ)(u.y)*h,"px"),marginTop:"".concat((0,a.FJ)(c.margin.top)*h,"px"),marginLeft:"".concat((0,a.FJ)(c.margin.left)*h,"px"),marginRight:"".concat((0,a.FJ)(c.margin.right)*h,"px"),marginBottom:"".concat((0,a.FJ)(c.margin.bottom)*h,"px"),background:l.vW8.getPageViewBackground(d,s.docEnv.darkMode),boxShadow:l.vW8.getPageViewShadow(d),backdropFilter:l.vW8.getPageViewBackdropFilter(d),zIndex:O.MainView});return c.recycle(),i().createElement("div",{className:l.F51.meloPageView,"data-page-index":p,style:(0,n.__assign)({},l.vW8.cssPropsToStyle(f)),ref:this.rootRef},o)},t.prototype.zoom=function(){return this.props.zoom||1},t}($e),so=function(e){function t(t){var o=e.call(this,t)||this;o.renderViewRefs=[],o.addonViewRootElements=[],o.containerRootElements=[],o.upperAnchorRootElements=[],o.lowerAnchorRootElements=[],o.prevSortedRenderPages=[],o.pagesReused=[],o.pagesNewRender=[],o.pagesInRenderRect=[],o.pagesOutside=[],o.isZooming=!1,o.zoom=t.context.zoom,o.layoutBoxRenderer=new ao(o.props.context,o.props.layoutController,o.props.shares);var n=W;return o.props.shares.docEnv.docViewType===u.DocViewType.PrintPreview&&(n=h.LgD.Svg),n===h.LgD.Canvas?o.renderController=new Qe(o.props.layoutController,o.props.context):n===h.LgD.Svg&&(o.renderController=new Ze),o.state={zoom:o.zoom},o}var o,r,s,c,d,p,g,y;return(0,n.__extends)(t,e),t.prototype.componentDidMount=function(){this.renderController.initRenderViews(this.addonViewRootElements,this.containerRootElements,this.upperAnchorRootElements,this.lowerAnchorRootElements)},t.prototype.renderCanvas=function(e,t){var o=this,n={pagesInRenderRect:this.pagesInRenderRect,pagesOutside:this.pagesOutside,pagesNewRender:this.pagesNewRender};this.renderController.render({layoutBox:e,options:t,renderPages:n,zoom:this.zoom,context:this.props.context,doCollect:function(t){var n=t.pageIndex,r=e.children[n];return r&&o.layoutBoxRenderer.collectForRenderer(t,r,o.props.shares),o.layoutBoxRenderer.getCollectIncRegion()}})},t.prototype.render=function(){var e=this,t=this.getRenderPages();if(0===t.length)return null;var o=this.props.context.docEnv,r=o.docViewType,a=o.layoutType;return this.docBoxSize=l.vW8.calcDocBoxSize(t[0].parentBox,this.state.zoom),this.updateRenderPages(),i().createElement("div",{className:l.F51.meloDocView,style:(0,n.__assign)((0,n.__assign)({cursor:"text",marginBottom:l.vW8.getDocumentViewMarginBottom(a,r)},this.docBoxSize),{boxShadow:l.vW8.getDocumentViewShadow(a)}),"aria-hidden":!0,ref:this.rootRef,onMouseDown:function(t){e.onMouseDown(t)},onMouseMove:function(t){e.onMouseMove(t)},onMouseUp:function(t){e.onMouseUp(t)},onContextMenu:function(t){e.onContextMenu(t)},onTouchStart:function(t){e.onTouchStart(t)},onTouchMove:function(t){e.onTouchMove(t)},onTouchEnd:function(t){e.onTouchEnd(t)},onDoubleClick:function(t){e.onDoubleClick(t)}},this.addonViewComponent(),this.pagesComponent())},t.prototype.setZoom=function(e){if(this.zoom!==e){this.setState({zoom:e});var t=this.props.shares.renderState,o=t.getEditorInfo()||{zoom:1};o.zoom=e,t.setEditorInfo(o)}this.zoom=e},t.prototype.setZooming=function(e){this.isZooming=e},t.prototype.calMouseEventHitPoint=function(e){return this.calcHitPointWithBodyZoom({x:(0,a.Ej)(e.clientX),y:(0,a.Ej)(e.clientY)})},t.prototype.calTouchEventHitPoint=function(e){var t=e.nativeEvent.changedTouches.item(0);if(t)return this.calcHitPointWithBodyZoom({x:(0,a.Ej)(t.clientX),y:(0,a.Ej)(t.clientY)})},t.prototype.calcHitPointWithBodyZoom=function(e){var t;if(null===(t=this.rootRef)||void 0===t?void 0:t.current){var o=this.rootRef.current.getBoundingClientRect(),n=f.$w.getElementZoomValue(document.body);return{x:(e.x/n-(0,a.Ej)(o.left))/this.zoom,y:(e.y/n-(0,a.Ej)(o.top))/this.zoom}}},t.prototype.dispatchCustomEvent=function(e,t){e.target.dispatchEvent(new CustomEvent(t,{bubbles:!0,detail:{originalEvent:e.nativeEvent}}))},t.prototype.onMouseDown=function(e){var t=this.calMouseEventHitPoint(e);this.props.context.fire(new l.VDf(e,t),!1),e.nativeEvent.stopImmediatePropagation()},t.prototype.onMouseMove=function(e){var t=this.calMouseEventHitPoint(e);this.props.context.fire(new l.VDf(e,t),!1)},t.prototype.onMouseUp=function(e){var t=this.calMouseEventHitPoint(e);this.props.context.fire(new l.VDf(e,t),!1),this.dispatchCustomEvent(e,"mouseup_for_addon")},t.prototype.onContextMenu=function(e){var t=this.calMouseEventHitPoint(e);this.props.context.fire(new l.VDf(e,t),!1),e.nativeEvent.stopImmediatePropagation()},t.prototype.onDoubleClick=function(e){var t=this.calMouseEventHitPoint(e);this.props.context.fire(new l.VDf(e,t),!1),e.nativeEvent.stopImmediatePropagation()},t.prototype.onTouchStart=function(e){if(!this.isMobileZooming()){var t=this.calTouchEventHitPoint(e);this.props.context.fire(new l.NkY(e,t),!1),e.nativeEvent.stopImmediatePropagation()}},t.prototype.onTouchMove=function(e){if(!this.isMobileZooming()){var t=this.calTouchEventHitPoint(e);this.props.context.fire(new l.NkY(e,t),!1),e.nativeEvent.stopImmediatePropagation()}},t.prototype.onTouchEnd=function(e){if(!this.isMobileZooming()){var t=this.calTouchEventHitPoint(e);this.props.context.fire(new l.NkY(e,t),!1),e.nativeEvent.stopImmediatePropagation()}},t.prototype.isMobileZooming=function(){return!1},t.prototype.addonViewComponent=function(){var e,t=this,o=this.props.layoutBox;if(!o)return null;var r=(0,a.FJ)(o.edge.padding.top),s={top:-r,bottom:0,left:0,right:0},c=l.vW8.calcDocBoxSize(o,void 0,s),d=o.lastChild,p={x:0,y:(null==d?void 0:d.edge.margin.bottom)||0},h=this.getLayoutBoxZoomTransform(o,p);return i().createElement("div",{className:l.F51.meloAddonView,style:(0,n.__assign)({position:"absolute",zIndex:O.ContainerView,whiteSpace:"pre",transform:h,pointerEvents:"none",top:"".concat(r,"px")},c)},i().createElement(E,{ref:function(e){t.addonViewRootElements[0]=e},zoom:this.state.zoom,disabled:null===(e=this.props.shares.renderState.getFocusOnInfo())||void 0===e?void 0:e.isFocusHeaderFooter}))},t.prototype.pagesComponent=function(){var e=this.getSortedPagesToRender();return this.prevSortedRenderPages=e,this.generateSortedPagesComponents(e)},t.prototype.updateRenderPages=function(){this.updatePagesInRenderRect(),this.updatePagesReused(),this.updatePagesNewRender()},t.prototype.updatePagesInRenderRect=function(){var e=this.props.renderRect,t=[];this.getRenderPages().forEach((function(o,n){var r=o.getOuterPoint(),i=new a.HL({x:0,y:r.y,width:o.totalWidth,height:o.totalHeight});(null==e?void 0:e.intersect(i))&&t.push(n)})),this.pagesInRenderRect=t},t.prototype.updatePagesReused=function(){var e=this;this.pagesReused=this.pagesInRenderRect.filter((function(t){return e.prevSortedRenderPages.includes(t)}))},t.prototype.updatePagesNewRender=function(){var e=this;this.pagesNewRender=this.pagesInRenderRect.filter((function(t){return!e.prevSortedRenderPages.includes(t)}))},t.prototype.getSortedPagesToRender=function(){var e=[];0===this.pagesReused.length?(e=(0,n.__spreadArray)([],(0,n.__read)(this.pagesInRenderRect),!1),this.pagesOutside=[]):e=this.adjustPagesOrder();var t=this.getRenderPages();return e.filter((function(e){return t[e]}))},t.prototype.adjustPagesOrder=function(){var e=this,t=(0,n.__spreadArray)([],(0,n.__read)(this.pagesNewRender),!1),o=[],r=[];return this.prevSortedRenderPages.forEach((function(n){!e.pagesReused.includes(n)&&t.length>0?o.push(t.pop()):(o.push(n),e.pagesReused.includes(n)||r.push(n))})),this.pagesOutside=r,(0,n.__spreadArray)((0,n.__spreadArray)([],(0,n.__read)(o),!1),(0,n.__read)(t),!1)},t.prototype.generateSortedPagesComponents=function(e){var t=this,o=this.props,r=o.overlayNode,a=o.renderRect,s=(o.layoutBox,(0,n.__rest)(o,["overlayNode","renderRect","layoutBox"])),c=this.props.shares.decoratorManager.getDecorator(l.cip.Page),d=this.getRenderPages();return e.map((function(e,o){var l=d[e];if(!l)return null;var p=t.calcPageLayoutStyle(l,e),h=t.getFrontBehindContent(c,t.props.layoutBox),f=h.behindContent,g=h.frontContent,y=t.props.context.docEnv.layoutType;return[i().createElement(lo,(0,n.__assign)({key:"logic-page-".concat(o),layoutBox:l,overlayNode:r.childAt(e),zoom:t.state.zoom,renderRect:a},s),t.printCoverComponent(),(0,u.isPrintLayout)(y)||(0,u.isScrollLayout)(y)?t.frontViewComponent(g,p):"",t.upperAnchorViewComponent(e,p),t.containerViewComponent(e,p),t.renderCanvasViewComponent(e),t.lowerAnchorViewComponent(e,p),(0,u.isPrintLayout)(y)||(0,u.isScrollLayout)(y)?t.behindViewComponent(f,p):""),i().createElement(ot,{key:"gap-".concat(e),pageBox:l,layoutType:y,zoom:t.state.zoom,context:t.props.context})]}))},t.prototype.getPageOverflowStyle=function(){return(0,u.isPrintLayout)(this.props.shares.docEnv.layoutType)?"hidden":"visible"},t.prototype.getFrontBehindContent=function(e,t){var o=e.decorate(t);return{frontContent:this.getDecoratedContent(o,l.hjr.Front),behindContent:this.getDecoratedContent(o,l.hjr.Back)}},t.prototype.getDecoratedContent=function(e,t){var o=[];return e.forEach((function(e){var r=(0,n.__read)(e,2),i=r[0];r[1].order===t&&o.push(i)})),o},t.prototype.calcPageLayoutStyle=function(e,t){var o,r,i=l.vW8.boxSize(e),a={x:0,y:(null===(r=null===(o=e.parentBox)||void 0===o?void 0:o.lastChild)||void 0===r?void 0:r.edge.margin.bottom)||0},s=this.getLayoutBoxZoomTransform(e,a),c=this.pagesOutside.includes(t)?"none":"";return(0,n.__assign)({display:c,transform:s},i)},t.prototype.printCoverComponent=function(){return i().createElement("div",{id:"print-disable-cover",style:{display:"none",position:"absolute",width:"100%",height:"1000px",zIndex:O.PrintCover,pointerEvents:"none",backgroundColor:"#fff",overflow:this.getPageOverflowStyle()}})},t.prototype.frontViewComponent=function(e,t){return i().createElement("div",{className:l.F51.meloPageFrontView,style:(0,n.__assign)((0,n.__assign)({position:"absolute",zIndex:O.FrontView,pointerEvents:"none"},t),{overflow:this.getPageOverflowStyle()})},e)},t.prototype.upperAnchorViewComponent=function(e,t){var o=this;return i().createElement("div",{className:l.F51.meloPageUpperAnchorView,style:(0,n.__assign)((0,n.__assign)({position:"absolute",zIndex:O.UpperAnchorView,pointerEvents:"none"},t),{overflow:this.getPageOverflowStyle()})},i().createElement(A,{ref:function(t){o.upperAnchorRootElements[e]=t}}))},t.prototype.lowerAnchorViewComponent=function(e,t){var o=this;return i().createElement("div",{className:l.F51.meloPageLowerAnchorView,style:(0,n.__assign)((0,n.__assign)({position:"absolute",zIndex:O.LowerAnchorView},t),{overflow:this.getPageOverflowStyle()})},i().createElement(A,{ref:function(t){o.lowerAnchorRootElements[e]=t}}))},t.prototype.containerViewComponent=function(e,t){var o=this,r="".concat(l.F51.meloPageContainerView);return i().createElement("div",{className:"".concat(r," page-").concat(e),style:(0,n.__assign)({zIndex:O.ContainerView,filter:this.props.context.docEnv.darkMode?N:""},t)},i().createElement(T,{ref:function(t){o.containerRootElements[e]=t},zoom:this.state.zoom}))},t.prototype.behindViewComponent=function(e,t){return i().createElement("div",{className:l.F51.meloPageBehindView,style:(0,n.__assign)((0,n.__assign)({position:"absolute",zIndex:O.BehindView,pointerEvents:"none"},t),{overflow:this.getPageOverflowStyle()})},e)},t.prototype.renderCanvasViewComponent=function(e){var t=this;this.renderViewRefs[e]||(this.renderViewRefs[e]=i().createRef());var o=this.props.renderRect,n=this.state.zoom,r=[];return this.getRenderPages().forEach((function(a,s){e===s&&r.push(i().createElement("div",{className:l.F51.meloPageCanvasView,style:{zIndex:O.MainView},ref:t.renderViewRefs[e]},t.renderController.getRenderViewComponent(e,o,a,n)))})),r},t.prototype.getLayoutBoxZoomTransform=function(e,t){void 0===t&&(t={x:0,y:0});var o=this.state.zoom,n=(0,a.FJ)(e.totalWidth-t.x)*(o-1)/2,r=(0,a.FJ)(e.totalHeight-t.y)*(o-1)/2;return"matrix(".concat(o,", 0, 0, ").concat(o,", ").concat(n,", ").concat(r,")")},t.prototype.getRenderPages=function(){var e,t;return null!==(t=null===(e=this.props.layoutBox)||void 0===e?void 0:e.children)&&void 0!==t?t:[]},(0,n.__decorate)([(0,f.o3)(),(0,n.__metadata)("design:type",Function),(0,n.__metadata)("design:paramtypes",["function"==typeof(o=void 0!==i()&&i().MouseEvent)?o:Object]),(0,n.__metadata)("design:returntype",void 0)],t.prototype,"onMouseDown",null),(0,n.__decorate)([(0,f.o3)(),(0,n.__metadata)("design:type",Function),(0,n.__metadata)("design:paramtypes",["function"==typeof(r=void 0!==i()&&i().MouseEvent)?r:Object]),(0,n.__metadata)("design:returntype",void 0)],t.prototype,"onMouseMove",null),(0,n.__decorate)([(0,f.o3)(),(0,n.__metadata)("design:type",Function),(0,n.__metadata)("design:paramtypes",["function"==typeof(s=void 0!==i()&&i().MouseEvent)?s:Object]),(0,n.__metadata)("design:returntype",void 0)],t.prototype,"onMouseUp",null),(0,n.__decorate)([(0,f.o3)(),(0,n.__metadata)("design:type",Function),(0,n.__metadata)("design:paramtypes",["function"==typeof(c=void 0!==i()&&i().MouseEvent)?c:Object]),(0,n.__metadata)("design:returntype",void 0)],t.prototype,"onContextMenu",null),(0,n.__decorate)([(0,f.o3)(),(0,n.__metadata)("design:type",Function),(0,n.__metadata)("design:paramtypes",["function"==typeof(d=void 0!==i()&&i().MouseEvent)?d:Object]),(0,n.__metadata)("design:returntype",void 0)],t.prototype,"onDoubleClick",null),(0,n.__decorate)([(0,f.o3)(),(0,n.__metadata)("design:type",Function),(0,n.__metadata)("design:paramtypes",["function"==typeof(p=void 0!==i()&&i().TouchEvent)?p:Object]),(0,n.__metadata)("design:returntype",void 0)],t.prototype,"onTouchStart",null),(0,n.__decorate)([(0,f.o3)(),(0,n.__metadata)("design:type",Function),(0,n.__metadata)("design:paramtypes",["function"==typeof(g=void 0!==i()&&i().TouchEvent)?g:Object]),(0,n.__metadata)("design:returntype",void 0)],t.prototype,"onTouchMove",null),(0,n.__decorate)([(0,f.o3)(),(0,n.__metadata)("design:type",Function),(0,n.__metadata)("design:paramtypes",["function"==typeof(y=void 0!==i()&&i().TouchEvent)?y:Object]),(0,n.__metadata)("design:returntype",void 0)],t.prototype,"onTouchEnd",null),t}($e),co=function(){function e(e){var t=this;this.rangeTree=new f.wc,this.uuidMap=new Map,this.selectedRangesMap=new Map,this.manualCheckRanges=function(){var e,o;if((0,n.__spreadArray)([],(0,n.__read)(t.selectedRangesMap.values()),!1).some((function(e){return 0===e.range.len})))t.selectedRangesMap.clear();else{t.createRangeTree();try{for(var r=(0,n.__values)(t.selectedRangesMap),i=r.next();!i.done;i=r.next()){var a=(0,n.__read)(i.value,2),l=a[0],s=a[1],c=t.rangeTree.find(s.range.begin());if(c.isPresent()){var d=c.get(),p=d.id,h=d.range;if(p===l&&h.equal(s.range))continue;t.selectedRangesMap.delete(l),t.selectedRangesMap.set(p,t.uuidMap.get(p))}else t.selectedRangesMap.delete(l)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(e)throw e.error}}}},this.refreshLayerState=(0,a.P2)((function(){var e=t.selectedRangesMap;t.keys=(0,n.__spreadArray)([],(0,n.__read)(e.keys()),!1),t.editor.fire(new l.SOA({gcpRangeCollection:(0,n.__spreadArray)([],(0,n.__read)(e.values()),!1)})),t.editor.view.forceOverlayRerender()}),50),this.insertActiveParagraphToRangeClass=function(e,o){var n=e.id;o&&t.selectedRangesMap.has(n)||(t.selectedRangesMap.delete(n),o&&t.selectedRangesMap.set(n,e))},this.changeActiveState=function(e,o,n){void 0===n&&(n=!0),o.forEach((function(o){return t.insertActiveParagraphToRangeClass(o,e)})),n&&t.manualCheckRanges(),t.refreshLayerState()},this.editor=e}return e.getInstance=function(t){return e.instance||(e.instance=new e(t)),e.instance},e.prototype.createRangeTree=function(){var e,t,o,r,i=this.rangeTree,l=this.uuidMap;try{for(var s=(0,n.__values)(l.values()),c=s.next();!c.done;c=s.next()){var d=c.value,p=d.layoutBox;p?d.range=p.getRange():a.Yd.info("Layout box is not ready for paragraph ".concat(d.id))}}catch(t){e={error:t}}finally{try{c&&!c.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}i.makeEmpty();try{for(var h=(0,n.__values)(l.values()),u=h.next();!u.done;u=h.next()){var f=u.value;i.insert(f.range.begin(),f)}}catch(e){o={error:e}}finally{try{u&&!u.done&&(r=h.return)&&r.call(h)}finally{if(o)throw o.error}}},e}()}}]),"object"==typeof globalThis&&(globalThis.jsExecEndTimeStamp=Date.now(),globalThis.cachedPerformanceEntries||(globalThis.cachedPerformanceEntries=[]),globalThis.cachedPerformanceEntries.push({name:"jsExec: js/public-5997-212737e9.js",entryType:"jsExec",startTime:globalThis.jsExecStartTimeStamp,endTime:globalThis.jsExecEndTimeStamp}));
//# sourceMappingURL=public-5997-212737e9.js.map