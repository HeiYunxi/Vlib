import{m as M,n as I,r as h,a as i,o as z,b as p,c as v,d as V,e as t,w as a,f as y,u as b,h as d,t as S,E as g}from"./index.cc30dbfe.js";import{u as x}from"./menu.895df529.js";import"./http.f2a51fde.js";const P={class:"card-header"},T=y("span",null,"\u83DC\u5355\u4FE1\u606F\u6DFB\u52A0",-1),Z={key:0},j={key:1},G={style:{"text-align":"center"}},H={slot:"footer",class:"dialog-footer",style:{"text-align":"center","padding-top":"20px"}},W={__name:"Add",setup(J){const k=M(),w=I(),l=h({menuId:"",cname:"",ename:"",path:"",component:"",icon:"",pid:"",sort:""});i([]),z(async()=>{l.menuId="",l.cname="",l.ename="",l.path="",l.component="",l.icon="",l.pid="",l.sort=""});const m=i(),C=h({cname:[{required:!0,message:"\u83DC\u5355\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],ename:[{required:!0,message:"\u83DC\u5355\u82F1\u6587\u540D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{validator:function(n,e,s){/^[a-zA-Z]+$/.test(e)==!1?s(new Error("\u83DC\u5355\u82F1\u6587\u540D\u5FC5\u987B\u4E3A\u82F1\u6587\u5B57\u6BCD")):s()},trigger:"blur"}],path:[{required:!0,message:"\u8BF7\u6C42\u5730\u5740\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],component:[{required:!0,message:"\u83DC\u5355\u8DEF\u5F84\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],icon:[{required:!0,message:"\u83DC\u5355\u56FE\u6807\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],pid:[{required:!0,message:"\u83DC\u5355\u7236id\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],sort:[{required:!0,message:"\u83DC\u5355\u6392\u5E8F\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),q=()=>{!m||m.value.validate(async n=>{if(n){const e=await x.saveMenu(l);e.data!=null?e.data?(g.info("\u65B0\u589E\u83DC\u5355\u6210\u529F"),w.push("/menu/list")):g.error("\u65B0\u589E\u83DC\u5355\u5931\u8D25"):g.error("\u670D\u52A1\u5668\u5185\u90E8\u9519\u8BEF")}else return!1})},U=()=>{!m||m.value.resetFields()},c=i(!1),_=i([]),R=h({children:"children",label:"label"}),$=i([]),E=i([]),f=i(null),N=async n=>{console.log(n);const e=await x.getMenuAll({});e.data!=null&&(_.value=e.data.data,console.log(_.value)),c.value=!0},A=()=>{if(f.value){const n=f.value.getCheckedKeys();if(n.length>1){g.error("\u53EA\u80FD\u9009\u62E9\u4E00\u4E2A\u7236\u8282\u70B9");return}l.pid=n[0],console.log("\u9009\u4E2D\u7684\u952E:",n[0]),c.value=!1}if(f.value){const n=f.value.getCheckedNodes();console.log("\u9009\u4E2D\u7684node:",n)}};return(n,e)=>{const s=p("el-button"),r=p("el-form-item"),u=p("el-input"),B=p("el-form"),D=p("el-card"),F=p("el-tree"),K=p("el-dialog");return v(),V("div",null,[t(D,null,{header:a(()=>[y("div",P,[T,t(s,{size:"mini",style:{float:"right"},onClick:e[0]||(e[0]=o=>b(w).go(-1))},{default:a(()=>[d("\u8FD4\u56DE")]),_:1}),d("\xA0\xA0\xA0 ")])]),default:a(()=>[t(B,{model:l,rules:C,ref_key:"ruleFormRef",ref:m},{default:a(()=>[b(k).query.edit=="1"?(v(),V("p",Z,[t(r,{label:"\u83DC\u5355\u7F16\u53F7:"},{default:a(()=>[d(S(b(k).query.menuId),1)]),_:1})])):(v(),V("p",j)),t(r,{label:"\u83DC\u5355\u540D\u79F0:",prop:"cname"},{default:a(()=>[t(u,{modelValue:l.cname,"onUpdate:modelValue":e[1]||(e[1]=o=>l.cname=o),style:{width:"300px"},placeholder:"\u8BF7\u8F93\u5165\u83DC\u5355\u540D\u79F0",class:"input-with-select"},null,8,["modelValue"])]),_:1}),t(r,{label:"\u83DC\u5355\u82F1\u6587\u540D:",prop:"ename"},{default:a(()=>[t(u,{modelValue:l.ename,"onUpdate:modelValue":e[2]||(e[2]=o=>l.ename=o),style:{width:"300px"},placeholder:"\u8BF7\u8F93\u5165\u83DC\u5355\u82F1\u6587\u540D",class:"input-with-select"},null,8,["modelValue"])]),_:1}),t(r,{label:"\u8BF7\u6C42\u5730\u5740:",prop:"path"},{default:a(()=>[t(u,{modelValue:l.path,"onUpdate:modelValue":e[3]||(e[3]=o=>l.path=o),style:{width:"300px"},placeholder:"\u8BF7\u8F93\u5165\u8BF7\u6C42\u5730\u5740",class:"input-with-select"},null,8,["modelValue"])]),_:1}),t(r,{label:"\u83DC\u5355\u8DEF\u5F84:",prop:"component"},{default:a(()=>[t(u,{modelValue:l.component,"onUpdate:modelValue":e[4]||(e[4]=o=>l.component=o),style:{width:"300px"},placeholder:"\u8BF7\u8F93\u5165\u83DC\u5355\u8DEF\u5F84",class:"input-with-select"},null,8,["modelValue"])]),_:1}),t(r,{label:"\u83DC\u5355\u56FE\u6807:",prop:"icon"},{default:a(()=>[t(u,{modelValue:l.icon,"onUpdate:modelValue":e[5]||(e[5]=o=>l.icon=o),style:{width:"300px"},placeholder:"\u8BF7\u8F93\u5165\u83DC\u5355\u56FE\u6807",class:"input-with-select"},null,8,["modelValue"])]),_:1}),t(r,{label:"\u7236\u7EA7\u83DC\u5355:",prop:"pid"},{default:a(()=>[t(u,{readonly:"",modelValue:l.pid,"onUpdate:modelValue":e[6]||(e[6]=o=>l.pid=o),style:{width:"300px"},placeholder:"\u8BF7\u9009\u62E9\u7236\u7EA7\u83DC\u5355",class:"input-with-select"},null,8,["modelValue"]),t(s,{type:"primary",onClick:e[7]||(e[7]=o=>N())},{default:a(()=>[d("\u9009\u62E9")]),_:1})]),_:1}),t(r,{label:"\u83DC\u5355\u6392\u5E8F:",prop:"sort"},{default:a(()=>[t(u,{modelValue:l.sort,"onUpdate:modelValue":e[8]||(e[8]=o=>l.sort=o),style:{width:"300px"},placeholder:"\u8BF7\u8F93\u5165\u83DC\u5355\u6392\u5E8F",class:"input-with-select"},null,8,["modelValue"])]),_:1}),t(s,{type:"primary",onClick:e[9]||(e[9]=o=>q())},{default:a(()=>[d("\u4FDD\u5B58")]),_:1}),t(s,{type:"primary",onClick:e[10]||(e[10]=o=>U())},{default:a(()=>[d("\u91CD\u7F6E")]),_:1})]),_:1},8,["model","rules"])]),_:1}),t(K,{title:"\u9009\u62E9\u7236\u7EA7\u83DC\u5355",modelValue:c.value,"onUpdate:modelValue":e[12]||(e[12]=o=>c.value=o),width:"700px","before-close":n.handleClose},{default:a(()=>[y("div",G,[t(F,{data:_.value,"check-strictly":!0,"show-checkbox":"","default-expand-all":!0,ref_key:"treeRef",ref:f,"node-key":"id","default-expanded-keys":E.value,"default-checked-keys":$.value,props:R},null,8,["data","default-expanded-keys","default-checked-keys","props"])]),y("div",H,[t(s,{onClick:e[11]||(e[11]=o=>c.value=!1)},{default:a(()=>[d("\u53D6 \u6D88")]),_:1}),t(s,{type:"primary",onClick:A},{default:a(()=>[d("\u786E \u5B9A")]),_:1})])]),_:1},8,["modelValue","before-close"])])}}};export{W as default};
